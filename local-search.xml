<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>javascriptæ€§èƒ½ä¼˜åŒ–</title>
    <link href="/2022/03/31/js%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    <url>/2022/03/31/js%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="å†…å­˜ç®¡ç†"><a href="#å†…å­˜ç®¡ç†" class="headerlink" title="å†…å­˜ç®¡ç†"></a>å†…å­˜ç®¡ç†</h1><p>js çš„å†…å­˜ç®¡ç†æ˜¯è‡ªåŠ¨çš„</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj1 = &#123;&#125;; <span class="hljs-comment">// ç”³è¯·ç©ºé—´</span>obj1.name = <span class="hljs-string">&quot;mmm&quot;</span>; <span class="hljs-comment">// ä½¿ç”¨ç©ºé—´</span>obj1 = <span class="hljs-literal">null</span>; <span class="hljs-comment">// é‡Šæ”¾</span></code></pre></div><h3 id="å†…å­˜é—®é¢˜"><a href="#å†…å­˜é—®é¢˜" class="headerlink" title="å†…å­˜é—®é¢˜"></a>å†…å­˜é—®é¢˜</h3><ul><li>  å†…å­˜æ³„æ¼</li><li>  å†…å­˜è†¨èƒ€</li><li>  é¢‘ç¹åƒåœ¾å›æ”¶</li></ul><h3 id="åˆ†ç¦»-DOM"><a href="#åˆ†ç¦»-DOM" class="headerlink" title="åˆ†ç¦» DOM"></a>åˆ†ç¦» DOM</h3><ul><li>  é¡µé¢ä¸Šä¸è£…è½½çš„ DOM</li><li>  åƒåœ¾å¯¹è±¡å¼•ç”¨çš„ DOM</li><li>  æ´»åŠ¨å¯¹è±¡å¼•ç”¨çš„ DOM</li></ul><h1 id="åƒåœ¾å›æ”¶"><a href="#åƒåœ¾å›æ”¶" class="headerlink" title="åƒåœ¾å›æ”¶"></a>åƒåœ¾å›æ”¶</h1><p>ä¸æ˜¯å¯è¾¾å¯¹è±¡å°±è¢«è§†ä¸ºå†…å­˜åƒåœ¾</p><h2 id="å¯è¾¾å¯¹è±¡"><a href="#å¯è¾¾å¯¹è±¡" class="headerlink" title="å¯è¾¾å¯¹è±¡"></a><strong>å¯è¾¾å¯¹è±¡</strong></h2><ul><li>  å¯ä»¥è®¿é—®åˆ°çš„å¯¹è±¡</li><li>  ä»æ ¹ï¼ˆå…¨å±€ï¼‰å‡ºå‘è®¿é—®</li></ul><h2 id="GC-ç®—æ³•"><a href="#GC-ç®—æ³•" class="headerlink" title="GC ç®—æ³•"></a>GC ç®—æ³•</h2><h3 id="å¼•ç”¨è®¡æ•°"><a href="#å¼•ç”¨è®¡æ•°" class="headerlink" title="å¼•ç”¨è®¡æ•°"></a>å¼•ç”¨è®¡æ•°</h3><p>å¼•ç”¨è®¡æ•°å™¨åˆ¤æ–­å¼•ç”¨è®¡æ•°</p><ul><li>  å‘ç°åƒåœ¾æ—¶ç«‹å³å›æ”¶ï¼ˆå¯¹è±¡ä¸Šä¿å­˜äº†è®¡æ•°å™¨ï¼‰</li><li>  æœ€å¤§é™åº¦å‡å°‘ç¨‹åºæš‚åœ</li><li>  æ— æ³•å›æ”¶å¾ªç¯å¼•ç”¨</li><li>  èµ„æºå¼€é”€è¾ƒå¤§ï¼ˆè®¡æ•°è®°å½•ï¼‰</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">const</span> o1 = &#123;&#125;;<span class="hljs-keyword">const</span> o2 = &#123;&#125;;<span class="hljs-comment">// ä»æ ¹æ— æ³•è®¿é—®åˆ°o1,o2</span><span class="hljs-comment">// ä½†æ˜¯o1,o2çš„å¼•ç”¨è®¡æ•°éƒ½ä¸æ˜¯0</span><span class="hljs-comment">// æ— æ³•è¢«å›æ”¶</span>o1.a = o2;o2.a = o1;<span class="hljs-keyword">return</span> <span class="hljs-number">123</span>;&#125;test();</code></pre></div><h3 id="æ ‡è®°æ¸…é™¤"><a href="#æ ‡è®°æ¸…é™¤" class="headerlink" title="æ ‡è®°æ¸…é™¤"></a>æ ‡è®°æ¸…é™¤</h3><p><em>ä¸¤æ¬¡éå†</em>æ‰€æœ‰å¯¹è±¡ï¼Œ1 æ ‡è®°å¯è¾¾å¯¹è±¡ï¼Œ2 æ¸…é™¤æ²¡æœ‰æ ‡è®°çš„å¯¹è±¡</p><ul><li>  ç©ºé—´ç¢ç‰‡åŒ–ï¼šå›æ”¶çš„ç©ºé—´å¯èƒ½å¾ˆç¢ï¼ˆ å†…å­˜åœ°å€ä¸è¿ç»­ï¼‰ä¸èƒ½æ»¡è¶³æ–°å˜é‡çš„éœ€æ±‚</li><li>  å¯ä»¥å›æ”¶å¾ªç¯å¼•ç”¨</li><li>  ä¸èƒ½ç«‹å³å›æ”¶</li></ul><h3 id="æ ‡è®°æ•´ç†"><a href="#æ ‡è®°æ•´ç†" class="headerlink" title="æ ‡è®°æ•´ç†"></a>æ ‡è®°æ•´ç†</h3><p>æ ‡è®°æ¸…é™¤å¹¶ä¸”ä¼šæŠŠå¯¹è±¡å­˜å‚¨çš„å†…å­˜åœ°å€è¿›è¡Œæ•´ç†ç§»åŠ¨</p><h3 id="åˆ†ä»£å›æ”¶"><a href="#åˆ†ä»£å›æ”¶" class="headerlink" title="åˆ†ä»£å›æ”¶"></a>åˆ†ä»£å›æ”¶</h3><h2 id="æ€§èƒ½å·¥å…·"><a href="#æ€§èƒ½å·¥å…·" class="headerlink" title="æ€§èƒ½å·¥å…·"></a>æ€§èƒ½å·¥å…·</h2><ul><li>performance<ul><li>  timeline</li></ul></li><li>memory<ul><li>  Head Snapshot =&gt; åˆ†ç¦» DOM</li></ul></li></ul><h1 id="v8"><a href="#v8" class="headerlink" title="v8"></a>v8</h1><ul><li>  js æ‰§è¡Œå¼•æ“</li><li>  ä¼˜ç§€çš„åƒåœ¾å›æ”¶</li><li>  å³æ—¶ç¼–è¯‘</li><li>  å†…å­˜è®¾é™</li></ul><h2 id="v8-ä½¿ç”¨çš„-GC-ç®—æ³•"><a href="#v8-ä½¿ç”¨çš„-GC-ç®—æ³•" class="headerlink" title="v8 ä½¿ç”¨çš„ GC ç®—æ³•"></a>v8 ä½¿ç”¨çš„ GC ç®—æ³•</h2><h3 id="åˆ†ä»£å›æ”¶-1"><a href="#åˆ†ä»£å›æ”¶-1" class="headerlink" title="åˆ†ä»£å›æ”¶"></a>åˆ†ä»£å›æ”¶</h3><blockquote><p>å†…å­˜åˆ†ä¸ºæ–°ç”Ÿä»£ï¼Œè€ç”Ÿä»£å¯¹è±¡</p></blockquote><table style="text-align:center"><thead><td colspan=2>æ–°ç”Ÿä»£</td><td>è€ç”Ÿä»£</td></thead><tbody><tr><td colspan=2>64ä½:32M  / 32ä½:16M</td><td>64ä½:1.4G  / 32ä½:700M</td></tr><tr><td>From</td><td>To</td><td>è€ç”Ÿä»£å­˜å‚¨åŒº</td></tr></tbody></table><h4 id="æ–°ç”Ÿä»£ç©ºé—´"><a href="#æ–°ç”Ÿä»£ç©ºé—´" class="headerlink" title="æ–°ç”Ÿä»£ç©ºé—´"></a>æ–°ç”Ÿä»£ç©ºé—´</h4><p>å­˜æ´»æ—¶é—´è¾ƒçŸ­çš„å¯¹è±¡</p><ul><li>  å¹³åˆ†ä¸¤ä¸ªç­‰å¤§ç©ºé—´</li><li>  ä½¿ç”¨ç©ºé—´ä¸º<code>From</code>ï¼Œç©ºé—²ç©ºé—´ä¸º<code>To</code></li><li>  æ´»åŠ¨å¯¹è±¡å­˜å‚¨åœ¨<code>From</code></li><li>  <code>æ ‡è®°æ•´ç†</code>åå°†æ´»åŠ¨å¯¹è±¡æ‹·è´åˆ°<code>To</code></li><li>  <code>From</code>å®Œå…¨é‡Šæ”¾ä¸<code>To</code>äº¤æ¢</li></ul><blockquote><p>æ™‹å‡</p></blockquote><ul><li>  å°†æ–°ç”Ÿä»£å¯¹è±¡ç§»åŠ¨åˆ°è€ç”Ÿä»£</li><li>  ä¸€è½® GC åè¿˜å­˜æ´»çš„å¯¹è±¡è¿›è¡Œæ™‹å‡</li><li>  <code>To</code>ç©ºé—´ä½¿ç”¨ç‡è¶…è¿‡ 25%</li></ul><h4 id="è€ç”Ÿä»£ç©ºé—´"><a href="#è€ç”Ÿä»£ç©ºé—´" class="headerlink" title="è€ç”Ÿä»£ç©ºé—´"></a>è€ç”Ÿä»£ç©ºé—´</h4><p>å­˜æ´»æ—¶é—´è¾ƒé•¿çš„å¯¹è±¡ï¼ˆå…¨å±€å˜é‡ï¼Œé—­åŒ…å†…çš„å˜é‡ï¼‰</p><ul><li>  ä¸»è¦ä½¿ç”¨<code>æ ‡è®°æ¸…é™¤</code></li><li>  <code>æ™‹å‡</code>å‘ç”Ÿæ—¶ï¼Œå¦‚æœå‡ºç°ç©ºé—´ä¸è¶³åˆ™ä¼š<code>æ ‡è®°æ•´ç†</code></li><li>  <code>å¢é‡æ ‡è®°</code>æé«˜æ•ˆç‡(å°†åƒåœ¾å›æ”¶åˆ†æ­¥æ‰§è¡Œï¼Œä¸ç¨‹åºæ‰§è¡Œäº¤æ›¿è¿›è¡Œï¼Œå‡å°‘ç¨‹åºå•æ¬¡ç­‰å¾…æ—¶é—´)</li></ul><h2 id="å †æ ˆå¤„ç†"><a href="#å †æ ˆå¤„ç†" class="headerlink" title="å †æ ˆå¤„ç†"></a>å †æ ˆå¤„ç†</h2><h3 id="å †æ ˆå‡†å¤‡"><a href="#å †æ ˆå‡†å¤‡" class="headerlink" title="å †æ ˆå‡†å¤‡"></a>å †æ ˆå‡†å¤‡</h3><ul><li>  æ‰§è¡Œç¯å¢ƒæ ˆ<code>ECStack - execution context stack</code></li><li>  æ‰§è¡Œä¸Šä¸‹æ–‡<code>EC(G)</code></li><li>  å…¨å±€ä¸Šä¸‹æ–‡<code>VO(G)</code></li><li>  å…¨å±€å¯¹è±¡<code>GO</code></li></ul><table style="text-align:center"><thead><td colspan=5>æ‰§è¡Œç¯å¢ƒæ ˆECStack</td><td>å…¨å±€å¯¹è±¡GO</td></thead><tbody><tr><td colspan=2>æ‰§è¡Œä¸Šä¸‹æ–‡EC(G)</td><td colspan=2>ç§æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡EC(func)</td><td rowspan=3>......</td><td colspan=1 rowspan=3>setInterval</br>setTimeout</td></tr><tr><td>å…¨å±€ä¸Šä¸‹æ–‡VO(G)</td><td>å…¶ä»–ä»£ç </td><td>å±€éƒ¨ä¸Šä¸‹æ–‡AO</td><td>å…¶ä»–ä»£ç </td></tr><tr><td>å¯é€šè¿‡window è®¿é—®GO</br>å­˜æ”¾å…¨å±€å˜é‡</td><td>{..func().}</td><td>...</td><td>...</td></tr></tbody></table>å †å†…å­˜<div style="display:flex;"><div style="height:100px;min-width:100px;border:1px solid"><div style="border-bottom:1px solid">0x000</div></div><div style="height:100px;min-width:100px;border:1px solid"><div style="border-bottom:1px solid">0x001</div></div><div style="height:100px;min-width:100px;border:1px solid"><div style="border-bottom:1px solid">0x002</div></div><div style="height:100px;min-width:100px;border:1px solid"><div style="border-bottom:1px solid">0x003 ã€funcã€‘</div><div style="padding:5px"><p>[[scope]]:EC(G)</p><p>ç¡®å®šä½œç”¨åŸŸé“¾</p></div></div><div style="height:100px;min-width:100px;border:1px solid"><div style="border-bottom:1px solid">...</div><div>...</div></div></div></br><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> obj1 = &#123;<span class="hljs-attr">x</span>:<span class="hljs-number">100</span>&#125;<span class="hljs-keyword">var</span> obj2 = obj1obj1.y = obj1 = &#123;<span class="hljs-attr">x</span>:<span class="hljs-number">200</span>&#125;<span class="hljs-comment">// å…ˆæ‰§è¡Œ obj1.y = &#123;x:200&#125;</span><span class="hljs-comment">// åæ‰§è¡Œ obj1 = &#123;x:200&#125;</span><span class="hljs-comment">// &#123;x:200&#125;é‡Œæ²¡æœ‰.y</span>obj1.y =&gt; <span class="hljs-literal">undefined</span>obj2 =&gt; &#123;<span class="hljs-attr">x</span>:<span class="hljs-number">100</span>,<span class="hljs-attr">y</span>:&#123;<span class="hljs-attr">x</span>:<span class="hljs-number">200</span>&#125;&#125;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> arr = [<span class="hljs-string">&#x27;xxx&#x27;</span>,<span class="hljs-string">&#x27;aaa&#x27;</span>]<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">obj</span>)</span>&#123;  obj[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;yyy&#x27;</span> <span class="hljs-comment">// obj = arr = [&#x27;yyy&#x27;,&#x27;aaa&#x27;]</span>  obj = [<span class="hljs-string">&#x27;nb&#x27;</span>]  obj[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;mmm&#x27;</span> <span class="hljs-comment">// obj[&#x27;nb&#x27;,&#x27;mmm&#x27;]</span>  <span class="hljs-built_in">console</span>.log(obj)&#125;foo(arr)</code></pre></div><blockquote><p>å˜é‡æŸ¥æ‰¾ï¼šé¡ºç€ä½œç”¨åŸŸé“¾ä¾æ¬¡è®¿é—®å¤–éƒ¨ä¸Šä¸‹æ–‡ &lt;AO1,AO2,â€¦VO&gt;</p></blockquote><blockquote><p>[[scope]] å‡½æ•°ä¹¦å†™æ—¶ç¡®å®šï¼Œæ‰€åœ¨ä¸Šä¸‹æ–‡</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span>  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(c+b++)  &#125;&#125;<span class="hljs-keyword">var</span> f = foo()f(<span class="hljs-number">5</span>) <span class="hljs-comment">// 7 5+2</span>f(<span class="hljs-number">10</span>) <span class="hljs-comment">// 13 10+3</span></code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> a = <span class="hljs-number">10</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">a</span>)</span>&#123;  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(b+(++a))  &#125;&#125;<span class="hljs-keyword">let</span> fn = foo(<span class="hljs-number">10</span>)fn(<span class="hljs-number">5</span>) <span class="hljs-comment">// 16</span>foo(<span class="hljs-number">6</span>)(<span class="hljs-number">7</span>) <span class="hljs-comment">// 14</span>fn(<span class="hljs-number">20</span>) <span class="hljs-comment">// 32</span></code></pre></div><h1 id="ä¼˜åŒ–æ‰‹æ®µ"><a href="#ä¼˜åŒ–æ‰‹æ®µ" class="headerlink" title="ä¼˜åŒ–æ‰‹æ®µ"></a>ä¼˜åŒ–æ‰‹æ®µ</h1><h3 id="å˜é‡å±€éƒ¨åŒ–"><a href="#å˜é‡å±€éƒ¨åŒ–" class="headerlink" title="å˜é‡å±€éƒ¨åŒ–"></a>å˜é‡å±€éƒ¨åŒ–</h3><p>ç¼©çŸ­è®¿é—®æ•°æ®æ—¶æŸ¥æ‰¾è·¯å¾„,å˜é‡å­˜å‚¨ä½ç½®ç¦»ä½¿ç”¨çš„åœ°æ–¹è¶Šè¿‘è¶Šå¥½</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// bad</span><span class="hljs-keyword">var</span> i,str = <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">packageDom</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">1000</span> ;i++&gt;)&#123;    str += i <span class="hljs-comment">//  æ¯æ¬¡å¾ªç¯éƒ½è¦å»VO(G)ä¸­æ‰èƒ½æ‰¾åˆ°str,i</span>  &#125;  <span class="hljs-keyword">return</span> str&#125;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// good</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">packageDom</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">let</span> str = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">1000</span> ;i++&gt;)&#123;    str += i <span class="hljs-comment">//  ä¸ç”¨è®¿é—®EC(G)</span>  &#125;  <span class="hljs-keyword">return</span> str&#125;</code></pre></div><h3 id="å‡å°‘è®¿é—®å±‚çº§"><a href="#å‡å°‘è®¿é—®å±‚çº§" class="headerlink" title="å‡å°‘è®¿é—®å±‚çº§"></a>å‡å°‘è®¿é—®å±‚çº§</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// bad</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name</span>)</span>&#123;  <span class="hljs-built_in">this</span>.name = <span class="hljs-string">&#x27;personnnn&#x27;</span>  <span class="hljs-built_in">this</span>.getName = <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name  &#125;&#125;<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> Person()p1.getName()</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// good</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name</span>)</span>&#123;  <span class="hljs-built_in">this</span>.name = <span class="hljs-string">&#x27;personnnn&#x27;</span>&#125;<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> Person()p1.name</code></pre></div><h3 id="ç¼“å­˜æ•°æ®"><a href="#ç¼“å­˜æ•°æ®" class="headerlink" title="ç¼“å­˜æ•°æ®"></a>ç¼“å­˜æ•°æ®</h3><p>ç¼“å­˜éœ€è¦å¤šæ¬¡ä½¿ç”¨çš„æ•°æ®</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// bad</span><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ;i &lt; <span class="hljs-number">100000</span> ;i++)&#123;  handle(xxxObj.key1)&#125;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// good</span><span class="hljs-keyword">const</span> cacheItem = xxxObj.key1<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ;i &lt; <span class="hljs-number">100000</span> ;i++)&#123;  handle(cacheItem)&#125;</code></pre></div><h3 id="å‡å°‘åˆ¤æ–­ï¼Œæå‰return"><a href="#å‡å°‘åˆ¤æ–­ï¼Œæå‰return" class="headerlink" title="å‡å°‘åˆ¤æ–­ï¼Œæå‰return"></a>å‡å°‘åˆ¤æ–­ï¼Œæå‰return</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//  bad</span><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">do</span>(<span class="hljs-params">k1,k2</span>)</span>&#123;  <span class="hljs-keyword">if</span>(k1)&#123;    <span class="hljs-keyword">if</span>(arr.includes(k1))&#123;      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;includes&#x27;</span>      <span class="hljs-keyword">if</span>(k2&gt;<span class="hljs-number">5</span>)&#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">666</span>      &#125;    &#125;  &#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;no argument&#x27;</span>  &#125;&#125;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//  good</span><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">do</span>(<span class="hljs-params">k1,k2</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!k1) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;no argument&#x27;</span>  <span class="hljs-keyword">if</span>(!arr.includes(k1)) <span class="hljs-keyword">return</span>   <span class="hljs-keyword">if</span>(k2&gt;<span class="hljs-number">5</span>)&#123;    <span class="hljs-keyword">return</span> <span class="hljs-number">666</span>  &#125;&#125;</code></pre></div><h3 id="å‡å°‘å¾ªç¯ä½“å†…æ“ä½œ"><a href="#å‡å°‘å¾ªç¯ä½“å†…æ“ä½œ" class="headerlink" title="å‡å°‘å¾ªç¯ä½“å†…æ“ä½œ"></a>å‡å°‘å¾ªç¯ä½“å†…æ“ä½œ</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// bad</span><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ; i&lt; arr.length ; i++)&#123;  ...&#125;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// good</span><span class="hljs-keyword">const</span> len = arr.length<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ; i &lt; len ; i++)&#123;  ...&#125;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// better</span><span class="hljs-keyword">while</span>(len--)&#123;  ...&#125;</code></pre></div><h3 id="å­—é¢é‡å’Œæ„é€ å‡½æ•°"><a href="#å­—é¢é‡å’Œæ„é€ å‡½æ•°" class="headerlink" title="å­—é¢é‡å’Œæ„é€ å‡½æ•°"></a>å­—é¢é‡å’Œæ„é€ å‡½æ•°</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// bad</span><span class="hljs-keyword">const</span> o1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>()o1.a = <span class="hljs-number">666</span><span class="hljs-keyword">const</span> str = <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(<span class="hljs-string">&#x27;mmm&#x27;</span>) <span class="hljs-comment">// ç‰¹åˆ«æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ€§èƒ½æŸè€—å¾ˆå¤§</span></code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// good</span><span class="hljs-keyword">const</span> o1 = &#123;  a : <span class="hljs-number">666</span>&#125; <span class="hljs-keyword">const</span> str = <span class="hljs-string">&#x27;mmm&#x27;</span> <span class="hljs-comment">// å­—é¢é‡è°ƒç”¨æ–¹æ³•æ—¶ä¼šè¢«åŒ…è£…ä¸ºå¯¹è±¡</span></code></pre></div><h3 id="é˜²æŠ–"><a href="#é˜²æŠ–" class="headerlink" title="é˜²æŠ–"></a>é˜²æŠ–</h3><h3 id="èŠ‚æµ"><a href="#èŠ‚æµ" class="headerlink" title="èŠ‚æµ"></a>èŠ‚æµ</h3>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
      <tag>js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>typescript</title>
    <link href="/2022/03/30/typescript/"/>
    <url>/2022/03/30/typescript/</url>
    
    <content type="html"><![CDATA[<h1 id="è¯­è¨€ç±»å‹"><a href="#è¯­è¨€ç±»å‹" class="headerlink" title="è¯­è¨€ç±»å‹"></a>è¯­è¨€ç±»å‹</h1><h2 id="ç±»å‹å®‰å…¨"><a href="#ç±»å‹å®‰å…¨" class="headerlink" title="ç±»å‹å®‰å…¨"></a>ç±»å‹å®‰å…¨</h2><ul><li>  å¼ºç±»å‹ ï¼ˆä¸å…è®¸éšå¼ç±»å‹è½¬æ¢ï¼‰</li><li>  å¼±ç±»å‹ ï¼ˆå…è®¸éšå¼è½¬æ¢ï¼‰</li></ul><h2 id="ç±»å‹æ£€æŸ¥"><a href="#ç±»å‹æ£€æŸ¥" class="headerlink" title="ç±»å‹æ£€æŸ¥"></a>ç±»å‹æ£€æŸ¥</h2><ul><li><p>  é™æ€ç±»å‹è¯­è¨€ ï¼ˆå˜é‡ç±»å‹ä¹¦å†™æ—¶å°±ç¡®å®šä¸”ä¸èƒ½ä¿®æ”¹ï¼‰</p></li><li><p>  åŠ¨æ€ç±»å‹è¯­è¨€ ï¼ˆå˜é‡ç±»å‹è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šï¼Œä¸”å¯ä»¥ä¿®æ”¹ï¼‰</p></li></ul><h2 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h2><ul><li>  å¼±ç±»å‹</li><li>  åŠ¨æ€ç±»å‹</li><li>  è„šæœ¬è¯­è¨€ï¼Œæ— éœ€ç¼–è¯‘</li></ul><h1 id="Flow"><a href="#Flow" class="headerlink" title="Flow"></a>Flow</h1><p><code>javascript</code>ç±»å‹æ£€æŸ¥å™¨</p><p>JUMP TO:<a href="https://github.com/facebook/flow">FLow</a></p><p>â€¦ç•¥è¿‡</p><h1 id="Typescript"><a href="#Typescript" class="headerlink" title="Typescript"></a>Typescript</h1><ul><li>  <code>javascript</code>çš„è¶…é›†</li><li>  åŠ å…¥<code>ECMAScript</code>æ–°ç‰¹æ€§å’Œç±»å‹ç³»ç»Ÿ</li><li>  æœ€ç»ˆä¼šè¢«ç¼–è¯‘å›<code>javascript</code></li></ul><h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><blockquote><p>åŸå§‹å€¼ç±»å‹ </p></blockquote><ul><li><p>  <code>string</code></p></li><li><p>  <code>number(NaN Infinity)</code></p></li><li><p>  <code>boolean</code></p></li><li><p>  <code>void</code></p></li><li><p>  <code>null</code></p></li><li><p>  <code>undefined</code></p></li><li><p>  <code>symbol</code></p><blockquote><hr></blockquote></li><li><p><code>object</code></p></li><li><p><code>array</code></p></li><li><p><code>tuple</code></p></li><li><p><code>enum</code></p></li><li><p><code>function</code></p></li><li><p><code>any</code></p></li></ul><h2 id="ç±»å‹æ¨æ–­"><a href="#ç±»å‹æ¨æ–­" class="headerlink" title="ç±»å‹æ¨æ–­"></a>ç±»å‹æ¨æ–­</h2><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> num1 = <span class="hljs-number">123</span>;<span class="hljs-comment">// num1:number</span>num1 = <span class="hljs-string">&quot;mmm&quot;</span>; <span class="hljs-comment">// error</span></code></pre></div><h2 id="ç±»å‹æ–­è¨€"><a href="#ç±»å‹æ–­è¨€" class="headerlink" title="ç±»å‹æ–­è¨€"></a>ç±»å‹æ–­è¨€</h2><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> num1 = n1 <span class="hljs-keyword">as</span> <span class="hljs-built_in">number</span>;<span class="hljs-keyword">const</span> num2 = &lt;<span class="hljs-built_in">number</span>&gt;n2;</code></pre></div><h2 id="interface-æ¥å£"><a href="#interface-æ¥å£" class="headerlink" title="interface æ¥å£"></a>interface æ¥å£</h2><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> Post &#123;[prop: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// åŠ¨æ€æˆå‘˜</span>content?: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// å¯é€‰</span><span class="hljs-keyword">readonly</span> author: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// åªè¯»</span>&#125;</code></pre></div><h2 id="class-ç±»"><a href="#class-ç±»" class="headerlink" title="class ç±»"></a>class ç±»</h2><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<span class="hljs-comment">// å¿…é¡»è¦ç±»å‹å£°æ˜</span><span class="hljs-keyword">public</span> name: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// é»˜è®¤ å…±æœ‰å±æ€§</span><span class="hljs-keyword">private</span> age: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// ç§æœ‰å±æ€§ï¼Œå­ç±»ä¸èƒ½è®¿é—®</span><span class="hljs-keyword">protected</span> gender: <span class="hljs-built_in">boolean</span>; <span class="hljs-comment">// åªèƒ½åœ¨å­ç±»ä¸­è®¿é—®</span><span class="hljs-keyword">private</span> <span class="hljs-comment">/*é»˜è®¤public*/</span> <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)</span> &#123;<span class="hljs-built_in">this</span>.name = name;<span class="hljs-built_in">this</span>.age = age;&#125; <span class="hljs-comment">// è®¾ç½®privateåä¸èƒ½åœ¨å¤–éƒ¨new</span><span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">create</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Person(name, age); <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œåˆ›å»ºå®ä¾‹</span>&#125;&#125;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> Eat &#123;eat(food: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span>;&#125;<span class="hljs-keyword">interface</span> Run &#123;run(distance: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span>;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> <span class="hljs-title">implements</span> <span class="hljs-title">Eat</span>, <span class="hljs-title">Run</span> </span>&#123;eat(food: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;åƒäº†&quot;</span> + food);&#125;run(distance: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;è·‘äº†&quot;</span> + distance);&#125;&#125;</code></pre></div><h3 id="æŠ½è±¡ç±»"><a href="#æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡ç±»"></a>æŠ½è±¡ç±»</h3><p>åªèƒ½è¢«ç»§æ‰¿ä¸èƒ½è¢«<code>new</code></p><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span></span>&#123;  eat(food:<span class="hljs-built_in">string</span>):<span class="hljs-built_in">void</span>&#123;    ...  &#125;  <span class="hljs-keyword">abstract</span> run (distance:<span class="hljs-built_in">number</span>):<span class="hljs-built_in">void</span>&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span></span>&#123;  <span class="hljs-comment">// æç¤º Non-abstract class &#x27;Cat&#x27; does not implement inherited abstract member &#x27;run&#x27; from class &#x27;Animal&#x27;.</span>  <span class="hljs-comment">// éœ€è¦è‡ªå·±å†™å‡ºç¬¦åˆrunå½¢çŠ¶çš„runæ–¹æ³•</span>  run(distance: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> &#123;    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;Method not implemented.&quot;</span>);  &#125;&#125;</code></pre></div><h2 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h2><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createArray</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">length:<span class="hljs-built_in">number</span>,value:T</span>):<span class="hljs-title">T</span>[]</span>&#123;  <span class="hljs-keyword">const</span> arr = <span class="hljs-built_in">Array</span>&lt;T&gt;(length).fill(value)  <span class="hljs-keyword">return</span> arr&#125;</code></pre></div><h2 id="ç±»å‹å£°æ˜"><a href="#ç±»å‹å£°æ˜" class="headerlink" title="ç±»å‹å£°æ˜"></a>ç±»å‹å£°æ˜</h2>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>typescript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‡½æ•°å¼ç¼–ç¨‹</title>
    <link href="/2022/03/29/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
    <url>/2022/03/29/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h1><ul><li>  å¯¹æ•°æ®ä¹‹é—´çš„è¿ç®—è¿‡ç¨‹è¿›è¡ŒæŠ½è±¡</li><li>  â€œå‡½æ•°â€æ˜¯æ•°å­¦ä¸­çš„â€œå‡½æ•°â€<code>a = sin(30)</code>ï¼Œæ˜¯ä¸€ç§æ˜ å°„å…³ç³»</li><li>  ç›¸åŒçš„è¾“å…¥ä¸€å®šä¼šå¾—åˆ°ç›¸åŒçš„è¾“å‡ºï¼ˆå‰¯ä½œç”¨ï¼‰</li></ul><h3 id="å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘"><a href="#å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘" class="headerlink" title="å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘"></a>å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘</h3><ul><li>  å‡½æ•°å¯ä»¥å­˜å‚¨åœ¨å˜é‡ä¸­</li><li>  å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•° <em>ï¼ˆé«˜é˜¶å‡½æ•°ï¼‰</em></li><li>  å‡½æ•°å¯ä»¥ä½œä¸ºè¿”å›å€¼ <em>ï¼ˆé«˜é˜¶å‡½æ•°ï¼‰</em></li></ul><blockquote><p>é«˜é˜¶å‡½æ•° =&gt; æŠ½è±¡é€šç”¨é—®é¢˜ï¼Œå±è”½å®ç°çš„ç»†èŠ‚</p></blockquote><h2 id="é—­åŒ…closure"><a href="#é—­åŒ…closure" class="headerlink" title="é—­åŒ…closure"></a>é—­åŒ…<code>closure</code></h2><p>JUMP To:<a href="https://tatekii33.cool/2022/02/24/%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE%E4%B8%8E%E9%97%AD%E5%8C%85">é—­åŒ…</a></p><h2 id="çº¯å‡½æ•°pf"><a href="#çº¯å‡½æ•°pf" class="headerlink" title="çº¯å‡½æ•°pf"></a>çº¯å‡½æ•°<code>pf</code></h2><ul><li>  ä¸ä¿®æ”¹å‚æ•°</li><li>  ä¸äº§ç”Ÿå‰¯ä½œç”¨</li><li>  ä¸è°ƒç”¨ä¸çº¯çš„æ–¹æ³•</li></ul><h3 id="çº¯å‡½æ•°çš„å¥½å¤„"><a href="#çº¯å‡½æ•°çš„å¥½å¤„" class="headerlink" title="çº¯å‡½æ•°çš„å¥½å¤„"></a>çº¯å‡½æ•°çš„å¥½å¤„</h3><ul><li>  å¯ç¼“å­˜</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// lodash.memoize()</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">memoize</span>(<span class="hljs-params">fn</span>) </span>&#123;<span class="hljs-keyword">const</span> cache = &#123;&#125;;<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">const</span> key = <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-built_in">arguments</span>);cache[key] = cache[key] || fn.apply(fn, <span class="hljs-built_in">arguments</span>);<span class="hljs-keyword">return</span> cache[key];&#125;;&#125;</code></pre></div><ul><li>  å¯æµ‹è¯•</li><li>  å¹¶è¡Œå¤„ç†(<code>webWorker</code>)</li></ul><h3 id="å‰¯ä½œç”¨effect"><a href="#å‰¯ä½œç”¨effect" class="headerlink" title="å‰¯ä½œç”¨effect"></a>å‰¯ä½œç”¨<code>effect</code></h3><ul><li>  å‡½æ•°çš„çŠ¶æ€ä¾èµ–å¤–éƒ¨çš„çŠ¶æ€å°±ä¼šå¸¦æ¥å‰¯ä½œç”¨</li><li>  å‰¯ä½œç”¨ä¼šä½¿å‡½æ•°ä¸çº¯</li></ul><h2 id="æŸ¯é‡ŒåŒ–curry"><a href="#æŸ¯é‡ŒåŒ–curry" class="headerlink" title="æŸ¯é‡ŒåŒ–curry"></a>æŸ¯é‡ŒåŒ–<code>curry</code></h2><p>JUMP To:<a href="https://tatekii33.cool/2022/02/24/%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE%E4%B8%8E%E9%97%AD%E5%8C%85">æŸ¯é‡ŒåŒ–</a></p><ul><li>  ç¼“å­˜å‡½æ•°çš„å‚æ•°</li><li>  å°†å¤šå…ƒå‡½æ•°è½¬åŒ–ä¸ºå¤šä¸ªä¸€å…ƒå‡½æ•°</li><li>  é™ä½å‡½æ•°çš„ç²’åº¦ï¼Œæ–¹ä¾¿ç»„åˆ</li><li></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// lodash.curry()</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">curry</span>(<span class="hljs-params">func</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">curried</span>(<span class="hljs-params">...args</span>) </span>&#123;<span class="hljs-keyword">if</span> (args.length &lt; func.length) &#123;<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> curried(...args.concat([...arguments]));&#125;;&#125;<span class="hljs-keyword">return</span> func(...args);&#125;;&#125;</code></pre></div><h2 id="å‡½æ•°ç»„åˆcompose"><a href="#å‡½æ•°ç»„åˆcompose" class="headerlink" title="å‡½æ•°ç»„åˆcompose"></a>å‡½æ•°ç»„åˆ<code>compose</code></h2><ul><li>  å°è£…æ´‹è‘±ä»£ç <code>_.toUpper(._first(._reverse(array)))</code></li><li>  å¿½ç•¥ä¸­é—´çŠ¶æ€ <em>(æ•°æ®ç®¡é“)</em></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript">fn: A -&gt; B -&gt; C -&gt; Dfn: A -----------&gt; D</code></pre></div><ul><li>  é»˜è®¤ä»å³å‘å·¦æ‰§è¡Œ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// lodash.flowRight()</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flowRight</span>(<span class="hljs-params">...fns</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) </span>&#123;<span class="hljs-keyword">return</span> fns.reduceRight(<span class="hljs-function">(<span class="hljs-params">acc, fn</span>) =&gt;</span> &#123;<span class="hljs-keyword">return</span> fn(acc);&#125;, ...args);&#125;;&#125;<span class="hljs-comment">// es6</span><span class="hljs-keyword">const</span> compose =(...fns) =&gt;(...args) =&gt;fns.reduceRight(<span class="hljs-function">(<span class="hljs-params">acc, fn</span>) =&gt;</span> fn(acc), ...args);</code></pre></div><h3 id="lodash-fp-æ¨¡å—"><a href="#lodash-fp-æ¨¡å—" class="headerlink" title="lodash/fp æ¨¡å—"></a>lodash/fp æ¨¡å—</h3><ul><li>  æŸ¯é‡ŒåŒ–çš„ lodash æ–¹æ³•</li><li>  å‡½æ•°å‚æ•°åœ¨å‰ï¼Œæ•°æ®åœ¨å</li></ul><p>(FP Guide)[<a href="https://github.com/lodash/lodash/wiki/FP-Guide]">https://github.com/lodash/lodash/wiki/FP-Guide]</a></p><div class="hljs code-wrapper"><pre><code class="hljs javascript">_.map([<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>], <span class="hljs-built_in">parseInt</span>);<span class="hljs-comment">// [1,NaN,NaN]</span><span class="hljs-comment">// mapFn(item,index|key,array)</span><span class="hljs-comment">// parseInt(string,radix)// å°†radixè¿›åˆ¶çš„stringè½¬ä¸ºåè¿›åˆ¶</span>fp.map(<span class="hljs-built_in">parseInt</span>, [<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>]);<span class="hljs-comment">// [1,2,3]</span></code></pre></div><h3 id="PointFree"><a href="#PointFree" class="headerlink" title="PointFree"></a><code>PointFree</code></h3><ul><li>  ä¸éœ€è¦æŒ‡æ˜å¤„ç†çš„æ•°æ®</li><li>  åªéœ€è¦åˆæˆè¿ç®—çš„è¿‡ç¨‹</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Hello World =&gt; hello_world</span><span class="hljs-keyword">const</span> f = fp.flowRight(fp.replace(<span class="hljs-regexp">/\s+/g</span>, <span class="hljs-string">&quot;_&quot;</span>), fp.toLower);f(<span class="hljs-string">&quot;Hello World&quot;</span>);</code></pre></div><h2 id="å‡½å­Functor"><a href="#å‡½å­Functor" class="headerlink" title="å‡½å­Functor"></a>å‡½å­<code>Functor</code></h2><ul><li>  ä¸€ä¸ªåŒ…è£¹å€¼çš„ç›’å­</li><li>  ä¸ç›´æ¥å¯¹å¤–æš´éœ²å€¼</li><li>  å®ç° map å¥‘çº¦</li></ul><h3 id="Eitherå‡½å­"><a href="#Eitherå‡½å­" class="headerlink" title="Eitherå‡½å­"></a><code>Either</code>å‡½å­</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Eitherå‡½å­</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Left</span> </span>&#123;<span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">of</span>(<span class="hljs-params">value</span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Left(value);&#125;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">value</span>)</span> &#123;<span class="hljs-built_in">this</span>._value = value;&#125;<span class="hljs-function"><span class="hljs-title">map</span>(<span class="hljs-params">fn</span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;&#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Right</span> </span>&#123;<span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">of</span>(<span class="hljs-params">value</span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Right(value);&#125;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">value</span>)</span> &#123;<span class="hljs-built_in">this</span>._value = value;&#125;<span class="hljs-function"><span class="hljs-title">map</span>(<span class="hljs-params">fn</span>)</span> &#123;<span class="hljs-keyword">return</span> Right.of(fn(<span class="hljs-built_in">this</span>._value));&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseJSON</span>(<span class="hljs-params">str</span>) </span>&#123;<span class="hljs-keyword">try</span> &#123;<span class="hljs-keyword">return</span> Right.of(<span class="hljs-built_in">JSON</span>.parse(str));&#125; <span class="hljs-keyword">catch</span> (e) &#123;<span class="hljs-keyword">return</span> Left.of(&#123; <span class="hljs-attr">error</span>: e.message &#125;);&#125;&#125;</code></pre></div><h3 id="IOå‡½å­"><a href="#IOå‡½å­" class="headerlink" title="IOå‡½å­"></a><code>IO</code>å‡½å­</h3><ul><li>  å°†ä¸çº¯çš„å‡½æ•°ç”¨å‡½å­ä¿å­˜</li><li>  å»¶è¿Ÿæ‰§è¡Œå‰¯ä½œç”¨ï¼Œå¹¶ä¸”ä¸çº¯çš„æ“ä½œäº¤ç”±è°ƒç”¨è€…å¤„ç†</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IO</span> </span>&#123;<span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">of</span>(<span class="hljs-params">value</span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IO(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> value;&#125;);&#125;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">fn</span>)</span> &#123;<span class="hljs-built_in">this</span>._value = fn;&#125;<span class="hljs-function"><span class="hljs-title">map</span>(<span class="hljs-params">fn</span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IO(fp.flowRight(fn, <span class="hljs-built_in">this</span>._value));&#125;&#125;<span class="hljs-keyword">const</span> path = IO.of(process).map(<span class="hljs-function">(<span class="hljs-params">p</span>) =&gt;</span> p.execPath);<span class="hljs-comment">// è¾“å‡ºçš„pathæ˜¯ä¸€ä¸ªåŒ…è£¹äº†å‰¯ä½œç”¨çš„çº¯å‡½æ•°</span>path._value();<span class="hljs-comment">// ç›´åˆ°æ‰§è¡Œ._value()æ—¶æ‰ä¼šå¤„ç†å‰¯ä½œç”¨</span></code></pre></div><h2 id="folktale"><a href="#folktale" class="headerlink" title="folktale"></a><code>folktale</code></h2><p>JUMP TO:<a href="https://folktale.origamitower.com/">https://folktale.origamitower.com/</a></p><h3 id="Taskå‡½å­"><a href="#Taskå‡½å­" class="headerlink" title="Taskå‡½å­"></a><code>Task</code>å‡½å­</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; task &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;folktale/concurrency/task&quot;</span>);<span class="hljs-keyword">const</span> &#123; split, find &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;lodash/fp&quot;</span>);<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs&quot;</span>);<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readFile</span>(<span class="hljs-params">filename</span>) </span>&#123;<span class="hljs-keyword">return</span> task(<span class="hljs-function">(<span class="hljs-params">resolver</span>) =&gt;</span> &#123;fs.readFile(filename, <span class="hljs-string">&quot;utf-8&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (err) resolver.reject(err);resolver.resolve(data);&#125;);&#125;);&#125;<span class="hljs-keyword">const</span> readVersion = readFile(<span class="hljs-string">&quot;package.json&quot;</span>).map(split(<span class="hljs-string">&quot;\n&quot;</span>)).map(find(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x.includes(<span class="hljs-string">&quot;version&quot;</span>))).run().listen(&#123;onRejected: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(err),onResolved: <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;res=&gt;&quot;</span>, val),&#125;);<span class="hljs-built_in">console</span>.log(readVersion);<span class="hljs-comment">// TaskExecution &#123;</span><span class="hljs-comment">//   _task: Task &#123; _computation: [Function (anonymous)] &#125;,</span><span class="hljs-comment">//   _deferred: Object [folktale:Deferred] &#123;&#125;,</span><span class="hljs-comment">//   _links: []</span><span class="hljs-comment">// &#125;</span><span class="hljs-comment">// res=&gt;   &quot;version&quot;: &quot;1.0.0&quot;,</span></code></pre></div><h3 id="Pointå‡½å­"><a href="#Pointå‡½å­" class="headerlink" title="Pointå‡½å­"></a><code>Point</code>å‡½å­</h3><ul><li>  å®ç°äº†<code>of</code>é™æ€æ–¹æ³•çš„å‡½å­</li><li>  é¿å…ä½¿ç”¨<code>new</code>æ¥åˆ›å»ºå¯¹è±¡</li><li>  ä¸Šé¢çš„éƒ½å±äº point å‡½å­,å°†å€¼åŒ…è£¹åˆ°ä¸Šä¸‹æ–‡ä¸­</li></ul><h3 id="Monadå‡½å­"><a href="#Monadå‡½å­" class="headerlink" title="Monadå‡½å­"></a><code>Monad</code>å‡½å­</h3><ul><li>  è¿”å›ä¸€ä¸ªå‡½å­</li><li>  å¯ä»¥æ‰å¹³åŒ–çš„<code>Point</code>å‡½å­</li><li>  å®ç°äº†é™æ€<code>join``of</code>æ–¹æ³•</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IO</span> </span>&#123;<span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">of</span>(<span class="hljs-params">value</span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IO(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> value;&#125;);&#125;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">fn</span>)</span> &#123;<span class="hljs-built_in">this</span>._value = fn;&#125;<span class="hljs-function"><span class="hljs-title">map</span>(<span class="hljs-params">fn</span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IO(fp.flowRight(fn, <span class="hljs-built_in">this</span>._value));&#125;<span class="hljs-function"><span class="hljs-title">join</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._value();&#125;<span class="hljs-function"><span class="hljs-title">flatMap</span>(<span class="hljs-params">fn</span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.map(fn).join();&#125;&#125;<span class="hljs-keyword">const</span> readFile = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">filename</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IO(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> fs.readFileSync(filename, <span class="hljs-string">&quot;utf-8&quot;</span>);&#125;);&#125;;<span class="hljs-keyword">const</span> print = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IO(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> x;&#125;);&#125;;<span class="hljs-keyword">const</span> res = readFile(<span class="hljs-string">&quot;package.json&quot;</span>).flatMap(print).join();</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue-router@4.xå®ç°åˆ†æ</title>
    <link href="/2022/03/22/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Dvue3-router/"/>
    <url>/2022/03/22/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Dvue3-router/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h1><h2 id="vue-router"><a href="#vue-router" class="headerlink" title="vue-router"></a>vue-router</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; ref, inject &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<span class="hljs-keyword">const</span> ROUTER_KEY = <span class="hljs-built_in">Symbol</span>();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useRouter</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> inject(ROUTER_KEY);&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createRouter</span>(<span class="hljs-params">options</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Router(options);&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createWebHashHistory</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bindEvent</span>(<span class="hljs-params">fn</span>) </span>&#123;<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&quot;hashchange&quot;</span>, fn);&#125;<span class="hljs-keyword">const</span> url = <span class="hljs-built_in">window</span>.location.hash.slice(<span class="hljs-number">1</span>) || <span class="hljs-string">&quot;/&quot;</span>;<span class="hljs-keyword">return</span> &#123;bindEvents,url,&#125;;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Router</span> </span>&#123;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">options</span>)</span> &#123;<span class="hljs-built_in">this</span>.history = options.history;<span class="hljs-built_in">this</span>.router = options.routes;<span class="hljs-built_in">this</span>.current = ref(<span class="hljs-built_in">this</span>.history.url);<span class="hljs-built_in">this</span>.history.bindEvents(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-built_in">this</span>.current.value = <span class="hljs-built_in">window</span>.location.hash.slice(<span class="hljs-number">1</span>);&#125;);&#125;<span class="hljs-function"><span class="hljs-title">install</span>(<span class="hljs-params">app</span>)</span> &#123;app.provide(ROUTER_KEY, <span class="hljs-built_in">this</span>);&#125;&#125;<span class="hljs-keyword">export</span> &#123; createRouter, createWebHashHistory, useRouter &#125;;</code></pre></div><h2 id="router-view"><a href="#router-view" class="headerlink" title="router-view"></a>router-view</h2><div class="hljs code-wrapper"><pre><code class="hljs vue">&lt;template&gt;&lt;component :is&#x3D;&quot;comp&quot;&gt;&lt;&#x2F;component&gt;&lt;&#x2F;template&gt;&lt;script setup&gt;import &#123; computed &#125; from &quot;vue&quot;;import &#123; useRouter &#125; from &quot;ğŸ‘†&quot;;const router &#x3D; useRouter();const comp &#x3D; computed(() &#x3D;&gt; &#123;const route &#x3D; router.routes.find((route) &#x3D;&gt; route.path &#x3D;&#x3D;&#x3D; router.current.value); &#x2F;&#x2F; ä½¿ç”¨pathæŸ¥æ‰¾return route ? route.component : null;&#125;);&lt;&#x2F;script&gt;</code></pre></div><h2 id="router-link"><a href="#router-link" class="headerlink" title="router-link"></a>router-link</h2><div class="hljs code-wrapper"><pre><code class="hljs vue">&lt;template&gt;&lt;a :href&#x3D;&quot;&#39;#&#39; + props.to&quot;&gt;  &lt;!-- ç®€å•çš„æ”¹å˜åœ°å€æ hash --&gt;&lt;slot &#x2F;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;template&gt;&lt;script setup&gt;const props &#x3D; defineProps(&#123;to: &#123;type: String,required: true,&#125;,&#125;);&lt;&#x2F;script&gt;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>vue</tag>
      
      <tag>vue-router</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>æºç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ‰‹å†™ç³»åˆ—</title>
    <link href="/2022/03/16/%E6%89%8B%E5%86%99/"/>
    <url>/2022/03/16/%E6%89%8B%E5%86%99/</url>
    
    <content type="html"><![CDATA[<h2 id="äº‹ä»¶ä¸­å¿ƒ-EventCenter"><a href="#äº‹ä»¶ä¸­å¿ƒ-EventCenter" class="headerlink" title="äº‹ä»¶ä¸­å¿ƒ EventCenter"></a>äº‹ä»¶ä¸­å¿ƒ EventCenter</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventCenter</span> </span>&#123;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-built_in">this</span>.events = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();&#125;<span class="hljs-function"><span class="hljs-title">register</span>(<span class="hljs-params">event, isOnce, fn, ...args1</span>)</span> &#123;<span class="hljs-keyword">const</span> curEvent = <span class="hljs-built_in">this</span>.events.has(event) ? <span class="hljs-built_in">this</span>.events.get(event) : <span class="hljs-built_in">this</span>.events.set(event, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()).get(event);curEvent.set(fn, <span class="hljs-function">(<span class="hljs-params">...args2</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> res = fn(...args1, ...args2);<span class="hljs-keyword">if</span> (isOnce) &#123;<span class="hljs-built_in">this</span>.off(event, fn);&#125;<span class="hljs-keyword">return</span> res;&#125;);&#125;<span class="hljs-function"><span class="hljs-title">on</span>(<span class="hljs-params">event, fn, ...args</span>)</span> &#123;register(event, <span class="hljs-literal">false</span>, fn, ...args);&#125;<span class="hljs-function"><span class="hljs-title">once</span>(<span class="hljs-params">event, fn, ...args</span>)</span> &#123;register(event, <span class="hljs-literal">true</span>, fn, ...args);&#125;<span class="hljs-function"><span class="hljs-title">off</span>(<span class="hljs-params">event, fn</span>)</span> &#123;<span class="hljs-keyword">if</span> (!event || !<span class="hljs-built_in">this</span>.events.has(event)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-keyword">if</span> (!fn) &#123;<span class="hljs-comment">// åˆ é™¤æ•´ä¸ªäº‹ä»¶</span><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.events.delete(event);&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-comment">// åˆ é™¤å•ä¸ªè®¢é˜…</span><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.events.get(event).delete(fn);&#125;&#125;<span class="hljs-function"><span class="hljs-title">fire</span>(<span class="hljs-params">event, ...args</span>)</span> &#123;<span class="hljs-keyword">const</span> curEvents = <span class="hljs-built_in">this</span>.events.get(event);<span class="hljs-keyword">if</span> (!curEvents) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> cb <span class="hljs-keyword">of</span> curEvents.values()) &#123;cb(...args);&#125;&#125;&#125;<span class="hljs-comment">// è¯·ä½¿ç”¨åŸç”Ÿä»£ç å®ç°ä¸€ä¸ªEventsæ¨¡å—ï¼Œå¯ä»¥å®ç°è‡ªå®šä¹‰äº‹ä»¶çš„è®¢é˜…ã€è§¦å‘ã€ç§»é™¤åŠŸèƒ½</span><span class="hljs-keyword">const</span> fn1 = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;I want sleep1&quot;</span>, ...args);<span class="hljs-keyword">const</span> fn2 = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;I want sleep2&quot;</span>, ...args);<span class="hljs-keyword">const</span> event = <span class="hljs-keyword">new</span> Events();event.on(<span class="hljs-string">&quot;sleep&quot;</span>, fn1, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);event.on(<span class="hljs-string">&quot;sleep&quot;</span>, fn2, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);event.fire(<span class="hljs-string">&quot;sleep&quot;</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>);<span class="hljs-comment">// I want sleep1 1 2 3 4 5 6</span><span class="hljs-comment">// I want sleep2 1 2 3 4 5 6</span>event.off(<span class="hljs-string">&quot;sleep&quot;</span>, fn1);event.once(<span class="hljs-string">&quot;sleep&quot;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;I want sleep&quot;</span>));event.fire(<span class="hljs-string">&quot;sleep&quot;</span>);<span class="hljs-comment">// I want sleep2 1 2 3</span><span class="hljs-comment">// I want sleep</span>event.fire(<span class="hljs-string">&quot;sleep&quot;</span>);<span class="hljs-comment">// I want sleep2 1 2 3</span></code></pre></div><h2 id="new-æ“ä½œç¬¦"><a href="#new-æ“ä½œç¬¦" class="headerlink" title="new æ“ä½œç¬¦"></a><code>new</code> æ“ä½œç¬¦</h2><p><code>new(constructor)</code>è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p><ol><li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</li><li>å°†è¿™ä¸ªç©ºå¯¹è±¡é“¾æ¥åˆ°æ„é€ å‡½æ•°çš„åŸå‹</li><li>å°†<code>this</code>æŒ‡å‘åˆ›å»ºå‡ºæ¥çš„ç©ºå¯¹è±¡å¹¶æ‰§è¡Œæ„é€ å‡½æ•°</li><li>å¦‚æœæ‰§è¡Œç»“æœæ˜¯å¯¹è±¡åˆ™è¿”å›è¿™ä¸ªç»“æœ</li><li>å¦åˆ™è¿”å›<code>this</code></li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> isObj = <span class="hljs-function"><span class="hljs-params">o</span> =&gt;</span> o !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> o === <span class="hljs-string">&#x27;object&#x27;</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_new</span>(<span class="hljs-params">func,...args</span>)</span>&#123;  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> func !== <span class="hljs-string">&quot;function&quot;</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;must new a function&quot;</span>);  <span class="hljs-keyword">const</span> newObj = <span class="hljs-built_in">Object</span>.create(func.prototype)  <span class="hljs-keyword">const</span> res = func.call(newObj...args)  <span class="hljs-keyword">return</span> isObj(res) ? res : newObj&#125;</code></pre></div><h2 id="Object-create"><a href="#Object-create" class="headerlink" title="Object.create"></a><code>Object.create</code></h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Object</span>._create = <span class="hljs-function">(<span class="hljs-params">instance, propertiesObject</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> instance !== <span class="hljs-string">&quot;function&quot;</span> || <span class="hljs-keyword">typeof</span> instance !== <span class="hljs-string">&quot;object&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;instance can only be object or function&quot;</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">F</span>(<span class="hljs-params"></span>) </span>&#123;&#125;F.prototype = instance;<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">new</span> F();<span class="hljs-keyword">if</span> (propertiesObject) &#123;<span class="hljs-built_in">Reflect</span>.ownKeys(propertiesObject).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;<span class="hljs-built_in">Reflect</span>.defineProperty(res, key, propertiesObject[key]);&#125;);&#125;&#125;;</code></pre></div><h2 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a><code>instanceof</code></h2><p>æ£€æµ‹å³ä¾§çš„åŸå‹æ˜¯å¦åœ¨å·¦ä¾§çš„åŸå‹é“¾ä¸Šæ¸¸ï¼Œä½†å®ƒä¸èƒ½æ£€æµ‹<code>null</code> å’Œ <code>undefined</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_instanceof</span>(<span class="hljs-params">L, R</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> L !== <span class="hljs-string">&quot;object&quot;</span> || L === <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;need object data&quot;</span>);&#125;L = <span class="hljs-built_in">Reflect</span>.getPrototypeOf(L); <span class="hljs-comment">// L = L.__proto__</span>R = R.prototype;<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<span class="hljs-keyword">if</span> (L === <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// åŸå‹è¿åˆ°å¤´</span><span class="hljs-keyword">if</span> (L === R) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;L = <span class="hljs-built_in">Reflect</span>.getPrototypeOf(L);&#125;&#125;</code></pre></div><h2 id="é˜²æŠ–å‡½æ•°"><a href="#é˜²æŠ–å‡½æ•°" class="headerlink" title="é˜²æŠ–å‡½æ•°"></a>é˜²æŠ–å‡½æ•°</h2><ul><li>  å°†é«˜é¢‘è°ƒç”¨å‡½æ•°æ›´æ”¹ä¸ºå›ºå®šæ—¶é—´ä¸å†è°ƒç”¨æ‰æ‰§è¡Œå›è°ƒ</li><li>  è¾“å…¥æ¡†è”æƒ³ï¼Œæäº¤æŒ‰é’®</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>func å›è°ƒ</span><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>wait é—´éš”æ—¶é—´</span><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;boolean&#125;</span> </span>immediate ç«‹å³æ‰§è¡Œï¼Ÿ</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debounce</span>(<span class="hljs-params">func, wait = <span class="hljs-number">300</span>, immediate = <span class="hljs-literal">true</span>, ...args1</span>) </span>&#123;<span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_debounce</span>(<span class="hljs-params">...args2</span>) </span>&#123;<span class="hljs-keyword">if</span> (timer) <span class="hljs-built_in">clearTimeout</span>(timer);<span class="hljs-keyword">const</span> init = immediate &amp;&amp; !timer;timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;timer = <span class="hljs-literal">null</span>;!immediate ? func.apply(<span class="hljs-built_in">this</span>, [...args1, ...args2]) : <span class="hljs-literal">null</span>;&#125;, wait);init ? func.apply(<span class="hljs-built_in">this</span>, [...args1, ...args2]) : <span class="hljs-literal">null</span>;&#125;_debounce.cancel = <span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-built_in">clearTimeout</span>(timer);timer = <span class="hljs-literal">null</span>;&#125;;<span class="hljs-keyword">return</span> _debounce;&#125;</code></pre></div><h2 id="èŠ‚æµå‡½æ•°"><a href="#èŠ‚æµå‡½æ•°" class="headerlink" title="èŠ‚æµå‡½æ•°"></a>èŠ‚æµå‡½æ•°</h2><ul><li>  å°†é«˜é¢‘è°ƒç”¨å‡½æ•°æ›´æ”¹ä¸ºå›ºå®šé—´éš”æ‰§è¡Œå›è°ƒ</li><li>  çª—å£æ»šåŠ¨ï¼Œçª—å£ç¼©æ”¾</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>func å›è°ƒ</span><span class="hljs-comment"> * <span class="hljs-doctag">@param </span>wait é—´éš”æ—¶é—´</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throttle</span>(<span class="hljs-params">func, wait = <span class="hljs-number">300</span>, ...args1</span>) </span>&#123;<span class="hljs-keyword">let</span> previous = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_throttle</span>(<span class="hljs-params">...args2</span>) </span>&#123;<span class="hljs-keyword">const</span> now = +<span class="hljs-built_in">Date</span>.now();<span class="hljs-keyword">const</span> interval = wait - (now - previous);<span class="hljs-keyword">if</span> (interval &lt;= <span class="hljs-number">0</span>) &#123;<span class="hljs-comment">// å‡‘å·§å’Œè®¾å®šé¢‘ç‡ç›¸åŒï¼Œä¸¤ä¸ªiféƒ½ä¼šæ»¡è¶³ï¼Œåˆ™å…ˆæ‰§è¡Œè¿™é‡Œ</span><span class="hljs-comment">// ä¹Ÿè¦æ¸…ç†å®šæ—¶å™¨</span><span class="hljs-built_in">clearTimeout</span>(timer)timer = <span class="hljs-literal">null</span><span class="hljs-comment">// æ“ä½œé¢‘ç‡æ…¢äºè®¾å®šé—´éš”</span>func.apply(<span class="hljs-built_in">this</span>, [...args1, ...args2]);previous = now;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!timer) &#123;<span class="hljs-comment">// å¦‚æœæ“ä½œé¢‘ç‡è¿‡å¿«</span><span class="hljs-comment">// å¹¶ä¸”è¿˜æ²¡æœ‰å®šæ—¶å™¨</span><span class="hljs-comment">// è®¾ç½®ä¸€ä¸ªè¾¾åˆ°è§„å®šé—´éš”åæ‰§è¡Œå›è°ƒçš„å®šæ—¶å™¨</span><span class="hljs-comment">// å¦‚æœæœ‰å®šæ—¶å™¨åˆ™return</span>timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-built_in">clearTimeout</span>(timer);timer = <span class="hljs-literal">null</span>;func.apply(<span class="hljs-built_in">this</span>, [...args1, ...args2]);previous = +<span class="hljs-built_in">Date</span>.now();&#125;);&#125;&#125;<span class="hljs-keyword">return</span> _throttle;&#125;</code></pre></div><h2 id="é‡è¯•å‡½æ•°"><a href="#é‡è¯•å‡½æ•°" class="headerlink" title="é‡è¯•å‡½æ•°"></a>é‡è¯•å‡½æ•°</h2><p>å®ç°ä¸€ä¸ªé‡è¯•å‡½æ•°ï¼ŒæŒ‰ä¸€å®šé—´éš”ä¸æ–­å°è¯•æ‰§è¡Œä¸€ä¸ª promise</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">retry</span>(<span class="hljs-params">func, wait, limit</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attempt</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">Promise</span>.resolve(func).then(resolve <span class="hljs-comment">/*å°è¯•resolve*/</span>).catch(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-keyword">if</span> (limit-- === <span class="hljs-number">1</span>) &#123;reject(<span class="hljs-string">&quot;è¾¾åˆ°æœ€å¤§å°è¯•æ¬¡æ•°&quot;</span>);&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">let</span> timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;attempt();<span class="hljs-built_in">clearTimeout</span>(timer);timer = <span class="hljs-literal">null</span>;&#125;, wait);&#125;&#125;);&#125;attempt();&#125;).catch(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(e);&#125;);&#125;</code></pre></div><h2 id="å¹¶å‘çº¿ç¨‹æ± "><a href="#å¹¶å‘çº¿ç¨‹æ± " class="headerlink" title="å¹¶å‘çº¿ç¨‹æ± "></a>å¹¶å‘çº¿ç¨‹æ± </h2><p>åŒæ—¶æ‰§è¡Œå‡ ä¸ªå‡½æ•°ï¼ˆor ä¸åŒå‚æ•°çš„åŒä¸€ä¸ªå‡½æ•°</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><span class="hljs-comment"> *  <span class="hljs-doctag">@params </span>limit å¹¶è¡Œé™åˆ¶</span><span class="hljs-comment"> *  <span class="hljs-doctag">@params </span>args å‚æ•°æ•°ç»„</span><span class="hljs-comment"> *  <span class="hljs-doctag">@params </span>func å‡½æ•°</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asyncPool</span>(<span class="hljs-params">limit, args, func</span>) </span>&#123;<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<span class="hljs-keyword">const</span> len = args.length;<span class="hljs-keyword">const</span> ret = []; <span class="hljs-comment">// æ‰€æœ‰ä»»åŠ¡</span><span class="hljs-keyword">const</span> executing = []; <span class="hljs-comment">// å¹¶è¡Œä¸­çš„ä»»åŠ¡</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enqueue</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">if</span> (i &gt; len - <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.resolve(); <span class="hljs-comment">// æ‰§è¡Œå®Œæ‰€æœ‰å‚æ•°ï¼Œresolve</span><span class="hljs-keyword">const</span> curArg = args[i]; <span class="hljs-comment">//  å½“å‰å‚æ•°</span><span class="hljs-keyword">const</span> p = <span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function">() =&gt;</span> func(curArg)); <span class="hljs-comment">// åŒ…è£…ä¸ºpromise</span><span class="hljs-keyword">const</span> e = p.then(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-comment">// å°è£…ä¸ºfulfilledåä»å¹¶å‘æ± ä¸­åˆ é™¤</span>executing.splice(executing.indexOf(e), <span class="hljs-number">1</span>);&#125;);ret.push(p); <span class="hljs-comment">// æ·»åŠ è¿›å¾…æ‰€æœ‰ä»»åŠ¡æ•°ç»„</span>executing.push(e); <span class="hljs-comment">// æ·»åŠ è¿›å¾…å¤„ç†ä»»åŠ¡æ•°ç»„</span><span class="hljs-keyword">let</span> r = <span class="hljs-built_in">Promise</span>.resolve();<span class="hljs-keyword">if</span> (executing.length === limit) &#123;<span class="hljs-comment">// å¦‚æœå¹¶è¡Œä»»åŠ¡æ•°è¾¾åˆ°é™åˆ¶ï¼Œå¼€å¯race</span>r = <span class="hljs-built_in">Promise</span>.race(executing);&#125;<span class="hljs-keyword">return</span> r.then(<span class="hljs-function">() =&gt;</span> enqueue());&#125;<span class="hljs-keyword">return</span> enqueue.then(<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">Promise</span>.all(ret));&#125;<span class="hljs-comment">// Promise.all åœ¨æ‰€æœ‰promise fulfilledåæ‰ä¼šè¾“å‡º</span><span class="hljs-comment">// åŒæ—¶executingåˆä¿è¯äº†åŒæ—¶åœ¨æ”¹å˜ä¸­çš„promiseä¸ä¼šè¶…å‡ºé™åˆ¶</span><span class="hljs-keyword">const</span> cb = <span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">console</span>.log(str), <span class="hljs-number">2000</span>);<span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">123</span>, <span class="hljs-number">124</span>, <span class="hljs-number">666</span>, <span class="hljs-number">777</span>, <span class="hljs-number">888</span>];<span class="hljs-built_in">console</span>.log(asyncPool(<span class="hljs-number">2</span>, arr, cb));</code></pre></div><h2 id="æ·±æ‹·è´"><a href="#æ·±æ‹·è´" class="headerlink" title="æ·±æ‹·è´"></a>æ·±æ‹·è´</h2><ul><li>  æµ…æ‹·è´<code>Object.assign/&#123;...originObj&#125;</code>é¢å¯¹å¼•ç”¨ç±»å‹åªæ‹·è´äº†æŒ‡é’ˆ</li><li>  <code>JSON.parse(JSON.stringify(originObj))</code>é¢å¯¹<em>å‡½æ•°</em>å’Œ<em>Symbol</em>ä¼šæŠ¥é”™</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> isObj = <span class="hljs-function">(<span class="hljs-params">o</span>) =&gt;</span> <span class="hljs-number">0</span> !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> o === <span class="hljs-string">&quot;object&quot;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepClone</span>(<span class="hljs-params">source, cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakSet</span>()</span>) </span>&#123;<span class="hljs-comment">// cacheå¤„ç†å¾ªç¯å¼•ç”¨</span><span class="hljs-keyword">if</span> (!isObj(source) || cache.has(source)) <span class="hljs-keyword">return</span> source;<span class="hljs-keyword">const</span> _constructor = source.constructor;<span class="hljs-keyword">const</span> newObj = _constructor === <span class="hljs-built_in">Object</span> ? &#123;&#125; : <span class="hljs-keyword">new</span> _constructor(source);<span class="hljs-comment">// ä¸åªæ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œä¹Ÿå¤„ç†å…¶ä»–çš„ç±»å‹åƒæ—¥æœŸå’Œæ­£åˆ™</span>cache.add(newObj);<span class="hljs-built_in">Reflect</span>.ownKeys(source).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;newObj[key] = deepClone(source[key], cache);&#125;);<span class="hljs-keyword">return</span> newObj;&#125;</code></pre></div><h2 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign"></a>Object.assign</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Object</span>._assign = <span class="hljs-function">(<span class="hljs-params">target, ...properties</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (target === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> target !== <span class="hljs-string">&quot;object&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;can only assign an object&quot;</span>);&#125;properties.reduce(<span class="hljs-function">(<span class="hljs-params">pre, acc</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (acc === <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> pre;<span class="hljs-comment">// ä¸å¯éå†å±æ€§ä¹Ÿä¼šè¢«æ‹·è´</span><span class="hljs-built_in">Reflect</span>.ownKeys(acc).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;pre[key] = acc[key];&#125;);<span class="hljs-keyword">return</span> pre;&#125;, target);&#125;;</code></pre></div><h2 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> _typeof = <span class="hljs-function">(<span class="hljs-params">o</span>) =&gt;</span> <span class="hljs-built_in">Object</span>.prototype.call(o).slice(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>).toLowerCase();</code></pre></div><h2 id="call-apply-bind"><a href="#call-apply-bind" class="headerlink" title="call/apply/bind"></a>call/apply/bind</h2><p>éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œåˆ™ <code>context</code> æŒ‡å®šä¸º <code>null</code> æˆ– <code>undefined</code> æ—¶ä¼šè‡ªåŠ¨æ›¿æ¢ä¸ºæŒ‡å‘å…¨å±€å¯¹è±¡ï¼ŒåŸå§‹å€¼ä¼šè¢«åŒ…è£…ã€‚</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Function</span>.prototype._call = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">context, ...args</span>) </span>&#123;<span class="hljs-keyword">const</span> func = <span class="hljs-built_in">this</span>;context = context || <span class="hljs-built_in">window</span>;<span class="hljs-keyword">const</span> caller = <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">&quot;caller&quot;</span>);context[caller] = func;<span class="hljs-keyword">const</span> res = context[caller](...args);<span class="hljs-built_in">Reflect</span>.delete(context, caller);<span class="hljs-keyword">return</span> res;&#125;;<span class="hljs-built_in">Function</span>.prototype._apply = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">context, args</span>) </span>&#123;<span class="hljs-keyword">const</span> func = <span class="hljs-built_in">this</span>;context = context || <span class="hljs-built_in">window</span>;<span class="hljs-keyword">const</span> caller = <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">&quot;caller&quot;</span>);context[caller] = func;<span class="hljs-keyword">const</span> res = context[caller](...args);<span class="hljs-built_in">Reflect</span>.delete(context, caller);<span class="hljs-keyword">return</span> res;&#125;;<span class="hljs-built_in">Function</span>.prototype._bind = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">context, ...args1</span>) </span>&#123;<span class="hljs-keyword">const</span> func = <span class="hljs-built_in">this</span>;context = context || <span class="hljs-built_in">window</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boundFn</span>(<span class="hljs-params">...args2</span>) </span>&#123;<span class="hljs-keyword">return</span> func.apply(<span class="hljs-built_in">this</span> <span class="hljs-keyword">instanceof</span> func ? <span class="hljs-built_in">this</span> : context, [...args1, ...args2]);&#125;boundFn.prototype = <span class="hljs-built_in">Object</span>.create(func.prototype);<span class="hljs-keyword">return</span> boundFn;&#125;;</code></pre></div><h2 id="å®ç°ä¸€ä¸ªè¿­ä»£å™¨"><a href="#å®ç°ä¸€ä¸ªè¿­ä»£å™¨" class="headerlink" title="å®ç°ä¸€ä¸ªè¿­ä»£å™¨"></a>å®ç°ä¸€ä¸ªè¿­ä»£å™¨</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createIterator</span>(<span class="hljs-params">arrayLike</span>) </span>&#123;<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> &#123;<span class="hljs-function"><span class="hljs-title">next</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-keyword">return</span> &#123;value: arrayLike[i],done: i &gt;= arrayLike.length,&#125;;&#125;,[<span class="hljs-built_in">Symbol</span>.Iterator]() &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;&#125;,&#125;;&#125;</code></pre></div><h2 id="å°è£…-ajax"><a href="#å°è£…-ajax" class="headerlink" title="å°è£… ajax"></a>å°è£… ajax</h2><p>ä½¿ç”¨ promise å°è£… ajax,<code>async javascript xml</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> request = <span class="hljs-function">(<span class="hljs-params">method, url, params = &#123;&#125;</span>) =&gt;</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.readyState !== <span class="hljs-number">4</span>) <span class="hljs-keyword">return</span>;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === <span class="hljs-number">200</span>) &#123;resolve(<span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">this</span>.response));&#125; <span class="hljs-keyword">else</span> &#123;reject(<span class="hljs-built_in">this</span>.statusText);&#125;&#125;;xhr.onerror = reject;xhr.responseType = <span class="hljs-string">&quot;json&quot;</span>;xhr.setRequestHeader(<span class="hljs-string">&quot;Accept&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);<span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^(get)$|^(GET)$/</span>.test(method)) &#123;<span class="hljs-keyword">let</span> paramsStr = <span class="hljs-string">&quot;&quot;</span>;<span class="hljs-built_in">Object</span>.entries(params).forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> [k, v] = item;paramsStr += <span class="hljs-string">`<span class="hljs-subst">$&#123;k&#125;</span>=<span class="hljs-subst">$&#123;v&#125;</span>&amp;`</span>;&#125;);xhr.open(<span class="hljs-string">&quot;GET&quot;</span>, url + <span class="hljs-string">`?<span class="hljs-subst">$&#123;paramsStr&#125;</span>`</span>);xhr.send();&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^(post)$|^(POST)$/</span>.test(method)) &#123;xhr.setRequestHeader(<span class="hljs-string">&quot;Content-type&quot;</span>, <span class="hljs-string">&quot;application/x-www-urlencode&quot;</span>);xhr.open(<span class="hljs-string">&quot;POST&quot;</span>, url);xhr.send(<span class="hljs-built_in">encodeURIComponent</span>(params));&#125;&#125;).catch(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(e);&#125;);&#125;;</code></pre></div><h2 id="sleep-å‡½æ•°"><a href="#sleep-å‡½æ•°" class="headerlink" title="sleep å‡½æ•°"></a>sleep å‡½æ•°</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sleep</span>(<span class="hljs-params">wait</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<span class="hljs-built_in">setTimeout</span>(resolve, wait);&#125;);&#125;</code></pre></div><h2 id="fill-æ–¹æ³•"><a href="#fill-æ–¹æ³•" class="headerlink" title="fill æ–¹æ³•"></a>fill æ–¹æ³•</h2><p>å¦‚æœ start æ˜¯ä¸ªè´Ÿæ•°, åˆ™å¼€å§‹ç´¢å¼•ä¼šè¢«è‡ªåŠ¨è®¡ç®—æˆä¸º length+start, å…¶ä¸­ length æ˜¯ this å¯¹è±¡çš„ length å±æ€§å€¼ã€‚å¦‚æœ end æ˜¯ä¸ªè´Ÿæ•°, åˆ™ç»“æŸç´¢å¼•ä¼šè¢«è‡ªåŠ¨è®¡ç®—æˆä¸º length+endã€‚</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype._fill = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value, startIndex, endIndex</span>) </span>&#123;<span class="hljs-keyword">let</span> i = startIndex &gt;= <span class="hljs-number">0</span> ? startIndex : startIndex + <span class="hljs-built_in">this</span>.length;endIndex = endIndex &gt;= <span class="hljs-number">0</span> ? endIndex : endIndex + <span class="hljs-built_in">this</span>.length;<span class="hljs-keyword">while</span> (i &lt; endIndex) &#123;<span class="hljs-built_in">this</span>[i++] = value;&#125;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;&#125;;</code></pre></div><h2 id="LRU-ç¼“å­˜"><a href="#LRU-ç¼“å­˜" class="headerlink" title="LRU ç¼“å­˜"></a>LRU ç¼“å­˜</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LRU</span>(<span class="hljs-params">capacity</span>) </span>&#123;<span class="hljs-built_in">this</span>.capacity = capacity;<span class="hljs-built_in">this</span>.cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();&#125;LRU.prototype.get = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.cache.has(key)) &#123;<span class="hljs-comment">// å¦‚æœæœ‰è¿™ä¸ªç¼“å­˜ï¼Œå–å‡ºå¹¶è°ƒæ•´åœ¨mapä¸­çš„ä½ç½®</span><span class="hljs-keyword">const</span> val = <span class="hljs-built_in">this</span>.cache.get(key);<span class="hljs-built_in">this</span>.cache.delete(key);<span class="hljs-built_in">this</span>.cache.set(key, val);<span class="hljs-keyword">return</span> val;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#125;&#125;;LRU.prototype.add = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, val</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.cache.has(key)) &#123;<span class="hljs-built_in">this</span>.cache.delete(key);<span class="hljs-built_in">this</span>.cache.set(key, val);&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">const</span> size = <span class="hljs-built_in">this</span>.cache.size;<span class="hljs-keyword">if</span> (size === <span class="hljs-built_in">this</span>.capacity) &#123;<span class="hljs-comment">// ç¼“å­˜æ»¡äº†ï¼Œåˆ é™¤æœ€æ—§çš„</span><span class="hljs-keyword">const</span> _key = <span class="hljs-built_in">this</span>.cache.keys().next().value;<span class="hljs-built_in">this</span>.cache.delete(_key);<span class="hljs-built_in">this</span>.cache.set(key, val);&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-built_in">this</span>.cache.set(key, val);&#125;&#125;&#125;;</code></pre></div><h2 id="co-å‡½æ•°-è‡ªæ‰§è¡Œ-generator-å‡½æ•°"><a href="#co-å‡½æ•°-è‡ªæ‰§è¡Œ-generator-å‡½æ•°" class="headerlink" title="co å‡½æ•° è‡ªæ‰§è¡Œ generator å‡½æ•°"></a>co å‡½æ•° è‡ªæ‰§è¡Œ generator å‡½æ•°</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">co</span>(<span class="hljs-params">generatorFunc</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<span class="hljs-comment">// ç”Ÿæˆå™¨</span><span class="hljs-keyword">const</span> gen = generatorFunc();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">step</span>(<span class="hljs-params">fn</span>) </span>&#123;<span class="hljs-keyword">let</span> res = <span class="hljs-literal">null</span>;<span class="hljs-keyword">try</span> &#123;res = fn.next();&#125; <span class="hljs-keyword">catch</span> (e) &#123;reject(e);&#125;<span class="hljs-keyword">if</span> (res.done) &#123;<span class="hljs-keyword">return</span> resolve(res.value);&#125;<span class="hljs-built_in">Promise</span>.resolve(res.value).then((v) =&gt; &#123;step(<span class="hljs-function">() =&gt;</span> gen.next(v));&#125;,(r) =&gt; &#123;step(<span class="hljs-function">() =&gt;</span> gen.throw(r));&#125;);&#125;step(<span class="hljs-function">() =&gt;</span> gen.next());&#125;);&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">co</span>(<span class="hljs-params">generator</span>) </span>&#123;<span class="hljs-keyword">const</span> g = generator();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleResult</span>(<span class="hljs-params">result</span>) </span>&#123;<span class="hljs-keyword">if</span> (result.done) &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.resolve(result.value);&#125;<span class="hljs-keyword">if</span> (!(result.value <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Promise</span>)) &#123;result.value = <span class="hljs-built_in">Promise</span>.resolve(result.value);&#125;<span class="hljs-keyword">return</span> result.value.then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> handleResult(data));&#125;<span class="hljs-keyword">return</span> handleResult(g.next());&#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vuex@3.xå®ç°åˆ†æ</title>
    <link href="/2022/03/14/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Dvue2-vuex/"/>
    <url>/2022/03/14/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Dvue2-vuex/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆå§‹åŒ–é˜¶æ®µ"><a href="#åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="åˆå§‹åŒ–é˜¶æ®µ"></a>åˆå§‹åŒ–é˜¶æ®µ</h1><h2 id="å®‰è£…-Vuex"><a href="#å®‰è£…-Vuex" class="headerlink" title="å®‰è£… Vuex"></a>å®‰è£… Vuex</h2><p>åœ¨ç»„ä»¶<code>beforeCreate</code>çš„é’©å­ä¸­å°† vuex çš„<code>Store</code>å®ä¾‹æŒ‚è½½åœ¨å®ä¾‹<code>this.$store</code>ä¸Šï¼›</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vuexInit</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">const</span> options = <span class="hljs-built_in">this</span>.$options;<span class="hljs-comment">// store injection</span><span class="hljs-keyword">if</span> (options.store) &#123;<span class="hljs-built_in">this</span>.$store = <span class="hljs-keyword">typeof</span> options.store === <span class="hljs-string">&quot;function&quot;</span> ? options.store() : options.store;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (options.parent &amp;&amp; options.parent.$store) &#123;<span class="hljs-comment">// å¦‚æœæ˜¯å­ç»„ä»¶ä¸­æ‰§è¡Œï¼Œä¹Ÿä¼šæŒ‡å‘æœ€é¡¶å±‚çš„$store</span><span class="hljs-built_in">this</span>.$store = options.parent.$store;&#125;&#125;</code></pre></div><h2 id="å®ä¾‹åŒ–-Store"><a href="#å®ä¾‹åŒ–-Store" class="headerlink" title="å®ä¾‹åŒ– Store"></a>å®ä¾‹åŒ– Store</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// è°ƒç”¨new Store()</span><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Store</span> </span>&#123;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">options = &#123;&#125;</span>)</span> &#123;<span class="hljs-comment">// optionsæ˜¯vueå®ä¾‹åŒ–çš„options</span><span class="hljs-keyword">const</span> &#123; plugins = [], strict = <span class="hljs-literal">false</span> &#125; = options;<span class="hljs-comment">// store internal state</span><span class="hljs-built_in">this</span>._committing = <span class="hljs-literal">false</span>;<span class="hljs-built_in">this</span>._actions = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);<span class="hljs-built_in">this</span>._actionSubscribers = [];<span class="hljs-built_in">this</span>._mutations = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);<span class="hljs-built_in">this</span>._wrappedGetters = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);<span class="hljs-built_in">this</span>._modules = <span class="hljs-keyword">new</span> ModuleCollection(options); <span class="hljs-comment">/* â­ï¸åˆå§‹åŒ–æ¨¡å— */</span><span class="hljs-built_in">this</span>._modulesNamespaceMap = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);<span class="hljs-built_in">this</span>._subscribers = [];<span class="hljs-built_in">this</span>._watcherVM = <span class="hljs-keyword">new</span> Vue(); <span class="hljs-comment">/*ç”¨ä¸€ä¸ªæ–°çš„vueå®ä¾‹ä½œä¸ºvuexWatcher*/</span><span class="hljs-comment">// bind commit and dispatch to self</span><span class="hljs-keyword">const</span> store = <span class="hljs-built_in">this</span>;<span class="hljs-keyword">const</span> &#123; dispatch, commit &#125; = <span class="hljs-built_in">this</span>;<span class="hljs-built_in">this</span>.dispatch = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boundDispatch</span>(<span class="hljs-params">type, payload</span>) </span>&#123;<span class="hljs-keyword">return</span> dispatch.call(store, type, payload);&#125;;<span class="hljs-built_in">this</span>.commit = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boundCommit</span>(<span class="hljs-params">type, payload, options</span>) </span>&#123;<span class="hljs-keyword">return</span> commit.call(store, type, payload, options);&#125;;<span class="hljs-comment">// æ ¹storeå°±æ˜¯_module.root</span><span class="hljs-keyword">const</span> state = <span class="hljs-built_in">this</span>._modules.root.state;<span class="hljs-comment">/* â­ï¸å®‰è£…æ¨¡å— */</span>installModule(<span class="hljs-built_in">this</span>, state, [], <span class="hljs-built_in">this</span>._modules.root);<span class="hljs-comment">// åˆå§‹åŒ– store vm, è´Ÿè´£æä¾›ç›¸åº”å¼</span><span class="hljs-comment">// (also registers _wrappedGetters as computed properties)</span>resetStoreVM(<span class="hljs-built_in">this</span>, state);<span class="hljs-comment">// åº”ç”¨plugin</span>plugins.forEach(<span class="hljs-function">(<span class="hljs-params">plugin</span>) =&gt;</span> plugin(<span class="hljs-built_in">this</span>));<span class="hljs-keyword">if</span> (Vue.config.devtools) &#123;<span class="hljs-comment">// devtool</span>devtoolPlugin(<span class="hljs-built_in">this</span>);&#125;&#125;&#125;</code></pre></div><h3 id="åˆå§‹åŒ–æ¨¡å—"><a href="#åˆå§‹åŒ–æ¨¡å—" class="headerlink" title="åˆå§‹åŒ–æ¨¡å—"></a>åˆå§‹åŒ–æ¨¡å—</h3><p>ä»æ ¹<code>module</code>å¼€å§‹ï¼ŒæŒ‰ç…§å±‚çº§å…³ç³»é€’å½’å®ä¾‹åŒ–æ‰€æœ‰çš„å­<code>module</code>ä¸ºä¸€æ•´ä¸ªæ ‘å½¢ç»“æ„çš„å¯¹è±¡</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ModuleCollection</span> </span>&#123;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">rawRootModule</span>)</span> &#123;<span class="hljs-comment">// ä¸ºæ ¹storeæ¨¡å—å¼€å§‹æ‰§è¡Œregisteræ–¹æ³•</span><span class="hljs-built_in">this</span>.register([], rawRootModule, <span class="hljs-literal">false</span>);&#125;<span class="hljs-comment">// æ ¹æ®pathå»æŸ¥æ‰¾æ¨¡å—</span><span class="hljs-function"><span class="hljs-title">get</span>(<span class="hljs-params">path</span>)</span> &#123;<span class="hljs-keyword">return</span> path.reduce(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-built_in">module</span>, key</span>) =&gt;</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">module</span>.getChild(key);<span class="hljs-comment">/**</span><span class="hljs-comment"> * getChild (key) &#123;</span><span class="hljs-comment"> *   return this._children[key]</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span>&#125;, <span class="hljs-built_in">this</span>.root);&#125;<span class="hljs-function"><span class="hljs-title">register</span>(<span class="hljs-params">path, rawModule, runtime = <span class="hljs-literal">true</span></span>)</span> &#123;<span class="hljs-comment">/// ...</span><span class="hljs-keyword">const</span> newModule = <span class="hljs-keyword">new</span> Module(rawModule, runtime);<span class="hljs-comment">// ç”Ÿæˆå•ä¸ªçš„moduleå®ä¾‹</span><span class="hljs-keyword">if</span> (path.length === <span class="hljs-number">0</span>) &#123;<span class="hljs-comment">// pathé•¿åº¦æ˜¯0è¯´æ˜æ˜¯æ ¹module</span><span class="hljs-built_in">this</span>.root = newModule;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-comment">// å¦åˆ™æ·»åŠ ä¸ºä¸Šçº§çš„å­æ¨¡å—</span><span class="hljs-keyword">const</span> parent = <span class="hljs-built_in">this</span>.get(path.slice(<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>));parent.addChild(path[path.length - <span class="hljs-number">1</span>], newModule);<span class="hljs-comment">/**</span><span class="hljs-comment"> * addChild (key, module) &#123;</span><span class="hljs-comment"> *   this._children[key] = module</span><span class="hljs-comment"> * &#125;</span><span class="hljs-comment"> */</span>&#125;<span class="hljs-comment">// ä¸ºå½“å‰æ¨¡å—ä¸­çš„æ‰€æœ‰å­æ¨¡å—é€’å½’è°ƒç”¨register</span><span class="hljs-keyword">if</span> (rawModule.modules) &#123;forEachValue(rawModule.modules, <span class="hljs-function">(<span class="hljs-params">rawChildModule, key</span>) =&gt;</span> &#123;<span class="hljs-built_in">this</span>.register(path.concat(key), rawChildModule, runtime);&#125;);&#125;&#125;&#125;</code></pre></div><h3 id="å®‰è£…æ¨¡å—"><a href="#å®‰è£…æ¨¡å—" class="headerlink" title="å®‰è£…æ¨¡å—"></a>å®‰è£…æ¨¡å—</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">installModule</span>(<span class="hljs-params">store, rootState, path, <span class="hljs-built_in">module</span>, hot</span>) </span>&#123;<span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æ ¹æ¨¡å—</span><span class="hljs-keyword">const</span> isRoot = !path.length;<span class="hljs-comment">// åˆ¤æ–­æœ‰æ²¡æœ‰å‘½åç©ºé—´</span><span class="hljs-keyword">const</span> namespace = store._modules.getNamespace(path);<span class="hljs-comment">// return namespace + (module.namespaced ? key + &#x27;/&#x27; : &#x27;&#x27;)</span><span class="hljs-comment">// æ³¨å†Œåˆ°namespace map</span><span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span>.namespaced) &#123;store._modulesNamespaceMap[namespace] = <span class="hljs-built_in">module</span>;&#125;<span class="hljs-comment">// set state</span><span class="hljs-keyword">if</span> (!isRoot &amp;&amp; !hot) &#123;<span class="hljs-keyword">const</span> parentState = getNestedState(rootState, path.slice(<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>));<span class="hljs-keyword">const</span> moduleName = path[path.length - <span class="hljs-number">1</span>];store._withCommit(<span class="hljs-function">() =&gt;</span> &#123;Vue.set(parentState, moduleName, <span class="hljs-built_in">module</span>.state);&#125;);&#125;<span class="hljs-keyword">const</span> local = (<span class="hljs-built_in">module</span>.context = makeLocalContext(store, namespace, path));<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªlocalä¸Šä¸‹æ–‡</span><span class="hljs-comment">// å¯¹äºæœ‰namespaceçš„dispatchå’Œcommitä¼šæ‹¼æ¥ä¸Šnamespace</span><span class="hljs-comment">// å¯¹äºæœ‰namespaceçš„getteræœ‰ç‰¹æ®Šå¤„ç†ï¼Œä¸æ˜¯ç›´æ¥è¿”å›è€Œæ˜¯ç”¨Objectã€‚definePropertyè®¾ç½®äº†getter</span><span class="hljs-comment">/** </span><span class="hljs-comment">   * function makeLocalContext (store, namespace, path) &#123;</span><span class="hljs-comment">        const noNamespace = namespace === &#x27;&#x27;</span><span class="hljs-comment">        const local = &#123;</span><span class="hljs-comment">          dispatch: noNamespace ? store.dispatch : (_type, _payload, _options) =&gt; &#123;...&#125;),</span><span class="hljs-comment">          commit: noNamespace ? store.commit : (_type, _payload, _options) =&gt; &#123;...&#125;)</span><span class="hljs-comment">        &#125;</span><span class="hljs-comment">        </span><span class="hljs-comment">        Object.defineProperties(local, &#123;</span><span class="hljs-comment">          getters: &#123;</span><span class="hljs-comment">            get: noNamespace</span><span class="hljs-comment">              ? () =&gt; store.getters</span><span class="hljs-comment">              : () =&gt; makeLocalGetters(store, namespace)</span><span class="hljs-comment">          &#125;,</span><span class="hljs-comment">          state: &#123;</span><span class="hljs-comment">            get: () =&gt; getNestedState(store.state, path)</span><span class="hljs-comment">          &#125;</span><span class="hljs-comment">        &#125;)</span><span class="hljs-comment">        return local</span><span class="hljs-comment">        &#125;</span><span class="hljs-comment">  */</span> <span class="hljs-comment">// æ³¨å†Œ å„ç§æ–¹æ³•</span><span class="hljs-built_in">module</span>.forEachMutation(<span class="hljs-function">(<span class="hljs-params">mutation, key</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> namespacedType = namespace + key;registerMutation(store, namespacedType, mutation, local);&#125;);<span class="hljs-built_in">module</span>.forEachAction(<span class="hljs-function">(<span class="hljs-params">action, key</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> type = action.root ? key : namespace + key;<span class="hljs-keyword">const</span> handler = action.handler || action;registerAction(store, type, handler, local);&#125;);<span class="hljs-built_in">module</span>.forEachGetter(<span class="hljs-function">(<span class="hljs-params">getter, key</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> namespacedType = namespace + key;registerGetter(store, namespacedType, getter, local);&#125;);<span class="hljs-comment">// éå†å®‰è£…å­æ¨¡å—</span><span class="hljs-built_in">module</span>.forEachChild(<span class="hljs-function">(<span class="hljs-params">child, key</span>) =&gt;</span> &#123;installModule(store, rootState, path.concat(key), child, hot);&#125;);&#125;</code></pre></div><h3 id="å®ä¾‹åŒ–store-vm"><a href="#å®ä¾‹åŒ–store-vm" class="headerlink" title="å®ä¾‹åŒ–store.vm"></a>å®ä¾‹åŒ–store.vm</h3><ul><li>å»ºç«‹<code>getter</code>å’Œ<code>state</code>ä¹‹é—´çš„è”ç³»</li><li>ä½¿ç”¨ä¸€ä¸ªvueå®ä¾‹æ¥å­˜å‚¨<code>state</code>ï¼Œè®¿é—®äº† <code>store._vm[key]</code>ï¼Œä¹Ÿå°±æ˜¯ <code>computed[key]</code></li><li><code>computed</code>çš„ç‰¹æ€§å¯ä»¥ç¼“å­˜å¹¶ä¸”<code>state</code>å˜åŒ–çš„æ—¶å€™æ‰ä¼šé‡æ–°è®¡ç®—</li><li>å½“ <code>store.state</code> å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œä¸‹ä¸€æ¬¡å†è®¿é—® <code>store.getters</code> çš„æ—¶å€™ä¼šé‡æ–°è®¡ç®—ã€‚</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resetStoreVM</span> (<span class="hljs-params">store, state, hot</span>) </span>&#123;  <span class="hljs-keyword">const</span> oldVm = store._vm  <span class="hljs-comment">// bind store public getters</span>  store.getters = &#123;&#125;  <span class="hljs-keyword">const</span> wrappedGetters = store._wrappedGetters  <span class="hljs-keyword">const</span> computed = &#123;&#125;  forEachValue(wrappedGetters, <span class="hljs-function">(<span class="hljs-params">fn, key</span>) =&gt;</span> &#123;    <span class="hljs-comment">// use computed to leverage its lazy-caching mechanism</span>    computed[key] = <span class="hljs-function">() =&gt;</span> fn(store)    <span class="hljs-built_in">Object</span>.defineProperty(store.getters, key, &#123;      get: <span class="hljs-function">() =&gt;</span> store._vm[key],      enumerable: <span class="hljs-literal">true</span> <span class="hljs-comment">// for local getters</span>    &#125;)  &#125;)  <span class="hljs-comment">// ä½¿ç”¨ä¸€ä¸ªvueå®ä¾‹æ¥å­˜å‚¨stateï¼Œè®¿é—®stateå°±æ˜¯è®¿é—®computed[key]ï¼Œ</span><span class="hljs-comment">// å®ç°stateæ”¹å˜çš„æ—¶å€™getteræ‰æ”¹å˜ï¼Œå¹¶ä¸”è¢«ç¼“å­˜</span>  store._vm = <span class="hljs-keyword">new</span> Vue(&#123;    data: &#123;      $$state: state    &#125;,    computed  &#125;)  <span class="hljs-comment">// enable strict mode for new vm</span>  <span class="hljs-keyword">if</span> (store.strict) &#123;    enableStrictMode(store)  &#125;<span class="hljs-comment">// ä¸¥æ ¼æ¨¡å¼ä¼šæ·»åŠ ä¸€ä¸ªwatchç›‘æµ‹stateçš„æ”¹å˜æ˜¯å¦æ¥è‡ªévuexæ¥å£</span><span class="hljs-comment">// function enableStrictMode (store) &#123;</span><span class="hljs-comment">// store._vm.$watch(function () &#123; return this._data.$$state &#125;, () =&gt; &#123;</span><span class="hljs-comment">// if (process.env.NODE_ENV !== &#x27;production&#x27;) &#123;</span><span class="hljs-comment">// assert(store._committing, `Do not mutate vuex store state outside mutation handlers.`)</span><span class="hljs-comment">// &#125;</span><span class="hljs-comment">// &#125;, &#123; deep: true, sync: true &#125;)</span><span class="hljs-comment">// &#125;</span>  <span class="hljs-keyword">if</span> (oldVm) &#123;    Vue.nextTick(<span class="hljs-function">() =&gt;</span> oldVm.$destroy())  &#125;&#125;</code></pre></div><h1 id="å½’çº³"><a href="#å½’çº³" class="headerlink" title="å½’çº³"></a>å½’çº³</h1><ol><li>åœ¨<code>beforeCreate</code>é’©å­ä¸­æ··å…¥<code>vuexInit()</code>æ–¹æ³•</li><li>é€šè¿‡é€’å½’åˆ¤æ–­æ˜¯å¦æœ‰çˆ¶ç»„ä»¶ï¼Œç»‘å®š<code>this.$store</code>æŒ‡å‘åˆ°å®ä¾‹åŒ–çš„<code>Store</code></li><li>ä»æ ¹<code>module</code>æŒ‰ç…§çˆ¶å­å±‚çº§è®¡ç®—å‡ºå®Œæ•´çš„<code>module</code>æ ‘</li><li>ä»æ ¹<code>module</code>å¼€å§‹æ¢³ç†æœ‰<code>namespace</code>çš„æ¨¡å—ï¼Œä¼šåœ¨ä»–è·¯å¾„å‰æ‹¼æ¥ä¸Š<code>namespace</code>ï¼Œå¹¶ä¿å­˜ä¸‹ä¸€ä¸ª<code>_modulesNamespaceMap</code></li><li>éå†æ¨¡å—ä¸­çš„æ‰€æœ‰å­ modulesï¼Œé€’å½’æ‰§è¡Œ installModule æ–¹æ³•ï¼Œè®¡ç®—å„è‡ª<code>state``getter``commit``dispatch</code>çš„è®¿é—®è·¯å¾„</li><li>æŒ‰ç…§å„ä¸ªAPIçš„å…¥å£ï¼Œå°†è‡ªå®šä¹‰çš„å›è°ƒå‡½æ•°åŠ å…¥å…¥å£æ•°ç»„</li><li><code>getter</code>çš„ç‰¹æ€§ä¼šä½¿ç”¨ä¸€ä¸ªvueå®ä¾‹å’Œ<code>computed</code>å±æ€§å®ç°ï¼Œåªæœ‰getterä¾èµ–çš„stateå˜åŒ–ågetterçš„ç»“æœä¹Ÿä¼šå˜åŒ–</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>vue</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>æºç </tag>
      
      <tag>vuex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue-router@3.xå®ç°åˆ†æ</title>
    <link href="/2022/03/10/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Dvue2-router/"/>
    <url>/2022/03/10/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Dvue2-router/</url>
    
    <content type="html"><![CDATA[<h1 id="vue-router"><a href="#vue-router" class="headerlink" title="vue-router"></a>vue-router</h1><h2 id="æ¨¡å¼"><a href="#æ¨¡å¼" class="headerlink" title="æ¨¡å¼"></a>æ¨¡å¼</h2><h3 id="hashæ¨¡å¼"><a href="#hashæ¨¡å¼" class="headerlink" title="hashæ¨¡å¼"></a><code>hash</code>æ¨¡å¼</h3><p>åŸç†ï¼šç›‘å¬<code>onHashChange</code>å’Œä¿®æ”¹<code>URL</code>çš„<code>hash</code>å€¼<code>#xxx</code></p><ul><li>  ä¸åˆ·æ–°é¡µé¢</li><li>  <code>hash</code>ä¸ä¼šå‘é€åˆ°æœåŠ¡å™¨</li><li>  <code>hash</code>çš„æ”¹å˜ä¼šä¿å­˜å†å²è®°å½•</li><li>  é€šè¿‡<code>&lt;a&gt;</code>æ ‡ç­¾çš„<code>href</code>æˆ–è€…<code>location.hash</code>ä¿®æ”¹</li></ul><h3 id="historyæ¨¡å¼"><a href="#historyæ¨¡å¼" class="headerlink" title="historyæ¨¡å¼"></a><code>history</code>æ¨¡å¼</h3><p>åŸç†ï¼šç›‘å¬<code>history.popState</code>ï¼Œé€šè¿‡<code>pushState``replaceState</code>ä¿®æ”¹å†å²æ ˆ</p><ul><li>  ä¸åˆ·æ–°é¡µé¢</li><li>  H5 <code>history API</code></li><li>  æœåŠ¡å™¨éœ€è¦é…åˆè®¾ç½®åœ°å€ä¸åŒ¹é…å›é€€</li><li>  <code>SEO</code>æ¯” hash å¥½</li></ul><h2 id="abstractæ¨¡å¼"><a href="#abstractæ¨¡å¼" class="headerlink" title="abstractæ¨¡å¼"></a><code>abstract</code>æ¨¡å¼</h2><h2 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h2><ul><li>  params</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> routes = [<span class="hljs-comment">// åŠ¨æ€å­—æ®µä»¥å†’å·å¼€å§‹</span>&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/users/:id&quot;</span>, <span class="hljs-attr">component</span>: User &#125;,];</code></pre></div><ul><li>  query</li></ul><p>URL åœ°å€çš„ query éƒ¨åˆ†</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">/users?id=<span class="hljs-number">123</span></code></pre></div><h2 id="è·¯ç”±é’©å­"><a href="#è·¯ç”±é’©å­" class="headerlink" title="è·¯ç”±é’©å­"></a>è·¯ç”±é’©å­</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å…¨å±€</span>router.beforeEach((to,form,next)) <span class="hljs-comment">// å¯¼èˆªè§¦å‘æ—¶</span>router.beforeResolve((to,form,next)) <span class="hljs-comment">// æ‰€æœ‰ç»„ä»¶å†…å®ˆå«å’Œå¼‚æ­¥è·¯ç”±ç»„ä»¶è¢«è§£æä¹‹å</span>router.afterEach((to, <span class="hljs-keyword">from</span>, failure))<span class="hljs-comment">// å…¨å±€é’©å­å¯ä»¥å®šä¹‰å¤šä¸ªï¼Œé¡ºåºæ‰§è¡Œå®Œåæ‰ä¼šresolveè·¯ç”±</span><span class="hljs-comment">// è·¯ç”±</span>beforeEnter() <span class="hljs-comment">// ä¸ä¼šåœ¨ paramsã€query æˆ– hash æ”¹å˜è§¦å‘ï¼Œåªä¼šåœ¨å¯¼èˆªè·¯å¾„æ”¹å˜è§¦å‘</span>&#123;  path:<span class="hljs-string">&#x27;/a&#x27;</span>,  component:<span class="hljs-function">()=&gt;</span><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/component/A&#x27;</span>),  beforeEnter:<span class="hljs-function">(<span class="hljs-params">(to,<span class="hljs-keyword">from</span>,next)</span>)=&gt;</span>&#123;&#125; <span class="hljs-comment">//</span>&#125;<span class="hljs-comment">// ç»„ä»¶å†…</span>beforeRouteEnter((to,<span class="hljs-keyword">from</span>,<span class="hljs-attr">next</span>:<span class="hljs-function">(<span class="hljs-params">vm</span>)=&gt;</span>&#123;<span class="hljs-comment">/*è®¿é—®this*/</span>&#125;)) <span class="hljs-comment">// ç»„ä»¶å®ä¾‹åˆ›å»ºä¹‹å‰</span>beforeRouteUpdate((to,<span class="hljs-keyword">from</span>))<span class="hljs-comment">/* CompositionAPI onBeforeRouteUpdate */</span>beforeRouteLeave((to,<span class="hljs-keyword">from</span>))<span class="hljs-comment">/* CompositionAPI onBeforeRouteLeave */</span></code></pre></div><h3 id="è§¦å‘æµç¨‹ï¼špageA-gt-pageB"><a href="#è§¦å‘æµç¨‹ï¼špageA-gt-pageB" class="headerlink" title="è§¦å‘æµç¨‹ï¼špageA=&gt;pageB"></a>è§¦å‘æµç¨‹ï¼špageA=&gt;pageB</h3><ol><li><p>pageA.<code>beforeRouteLeave</code></p></li><li><p>router.<code>beforeEach</code></p></li><li><p>routes[pageB].<code>beforeEnter</code></p></li><li><p>pageB.<code>beforeRouteEnter</code></p><blockquote><p>å¦‚æœ pageB æ¸²æŸ“è¿‡ï¼Œå¿½ç•¥ã€3ï¼Œ4ã€‘æ‰§è¡Œ pageB.beforeRouteUpdate</p></blockquote></li><li><p>router.<code>beforeResolve</code></p></li><li><p>router.<code>afterEach</code></p></li><li><p>DOM æ›´æ–°/æŒ‚è½½</p></li><li><p>æ‰§è¡Œç¬¬ã€4ã€‘æ­¥ä¸­<code>next</code>å›è°ƒ</p></li></ol><h1 id="åˆå§‹åŒ–é˜¶æ®µ"><a href="#åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="åˆå§‹åŒ–é˜¶æ®µ"></a>åˆå§‹åŒ–é˜¶æ®µ</h1><h2 id="Vue-use-å®‰è£…è·¯ç”±"><a href="#Vue-use-å®‰è£…è·¯ç”±" class="headerlink" title="Vue.use å®‰è£…è·¯ç”±"></a>Vue.use å®‰è£…è·¯ç”±</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">install</span>(<span class="hljs-params">Vue</span>) </span>&#123;<span class="hljs-keyword">if</span> (install.installed &amp;&amp; _Vue === Vue) <span class="hljs-keyword">return</span>;install.installed = <span class="hljs-literal">true</span>;_Vue = Vue;<span class="hljs-keyword">const</span> isDef = <span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> v !== <span class="hljs-literal">undefined</span>;<span class="hljs-keyword">const</span> registerInstance = <span class="hljs-function">(<span class="hljs-params">vm, callVal</span>) =&gt;</span> &#123;<span class="hljs-keyword">let</span> i = vm.$options._parentVnode;<span class="hljs-comment">// ä¼ªä»£ç </span>registerRouteInstance(vm, callVal);<span class="hljs-comment">// router-view renderå‡½æ•°çš„registerRouteInstanceæ–¹æ³•</span>&#125;;Vue.mixin(&#123;<span class="hljs-function"><span class="hljs-title">beforeCreate</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-keyword">if</span> (isDef(<span class="hljs-built_in">this</span>.$options.router)) &#123;<span class="hljs-built_in">this</span>._routerRoot = <span class="hljs-built_in">this</span>; <span class="hljs-comment">//  è·¯ç”±çš„rootç»„ä»¶</span><span class="hljs-built_in">this</span>._router = <span class="hljs-built_in">this</span>.$options.router; <span class="hljs-comment">// è·¯ç”±å®ä¾‹</span><span class="hljs-built_in">this</span>._router.init(<span class="hljs-built_in">this</span>); <span class="hljs-comment">// initè§ä¸‹æ–‡</span>Vue.util.defineReactive(<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;_route&quot;</span>, <span class="hljs-built_in">this</span>._router.history.current);<span class="hljs-comment">// ğŸ”¥å¯¹router-viewçš„å“åº”å¼ç»‘å®š</span>&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-built_in">this</span>._routerRoot = (<span class="hljs-built_in">this</span>.$parent &amp;&amp; <span class="hljs-built_in">this</span>.$parent._routerRoot) || <span class="hljs-built_in">this</span>;<span class="hljs-comment">// å¦‚æœæ˜¯å­ç»„ä»¶ï¼Œå°†è¿½æº¯åˆ°æ‹¥æœ‰routerçš„çˆ¶ç»„ä»¶ä½œä¸ºrootï¼Œæ‰§è¡Œä¸Šé¢å‡ è¡Œé€»è¾‘</span>&#125;registerInstance(<span class="hljs-built_in">this</span>, <span class="hljs-built_in">this</span>);&#125;,<span class="hljs-function"><span class="hljs-title">destroyed</span>(<span class="hljs-params"></span>)</span> &#123;registerInstance(<span class="hljs-built_in">this</span>);&#125;,&#125;);<span class="hljs-comment">// ä¸ºVueçš„åŸå‹ç»‘å®š`$router``$route`çš„getterå’Œå…¨å±€æ³¨å†Œä¸¤ä¸ªç»„ä»¶</span><span class="hljs-built_in">Object</span>.defineProperty(Vue.prototype, <span class="hljs-string">&quot;$router&quot;</span>, &#123;<span class="hljs-function"><span class="hljs-title">get</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._routerRoot._router;&#125;,&#125;);<span class="hljs-built_in">Object</span>.defineProperty(Vue.prototype, <span class="hljs-string">&quot;$route&quot;</span>, &#123;<span class="hljs-function"><span class="hljs-title">get</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._routerRoot._route;&#125;,&#125;);Vue.component(<span class="hljs-string">&quot;RouterView&quot;</span>, View);Vue.component(<span class="hljs-string">&quot;RouterLink&quot;</span>, Link);<span class="hljs-keyword">const</span> strats = Vue.config.optionMergeStrategies;strats.beforeRouteEnter = strats.beforeRouteLeave = strats.beforeRouteUpdate = strats.created;&#125;</code></pre></div><h2 id="å®ä¾‹åŒ–ä¸€ä¸ª-router"><a href="#å®ä¾‹åŒ–ä¸€ä¸ª-router" class="headerlink" title="å®ä¾‹åŒ–ä¸€ä¸ª router"></a>å®ä¾‹åŒ–ä¸€ä¸ª router</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VueRouter</span> </span>&#123;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">options: RouterOptions = &#123;&#125;</span>)</span> &#123;<span class="hljs-built_in">this</span>.app = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ ¹ç»„ä»¶</span><span class="hljs-built_in">this</span>.apps = []; <span class="hljs-comment">// optionsä¸­æœ‰routeré¡¹çš„å®ä¾‹</span><span class="hljs-built_in">this</span>.options = options; <span class="hljs-comment">//  è·¯ç”±é…ç½®</span><span class="hljs-built_in">this</span>.beforeHooks = [];<span class="hljs-built_in">this</span>.resolveHooks = []; <span class="hljs-comment">// é’©å­</span><span class="hljs-built_in">this</span>.afterHooks = [];<span class="hljs-built_in">this</span>.matcher = createMatcher(options.routes || [], <span class="hljs-built_in">this</span>);<span class="hljs-keyword">let</span> mode = options.mode || <span class="hljs-string">&quot;hash&quot;</span>;<span class="hljs-built_in">this</span>.fallback = mode === <span class="hljs-string">&quot;history&quot;</span> &amp;&amp; !supportsPushState &amp;&amp; options.fallback !== <span class="hljs-literal">false</span>;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.fallback) &#123;<span class="hljs-comment">// å›é€€åˆ°hashæ¨¡å¼</span>mode = <span class="hljs-string">&quot;hash&quot;</span>;&#125;<span class="hljs-keyword">if</span> (!inBrowser) &#123;mode = <span class="hljs-string">&quot;abstract&quot;</span>;&#125;<span class="hljs-built_in">this</span>.mode = mode;<span class="hljs-keyword">switch</span> (mode) &#123;<span class="hljs-keyword">case</span> <span class="hljs-string">&quot;history&quot;</span>:<span class="hljs-built_in">this</span>.history = <span class="hljs-keyword">new</span> HTML5History(<span class="hljs-built_in">this</span>, options.base);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-string">&quot;hash&quot;</span>:<span class="hljs-built_in">this</span>.history = <span class="hljs-keyword">new</span> HashHistory(<span class="hljs-built_in">this</span>, options.base, <span class="hljs-built_in">this</span>.fallback);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-string">&quot;abstract&quot;</span>:<span class="hljs-built_in">this</span>.history = <span class="hljs-keyword">new</span> AbstractHistory(<span class="hljs-built_in">this</span>, options.base);<span class="hljs-keyword">break</span>;&#125;&#125;<span class="hljs-function"><span class="hljs-title">init</span>(<span class="hljs-params">app: any</span>)</span> &#123;<span class="hljs-built_in">this</span>.apps.push(app);<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.app) &#123;<span class="hljs-keyword">return</span>;&#125;<span class="hljs-built_in">this</span>.app = app;<span class="hljs-keyword">const</span> history = <span class="hljs-built_in">this</span>.history;<span class="hljs-keyword">if</span> (history <span class="hljs-keyword">instanceof</span> HTML5History) &#123;history.transitionTo(history.getCurrentLocation());&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (history <span class="hljs-keyword">instanceof</span> HashHistory) &#123;<span class="hljs-keyword">const</span> setupHashListener = <span class="hljs-function">() =&gt;</span> &#123;history.setupListeners();&#125;;history.transitionTo(history.getCurrentLocation(), setupHashListener, setupHashListener);&#125;history.listen(<span class="hljs-function">(<span class="hljs-params">route</span>) =&gt;</span> &#123;<span class="hljs-built_in">this</span>.apps.forEach(<span class="hljs-function">(<span class="hljs-params">app</span>) =&gt;</span> &#123;app._route = route;&#125;);&#125;);&#125;&#125;</code></pre></div><h2 id="è·¯å¾„åŒ¹é…"><a href="#è·¯å¾„åŒ¹é…" class="headerlink" title="è·¯å¾„åŒ¹é…"></a>è·¯å¾„åŒ¹é…</h2><h3 id="createMatcher"><a href="#createMatcher" class="headerlink" title="createMatcher"></a>createMatcher</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createMatcher</span>(<span class="hljs-params">routes: <span class="hljs-built_in">Array</span>&lt;RouteConfig&gt;, router: VueRouter</span>): <span class="hljs-title">Matcher</span> </span>&#123;<span class="hljs-comment">// æ ¹æ®routesæ„å»ºå‡ºpathçš„é›†åˆpathList,</span><span class="hljs-comment">// path åˆ° RouteRecordçš„æ˜ å°„è¡¨pathMap</span><span class="hljs-comment">// name åˆ° RouteRecordçš„æ˜ å°„è¡¨nameMap</span><span class="hljs-comment">//  const record: RouteRecord = &#123;</span><span class="hljs-comment">//   path: normalizedPath,</span><span class="hljs-comment">//   regex: compileRouteRegex(normalizedPath, pathToRegexpOptions),</span><span class="hljs-comment">//   components: route.components || &#123; default: route.component &#125;,</span><span class="hljs-comment">//   instances: &#123;&#125;,</span><span class="hljs-comment">//   name,</span><span class="hljs-comment">//   parent,</span><span class="hljs-comment">//   matchAs,</span><span class="hljs-comment">//   redirect: route.redirect,</span><span class="hljs-comment">//   beforeEnter: route.beforeEnter,</span><span class="hljs-comment">//   meta: route.meta || &#123;&#125;,</span><span class="hljs-comment">//   props: route.props == null</span><span class="hljs-comment">//     ? &#123;&#125;</span><span class="hljs-comment">//     : route.components</span><span class="hljs-comment">//       ? route.props</span><span class="hljs-comment">//       : &#123; default: route.props &#125;</span><span class="hljs-comment">// &#125;</span><span class="hljs-keyword">const</span> &#123; pathList, pathMap, nameMap &#125; = createRouteMap(routes);<span class="hljs-comment">// åŠ¨æ€æ·»åŠ è·¯ç”±çš„æ–¹æ³•</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addRoutes</span>(<span class="hljs-params">routes</span>) </span>&#123;createRouteMap(routes, pathList, pathMap, nameMap);&#125;<span class="hljs-comment">//</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">match</span>(<span class="hljs-params">raw: RawLocation, currentRoute?: Route, redirectedFrom?: Location</span>): <span class="hljs-title">Route</span> </span>&#123;<span class="hljs-keyword">const</span> location = normalizeLocation(raw, currentRoute, <span class="hljs-literal">false</span>, router);<span class="hljs-keyword">const</span> &#123; name &#125; = location;<span class="hljs-keyword">if</span> (name) &#123;<span class="hljs-keyword">const</span> record = nameMap[name];<span class="hljs-keyword">if</span> (!record) <span class="hljs-keyword">return</span> _createRoute(<span class="hljs-literal">null</span>, location);<span class="hljs-keyword">const</span> paramNames = record.regex.keys.filter(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> !key.optional).map(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> key.name);<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> location.params !== <span class="hljs-string">&quot;object&quot;</span>) &#123;location.params = &#123;&#125;;&#125;<span class="hljs-keyword">if</span> (currentRoute &amp;&amp; <span class="hljs-keyword">typeof</span> currentRoute.params === <span class="hljs-string">&quot;object&quot;</span>) &#123;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> currentRoute.params) &#123;<span class="hljs-keyword">if</span> (!(key <span class="hljs-keyword">in</span> location.params) &amp;&amp; paramNames.indexOf(key) &gt; -<span class="hljs-number">1</span>) &#123;location.params[key] = currentRoute.params[key];&#125;&#125;&#125;<span class="hljs-keyword">if</span> (record) &#123;location.path = fillParams(record.path, location.params, <span class="hljs-string">`named route &quot;<span class="hljs-subst">$&#123;name&#125;</span>&quot;`</span>);<span class="hljs-keyword">return</span> _createRoute(record, location, redirectedFrom);&#125;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (location.path) &#123;location.params = &#123;&#125;;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; pathList.length; i++) &#123;<span class="hljs-keyword">const</span> path = pathList[i];<span class="hljs-keyword">const</span> record = pathMap[path];<span class="hljs-keyword">if</span> (matchRoute(record.regex, location.path, location.params)) &#123;<span class="hljs-keyword">return</span> _createRoute(record, location, redirectedFrom);&#125;&#125;&#125;<span class="hljs-keyword">return</span> _createRoute(<span class="hljs-literal">null</span>, location);&#125;<span class="hljs-comment">// ...</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_createRoute</span>(<span class="hljs-params">record: ?RouteRecord, location: Location, redirectedFrom?: Location</span>): <span class="hljs-title">Route</span> </span>&#123;<span class="hljs-comment">// é‡å®šå‘</span><span class="hljs-keyword">if</span> (record &amp;&amp; record.redirect) &#123;<span class="hljs-keyword">return</span> redirect(record, redirectedFrom || location);&#125;<span class="hljs-comment">// alias</span><span class="hljs-keyword">if</span> (record &amp;&amp; record.matchAs) &#123;<span class="hljs-keyword">return</span> alias(record, location, record.matchAs);&#125;<span class="hljs-keyword">return</span> createRoute(record, location, redirectedFrom, router);&#125;<span class="hljs-comment">//</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createRoute</span>(<span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">record: ?RouteRecord,</span></span><span class="hljs-function"><span class="hljs-params">location: Location,</span></span><span class="hljs-function"><span class="hljs-params">redirectedFrom?: ?Location,</span></span><span class="hljs-function"><span class="hljs-params">router?: VueRouter</span></span><span class="hljs-function"><span class="hljs-params"></span>): <span class="hljs-title">Route</span> </span>&#123;<span class="hljs-keyword">const</span> stringifyQuery = router &amp;&amp; router.options.stringifyQuery;<span class="hljs-keyword">let</span> query: any = location.query || &#123;&#125;;<span class="hljs-keyword">try</span> &#123;query = clone(query);&#125; <span class="hljs-keyword">catch</span> (e) &#123;&#125;<span class="hljs-keyword">const</span> route: Route = &#123;name: location.name || (record &amp;&amp; record.name),meta: (record &amp;&amp; record.meta) || &#123;&#125;,path: location.path || <span class="hljs-string">&quot;/&quot;</span>,hash: location.hash || <span class="hljs-string">&quot;&quot;</span>,query,params: location.params || &#123;&#125;,fullPath: getFullPath(location, stringifyQuery),matched: record ? formatMatch(record) : [],&#125;;<span class="hljs-keyword">if</span> (redirectedFrom) &#123;route.redirectedFrom = getFullPath(redirectedFrom, stringifyQuery);&#125;<span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.freeze(route);&#125;<span class="hljs-keyword">return</span> &#123;match,addRoutes,&#125;;&#125;</code></pre></div><h2 id="è·¯å¾„åˆ‡æ¢"><a href="#è·¯å¾„åˆ‡æ¢" class="headerlink" title="è·¯å¾„åˆ‡æ¢"></a>è·¯å¾„åˆ‡æ¢</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">transitionTo (location: RawLocation, onComplete?: <span class="hljs-built_in">Function</span>, onAbort?: <span class="hljs-built_in">Function</span>) &#123;  <span class="hljs-keyword">const</span> route = <span class="hljs-built_in">this</span>.router.match(location, <span class="hljs-built_in">this</span>.current)  <span class="hljs-comment">// æ ¹æ®ç›®æ ‡ location å’Œå½“å‰è·¯å¾„ this.current æ‰§è¡Œ this.router.match æ–¹æ³•å»åŒ¹é…åˆ°ç›®æ ‡çš„è·¯å¾„</span>  <span class="hljs-built_in">this</span>.confirmTransition(route, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-built_in">this</span>.updateRoute(route)    onComplete &amp;&amp; onComplete(route)    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.ready) &#123;      <span class="hljs-built_in">this</span>.ready = <span class="hljs-literal">true</span>      <span class="hljs-built_in">this</span>.readyCbs.forEach(<span class="hljs-function"><span class="hljs-params">cb</span> =&gt;</span> &#123; cb(route) &#125;)    &#125;  &#125;  <span class="hljs-comment">//...</span>  )&#125;updateRoute (route: Route) &#123;  <span class="hljs-keyword">const</span> prev = <span class="hljs-built_in">this</span>.current  <span class="hljs-built_in">this</span>.current = route  <span class="hljs-built_in">this</span>.cb &amp;&amp; <span class="hljs-built_in">this</span>.cb(route)  <span class="hljs-built_in">this</span>.router.afterHooks.forEach(<span class="hljs-function"><span class="hljs-params">hook</span> =&gt;</span> &#123; <span class="hljs-comment">/* router.afterEach */</span>    hook &amp;&amp; hook(route, prev)  &#125;)&#125;</code></pre></div><h3 id="confirmTransition"><a href="#confirmTransition" class="headerlink" title="confirmTransition"></a>confirmTransition</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript">confirmTransition (route: Route, <span class="hljs-attr">onComplete</span>: <span class="hljs-built_in">Function</span>, onAbort?: <span class="hljs-built_in">Function</span>) &#123;  <span class="hljs-keyword">const</span> current = <span class="hljs-built_in">this</span>.current  <span class="hljs-keyword">const</span> &#123;    updated,    deactivated,    activated  &#125; = resolveQueue(<span class="hljs-built_in">this</span>.current.matched, route.matched)  <span class="hljs-comment">// matchedæ•°ç»„å±æ€§ä¿å­˜äº†ä»åŒ¹é…åˆ°çš„recordå¾ªç¯å‘ä¸Šä¸€ç›´åˆ°æœ€å¤–å±‚çš„æ‰€æœ‰çš„record</span>  <span class="hljs-comment">// resolveè§£æå‡ºä¸‰ä¸ªé˜Ÿåˆ—</span>  <span class="hljs-comment">// a/b/c =&gt; a/b/d</span>  <span class="hljs-comment">// deactivated : [c]</span>  <span class="hljs-comment">// activate : [d]</span>  <span class="hljs-comment">// updated : [a,b]</span>  <span class="hljs-comment">// ç”Ÿæˆä¸€ä¸ªæŒ‰ç…§è·¯ç”±é’©å­é¡ºåºçš„é˜Ÿåˆ—</span>  <span class="hljs-keyword">const</span> queue = [].concat(    extractLeaveGuards(deactivated), <span class="hljs-comment">/* æ‰§è¡Œç¦»å¼€çš„é’©å­ */</span>    <span class="hljs-built_in">this</span>.router.beforeHooks, <span class="hljs-comment">/* router.beforeEach */</span>    extractUpdateHooks(updated), <span class="hljs-comment">/*  beforeRouteUpdate */</span>    activated.map(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> m.beforeEnter), <span class="hljs-comment">/* beforeRouteEnter */</span>    resolveAsyncComponents(activated) <span class="hljs-comment">/*è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶*/</span>  )  runQueue(queue, iterator, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">const</span> postEnterCbs = []    <span class="hljs-keyword">const</span> isValid = <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">this</span>.current === route    <span class="hljs-comment">// beforeRouteEnter</span>    <span class="hljs-keyword">const</span> enterGuards = extractEnterGuards(activated, postEnterCbs, isValid)    <span class="hljs-comment">// â­ï¸beforeRouteEnterçš„å›è°ƒä¼šæ·»åŠ åˆ°postEnterCbsæ•°ç»„ä¸­ï¼Œç­‰è·¯ç”±æ›´æ–°ååœ¨æœ€åæ‰§è¡Œ</span>    <span class="hljs-comment">// router.beforeResolve</span>    <span class="hljs-keyword">const</span> queue = enterGuards.concat(<span class="hljs-built_in">this</span>.router.resolveHooks)    runQueue(queue, iterator, <span class="hljs-function">() =&gt;</span> &#123;      onComplete(route)      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.router.app) &#123;        <span class="hljs-built_in">this</span>.router.app.$nextTick(<span class="hljs-function">() =&gt;</span> &#123;          postEnterCbs.forEach(<span class="hljs-function"><span class="hljs-params">cb</span> =&gt;</span> &#123; cb() &#125;)          <span class="hljs-comment">// â­ï¸æ‰§è¡ŒpostEnterCbsä¸­çš„å›è°ƒ</span>        &#125;)      &#125;    &#125;)  &#125;)&#125;</code></pre></div><h2 id="lt-router-view-gt"><a href="#lt-router-view-gt" class="headerlink" title="&lt;router-view&gt;"></a><code>&lt;router-view&gt;</code></h2><p>æŠŠæ ¹ <code>Vue</code> å®ä¾‹çš„ <code>_route</code> å±æ€§æ˜¯å“åº”å¼çš„ï¼Œåœ¨æ¯ä¸ª <code>&lt;router-view&gt;</code>çš„<code>render</code> å‡½æ•°çš„æ—¶å€™ï¼Œéƒ½ä¼šè®¿é—® <code>parent.$route</code>ï¼Œè¯¥<code>&lt;router-view&gt;</code> å°±è®¢é˜…äº†<code>router</code>çš„å˜åŒ–</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;name: <span class="hljs-string">&quot;RouterView&quot;</span>,functional: <span class="hljs-literal">true</span>,props: &#123;name: &#123;type: <span class="hljs-built_in">String</span>,<span class="hljs-keyword">default</span>: <span class="hljs-string">&quot;default&quot;</span>,&#125;,&#125;,<span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params">_, &#123; props, children, parent, data &#125;</span>)</span> &#123;data.routerView = <span class="hljs-literal">true</span>;<span class="hljs-keyword">const</span> h = parent.$createElement;<span class="hljs-keyword">const</span> name = props.name;<span class="hljs-keyword">const</span> route = parent.$route; <span class="hljs-comment">// ğŸ”¥æ‰§è¡Œæ—¶ä¼šè§¦å‘å“åº”å¼æ”¶é›†ä¸ºrouterçš„ä¾èµ–ï¼Œå½“routeræ›´æ–°æ—¶é‡æ–°æ‰§è¡Œ</span><span class="hljs-keyword">const</span> cache = parent._routerViewCache || (parent._routerViewCache = &#123;&#125;);<span class="hljs-keyword">while</span> (parent &amp;&amp; parent._routerRoot !== parent) &#123;parent = parent.$parent;&#125;<span class="hljs-keyword">const</span> component = (cache[name] = matched.components[name]);<span class="hljs-comment">// ç»™ matched.instances[name] èµ‹å€¼å½“å‰ç»„ä»¶çš„ vm å®ä¾‹</span>data.registerRouteInstance = <span class="hljs-function">(<span class="hljs-params">vm, val</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> current = matched.instances[name];<span class="hljs-keyword">if</span> ((val &amp;&amp; current !== vm) || (!val &amp;&amp; current === vm)) &#123;matched.instances[name] = val;&#125;&#125;;(data.hook || (data.hook = &#123;&#125;)).prepatch = <span class="hljs-function">(<span class="hljs-params">_, vnode</span>) =&gt;</span> &#123;matched.instances[name] = vnode.componentInstance;&#125;;<span class="hljs-keyword">return</span> h(component, data, children);&#125;,&#125;;</code></pre></div><h1 id="å½’çº³"><a href="#å½’çº³" class="headerlink" title="å½’çº³"></a>å½’çº³</h1><ol><li>åœ¨æ¯ä¸ªç»„ä»¶çš„<code>beforeCreate</code>å’Œ<code>destroyed</code>é’©å­ä¸­æ··å…¥è·¯ç”±æ–¹æ³•</li><li>ä¾æ®<code>routes</code>ä¸­å­è·¯ï¼Œé€’å½’ç”Ÿæˆ<code>path/name</code>æ˜ å°„ç»„ä»¶ä½ç½®çš„æ˜ å°„è¡¨<code>RouteRecords</code></li><li>å¯¹å®ä¾‹çš„<code>_route</code>å±æ€§ç»‘å®šå“åº”å¼</li><li>æ ¹æ®é€‰æ‹©çš„<code>mode</code>ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„<code>history</code>æ¨¡å¼ï¼Œä¸åœ°å€æ ç»‘å®šä¿®æ”¹</li><li><code>&lt;router-view&gt;</code>ç»„ä»¶çš„æ¸²æŸ“å‡½æ•°ä¼šè®¿é—®<code>_route</code>å±æ€§ï¼Œè®¢é˜…äº†è·¯ç”±çŠ¶æ€çš„æ”¹å˜</li><li>åœ°å€æ æˆ–è€…<code>router-link</code>æ”¹å˜åä¿®æ”¹äº†<code>_route</code></li><li><code>matcher</code>è®¡ç®—å‡ºä»å½“å‰urlåˆ°ç›®æ ‡urlçš„æ”¹å˜è·¯å¾„ï¼ˆ<code>matched</code>recordæ•°ç»„ï¼‰</li><li>å¯¹æ¯”æ–°æ—§çš„<code>[matched]</code>ä»ç¬¬ä¸€ä¸ªä¸åŒçš„ä½ç½®è§£æå‡º<code>activated``updated``deactivated</code>ä¸‰ä¸ªé˜Ÿåˆ—</li><li>æŒ‰ç…§è·¯ç”±é’©å­æ„é€ é˜Ÿåˆ—ï¼Œåˆ†åˆ«å¯¹é˜Ÿåˆ—ä¸­çš„ç»„ä»¶æ‰§è¡Œç¦»å¼€é’©å­ï¼Œæ›´æ–°é’©å­å’Œè¿›å…¥é’©å­ï¼Œå¹¶ä¸”æ··å…¥å…¨å±€çš„é’©å­</li><li>é€šçŸ¥è®¢é˜…äº†çš„<code>router-view</code>ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œ<code>router-view</code>ä¼šè®¡ç®—è‡ªå·±ç»„ä»¶åœ¨vueç»„ä»¶æ ‘ä¸­ä½ç½®ï¼Œå»<code>matched</code>ä¸­æ‰¾åˆ°è¯¥æ¸²æŸ“çš„ç»„ä»¶</li><li>æœ€åæ›´æ–°è·¯ç”±çš„æ–°çŠ¶æ€</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>vue</tag>
      
      <tag>vue-router</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>æºç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>react_hooks</title>
    <link href="/2022/03/02/react_hooks/"/>
    <url>/2022/03/02/react_hooks/</url>
    
    <content type="html"><![CDATA[<h1 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h1><h2 id="Why-Hooks"><a href="#Why-Hooks" class="headerlink" title="Why Hooks"></a>Why Hooks</h2><ul><li>  Class ç»„ä»¶çš„å¤ç”¨ä¸èƒ½ç›´æ¥ç»§æ‰¿ï¼Œå¾€å¾€éœ€è¦æ— é¡µé¢é€»è¾‘çš„é«˜é˜¶ç»„ä»¶ï¼›</li><li>  Hooks ä½¿å‡½æ•°å¼ç»„ä»¶è·å¾—ç±»ç»„ä»¶èƒ½åŠ›ï¼Œæ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€å’Œå“åº”å¼ï¼›</li><li>  æ›´æ˜“äºé€»è¾‘å¤ç”¨å’Œå…³æ³¨ç‚¹åˆ†ç¦»ï¼ˆåŒä¸€é€»è¾‘çš„ä»£ç å¯ä»¥æ”¾åœ¨ä¸€å—ï¼‰ï¼›</li></ul><h3 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h3><ol><li>Hooks åªèƒ½åœ¨ç»„ä»¶é¡¶å±‚ä½œç”¨åŸŸä½¿ç”¨</li><li><em>å¿…é¡»ä¿è¯æ‰€æœ‰ Hooks éƒ½èƒ½è¢«æ‰§è¡Œåˆ°å¹¶ä¸”æŒ‰é¡ºåºæ‰§è¡Œ</em></li><li>Hooks åªèƒ½åœ¨å‡½æ•°å’Œå…¶ä»– Hook ä¸­ä½¿ç”¨</li></ol><h2 id="å¸¸ç”¨-Hooks"><a href="#å¸¸ç”¨-Hooks" class="headerlink" title="å¸¸ç”¨ Hooks"></a>å¸¸ç”¨ Hooks</h2><h3 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h3><p>å®šä¹‰çŠ¶æ€å’Œæ”¹å˜çŠ¶æ€çš„å‡½æ•°</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> [currentValue,setNewValue] = React.useState(initState)<span class="hljs-comment">// æ”¹å˜çŠ¶æ€</span>setNewValue(newValue)setNewValue(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;...newValue&#125;)<span class="hljs-comment">//  å¦‚æœinitStateåªéœ€è¦åœ¨ç»„ä»¶mountæ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œå¯ä»¥è®¾ç½®æƒ°æ€§è¿”å›å€¼</span><span class="hljs-keyword">const</span> [state1, setState1] = useState(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">const</span> initialState = someExpensiveComputation(props);  <span class="hljs-keyword">return</span> initialState;&#125;);</code></pre></div><h3 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h3><p>å®šä¹‰å‰¯ä½œç”¨</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">React.useEffect(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-comment">// å‰¯ä½œç”¨æ“ä½œ</span><span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-comment">// åœ¨ç»„ä»¶é”€æ¯å’Œeffecté‡æ–°æ‰§è¡Œä¹‹å‰æ‰§è¡Œ</span>&#125;;&#125;, [stateValue]); <span class="hljs-comment">// ä¸º[]åˆ™ç›¸å½“äºdidMount</span>useEffect(fn); <span class="hljs-comment">//  ç»„å»ºæ¯æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œ</span>useEffect(fn, []); <span class="hljs-comment">//  Mountæ—¶æ‰§è¡Œ</span>useEffect(fn, [dep]); <span class="hljs-comment">//  Mount å’Œ dep å˜åŒ–æ—¶</span>useEffect(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;&#125;;&#125;, []); <span class="hljs-comment">//  unMountæ‰§è¡Œ</span></code></pre></div><h3 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h3><p>ç¼“å­˜å›è°ƒå‡½æ•°</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);<span class="hljs-keyword">const</span> handleIncrement = <span class="hljs-function">() =&gt;</span> setCount(count + <span class="hljs-number">1</span>)<span class="hljs-comment">// é»˜è®¤æ¯æ¬¡é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Œéƒ½ä¼šåˆ›å»ºæ–°çš„handleElementå‡½æ•°</span><span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;handleIncrement&#125;</span>&gt;</span>+<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="hljs-comment">// åŒæ—¶ç”±äºæ–°å‡½æ•°ï¼Œä¼šå¯¼è‡´æ¥æ”¶å‡½æ•°çš„ç»„ä»¶ä¹Ÿé‡æ–°æ¸²æŸ“</span><span class="hljs-keyword">const</span> handleIncrement = useCallback(<span class="hljs-function">() =&gt;</span> setCount(count + <span class="hljs-number">1</span>),[count])<span class="hljs-comment">// å°†countåŠ å…¥è¿™ä¸ªcallbackçš„ä¾èµ–æ•°ç»„ï¼Œåªæœ‰å½“countæ”¹å˜æ—¶æ‰åˆ›å»ºæ–°çš„å‡½æ•°ï¼Œåˆ›å»ºæ–°çš„é—­åŒ…å¹¶æ›´æ–°ç»„ä»¶</span></code></pre></div><h3 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h3><p>ç¼“å­˜è®¡ç®—ç»“æœ</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å¦‚æœæŸä¸ªæ•°æ®æ˜¯é€šè¿‡å…¶å®ƒæ•°æ®è®¡ç®—å¾—åˆ°çš„ï¼Œé‚£ä¹ˆåªæœ‰å½“ç”¨åˆ°çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¾èµ–çš„æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ‰åº”è¯¥éœ€è¦é‡æ–°è®¡ç®—,è¿›è€Œä¹Ÿå¯ä»¥é¿å…ä¸å¿…è¦çš„æ¸²æŸ“</span><span class="hljs-keyword">const</span> usersToShow = useMemo(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">if</span>(!users) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;  <span class="hljs-keyword">return</span> users.data.filter(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> &#123;    <span class="hljs-keyword">return</span> user.first_name.includes(searchKey)  &#125;)&#125;,[usersï¼ŒsearchKey])<span class="hljs-comment">// è„‘è¡¥Vueçš„computedå°±æ‡‚äº†</span></code></pre></div><blockquote><p>useCallback(fn, deps) ç›¸å½“äº useMemo(() =&gt; fn, deps)</p></blockquote><blockquote><p>useCallback å’Œ useMemo çš„ dep æ•°ç»„ä¼ ç©ºåˆ™åªè¿”å›é¦–æ¬¡æ‰§è¡Œç»“æœ</p></blockquote><h3 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> timer = ref(<span class="hljs-literal">null</span>);<span class="hljs-comment">// å­˜å‚¨è·¨æ¸²æŸ“çš„æ•°æ®</span><span class="hljs-keyword">const</span> startTimer = useCallback(<span class="hljs-function">() =&gt;</span> &#123;timer.current = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-comment">/*do some*/</span>&#125;);&#125;, []);<span class="hljs-keyword">const</span> stopTimer = useCallback(<span class="hljs-function">() =&gt;</span> &#123;cleatInterval(timer.current);timer.current = <span class="hljs-literal">null</span>;&#125;, []);<span class="hljs-comment">// DOMå¼•ç”¨</span><span class="hljs-keyword">const</span> xxxRef = useRef(<span class="hljs-literal">null</span>);&lt;input ref=&#123;xxxRef&#125;&gt;&lt;/input&gt;;</code></pre></div><h2 id="æ ¡éªŒ-Hooks"><a href="#æ ¡éªŒ-Hooks" class="headerlink" title="æ ¡éªŒ Hooks"></a>æ ¡éªŒ Hooks</h2><p>é€šè¿‡ eslint æ’ä»¶<code>eslint-plugin-react-hooks</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript">&#123;<span class="hljs-comment">//eslint config</span>...<span class="hljs-string">&quot;rules&quot;</span>:&#123;  <span class="hljs-string">&quot;react-hooks/rules-of-hooks&quot;</span>:<span class="hljs-string">&quot;error&quot;</span>,<span class="hljs-comment">//æ£€æŸ¥ä¾èµ–é¡¹çš„å£°æ˜</span>  <span class="hljs-string">&quot;react-hooks/exhaustive-deps&quot;</span>:<span class="hljs-string">&quot;warn&quot;</span>  &#125;...&#125;</code></pre></div><h3 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h3><p>ä½¿ç”¨ provide çš„ context</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> text1 = &#123;  p1:<span class="hljs-string">&#x27;è¯·è¾“å…¥&#x27;</span>&#125;<span class="hljs-keyword">const</span> SomeContext = React.createContext(text1)&lt;SomeContext.Provider value=&#123;text1&#125;&gt;      <span class="hljs-comment">// å†…éƒ¨çš„ç»„ä»¶å°±å¯ä»¥é€šè¿‡</span>      <span class="hljs-keyword">const</span> xxx = useContext(SomeContext)      <span class="hljs-comment">// æ¥ä½¿ç”¨xxxæ•°æ®</span>      &lt;input placeholder=&#123;xxx.p1&#125;&gt;&lt;/SomeContext&gt;</code></pre></div><h2 id="è‡ªå®šä¹‰-Hooks"><a href="#è‡ªå®šä¹‰-Hooks" class="headerlink" title="è‡ªå®šä¹‰ Hooks"></a>è‡ªå®šä¹‰ Hooks</h2><ul><li>  å‘½åçº¦å®šä»¥<code>use</code>å¼€å¤´ï¼›</li><li>  åœ¨å‡½æ•°å†…ä½¿ç”¨åˆ°äº†å…¶ä»– Hooks æ‰æ˜¯<code>Hooks</code>å‡½æ•°ï¼›</li></ul><h3 id="å…¸å‹-Hooks"><a href="#å…¸å‹-Hooks" class="headerlink" title="å…¸å‹ Hooks"></a>å…¸å‹ Hooks</h3><ul><li>  è·å–å¼‚æ­¥è¯·æ±‚ç»“æœ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> useAsyncReq = <span class="hljs-function">(<span class="hljs-params">reqFunc</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);<span class="hljs-keyword">const</span> [isLoading, setLoading] = useState(<span class="hljs-literal">false</span>);<span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);<span class="hljs-keyword">const</span> execute = useCallback(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-comment">// åœ¨mountå’ŒreqFuncå˜åŒ–éƒ½ä¼šå¼€å§‹ä¸€æ¬¡æ–°è¯·æ±‚</span>setLoading(<span class="hljs-literal">true</span>);setData(<span class="hljs-literal">null</span>);setError(<span class="hljs-literal">null</span>);<span class="hljs-keyword">return</span> reqFunc().then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;setData(res);&#125;).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;setError(err);&#125;).finally(<span class="hljs-function">() =&gt;</span> &#123;setLoading(<span class="hljs-literal">false</span>);&#125;);      &#125;, [reqFunc]);<span class="hljs-keyword">export</span> &#123; execute, isLoading, data, error &#125;;&#125;;</code></pre></div><ul><li>ç›‘å¬é¡µé¢æ»šåŠ¨<br>```javascript<br>const getPosition = ()  =&gt; {<br>x:document.body.scrollLeft,<br>y:document.body.scrollTop<br>}</li></ul><p>const useScroll = () =&gt; {<br>  const [position,setPosition] = useState(getPosition())</p><p>  useEffect(()=&gt;{<br>    // mountæ—¶æ‰§è¡Œä¸€æ¬¡<br>    const handler = () =&gt; setPosition(getPosition())<br>    // æ·»åŠ ç›‘å¬scroll<br>    document.addEventListener(â€˜scrollâ€™,handler)<br>    // ç»„ä»¶é”€æ¯æ—¶å–æ¶ˆç›‘å¬<br>    return () =&gt; document.removeEventListener(â€˜scrollâ€™,handler)<br>  },[])</p><p>  return position<br>}</p><p>``</p>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>react</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°ç¬¦åˆA+è§„èŒƒçš„Promise</title>
    <link href="/2022/02/24/Promise/"/>
    <url>/2022/02/24/Promise/</url>
    
    <content type="html"><![CDATA[<h2 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h2><p>Promise å¯¹è±¡ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªå°šæœªå®Œæˆä¸”é¢„è®¡åœ¨æœªæ¥å®Œæˆçš„å¼‚æ­¥æ“ä½œã€‚</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ul><li>  è§£å†³å›è°ƒåœ°ç‹±ï¼Œä½¿ç”¨ç»Ÿä¸€çš„ API æ¥å£å¤„ç†å¼‚æ­¥ä»»åŠ¡</li><li>  é“¾å¼è°ƒç”¨</li><li>  è¿”å›å€¼ç©¿é€ï¼ˆonFulfilled ä¸æ˜¯ function æ—¶ï¼Œä¸Šä¸€æ­¥çš„æ‰§è¡Œç»“æœ value å°†ç»§ç»­å‘åä¼ é€’ï¼‰</li><li>  é”™è¯¯å†’æ³¡ï¼ˆ</li></ul><blockquote><p>å›è°ƒåœ°ç‹±</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f1</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-comment">//f2çš„æ‰§è¡Œéœ€è¦ç­‰å¾…f1çš„ç»“æœ</span>  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-title">f2</span>(<span class="hljs-params"></span>)</span>&#123;     <span class="hljs-function"><span class="hljs-title">f3</span>(<span class="hljs-params"></span>)</span>&#123;      <span class="hljs-function"><span class="hljs-title">f4</span>(<span class="hljs-params"></span>)</span>&#123;        <span class="hljs-function"><span class="hljs-title">f5</span>(<span class="hljs-params"></span>)</span>&#123;          ...        &#125;        ...      &#125;    &#125;  &#125;&#125;</code></pre></div><h2 id="Promise-å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹"><a href="#Promise-å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹" class="headerlink" title="Promise å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹"></a>Promise å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹</h2><ol><li><p>å¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“ã€‚Promise å¯¹è±¡ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæœ‰ä¸‰ç§çŠ¶æ€ï¼š<code>pending</code>ï¼ˆè¿›è¡Œä¸­ï¼‰ã€<code>fulfilled</code>ï¼ˆå·²æˆåŠŸï¼‰å’Œ<code>rejected</code>ï¼ˆå·²å¤±è´¥ï¼‰ã€‚åªæœ‰å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œå¯ä»¥å†³å®šå½“å‰æ˜¯å“ªä¸€ç§çŠ¶æ€ï¼Œä»»ä½•å…¶ä»–æ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™ä¹Ÿæ˜¯ Promise è¿™ä¸ªåå­—çš„ç”±æ¥ï¼Œå®ƒçš„è‹±è¯­æ„æ€å°±æ˜¯â€œæ‰¿è¯ºâ€ï¼Œè¡¨ç¤ºå…¶ä»–æ‰‹æ®µæ— æ³•æ”¹å˜ã€‚</p></li><li><p>ä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªç»“æœã€‚Promise å¯¹è±¡çš„çŠ¶æ€æ”¹å˜ï¼Œåªæœ‰ä¸¤ç§å¯èƒ½ï¼šä» pending å˜ä¸º fulfilled å’Œä» pending å˜ä¸º rejectedã€‚åªè¦è¿™ä¸¤ç§æƒ…å†µå‘ç”Ÿï¼ŒçŠ¶æ€å°±å‡å›ºäº†ï¼Œä¸ä¼šå†å˜äº†ï¼Œä¼šä¸€ç›´ä¿æŒè¿™ä¸ªç»“æœã€‚å¦‚æœæ”¹å˜å·²ç»å‘ç”Ÿäº†ï¼Œä½ å†å¯¹ Promise å¯¹è±¡æ·»åŠ å›è°ƒå‡½æ•°ï¼Œä¹Ÿä¼šç«‹å³å¾—åˆ°è¿™ä¸ªç»“æœã€‚è¿™ä¸äº‹ä»¶ï¼ˆEventï¼‰å®Œå…¨ä¸åŒï¼Œäº‹ä»¶çš„ç‰¹ç‚¹æ˜¯ï¼Œå¦‚æœä½ é”™è¿‡äº†å®ƒï¼Œå†å»ç›‘å¬ï¼Œæ˜¯å¾—ä¸åˆ°ç»“æœçš„ã€‚</p></li></ol><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><h3 id="Promise-prototype-then"><a href="#Promise-prototype-then" class="headerlink" title="Promise.prototype.then()"></a>Promise.prototype.then()</h3><ul><li>  ä¸º Promise å®ä¾‹æ·»åŠ çŠ¶æ€æ”¹å˜æ—¶çš„å›è°ƒå‡½æ•°</li><li>  then æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>resolved</code>çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰æ˜¯<code>rejected</code>çŠ¶æ€çš„å›è°ƒå‡½æ•°</li><li>  then æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹,å¯ä»¥ then æ–¹æ³•åé¢å†è°ƒç”¨å¦ä¸€ä¸ª then æ–¹æ³•</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript">getJSON(<span class="hljs-string">&quot;/post/1.json&quot;</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">post</span>) </span>&#123;<span class="hljs-keyword">return</span> getJSON(post.commentURL);&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">funcA</span>(<span class="hljs-params">comments</span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;resolved: &quot;</span>, comments);&#125;,<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">funcB</span>(<span class="hljs-params">err</span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;rejected: &quot;</span>, err);&#125;);<span class="hljs-comment">// ç¬¬ä¸€ä¸ªthenæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œè¿”å›çš„æ˜¯å¦ä¸€ä¸ªPromiseå¯¹è±¡ã€‚è¿™æ—¶ï¼Œç¬¬äºŒä¸ªthenæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå°±ä¼šç­‰å¾…è¿™ä¸ªæ–°çš„Promiseå¯¹è±¡çŠ¶æ€å‘ç”Ÿå˜åŒ–ã€‚å¦‚æœå˜ä¸ºresolvedï¼Œå°±è°ƒç”¨funcAï¼Œå¦‚æœçŠ¶æ€å˜ä¸ºrejectedï¼Œå°±è°ƒç”¨funcBã€‚</span></code></pre></div><h3 id="Promise-prototype-catch"><a href="#Promise-prototype-catch" class="headerlink" title="Promise.prototype.catch()"></a>Promise.prototype.catch()</h3><ul><li><p>  æŒ‡å®šå‘ç”Ÿé”™è¯¯æ—¶çš„å›è°ƒå‡½æ•°</p></li><li><p>  Promise å¯¹è±¡çš„é”™è¯¯å…·æœ‰â€œå†’æ³¡â€æ€§è´¨ï¼Œä¼šä¸€ç›´å‘åä¼ é€’ï¼Œç›´åˆ°è¢«æ•è·ä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé”™è¯¯æ€»æ˜¯ä¼šè¢«ä¸‹ä¸€ä¸ª<code>catch</code>è¯­å¥æ•è·</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ä¸€èˆ¬æ¥è¯´ï¼Œä¸è¦åœ¨thenæ–¹æ³•é‡Œé¢å®šä¹‰ Reject çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼ˆå³thençš„ç¬¬äºŒä¸ªå‚æ•°ï¼‰ï¼Œæ€»æ˜¯ä½¿ç”¨catchæ–¹æ³•ã€‚</span><span class="hljs-comment">// bad</span>promise.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;<span class="hljs-comment">// success</span>&#125;,<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>&#123;<span class="hljs-comment">// error</span>&#125;);<span class="hljs-comment">// good</span>promise.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;<span class="hljs-comment">//cb</span><span class="hljs-comment">// success</span>&#125;).catch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>&#123;<span class="hljs-comment">// error</span>&#125;);</code></pre></div><blockquote><p>è·Ÿä¼ ç»Ÿçš„<code>try/catch</code>ä»£ç å—ä¸åŒçš„æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨<code>catch</code>æ–¹æ³•æŒ‡å®šé”™è¯¯å¤„ç†çš„å›è°ƒå‡½æ•°ï¼ŒPromise å¯¹è±¡æŠ›å‡ºçš„é”™è¯¯ä¸ä¼šä¼ é€’åˆ°å¤–å±‚ä»£ç ï¼Œå³ä¸ä¼šæœ‰ä»»ä½•ååº”</p></blockquote><ul><li>  catch æ–¹æ³•è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå› æ­¤åé¢è¿˜å¯ä»¥æ¥ç€è°ƒç”¨ then æ–¹æ³•</li></ul><h3 id="Promise-prototype-finally"><a href="#Promise-prototype-finally" class="headerlink" title="Promise.prototype.finally()"></a>Promise.prototype.finally()</h3><ul><li><p>  finally æ–¹æ³•ç”¨äºæŒ‡å®šä¸ç®¡ Promise å¯¹è±¡æœ€åçŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œ</p></li><li><p>  finally æ–¹æ³•çš„å›è°ƒå‡½æ•°ä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰åŠæ³•çŸ¥é“ï¼Œå‰é¢çš„ Promise çŠ¶æ€åˆ°åº•æ˜¯ fulfilled è¿˜æ˜¯ rejectedã€‚è¿™è¡¨æ˜ï¼Œfinally æ–¹æ³•é‡Œé¢çš„æ“ä½œï¼Œåº”è¯¥æ˜¯ä¸çŠ¶æ€æ— å…³çš„ï¼Œä¸ä¾èµ–äº Promise çš„æ‰§è¡Œç»“æœã€‚</p></li></ul><h3 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all()"></a>Promise.all()</h3><ul><li>  Promise.all æ–¹æ³•ç”¨äºå°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹</li></ul><p><code>const p = Promise.all([p1, p2, p3]);</code></p><ul><li>  p çš„çŠ¶æ€ç”± p1ã€p2ã€p3 å†³å®šï¼Œåˆ†æˆä¸¤ç§æƒ…å†µã€‚</li></ul><ol><li><p>åªæœ‰ p1ã€p2ã€p3 çš„çŠ¶æ€éƒ½å˜æˆ<code>fulfilled</code>ï¼Œp çš„çŠ¶æ€æ‰ä¼šå˜æˆ<code>fulfilled</code>ï¼Œæ­¤æ—¶ p1ã€p2ã€p3 çš„è¿”å›å€¼ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ é€’ç»™ p çš„å›è°ƒå‡½æ•°ã€‚</p></li><li><p>åªè¦ p1ã€p2ã€p3 ä¹‹ä¸­æœ‰ä¸€ä¸ªè¢«<code>rejected</code>ï¼Œp çš„çŠ¶æ€å°±å˜æˆ<code>rejected</code>ï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªè¢«<code>reject</code>çš„å®ä¾‹çš„è¿”å›å€¼ï¼Œä¼šä¼ é€’ç»™ p çš„å›è°ƒå‡½æ•°</p></li></ol><blockquote><p>å¦‚æœä½œä¸ºå‚æ•°çš„ Promise å®ä¾‹ï¼Œè‡ªå·±å®šä¹‰äº† catch æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä¸€æ—¦è¢« rejectedï¼Œå¹¶ä¸ä¼šè§¦å‘ Promise.all()çš„ catch æ–¹æ³•</p></blockquote><h3 id="Promise-race"><a href="#Promise-race" class="headerlink" title="Promise.race()"></a>Promise.race()</h3><p>Promise.race æ–¹æ³•åŒæ ·æ˜¯å°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚</p><p><code>const p = Promise.race([p1, p2, p3]);</code></p><p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦ p1ã€p2ã€p3 ä¹‹ä¸­æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œp çš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ã€‚é‚£ä¸ªç‡å…ˆæ”¹å˜çš„ Promise å®ä¾‹çš„è¿”å›å€¼ï¼Œå°±ä¼ é€’ç»™ p çš„å›è°ƒå‡½æ•°ã€‚</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//example</span><span class="hljs-keyword">const</span> p = <span class="hljs-built_in">Promise</span>.race([fetch(<span class="hljs-string">&quot;/resource-that-may-take-a-while&quot;</span>),<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;request timeout&quot;</span>)), <span class="hljs-number">5000</span>);&#125;), <span class="hljs-comment">// 5så†…è¯·æ±‚ä¸resolveåˆ™æŠ›å‡ºé”™è¯¯</span>]);p.then(<span class="hljs-built_in">console</span>.log).catch(<span class="hljs-built_in">console</span>.error);</code></pre></div><h3 id="promise-try"><a href="#promise-try" class="headerlink" title="promise.try()"></a>promise.try()</h3><p>ä¸æƒ³åŒºåˆ†ï¼Œå‡½æ•° f æ˜¯åŒæ­¥å‡½æ•°è¿˜æ˜¯å¼‚æ­¥æ“ä½œï¼Œä½†æ˜¯æƒ³ç”¨ Promise æ¥å¤„ç†å®ƒ</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">try</span> &#123;  database.users.get(&#123;<span class="hljs-attr">id</span>: userId&#125;)  .then(...)  .catch(...) <span class="hljs-comment">// promiseé”™è¯¯</span>&#125; <span class="hljs-keyword">catch</span> (e) &#123; <span class="hljs-comment">// åŒæ­¥é”™è¯¯</span>  <span class="hljs-comment">// ...</span>&#125;<span class="hljs-comment">// try catchæ•è·åŒæ­¥é”™è¯¯</span><span class="hljs-comment">// ç”¨promise.tryæ”¹å†™</span><span class="hljs-built_in">Promise</span>.try(<span class="hljs-function">() =&gt;</span> database.users.get(&#123;<span class="hljs-attr">id</span>: userId&#125;))  .then(...)  .catch(...)</code></pre></div><h3 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h3><ul><li>  ç«‹å³<code>resolve()</code>çš„ Promise å¯¹è±¡ï¼Œæ˜¯åœ¨æœ¬è½®â€œäº‹ä»¶å¾ªç¯â€ï¼ˆevent loopï¼‰çš„ç»“æŸæ—¶æ‰§è¡Œ</li></ul><blockquote><p>Promise.resolve()æ–¹æ³•å…è®¸è°ƒç”¨æ—¶ä¸å¸¦å‚æ•°ï¼Œç›´æ¥è¿”å›ä¸€ä¸ª resolved çŠ¶æ€çš„ Promise å¯¹è±¡ã€‚</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;three&quot;</span>);&#125;, <span class="hljs-number">0</span>);<span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;two&quot;</span>);&#125;);<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;one&quot;</span>);<span class="hljs-comment">// one</span><span class="hljs-comment">// two</span><span class="hljs-comment">// three</span></code></pre></div><ul><li><p><code>Promise.reject()</code>æ–¹æ³•çš„å‚æ•°ï¼Œä¼šåŸå°ä¸åŠ¨åœ°ä½œä¸º reject çš„ç†ç”±ï¼Œå˜æˆåç»­æ–¹æ³•çš„å‚æ•°</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> thenable = &#123;<span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">resolve, reject</span>)</span> &#123;reject(<span class="hljs-string">&quot;å‡ºé”™äº†&quot;</span>);&#125;,&#125;;<span class="hljs-built_in">Promise</span>.reject(thenable).catch(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(e);&#125;);<span class="hljs-comment">// catchæ–¹æ³•çš„å‚æ•°ä¸æ˜¯rejectæŠ›å‡ºçš„â€œå‡ºé”™äº†â€è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯thenableå¯¹è±¡ã€‚</span></code></pre></div></li></ul><h2 id="æ‰‹å†™-Promise"><a href="#æ‰‹å†™-Promise" class="headerlink" title="æ‰‹å†™ Promise"></a>æ‰‹å†™ Promise</h2><ul><li>  æµ‹è¯• a+è§„èŒƒ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript">promises-aplus-testsnode promises-aplus-tests yourpeomise.js<span class="hljs-comment">// yourpromise.js</span>MyPromise.defer = MyPromise.deferred = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">let</span> dfd = &#123;&#125;;dfd.promise = <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;dfd.resolve = resolve;dfd.reject = reject;&#125;);<span class="hljs-keyword">return</span> dfd;&#125;;<span class="hljs-built_in">module</span>.exports = MyPromise</code></pre></div><ul><li>  resolvePromise</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> isComplex = <span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> obj !== <span class="hljs-literal">null</span> &amp;&amp; (<span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">&quot;function&quot;</span> || <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">&quot;object&quot;</span>);<span class="hljs-comment">// åˆ¤æ–­thenä¹‹åçš„çŠ¶æ€</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolvePromise</span>(<span class="hljs-params">x, promise2, resolve, reject</span>) </span>&#123;<span class="hljs-keyword">if</span> (x === promise2) &#123;reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;Chaining cycle detected for promise&quot;</span>));&#125;<span class="hljs-keyword">if</span> (isComplex(x)) &#123;<span class="hljs-keyword">let</span> hasRes = <span class="hljs-literal">false</span>;<span class="hljs-keyword">try</span> &#123;<span class="hljs-keyword">const</span> then = x.then;<span class="hljs-comment">// å¦‚æœxæ˜¯promiseï¼Œç»§ç»­åˆ¤æ–­</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> then === <span class="hljs-string">&quot;function&quot;</span>) &#123;then.call(x,(v) =&gt; &#123;<span class="hljs-keyword">if</span> (hasRes) <span class="hljs-keyword">return</span>;hasRes = <span class="hljs-literal">true</span>;resolvePromise(v, promise2, resolve, reject);&#125;,(r) =&gt; &#123;<span class="hljs-keyword">if</span> (hasRes) <span class="hljs-keyword">return</span>;hasRes = <span class="hljs-literal">true</span>;reject(r);&#125;);&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-comment">// å¦‚æœxæ˜¯ä¸ªå¯¹è±¡</span>resolve(x);&#125;&#125; <span class="hljs-keyword">catch</span> (e) &#123;<span class="hljs-keyword">if</span> (hasRes) <span class="hljs-keyword">return</span>;hasRes = <span class="hljs-literal">true</span>;reject(e);&#125;&#125; <span class="hljs-keyword">else</span> &#123;resolve(x);&#125;&#125;<span class="hljs-comment">// é€šç”¨å¸¸é‡</span><span class="hljs-keyword">const</span> PENDING = <span class="hljs-built_in">Symbol</span>(PENDING);<span class="hljs-keyword">const</span> FULFILLED = <span class="hljs-built_in">Symbol</span>(FULFILLED);<span class="hljs-keyword">const</span> REJECTED = <span class="hljs-built_in">Symbol</span>(REJECTED);</code></pre></div><ul><li>  function ç‰ˆ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MyPromise</span>(<span class="hljs-params">executor</span>) </span>&#123;<span class="hljs-built_in">this</span>.status = PENDING;<span class="hljs-built_in">this</span>.data = <span class="hljs-literal">undefined</span>;<span class="hljs-built_in">this</span>.onFulfilledCb = [];<span class="hljs-built_in">this</span>.onRejectedCd = [];<span class="hljs-keyword">const</span> resolve = <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> &#123;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-comment">// æ”¾åœ¨ä¸‹ä¸ªå®ä»»åŠ¡ç­‰promise2éƒ½æ‰§è¡Œå¾—å‡ºçŠ¶æ€</span><span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === PENDING) &#123;<span class="hljs-built_in">this</span>.status = FULFILLED;<span class="hljs-built_in">this</span>.data = value;<span class="hljs-built_in">this</span>.onFulfilledCb.forEach(<span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> cb());&#125;&#125;);&#125;;<span class="hljs-keyword">const</span> reject = <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-comment">// æ”¾åœ¨ä¸‹ä¸ªå®ä»»åŠ¡ç­‰promise2éƒ½æ‰§è¡Œå¾—å‡ºçŠ¶æ€</span><span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === PENDING) &#123;<span class="hljs-built_in">this</span>.status = REJECTED;<span class="hljs-built_in">this</span>.data = reason;<span class="hljs-built_in">this</span>.onRejectedCd.forEach(<span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> cb());&#125;&#125;);&#125;;<span class="hljs-keyword">try</span> &#123;executor(resolve, reject);&#125; <span class="hljs-keyword">catch</span> (e) &#123;reject(e);&#125;&#125;MyPromise.prototype.then = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">onFulfill, onReject</span>) </span>&#123;onFulfill = <span class="hljs-keyword">typeof</span> onFulfill === <span class="hljs-string">&quot;function&quot;</span> ? onFulfill : <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value;onReject =<span class="hljs-keyword">typeof</span> onReject === <span class="hljs-string">&quot;function&quot;</span>? onReject: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<span class="hljs-keyword">throw</span> err;  &#125;;<span class="hljs-keyword">let</span> promise2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === PENDING) &#123;<span class="hljs-comment">// pushè¿›å»çš„æ—¶å€™promise2è¿˜æ²¡æœ‰æ‰§è¡Œå®Œ</span><span class="hljs-built_in">this</span>.onFulfilledCb.push(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-keyword">try</span> &#123;<span class="hljs-keyword">let</span> x = onFulfill(<span class="hljs-built_in">this</span>.data);resolvePromise(x, promise2, resolve, reject);&#125; <span class="hljs-keyword">catch</span> (e) &#123;reject(e);&#125;&#125;);<span class="hljs-built_in">this</span>.onRejectedCd.push(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-keyword">try</span> &#123;<span class="hljs-keyword">let</span> x = onReject(<span class="hljs-built_in">this</span>.data);resolvePromise(x, promise2, resolve, reject);&#125; <span class="hljs-keyword">catch</span> (e) &#123;reject(e);&#125;&#125;);<span class="hljs-comment">// ç”±äºnew Promiseæ„é€ å‡½æ•°é€»è¾‘</span><span class="hljs-comment">// å¯ä»¥ç®€å†™</span>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === FULFILLED) &#123;<span class="hljs-comment">// å¦‚æœè¿”å›ä¸€ä¸ªpromiseï¼Œä¾ç„¶éœ€è¦åˆ¤æ–­ä»–åç»­çš„çŠ¶æ€,äº¤ç»™ä¸‹ä¸€ä¸ªthenæ—¶å»åˆ¤æ–­ğŸ‘†çš„ä»£ç </span><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> onFulfill(<span class="hljs-built_in">this</span>.data)); <span class="hljs-comment">// setTimeout(()=&gt;&#123;</span><span class="hljs-comment">// try&#123;</span><span class="hljs-comment">// let x = onFulfill(this.data)</span><span class="hljs-comment">// resolvePromise(x,promise2,resolve,reject)</span><span class="hljs-comment">// &#125;catch(e)&#123;</span><span class="hljs-comment">// reject(e)</span><span class="hljs-comment">// &#125;</span><span class="hljs-comment">// &#125;)</span>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === REJECTED) &#123;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> onReject(<span class="hljs-built_in">this</span>.data)); &#125;&#125;);<span class="hljs-keyword">return</span> promise2;&#125;;</code></pre></div><ul><li>  class ç‰ˆ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPromise</span> </span>&#123;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">executor</span>)</span> &#123;<span class="hljs-keyword">try</span> &#123;executor(<span class="hljs-built_in">this</span>.resolve, <span class="hljs-built_in">this</span>.reject);&#125; <span class="hljs-keyword">catch</span> (e) &#123;<span class="hljs-built_in">this</span>, reject(e);&#125;&#125;status = PENDING;data = <span class="hljs-literal">undefined</span>;successCallback = [];failCallback = [];resolve = <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> MyPromise) &#123;<span class="hljs-keyword">return</span> value.then(<span class="hljs-built_in">this</span>.resolve, <span class="hljs-built_in">this</span>.reject);&#125;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === PENDING) &#123;<span class="hljs-built_in">this</span>.data = value;<span class="hljs-built_in">this</span>.status = FULFILLED;<span class="hljs-built_in">this</span>.successCallback.forEach(<span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> cb());&#125;&#125;);&#125;;reject = <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status === PENDING) &#123;<span class="hljs-built_in">this</span>.data = reason;<span class="hljs-built_in">this</span>.status = REJECTED;<span class="hljs-built_in">this</span>.failCallback.forEach(<span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> cb());&#125;&#125;);&#125;;<span class="hljs-function"><span class="hljs-title">then</span>(<span class="hljs-params">onResolve, onReject</span>)</span> &#123;onResolve = <span class="hljs-keyword">typeof</span> onResolve === <span class="hljs-string">&quot;function&quot;</span> ? onResolve : <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> val;onReject =<span class="hljs-keyword">typeof</span> onReject === <span class="hljs-string">&quot;function&quot;</span>? onReject: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<span class="hljs-keyword">throw</span> err;  &#125;;<span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> MyPromise(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.status === PENDING)&#123;<span class="hljs-built_in">this</span>.successCallback.push(<span class="hljs-function">()=&gt;</span>&#123;<span class="hljs-keyword">try</span>&#123;<span class="hljs-keyword">const</span> x = onResolve(<span class="hljs-built_in">this</span>.data)resolvePromise(x,promise2,resolve,reject)&#125;<span class="hljs-keyword">catch</span>(e)&#123;reject(e)&#125;&#125;)<span class="hljs-built_in">this</span>.failCallback.push(<span class="hljs-function">()=&gt;</span>&#123;<span class="hljs-keyword">try</span>&#123;<span class="hljs-keyword">const</span> x = onReject(<span class="hljs-built_in">this</span>.data)resolvePromise(x,promise2,resolve,reject)&#125;<span class="hljs-keyword">catch</span>(e)&#123;reject(e)&#125;&#125;)&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.status === FULFILLED)&#123;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>onResolve(<span class="hljs-built_in">this</span>.data))&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.status === REJECTED)&#123;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>onReject(<span class="hljs-built_in">this</span>.data))&#125;&#125;)<span class="hljs-keyword">return</span> promise2&#125;&#125;</code></pre></div><ul><li>  API</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Promise</span>.resolve = <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> resolve(value));<span class="hljs-built_in">Promise</span>.reject = <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> reject(reason));<span class="hljs-comment">// catch</span><span class="hljs-built_in">Promise</span>.prototype.catch = <span class="hljs-function">(<span class="hljs-params">onReject</span>) =&gt;</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.then(<span class="hljs-literal">null</span>, onReject);&#125;;<span class="hljs-comment">// finally</span><span class="hljs-built_in">Promise</span>.prototype.finally = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.then((value) =&gt; &#123;<span class="hljs-built_in">Promise</span>.resolve(callback()).then(<span class="hljs-function">() =&gt;</span> value);&#125;,(reason) =&gt; &#123;<span class="hljs-built_in">Promise</span>.resolve(callback()).then(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-keyword">throw</span> reason;&#125;);&#125;);&#125;;<span class="hljs-comment">// race</span><span class="hljs-built_in">Promise</span>.race = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pArr</span>) </span>&#123;<span class="hljs-comment">// æŠ›å‡ºç¬¬ä¸€ä¸ªæ”¹å˜çš„çŠ¶æ€</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;pArr.forEach(<span class="hljs-function">(<span class="hljs-params">pItem</span>) =&gt;</span> pItem.then(resolve, reject));&#125;);&#125;;<span class="hljs-comment">// any</span><span class="hljs-built_in">Promise</span>.any = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pArr</span>) </span>&#123;<span class="hljs-comment">// æœ‰resolveå°±resolve</span><span class="hljs-comment">// éƒ½æ²¡æœ‰resolveåˆ™è¿”å›ä¸€ä¸ªç”±æ‰€æœ‰errç»„æˆçš„AggregateErrorå¯¹è±¡</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (!pArr.length) <span class="hljs-keyword">return</span> reject(<span class="hljs-keyword">new</span> AggregateError([]));<span class="hljs-keyword">const</span> res = [];pArr.forEach(<span class="hljs-function">(<span class="hljs-params">pItem, index</span>) =&gt;</span> &#123;pItem.then((v) =&gt; &#123;resolve(v);&#125;,(e) =&gt; &#123;res[index] = e;&#125;);&#125;);reject(<span class="hljs-keyword">new</span> AggregateError(res));&#125;);&#125;;<span class="hljs-comment">// all</span><span class="hljs-built_in">Promise</span>.all = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pArr</span>) </span>&#123;<span class="hljs-comment">// resolveå…¨éƒ¨value</span><span class="hljs-comment">// æœ‰errå°±reject</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (!pArr.length) <span class="hljs-keyword">return</span> resolve([]);<span class="hljs-keyword">const</span> res = [];pArr.forEach(<span class="hljs-function">(<span class="hljs-params">pItem, index</span>) =&gt;</span> &#123;pItem.then((v) =&gt; &#123;res[index] = v;&#125;,(e) =&gt; &#123;reject(e);&#125;);&#125;);resolve(res);&#125;);&#125;;<span class="hljs-comment">// allSettled</span><span class="hljs-built_in">Promise</span>.allSettled = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pArr</span>) </span>&#123;<span class="hljs-comment">// è®°å½•æ¯ä¸ªpromiseçš„çŠ¶æ€</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (!pArr.length) <span class="hljs-keyword">return</span> resolve([]);<span class="hljs-keyword">const</span> res = [];pArr.forEach(<span class="hljs-function">(<span class="hljs-params">pItem, index</span>) =&gt;</span> &#123;<span class="hljs-comment">// if (pItem instanceof Promise) &#123;</span>pItem.then((v) =&gt; &#123;res[index] = &#123; <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;resolve&quot;</span>, <span class="hljs-attr">value</span>: v &#125;;&#125;,(e) =&gt; &#123;res[index] = &#123; <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;reject&quot;</span>, <span class="hljs-attr">reason</span>: e &#125;;&#125;);<span class="hljs-comment">// &#125; else &#123;</span><span class="hljs-comment">//   res[index] = &#123; status: &quot;resolve&quot;, value: pItem &#125;;</span><span class="hljs-comment">// &#125;</span>&#125;);resolve(res);&#125;);&#125;;</code></pre></div><h2 id="åŒæ­¥å‡½æ•°-promise-åŒ–"><a href="#åŒæ­¥å‡½æ•°-promise-åŒ–" class="headerlink" title="åŒæ­¥å‡½æ•° promise åŒ–"></a>åŒæ­¥å‡½æ•° promise åŒ–</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> promisify =(func) =&gt;(...args) =&gt;<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;args.push(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, value</span>) </span>&#123;<span class="hljs-keyword">if</span> (err) reject(err);<span class="hljs-keyword">else</span> resolve(value);&#125;);func.apply(<span class="hljs-literal">null</span>, args);&#125;);</code></pre></div><h2 id="é¢è¯•é¢˜"><a href="#é¢è¯•é¢˜" class="headerlink" title="é¢è¯•é¢˜"></a>é¢è¯•é¢˜</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;<span class="hljs-comment">// ...</span>&#125;);<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;<span class="hljs-comment">// ...</span>resolve(p1);&#125;);<span class="hljs-comment">//p1çš„çŠ¶æ€å†³å®šäº†p2çš„çŠ¶æ€ã€‚å¦‚æœp1çš„çŠ¶æ€æ˜¯pendingï¼Œé‚£ä¹ˆp2çš„å›è°ƒå‡½æ•°å°±ä¼šç­‰å¾…p1çš„çŠ¶æ€æ”¹å˜ï¼›å¦‚æœp1çš„çŠ¶æ€å·²ç»æ˜¯resolvedæˆ–è€…rejectedï¼Œé‚£ä¹ˆp2çš„å›è°ƒå‡½æ•°å°†ä¼šç«‹åˆ»æ‰§è¡Œã€‚</span><span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;fail&quot;</span>)), <span class="hljs-number">3000</span>);&#125;);<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> resolve(p1), <span class="hljs-number">1000</span>);&#125;);p2.then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(result)).catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(error));<span class="hljs-comment">// Error: fail</span><span class="hljs-comment">// ä¸Šé¢ä»£ç ä¸­ï¼Œp1æ˜¯ä¸€ä¸ª Promiseï¼Œ3 ç§’ä¹‹åå˜ä¸ºrejectedã€‚p2çš„çŠ¶æ€åœ¨ 1 ç§’ä¹‹åæ”¹å˜ï¼Œresolveæ–¹æ³•è¿”å›çš„æ˜¯p1ã€‚ç”±äºp2è¿”å›çš„æ˜¯å¦ä¸€ä¸ª Promiseï¼Œå¯¼è‡´p2è‡ªå·±çš„çŠ¶æ€æ— æ•ˆäº†ï¼Œç”±p1çš„çŠ¶æ€å†³å®šp2çš„çŠ¶æ€ã€‚æ‰€ä»¥ï¼Œåé¢çš„thenè¯­å¥éƒ½å˜æˆé’ˆå¯¹åè€…ï¼ˆp1ï¼‰ã€‚åˆè¿‡äº† 2 ç§’ï¼Œp1å˜ä¸ºrejectedï¼Œå¯¼è‡´è§¦å‘catchæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</span></code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>es6</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue-nextå­¦ä¹ </title>
    <link href="/2022/02/24/%5BTODO%5D%5B%E5%BD%92%E7%BA%B3%5Dvue@3/"/>
    <url>/2022/02/24/%5BTODO%5D%5B%E5%BD%92%E7%BA%B3%5Dvue@3/</url>
    
    <content type="html"><![CDATA[<h1 id="VUE3å¸¦æ¥çš„å¥½ä¸œè¥¿"><a href="#VUE3å¸¦æ¥çš„å¥½ä¸œè¥¿" class="headerlink" title="VUE3å¸¦æ¥çš„å¥½ä¸œè¥¿"></a>VUE3å¸¦æ¥çš„å¥½ä¸œè¥¿</h1><h2 id="Proxy-API"><a href="#Proxy-API" class="headerlink" title="Proxy API"></a><code>Proxy API</code></h2><h3 id="vue2-Xå­˜åœ¨çš„ç¼ºé™·"><a href="#vue2-Xå­˜åœ¨çš„ç¼ºé™·" class="headerlink" title="vue2.Xå­˜åœ¨çš„ç¼ºé™·"></a>vue2.Xå­˜åœ¨çš„ç¼ºé™·</h3><ul><li>æ— æ³•æ£€æµ‹å¯¹è±¡ä¸­ <code>property</code> çš„æ·»åŠ æˆ–ç§»é™¤ï¼›</li><li>é€šè¿‡ä¸‹æ ‡æ“ä½œæ•°ç»„ä¸ä¼šè§¦å‘å“åº” ï¼Œ<code>vm.items[indexOfItem] = newValue</code>èƒ½åšåˆ°ä½†æ€§èƒ½è€ƒè™‘æ”¾å¼ƒï¼›</li><li>ä¿®æ”¹æ•°ç»„çš„é•¿åº¦æ—¶ä¸ä¼šè§¦å‘å“åº”å¼ï¼Œ<code>vm.items.length = newLength</code>ï¼›</li><li>vue2æ—¶ä»£çš„è§£å†³æ–¹æ³•<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Objectæ–°å¢å…ƒç´ </span>Vue.set(object, propertyName, value)<span class="hljs-comment">// or</span><span class="hljs-built_in">this</span>.$set(<span class="hljs-built_in">this</span>.someObject,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-number">2</span>)<span class="hljs-comment">// ä¸‹æ ‡ä¿®æ”¹æ•°ç»„</span>Vue.set(vm.array1, indexOfItem, newValue)<span class="hljs-comment">// or</span><span class="hljs-built_in">this</span>.$set(<span class="hljs-built_in">this</span>.array1, indexOfItem, newValue)<span class="hljs-comment">// or</span><span class="hljs-built_in">this</span>.array1.splice(indexOfItem, <span class="hljs-number">1</span>, newValue)<span class="hljs-comment">// ä¿®æ”¹æ•°ç»„é•¿åº¦</span><span class="hljs-built_in">this</span>.array1.splice(newLength)</code></pre></div></li><li>é‡å†™äº†æ•°ç»„éƒ¨åˆ†æ–¹æ³•ä»¥æ”¯æŒå“åº”å¼<div class="hljs code-wrapper"><pre><code class="hljs javascript">pop()push()shift()unshift()splice()sort()reverse()</code></pre></div><h3 id="defineProperty"><a href="#defineProperty" class="headerlink" title="defineProperty"></a><code>defineProperty</code></h3></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Object</span>.defineProperty(obj<span class="hljs-comment">/* å¯¹è±¡*/</span>, prop<span class="hljs-comment">/* å±æ€§*/</span>, descriptor<span class="hljs-comment">/*æè¿°ç¬¦*/</span>)&#123;  <span class="hljs-comment">//å¯¹è±¡é‡Œç›®å‰å­˜åœ¨çš„å±æ€§æè¿°ç¬¦æœ‰ä¸¤ç§ä¸»è¦å½¢å¼ï¼šæ•°æ®æè¿°ç¬¦å’Œå­˜å–æè¿°ç¬¦ã€‚</span>  <span class="hljs-comment">//æ•°æ®æè¿°ç¬¦æ˜¯ä¸€ä¸ªå…·æœ‰å€¼çš„å±æ€§ï¼Œè¯¥å€¼å¯ä»¥æ˜¯å¯å†™çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸å¯å†™çš„ã€‚</span>  <span class="hljs-comment">//å­˜å–æè¿°ç¬¦æ˜¯ç”± getter å‡½æ•°å’Œ setter å‡½æ•°æ‰€æè¿°çš„å±æ€§ã€‚</span>  <span class="hljs-comment">//ä¸€ä¸ªæè¿°ç¬¦åªèƒ½æ˜¯è¿™ä¸¤è€…å…¶ä¸­ä¹‹ä¸€ï¼›ä¸èƒ½åŒæ—¶æ˜¯ä¸¤è€…ã€‚</span>  configurable: <span class="hljs-literal">true</span>,  <span class="hljs-comment">//configurable ç‰¹æ€§è¡¨ç¤ºå¯¹è±¡çš„å±æ€§æ˜¯å¦å¯ä»¥è¢«åˆ é™¤ï¼Œä»¥åŠé™¤ value å’Œ writable ç‰¹æ€§å¤–çš„å…¶ä»–ç‰¹æ€§æ˜¯å¦å¯ä»¥è¢«ä¿®æ”¹ã€‚</span>  enumerable: <span class="hljs-literal">true</span>,  <span class="hljs-comment">//enumerable å®šä¹‰äº†å¯¹è±¡çš„å±æ€§æ˜¯å¦å¯ä»¥åœ¨ for...in å¾ªç¯å’Œ Object.keys() ä¸­è¢«æšä¸¾ã€‚</span>  value: <span class="hljs-literal">true</span>,  writable: <span class="hljs-literal">true</span>,  <span class="hljs-comment">//å½“ writable å±æ€§è®¾ç½®ä¸º false æ—¶ï¼Œè¯¥å±æ€§è¢«ç§°ä¸ºâ€œä¸å¯å†™çš„â€ã€‚å®ƒä¸èƒ½è¢«é‡æ–°èµ‹å€¼ã€‚</span>  <span class="hljs-comment">//</span>  <span class="hljs-comment">// æˆ–è€…</span>  <span class="hljs-comment">//</span>  <span class="hljs-function"><span class="hljs-title">get</span>(<span class="hljs-params"></span>)</span> &#123; ... &#125;,  <span class="hljs-function"><span class="hljs-title">set</span>(<span class="hljs-params">newValue</span>)</span> &#123; ... &#125;,  enumerable : <span class="hljs-literal">true</span>,  configurable : <span class="hljs-literal">true</span>&#125;</code></pre></div><ol><li>å…¼å®¹<code>IE9</code></li><li>åŠ«æŒäº†å¯¹è±¡ä¸Šçš„<code>å±æ€§</code></li><li>æ•°æ®ç»“æ„è¶Šå¤æ‚åˆå§‹æ€§èƒ½ä¼šè¶Šå·®,éœ€è¦é€’å½’éå†ç»‘å®š<code>defineProperty</code></li><li>ä¸ºä¿æŒå“åº”å¼è¿˜éœ€è¦ä¸ºæ–°å¢æ•°æ®å†æ¬¡ç»‘å®š<code>defineProperty</code></li><li>éœ€è¦å¯¹åŸå§‹æ•°æ®ä¿®æ”¹æ¥è§¦å‘æ‹¦æˆªå™¨</li></ol><h3 id="proxy"><a href="#proxy" class="headerlink" title="proxy"></a><code>proxy</code></h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(target, handler)handler.getPrototypeOf()<span class="hljs-comment">//Object.getPrototypeOf æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>handler.setPrototypeOf()<span class="hljs-comment">//Object.setPrototypeOf æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>handler.isExtensible()<span class="hljs-comment">//Object.isExtensible æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>handler.preventExtensions()<span class="hljs-comment">//Object.preventExtensions æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>handler.getOwnPropertyDescriptor()<span class="hljs-comment">//Object.getOwnPropertyDescriptor æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>handler.defineProperty()<span class="hljs-comment">//Object.defineProperty æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>handler.has()<span class="hljs-comment">//in æ“ä½œç¬¦çš„æ•æ‰å™¨ã€‚</span>handler.get()<span class="hljs-comment">//å±æ€§è¯»å–æ“ä½œçš„æ•æ‰å™¨ã€‚</span>handler.set()<span class="hljs-comment">//å±æ€§è®¾ç½®æ“ä½œçš„æ•æ‰å™¨ã€‚</span>handler.deleteProperty()<span class="hljs-comment">//delete æ“ä½œç¬¦çš„æ•æ‰å™¨ã€‚</span>handler.ownKeys()<span class="hljs-comment">//Object.getOwnPropertyNames æ–¹æ³•å’Œ Object.getOwnPropertySymbols æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>handler.apply()<span class="hljs-comment">//å‡½æ•°è°ƒç”¨æ“ä½œçš„æ•æ‰å™¨ã€‚</span>handler.construct()<span class="hljs-comment">//new æ“ä½œç¬¦çš„æ•æ‰å™¨ã€‚</span></code></pre></div><ol><li>ä¸å…¼å®¹<code>IE</code></li><li>åŠ«æŒ<code>æ•´ä¸ªå¯¹è±¡</code>ï¼Œæ— éœ€å¯¹å¯¹è±¡æœ¬ä½“ä½œå‡ºä¿®æ”¹</li><li>å“åº”æ•°ç»„çš„æ”¹å˜</li><li>æ‹¦æˆªå™¨å“åº”çš„æ˜¯<code>proxy</code>ç”Ÿæˆçš„ä»£ç†å¯¹è±¡ï¼ŒåŸæ•°æ®çš„ä¿®æ”¹å°†ä¸ä¼šè§¦å‘æ‹¦æˆªå™¨</li><li>æ‹¦æˆªå™¨ç§ç±»ç¹å¤š</li></ol><h2 id="ç»„åˆå¼APIç”Ÿå‘½å‘¨æœŸ"><a href="#ç»„åˆå¼APIç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç»„åˆå¼APIç”Ÿå‘½å‘¨æœŸ"></a>ç»„åˆå¼APIç”Ÿå‘½å‘¨æœŸ</h2><p><code>onXXXX</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript">beforeCreate + <span class="hljs-function"><span class="hljs-params">created</span> =&gt;</span> setupbeforeMount =&gt; onBeforeMountmounted =&gt; onMountedbeforeUpdate =&gt; onBeforeUpdateupdated =&gt; onUpdatedbeforeDestroy =&gt; onBeforeUnmountdestroyed =&gt; onUnmounted<span class="hljs-comment">// keep-liveç»„ä»¶</span>activated =&gt; onActivateddeactivated =&gt; onDeactivated<span class="hljs-comment">// é”™è¯¯æ•è·</span>oneErrorCaptured<span class="hljs-comment">// è¿½è¸ª</span>onRenderTrackedonRenderTriggered</code></pre></div><h2 id="Composition-API"><a href="#Composition-API" class="headerlink" title="Composition API"></a><code>Composition API</code></h2><p>ç»„åˆå¼apiï¼Œè§£å†³å…³æ³¨ç‚¹åˆ†ç¦»é—®é¢˜ï¼ŒåŒä¸€é€»è¾‘ä»£ç å¯ä»¥æ‘†æ”¾åœ¨ä¸€èµ·</p><h2 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a><code>Hooks</code></h2><h2 id="css-in-js"><a href="#css-in-js" class="headerlink" title="css in js"></a><code>css in js</code></h2><h2 id="è‡ªå®šä¹‰æŒ‡ä»¤"><a href="#è‡ªå®šä¹‰æŒ‡ä»¤" class="headerlink" title="è‡ªå®šä¹‰æŒ‡ä»¤"></a>è‡ªå®šä¹‰æŒ‡ä»¤</h2><p>è‡ªå®šé’©å­ä¸ç»„ä»¶ç”Ÿå‘½å‘¨æœŸç»Ÿä¸€</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">created() <span class="hljs-comment">// åœ¨å…ƒç´ çš„ attribute æˆ–äº‹ä»¶ç›‘å¬å™¨è¢«åº”ç”¨ä¹‹å‰è°ƒç”¨ã€‚</span>beforeMount()mounted()beforeUpdate()updated()beforeUnmount()unmounted()<span class="hljs-keyword">const</span> app = Vue.createApp(&#123;&#125;)app.directive(<span class="hljs-string">&#x27;highlight&#x27;</span>, &#123;  <span class="hljs-function"><span class="hljs-title">beforeMount</span>(<span class="hljs-params">el, binding, vnode</span>)</span> &#123;    el.style.background = binding.value  &#125;&#125;)</code></pre></div><h1 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h1><h2 id="å®ç°reactive"><a href="#å®ç°reactive" class="headerlink" title="å®ç°reactive"></a>å®ç°reactive</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// reactivity.js çŒ´ç‰ˆå“åº”å¼æ¡†æ¶</span><span class="hljs-keyword">const</span> targetMap = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>();<span class="hljs-keyword">const</span> effectStack = [];<span class="hljs-keyword">const</span> isObject = <span class="hljs-function"><span class="hljs-params">obj</span> =&gt;</span> obj !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">&quot;object&quot;</span>;<span class="hljs-keyword">const</span> baseHandler = &#123;  <span class="hljs-function"><span class="hljs-title">get</span>(<span class="hljs-params">target, key</span>)</span> &#123;    <span class="hljs-keyword">const</span> ret = <span class="hljs-built_in">Reflect</span>.get(target, key);    track(target, key);    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ret === <span class="hljs-string">&quot;object&quot;</span>) &#123;      <span class="hljs-keyword">return</span> reactive(ret);    &#125;    <span class="hljs-keyword">return</span> ret;  &#125;,  <span class="hljs-function"><span class="hljs-title">set</span>(<span class="hljs-params">target, key, val</span>)</span> &#123;    <span class="hljs-built_in">Reflect</span>.set(target, key, val);    trigger(target, key, val);  &#125;,&#125;;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">track</span>(<span class="hljs-params">target, key</span>) </span>&#123;  <span class="hljs-keyword">let</span> activeEffect = effectStack[effectStack.length - <span class="hljs-number">1</span>];  <span class="hljs-keyword">if</span> (!activeEffect) <span class="hljs-keyword">return</span>;  <span class="hljs-keyword">let</span> depsMap = targetMap.get(target);  <span class="hljs-keyword">if</span> (!depsMap) &#123;    targetMap.set(target, (depsMap = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()));  &#125;  <span class="hljs-keyword">let</span> dep = depsMap.get(key);  <span class="hljs-keyword">if</span> (!dep) &#123;    depsMap.set(key, (dep = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>()));  &#125;  <span class="hljs-keyword">if</span> (!dep.has(activeEffect)) &#123;    dep.add(activeEffect);    <span class="hljs-comment">// TODO</span>    activeEffect.deps.push(dep);  &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trigger</span>(<span class="hljs-params">target, key, val</span>) </span>&#123;  <span class="hljs-keyword">const</span> depsMap = targetMap.get(target);  <span class="hljs-keyword">if</span> (!depsMap) &#123;    <span class="hljs-comment">// never been tracked</span>    <span class="hljs-keyword">return</span>;  &#125;  <span class="hljs-keyword">const</span> effects = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();  <span class="hljs-keyword">if</span> (key) &#123;    <span class="hljs-keyword">const</span> dep = depsMap.get(key);    dep.forEach(<span class="hljs-function">(<span class="hljs-params">effect</span>) =&gt;</span> &#123;      effects.add(effect);    &#125;);  &#125;  effects.forEach(<span class="hljs-function">(<span class="hljs-params">ef</span>) =&gt;</span> ef());&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createReactiveEffect</span>(<span class="hljs-params">fn,options</span>)</span>&#123;  <span class="hljs-keyword">const</span> effect = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reactiveEffect</span>(<span class="hljs-params"></span>)</span>&#123;      <span class="hljs-keyword">try</span> &#123;        effectStack.push(effect)        <span class="hljs-keyword">return</span> fn()      &#125; <span class="hljs-keyword">finally</span> &#123;        effectStack.pop()      &#125;  &#125;  effect.deps = []  effect.options = options  <span class="hljs-keyword">return</span> effect&#125;<span class="hljs-comment">// ---------</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reactive</span>(<span class="hljs-params">target</span>) </span>&#123;  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(target, baseHandler);&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">effect</span>(<span class="hljs-params">fn, options=&#123;&#125;</span>) </span>&#123;  <span class="hljs-keyword">const</span> effect = createReactiveEffect(fn, options);  <span class="hljs-keyword">if</span> (!options.lazy) &#123;    effect();  &#125;  <span class="hljs-keyword">return</span> effect;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">computed</span>(<span class="hljs-params">fn</span>)</span>&#123;  <span class="hljs-keyword">const</span> runner = effect(fn,&#123;<span class="hljs-attr">computed</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">lazy</span>:<span class="hljs-literal">true</span>&#125;)  <span class="hljs-keyword">return</span> &#123;    effect:runner,    <span class="hljs-keyword">get</span> <span class="hljs-title">val</span>()&#123;      <span class="hljs-keyword">return</span> runner()    &#125;  &#125;&#125;</code></pre></div><h2 id="ç®€å•å®ç°vuex"><a href="#ç®€å•å®ç°vuex" class="headerlink" title="ç®€å•å®ç°vuex"></a>ç®€å•å®ç°vuex</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123;reactive,inject,provide&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">const</span> STORE_KEY = <span class="hljs-built_in">Symbol</span>()<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useStore</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-keyword">return</span> reject(STORE_KEY)&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createStore</span>(<span class="hljs-params">options</span>)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Store(options)&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Store</span></span>&#123;<span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">options</span>)</span>&#123;<span class="hljs-keyword">const</span> &#123;state,mutations&#125; = options<span class="hljs-built_in">this</span>._state = reactive(&#123;data:state&#125;)<span class="hljs-built_in">this</span>._mutations = mutations&#125;<span class="hljs-keyword">get</span> <span class="hljs-title">state</span>()&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._state.data&#125;<span class="hljs-function"><span class="hljs-title">commit</span>(<span class="hljs-params">type,payload</span>)</span>&#123;<span class="hljs-keyword">const</span> entry = <span class="hljs-built_in">this</span>._mutations[type]entry &amp;&amp; entry(<span class="hljs-built_in">this</span>.state,payload)&#125;<span class="hljs-function"><span class="hljs-title">install</span>(<span class="hljs-params">app</span>)</span>&#123;app.provide(STORE_KEY,<span class="hljs-built_in">this</span>)&#125;&#125;<span class="hljs-keyword">export</span> &#123;createStore,useStore&#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>diffç®—æ³•</title>
    <link href="/2022/02/24/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Ddiff%E7%AE%97%E6%B3%95/"/>
    <url>/2022/02/24/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Ddiff%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><ul><li>diffç®—æ³•ï¼ŒåŒ…å«æ¸²æŸ“å™¨å¦‚ä½•å¯¹å„ç§ç±»å‹çš„vNodeçš„å±æ€§ï¼Œtextï¼Œfragmentè¿›è¡Œpatchæ›´æ–°ï¼Œä»¥åŠåˆ¤æ–­æ˜¯patch vNodeï¼Œè¿˜æ˜¯æ–°å¢è¿˜æ˜¯åˆ é™¤</li><li>é‡‡ç”¨åŒçº§æ¯”è¾ƒ</li></ul><h3 id="åŸºç¡€çš„diff"><a href="#åŸºç¡€çš„diff" class="headerlink" title="åŸºç¡€çš„diff"></a>åŸºç¡€çš„diff</h3><ul><li>æ–°èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹-&gt;åˆ é™¤å…¨éƒ¨æ—§çš„å­èŠ‚ç‚¹</li><li>æ–°èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹-&gt;åˆ é™¤æ—§çš„å¹¶æ·»åŠ æ–°çš„</li></ul><h3 id="æ ¸å¿ƒdiff"><a href="#æ ¸å¿ƒdiff" class="headerlink" title="æ ¸å¿ƒdiff"></a>æ ¸å¿ƒdiff</h3><ul><li>æ–°æ—§èŠ‚ç‚¹éƒ½æœ‰å¤šä¸ªå­èŠ‚ç‚¹æ—¶ï¼Œæ–°æ—§å­èŠ‚ç‚¹é—´çš„diff<div class="hljs code-wrapper"><pre><code class="hljs javascript">oldChildrenNode :[a,x,c,f]newChildrenNode :[a,c,f,r]</code></pre></div></li></ul><h4 id="æ²¡æœ‰key"><a href="#æ²¡æœ‰key" class="headerlink" title="æ²¡æœ‰key"></a>æ²¡æœ‰key</h4><ul><li>å°±åœ°æ›´æ–°ç­–ç•¥</li></ul><p>å–å‡ºæ–°æ—§vNodeæ•°ç»„ä¸­è¾ƒçŸ­çš„ä¸€ä¸ªä¸ºåŸºå‡†é•¿åº¦ä»å¤´å¼€å§‹è¿›è¡Œä¸€å¯¹ä¸€æ¯”è¾ƒï¼Œæ–°çš„æ¯”æ—§çš„é•¿åˆ™æ·»åŠ æ–°nodeéƒ¨åˆ†ï¼Œå¦åˆ™åˆ é™¤æ—§nodeéƒ¨åˆ†ï¼Œè¿™ä¸ªæ¯”è¾ƒæ˜¯ç›¸åŒä½ç½®å°±åœ°æ¯”è¾ƒ</p><h4 id="keyçš„ä½œç”¨"><a href="#keyçš„ä½œç”¨" class="headerlink" title="keyçš„ä½œç”¨"></a>keyçš„ä½œç”¨</h4><ul><li>vNodeä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦</li><li>ç”¨äºä¿å­˜æ–°æ—§vNodeçš„æ˜ å°„å…³ç³»</li><li>æ‰¾åˆ°å¯å¤ç”¨çš„vNode</li><li>ç”¨ç§»åŠ¨èŠ‚ç‚¹è¾¾åˆ°æ›´æ–°ç›®çš„â­ï¸</li></ul><h4 id="React-æœ€å¤§é€’å¢ç´¢å¼•å€¼k"><a href="#React-æœ€å¤§é€’å¢ç´¢å¼•å€¼k" class="headerlink" title="React æœ€å¤§é€’å¢ç´¢å¼•å€¼k"></a>React æœ€å¤§é€’å¢ç´¢å¼•å€¼k</h4><ul><li>ä¸¤æ¬¡å¾ªç¯ï¼Œéå†æ–°nodeå»æ—§nodeä¸­å¯»æ‰¾æ–°vnodeä½ç½®</li><li>å¦‚æœç´¢å¼•å‘ˆç°é€’å¢è¶‹åŠ¿<div class="hljs code-wrapper"><pre><code class="hljs javascript">old: key1 key2 key3<span class="hljs-keyword">new</span>: key1 key2 key3</code></pre></div>ï¼ˆnewA-&gt;oldA=&gt;0,newB-&gt;oldB=&gt;1,newC-&gt;oldC=&gt;2ï¼‰åˆ™è¯´æ˜æ–°æ—§ children ä¸­èŠ‚ç‚¹é¡ºåºç›¸åŒï¼Œä¸éœ€è¦ç§»åŠ¨æ“ä½œã€‚ç›¸åçš„ï¼Œå¦‚æœåœ¨å¯»æ‰¾çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„ç´¢å¼•å€¼ä¸å‘ˆç°é€’å¢è¶‹åŠ¿ï¼Œåˆ™è¯´æ˜éœ€è¦ç§»åŠ¨æ“ä½œ</li><li>å¦‚æœåŒ¹é…è¿‡ç¨‹ä¸­é€’å¢è§„å¾‹è¢«æ‰“ç ´</li></ul>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">old: key2 key3 key1<span class="hljs-keyword">new</span>: key1 key2 key3k = <span class="hljs-number">2</span> ä¹‹å‰çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½éœ€è¦ç§»åŠ¨</code></pre></div><p>  <code>k</code>ä¸ºåœ¨æ—§ children ä¸­æ‰€é‡åˆ°çš„æœ€å¤§ç´¢å¼•å€¼ï¼Œåˆ™åç»­åŒ¹é…çš„ç´¢å¼•å°äºè¿™ä¸ªå€¼æ„å‘³ç€éƒ½éœ€è¦ç§»åŠ¨</p><h3 id="Vue2çš„åŒç«¯æ¯”è¾ƒ"><a href="#Vue2çš„åŒç«¯æ¯”è¾ƒ" class="headerlink" title="Vue2çš„åŒç«¯æ¯”è¾ƒ"></a>Vue2çš„åŒç«¯æ¯”è¾ƒ</h3><blockquote><p>å€Ÿé‰´<code>snabbdom.js</code></p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript">(oStart)               [oEnd] oldA   oldB   oldC    oldD newB   newC   newD    newA(nStart)               [nEnd]<span class="hljs-comment">// oStartä¸nEndåŒ¹é…ä¸Šäº†keyï¼Œå°†oldAçš„DOMç§»åŠ¨åˆ°æ–°domæœ€å</span>      (oStart)        [oEnd] oldA   oldB   oldC    oldD ï½œ  ----------------------&gt;                        ï½œ newB   newC   newD    newA(nStart)      [nEnd]</code></pre></div><ul><li><p>vueåŒæ—¶ä»æ–°æ—§childrençš„ä¸¤ç«¯å¼€å§‹æ¯”è¾ƒ</p></li><li><p>å››ä¸ªæŒ‡é’ˆï¼Œåˆ†åˆ«æŸ¥æ‰¾æ˜¯å¦keyç›¸åŒ</p></li><li><p>åŒ¹é…åˆ°äº†ç›¸åŒçš„keyï¼Œåˆ™å°†çœŸå®domç§»åŠ¨,åŒæ—¶å››ä¸ªæŒ‡é’ˆå¯¹æ’ç§»åŠ¨</p></li><li><p>å¦‚æœç¬¬ä¸€è½®å››æ¬¡åŒ¹é…ä¸ä¸Šï¼Œåˆ™éå†æ—§nodeå¯»æ‰¾<code>nStart</code></p></li><li><p>if æ‰¾åˆ°å°†å…¶çœŸå®DOMç§»åŠ¨åˆ°<code>oStart</code>ä¹‹å‰ï¼Œå¹¶åœ¨åŸvnodeä½ç½®ç½®ç©ºundefinedï¼Œååºæ¯”è¾ƒä¼šè·³è¿‡ä»–</p></li><li><p>else æ‰¾ä¸åˆ°åˆ™æ·»åŠ æ–°å¢æ–°å…ƒç´ <code>nStart</code>åˆ°<code>oStart</code>ä¹‹å‰</p></li><li><p>åŒ¹é…ç»“æŸå<code>oEnd&lt;oStart</code>,æ–°å¢<code>nStartåˆ°nEnd</code>æ–°å…ƒç´ åˆ°<code>oStart</code>ä¹‹å‰</p></li><li><p>åŒ¹é…ç»“æŸå<code>nStart&gt;nEnd</code>,åˆ é™¤<code>oStartåˆ°oEnd</code>ä¹‹é—´å…ƒç´ </p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isUndef</span> (<span class="hljs-params">v</span>) </span>&#123;  <span class="hljs-keyword">return</span> v === <span class="hljs-literal">undefined</span> || v === <span class="hljs-literal">null</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isDef</span> (<span class="hljs-params">v</span>) </span>&#123;  <span class="hljs-keyword">return</span> v !== <span class="hljs-literal">undefined</span> &amp;&amp; v !== <span class="hljs-literal">null</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sameVnode</span> (<span class="hljs-params">a, b</span>) </span>&#123;  <span class="hljs-keyword">return</span> (    a.key === b.key &amp;&amp; (      (        a.tag === b.tag &amp;&amp;        a.isComment === b.isComment &amp;&amp;        isDef(a.data) === isDef(b.data) &amp;&amp;        !childrenIgnored(a) &amp;&amp; !childrenIgnored(b) &amp;&amp;        sameInputType(a, b)      ) || (        isTrue(a.isAsyncPlaceholder) &amp;&amp;        a.asyncFactory === b.asyncFactory &amp;&amp;        isUndef(b.asyncFactory.error)      )    )  )&#125;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateChildren</span> (<span class="hljs-params">parentElm, oldCh, newCh, insertedVnodeQueue, removeOnly</span>) </span>&#123;    <span class="hljs-keyword">let</span> oldStartIdx = <span class="hljs-number">0</span>    <span class="hljs-keyword">let</span> newStartIdx = <span class="hljs-number">0</span>    <span class="hljs-keyword">let</span> oldEndIdx = oldCh.length - <span class="hljs-number">1</span>    <span class="hljs-keyword">let</span> oldStartVnode = oldCh[<span class="hljs-number">0</span>]    <span class="hljs-keyword">let</span> oldEndVnode = oldCh[oldEndIdx]    <span class="hljs-keyword">let</span> newEndIdx = newCh.length - <span class="hljs-number">1</span>    <span class="hljs-keyword">let</span> newStartVnode = newCh[<span class="hljs-number">0</span>]    <span class="hljs-keyword">let</span> newEndVnode = newCh[newEndIdx]    <span class="hljs-keyword">let</span> oldKeyToIdx, idxInOld, vnodeToMove, refElm    <span class="hljs-keyword">while</span> (oldStartIdx &lt;= oldEndIdx &amp;&amp; newStartIdx &lt;= newEndIdx) &#123;      <span class="hljs-keyword">if</span> (isUndef(oldStartVnode)) &#123;        oldStartVnode = oldCh[++oldStartIdx] <span class="hljs-comment">// Vnode has been moved left</span>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isUndef(oldEndVnode)) &#123;        oldEndVnode = oldCh[--oldEndIdx]      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sameVnode(oldStartVnode, newStartVnode)) &#123;        patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue, newCh, newStartIdx)        oldStartVnode = oldCh[++oldStartIdx]        newStartVnode = newCh[++newStartIdx]      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sameVnode(oldEndVnode, newEndVnode)) &#123;        patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue, newCh, newEndIdx)        oldEndVnode = oldCh[--oldEndIdx]        newEndVnode = newCh[--newEndIdx]      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sameVnode(oldStartVnode, newEndVnode)) &#123; <span class="hljs-comment">// Vnode moved right</span>      <span class="hljs-comment">// è¯´æ˜oldStartVnodeèŠ‚ç‚¹æ›´æ–°åè¦ç§»åŠ¨å»æœ«å°¾ä½ç½®</span>        patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue, newCh, newEndIdx)        canMove &amp;&amp; nodeOps.insertBefore(parentElm, oldStartVnode.elm, nodeOps.nextSibling(oldEndVnode.elm))        oldStartVnode = oldCh[++oldStartIdx]        newEndVnode = newCh[--newEndIdx]      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sameVnode(oldEndVnode, newStartVnode)) &#123; <span class="hljs-comment">// Vnode moved left</span>      <span class="hljs-comment">// è¯´æ˜oldEndVnodeèŠ‚ç‚¹æ›´æ–°åè¦ç§»åŠ¨åˆ°æœ€å‰æ–¹</span>        patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue, newCh, newStartIdx)        canMove &amp;&amp; nodeOps.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm)        oldEndVnode = oldCh[--oldEndIdx]        newStartVnode = newCh[++newStartIdx]      &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">if</span> (isUndef(oldKeyToIdx)) oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx)        <span class="hljs-comment">// oldKeyToIndexæ˜¯æ—§èŠ‚ç‚¹çš„key2indexæ˜ å°„map</span>        idxInOld = isDef(newStartVnode.key)          ? oldKeyToIdx[newStartVnode.key]          : findIdxInOld(newStartVnode, oldCh, oldStartIdx, oldEndIdx)          <span class="hljs-comment">// å»æ—§èŠ‚ç‚¹ä¸­å¯»æ‰¾newStartVnode</span>        <span class="hljs-keyword">if</span> (isUndef(idxInOld)) &#123; <span class="hljs-comment">// æ‰¾ä¸åˆ°åˆ™æ–°å¢newStartVnodeå…ƒç´ åˆ°oldStartä¹‹å‰</span>          createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm, <span class="hljs-literal">false</span>, newCh, newStartIdx)        &#125; <span class="hljs-keyword">else</span> &#123;          <span class="hljs-comment">// æ‰¾å¾—åˆ°åˆ™è¿›è¡Œç§»åŠ¨</span>          vnodeToMove = oldCh[idxInOld]          <span class="hljs-keyword">if</span> (sameVnode(vnodeToMove, newStartVnode)) &#123;            patchVnode(vnodeToMove, newStartVnode, insertedVnodeQueue, newCh, newStartIdx)            oldCh[idxInOld] = <span class="hljs-literal">undefined</span>            <span class="hljs-comment">// å°†æ—§èŠ‚ç‚¹ä¸­åŒ¹é…åˆ°çš„ä½ç½®ç½®ç©ºï¼Œä»¥åçš„æŸ¥æ‰¾ä¼šè·³è¿‡</span>            canMove &amp;&amp; nodeOps.insertBefore(parentElm, vnodeToMove.elm, oldStartVnode.elm)            <span class="hljs-comment">// åŒ¹é…åˆ°çš„èŠ‚ç‚¹ç§»åŠ¨åˆ°oldStartä¹‹å‰</span>          &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// keyç›¸åŒä½†ä¸æ˜¯åŒä¸€ç§å…ƒç´ </span>            createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm, <span class="hljs-literal">false</span>, newCh, newStartIdx)          &#125;        &#125;        newStartVnode = newCh[++newStartIdx]      &#125;    &#125;    <span class="hljs-comment">// è·³å‡ºåŒ¹é…å</span>    <span class="hljs-keyword">if</span> (oldStartIdx &gt; oldEndIdx) &#123;      refElm = isUndef(newCh[newEndIdx + <span class="hljs-number">1</span>]) ? <span class="hljs-literal">null</span> : newCh[newEndIdx + <span class="hljs-number">1</span>].elm      addVnodes(parentElm, refElm, newCh, newStartIdx, newEndIdx, insertedVnodeQueue)    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (newStartIdx &gt; newEndIdx) &#123;      removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx)    &#125;  &#125;</code></pre></div><h3 id="Vue3-å€Ÿé‰´infernoå’Œiviçš„ç®—æ³•"><a href="#Vue3-å€Ÿé‰´infernoå’Œiviçš„ç®—æ³•" class="headerlink" title="Vue3 å€Ÿé‰´infernoå’Œiviçš„ç®—æ³•"></a>Vue3 å€Ÿé‰´<code>inferno</code>å’Œ<code>ivi</code>çš„ç®—æ³•</h3></li><li><p>æ’é™¤ç›¸åŒçš„é¦–ä½èŠ‚ç‚¹</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">[j]             [preEnd] |                  | a   e   f  k   b   c |                  |--------------------- |                  | a   f   k  e   b   c |                  |   [j]             [nextEnd]    [j] [preEnd]     |      | a   e   f  k   b   c     |      |---------------------     |      | a   f   k  e   b   c     |      |       [j] [nextEnd]</code></pre></div><ul><li>åˆ†åˆ«ä»æ–°æ—§èŠ‚ç‚¹çš„å¤´å’Œå°¾å‡ºå‘</li><li>ä¾æ¬¡éå†åˆ°keyå€¼ä¸ä¸€æ ·æ—¶åœæ­¢ </li><li>è¿™æ ·åŒ¹é…æˆåŠŸåå‰©ä¸‹çš„éƒ¨åˆ†å°±æ˜¯éœ€è¦æ–°å¢/åˆ é™¤çš„vNodeä»¬</li></ul></li><li><p>ä½¿ç”¨å‰©ä½™æ–°childrençš„é•¿åº¦å»ºç«‹sourceç´¢å¼•æ•°ç»„</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">  oldChildren = [e,f,k]  newChildren = [f,k,e]  source = [-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]- ä¸ºæ–°vnodeå»ºç«‹keyï¼Œindexç´¢å¼•è¡¨  <span class="hljs-string">``</span><span class="hljs-string">`js</span><span class="hljs-string">  keyIndex = &#123;f:0,k:1,e:2&#125;</span></code></pre></div></li><li><p>éå†æ—§childrenä¸­keyå»keyIndexä¸­æŸ¥æ‰¾<code>k = kenIndex[oldChildren[i]]</code>ï¼Œæœ‰è¿™ä¸ªkåˆ™æŠŠ<code>source</code>æ•°ç»„è¯¥ä½ç½®çš„-1æ”¹ä¸ºæ—§vNodeçš„ç´¢å¼•ï¼Œå¹¶ä¸”patchè¯¥èŠ‚ç‚¹ ;<code>k=undefined</code>åˆ™è¯´æ˜è¯¥èŠ‚ç‚¹å·²ç»è¢«åˆ é™¤ï¼Œè€Œsourceä¸­ä¾æ—§ä¸º-1çš„èŠ‚ç‚¹ä¸ºæ–°å¢èŠ‚ç‚¹</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">source = [<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]</code></pre></div></li><li><p>åˆ¤æ–­æ˜¯å¦éœ€è¦ç§»åŠ¨</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">source = [<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]<span class="hljs-comment">//sourceä¸­ï¼Œæœ€å¤§ç´¢å¼•ä¸º2ï¼Œ2ä¹‹åæœ‰å°äº2çš„ç´¢å¼•ï¼Œè¯´æ˜éœ€è¦ç§»åŠ¨</span><span class="hljs-comment">//æ ¹æ®sourceæ•°ç»„æ±‚å‡ºæœ€é•¿é€’å¢å­åºåˆ—</span>LIS = [<span class="hljs-number">1</span>ï¼Œ<span class="hljs-number">2</span>]<span class="hljs-comment">// LISä¸­å­˜å‚¨çš„æ˜¯sourceç´¢å¼•</span><span class="hljs-comment">// è¡¨ç¤ºæ–°æ—§childrenä¸­è¿™å‡ ä¸ªèŠ‚ç‚¹ä½ç½®ä¿æŒé€’å¢å…³ç³»</span></code></pre></div></li><li><p>æ ¹æ®LISå¾—å‡ºä¸è¿›è¡Œç§»åŠ¨çš„èŠ‚ç‚¹</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">newChildren[LIS] = [f,k]</code></pre></div></li><li><p>ä»LISå’Œæ–°childrenå°¾å¤„å»ºç«‹ä¸¤ä¸ªæŒ‡é’ˆå¤„ç†ä½™ä¸‹èŠ‚ç‚¹</p></li><li><p>æ¯”è¾ƒæŒ‡é’ˆçš„ç´¢å¼•æ˜¯æ˜¯å¦ç›¸åŒï¼Œä¸åŒåˆ™ç§»åŠ¨DOMä½ç½®åˆ°ä¸Šä¸ªæŒ‡é’ˆçš„çœŸå®DOMä¹‹å‰</p><blockquote><p>oldVnode.el = çœŸå®DOMï¼ŒåŒæ—¶source.key = -1çš„èŠ‚ç‚¹ç›´æ¥åˆ›å»ºäº†æ–°çš„çœŸå®DOM</p></blockquote></li></ul><h3 id="æœ€é•¿é€’å¢å­åºåˆ—"><a href="#æœ€é•¿é€’å¢å­åºåˆ—" class="headerlink" title="æœ€é•¿é€’å¢å­åºåˆ—"></a>æœ€é•¿é€’å¢å­åºåˆ—</h3><ul><li>å­åºåˆ—ï¼šä¸è¦æ±‚è¿ç»­</li><li>å­—ä¸²ï¼šè¦æ±‚è¿ç»­</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// åŠ¨æ€è§„åˆ’</span><span class="hljs-keyword">const</span> longestChildSequence = <span class="hljs-function"><span class="hljs-params">arr</span> =&gt;</span> &#123;  <span class="hljs-keyword">let</span> len = arr.length  <span class="hljs-keyword">if</span>(len &lt; <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>  <span class="hljs-keyword">const</span> dp = <span class="hljs-built_in">Array</span>(len).fill(<span class="hljs-number">1</span>)  <span class="hljs-comment">// dp[i]ä»£è¡¨åŸå§‹æ•°ç»„è¯¥ä½ç½®çš„æœ€é•¿å­åºåˆ—é•¿åº¦</span>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span> ; i &lt; len ; i++)&#123;    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span> ; j &lt; i ; j++)&#123;      <span class="hljs-comment">// jéå†ä¹‹å‰éå†è¿‡çš„æ‰€æœ‰å…ƒç´ </span>      <span class="hljs-comment">// å¯èƒ½å­˜åœ¨å¤§å°ä¸ä¸€çš„é€’å¢åºåˆ—ï¼Œä½¿ç”¨maxå–å¾—æœ€å¤§å€¼</span>      <span class="hljs-keyword">if</span>(arr[i] &gt; arr [j])&#123;        dp[i] = <span class="hljs-built_in">Math</span>.max(dp[i],dp[j]+<span class="hljs-number">1</span>)        <span class="hljs-comment">// [1,2,3,4,1,2,5]</span>        <span class="hljs-comment">// å¦‚æœåªä½¿ç”¨dp[j]+1 ï¼Œdp[6]ä¼šåœ¨[1,2,5]ä¸­å¾—å‡ºç»“æœ3</span>        <span class="hljs-comment">// ä½¿ç”¨maxæ¯”è¾ƒä¹‹å‰æ›´é•¿çš„åºåˆ—[1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5]å¾—åˆ°5</span>      &#125;    &#125;  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(...dp)&#125;<span class="hljs-comment">// è´ªå¿ƒ+äºŒåˆ†</span><span class="hljs-keyword">const</span> longestChildSequence = <span class="hljs-function"><span class="hljs-params">arr</span> =&gt;</span> &#123;  <span class="hljs-keyword">let</span> len = arr.length  <span class="hljs-keyword">if</span>(len &lt; <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>  <span class="hljs-keyword">const</span> res = [arr[<span class="hljs-number">0</span>]]  <span class="hljs-comment">//å°†arrä¸­åç»­å…ƒç´ arr[i]ä¸resæœ«å°¾å…ƒç´ æ¯”è¾ƒ</span>  <span class="hljs-comment">//å¤§äºåˆ™pushè¿›res</span>  <span class="hljs-comment">//å°äºåˆ™æŸ¥æ‰¾resä¸­ç¬¬ä¸€ä¸ªæ¯”arr[i]å¤§çš„å…ƒç´ å¹¶æ›¿æ¢</span>  <span class="hljs-comment">//ç”±äºå­˜åœ¨æ›¿æ¢ï¼Œå­åºåˆ—å€¼ä¸ä¸€å®šæ­£ç¡®ï¼Œä½†é•¿åº¦æ˜¯æ­£ç¡®çš„</span>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ; i&lt; len ;i++)&#123;    <span class="hljs-keyword">if</span>(arr[i]&gt;res[res.length-<span class="hljs-number">1</span>])&#123;      res.push(arr[i])    &#125;<span class="hljs-keyword">else</span>&#123;      <span class="hljs-comment">// resä¸­å·¦å³æŒ‡é’ˆçš„index</span>      <span class="hljs-comment">// äºŒåˆ†æŸ¥æ‰¾</span>      <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>      <span class="hljs-keyword">let</span> right = res.length - <span class="hljs-number">1</span>      <span class="hljs-keyword">while</span>(left&lt;right)&#123;        <span class="hljs-keyword">let</span> mid = <span class="hljs-built_in">Math</span>.floor((left+right)/<span class="hljs-number">2</span>)        <span class="hljs-comment">// let mid = ((left+right)/2) | 0</span>        <span class="hljs-comment">// æµ®ç‚¹å°æ•°å‘ä¸‹æ±‚æ•´</span>        <span class="hljs-keyword">if</span>(arr[i]&gt;res[mid])&#123;          left = mid + <span class="hljs-number">1</span>        &#125;<span class="hljs-keyword">else</span>&#123;          right = mid        &#125;      &#125;      res[left] = arr[i]    &#125;  &#125;  <span class="hljs-keyword">return</span> res.length &#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>vue</tag>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue@2.xå®ç°åˆ†æ</title>
    <link href="/2022/02/24/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Dvue2/"/>
    <url>/2022/02/24/%5B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%5Dvue2/</url>
    
    <content type="html"><![CDATA[<h1 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h1><h2 id="åˆå§‹åŒ–é˜¶æ®µ"><a href="#åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="åˆå§‹åŒ–é˜¶æ®µ"></a>åˆå§‹åŒ–é˜¶æ®µ</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">Vue.prototype._init = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options?: <span class="hljs-built_in">Object</span></span>)</span>&#123;  <span class="hljs-comment">// è®¾ç½®uid</span>  vm._uid = uid++  <span class="hljs-comment">// ä¸ä¸ºæ ¹ç»„ä»¶è®¾ç½®å“åº”å¼</span>  vm._isVue = <span class="hljs-literal">true</span>  <span class="hljs-comment">// åˆå¹¶é…ç½®</span>  <span class="hljs-comment">// åˆå¹¶å®ä¾‹çš„optionå¯¹è±¡ï¼Œé‡Œé¢ä¼šåŒ…å«åƒç”Ÿå‘½å‘¨æœŸé’©å­å›è°ƒç”¨ï¼ŒæŒ‡ä»¤ï¼Œè¿‡æ»¤å™¨ï¼Œvueå†…ç½®å¯¹è±¡ç­‰ï¼Œä¸ç”¨æˆ·è‡ªå®šä¹‰çš„å…¨å±€xxåˆå¹¶</span>  <span class="hljs-comment">// å®ä¾‹å†…éƒ¨æ‰§è¡Œä¼šæ¯”å¤–éƒ¨new Vueå¿«å¾ˆå¤š</span>  <span class="hljs-keyword">if</span> (options &amp;&amp; options._isComponent) &#123;    <span class="hljs-comment">// å®ä¾‹å†…éƒ¨æ‰§è¡Œnew Vue</span>    initInternalComponent(vm, options)  &#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-comment">// ä»å¤–éƒ¨æ‰§è¡Œnew Vueæ—¶</span>    vm.$options = mergeOptions(      âˆšs || &#123;&#125;,      vm    )  &#125;  <span class="hljs-comment">// åˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸ</span>  <span class="hljs-function"><span class="hljs-title">initLifecycle</span>(<span class="hljs-params">vm</span>)</span>&#123;    <span class="hljs-comment">//å…³è”`$parent`,å¹¶å°†è‡ªå·±æ·»åŠ è¿›çˆ¶ç»„ä»¶çš„`$children`æ•°ç»„,ç”Ÿæˆè‡ªå·±çš„`$children`æ•°ç»„å’Œ`$refs`å¯¹è±¡,å¹¶æŒ‡å®š`$root`</span>    <span class="hljs-keyword">var</span> parent = options.parent;    parent.$children.push(vm);    vm.$parent = parent;    vm.$root = parent ? parent.$root : vm;    vm.$children = [];    vm.$refs = &#123;&#125;;    vm._watcher = <span class="hljs-literal">null</span>;    vm._isMounted = <span class="hljs-literal">false</span>;<span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦mountçš„flag</span>  &#125;  <span class="hljs-function"><span class="hljs-title">initEvents</span>(<span class="hljs-params">vm</span>)</span>&#123;<span class="hljs-comment">// åˆå§‹åŒ–äº‹ä»¶ä¸­å¿ƒ</span>    vm._events = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);    <span class="hljs-keyword">var</span> listeners = vm.$options._parentListeners;    <span class="hljs-keyword">if</span> (listeners) &#123;      updateComponentListeners(vm, listeners); <span class="hljs-comment">// ç»„ä»¶ä¸Šçš„äº‹ä»¶</span>    &#125;  &#125;  <span class="hljs-function"><span class="hljs-title">initRender</span>(<span class="hljs-params">vm</span>)</span>&#123;      vm.$slots = resolveSlots(options._renderChildren, renderContext);<span class="hljs-comment">// åˆå§‹åŒ–æ’æ§½ï¼Œå¾—åˆ°vm.$slotså¯¹è±¡</span>      <span class="hljs-comment">// keyæ˜¯æ’æ§½å valueæ˜¯vnode</span>      vm._c = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b, c, d</span>) </span>&#123; <span class="hljs-keyword">return</span> createElement(vm, a, b, c, d, <span class="hljs-literal">false</span>); &#125;;      <span class="hljs-comment">// æ¨¡ç‰ˆç¼–è¯‘çš„createElementå‡½æ•°</span>      vm.$createElement = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b, c, d</span>) </span>&#123; <span class="hljs-keyword">return</span> createElement(vm, a, b, c, d, <span class="hljs-literal">true</span>); &#125;;      <span class="hljs-comment">// åˆå§‹åŒ–ç”¨æˆ·è‡ªå·±å†™çš„createElementå‡½æ•°</span>      defineReactive$$1(vm, <span class="hljs-string">&#x27;$attrs&#x27;</span>, parentData &amp;&amp; parentData.attrs || emptyObject, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;        !isUpdatingChildComponent &amp;&amp; warn(<span class="hljs-string">&quot;$attrs is readonly.&quot;</span>, vm);      &#125;, <span class="hljs-literal">true</span>);      defineReactive$$1(vm, <span class="hljs-string">&#x27;$listeners&#x27;</span>, options._parentListeners || emptyObject, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;        !isUpdatingChildComponent &amp;&amp; warn(<span class="hljs-string">&quot;$listeners is readonly.&quot;</span>, vm);      &#125;, <span class="hljs-literal">true</span>);  &#125;  callHook(vm, <span class="hljs-string">&#x27;beforeCreate&#x27;</span>);  initInjections(vm); <span class="hljs-comment">// resolve injections before data/props</span>  initState (vm) &#123;    initProps(vm, opts.props);    <span class="hljs-comment">// å­ç»„ä»¶æ ‡ç­¾ä¸Šçš„propå°†ä¼šç¼–è¯‘ä¸ºattrså¯¹è±¡</span>    <span class="hljs-comment">// renderå‡½æ•°åœ¨æ ¡éªŒè¿™äº›propsåä¼šä¼šç”ŸæˆpropDataä¼ å…¥VNodeæ„é€ å™¨</span>    <span class="hljs-comment">// å®ä¾‹åŒ–å­ç»„ä»¶çš„åŒæ—¶ä¹Ÿä¸ºpropç»‘å®šäº†å“åº”å¼</span>    initMethods(vm, opts.methods);    <span class="hljs-comment">// ç¡®ä¿æ–¹æ³•å‘½åè§„èŒƒå¹¶æ·»åŠ åˆ°å®ä¾‹ä¸Š</span>    initData(vm);    <span class="hljs-comment">// ç¡®ä¿dataä¸­å‘½åè§„èŒƒå¹¶ç»‘å®šå“åº”å¼</span>    initComputed(vm, opts.computed);    initWatch(vm, opts.watch);  &#125;  initProvide(vm); <span class="hljs-comment">// resolve provide after data/props</span>  callHook(vm, <span class="hljs-string">&#x27;created&#x27;</span>);&#125;</code></pre></div><h2 id="æŒ‚è½½é˜¶æ®µ"><a href="#æŒ‚è½½é˜¶æ®µ" class="headerlink" title="æŒ‚è½½é˜¶æ®µ"></a>æŒ‚è½½é˜¶æ®µ</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">mountComponent () &#123;  callHook(vm, <span class="hljs-string">&#x27;â­ï¸beforeMount&#x27;</span>);  <span class="hljs-keyword">let</span> updateComponent;  updateComponent = <span class="hljs-function">() =&gt;</span> &#123;    vm._update(vm._render(), hydrating);    <span class="hljs-comment">// updateå‡½æ•°</span>    Vue.prototype._update = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">vnode, hydrating</span>) </span>&#123;      <span class="hljs-keyword">if</span> (!prevVnode) &#123;        <span class="hljs-comment">// initial render</span>        vm.$el = vm.__patch__(vm.$el, vnode, hydrating, <span class="hljs-literal">false</span> <span class="hljs-comment">/* removeOnly */</span>);      &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-comment">// updates</span>        vm.$el = vm.__patch__(prevVnode, vnode);    &#125;;  &#125;;  <span class="hljs-keyword">new</span> Watcher(vm, updateComponent, noop, &#123;        before: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">before</span> (<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-keyword">if</span> (vm._isMounted) &#123;          callHook(vm, <span class="hljs-string">&#x27;beforeUpdate&#x27;</span>);        &#125;      &#125;    subs[i].notify  ---&gt; Watcher.prototype.update()    callHook(vm, <span class="hljs-string">&#x27;â­ï¸beforeDestroy&#x27;</span>);  &#125;, <span class="hljs-literal">true</span> <span class="hljs-comment">/* isRenderWatcher inité˜¶æ®µç”Ÿæˆçš„æ˜¯æ¸²æŸ“watcher*/</span>);    vm._isMounted = <span class="hljs-literal">true</span>;    callHook(vm, <span class="hljs-string">&#x27;mounted&#x27;</span>);&#125;</code></pre></div><h2 id="é”€æ¯é˜¶æ®µ"><a href="#é”€æ¯é˜¶æ®µ" class="headerlink" title="é”€æ¯é˜¶æ®µ"></a>é”€æ¯é˜¶æ®µ</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">Vue.prototype.$destroy = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;  callHook(vm, <span class="hljs-string">&#x27;â­ï¸beforeDestroy&#x27;</span>);  <span class="hljs-comment">// é”€æ¯å®ä¾‹ï¼Œå­å®ä¾‹ï¼Œä»çˆ¶ç»„ä»¶childrenä¸­åˆ é™¤ï¼Œé”€æ¯æ‰€æœ‰äº‹ä»¶å’ŒæŒ‡ä»¤</span>  remove(parent.$children, vm);  vm._watcher.teardown();  vm.__patch__(vm._vnode, <span class="hljs-literal">null</span>);  <span class="hljs-comment">// fire destroyed hook</span>    callHook(vm, <span class="hljs-string">&#x27;â­ï¸destroyed&#x27;</span>);  vm.$el.__vue__ = <span class="hljs-literal">null</span>;  vm.$vnode.parent = <span class="hljs-literal">null</span>;  &#125;;&#125;</code></pre></div><h2 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a>keep-alive</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">callHook(vm, <span class="hljs-string">&#x27;â­ï¸activated&#x27;</span>);callHook(vm, <span class="hljs-string">&#x27;â­ï¸deactivated&#x27;</span>);</code></pre></div><h1 id="å“åº”å¼åŸç†"><a href="#å“åº”å¼åŸç†" class="headerlink" title="å“åº”å¼åŸç†"></a>å“åº”å¼åŸç†</h1><h3 id="defineReactive"><a href="#defineReactive" class="headerlink" title="defineReactive"></a><code>defineReactive</code></h3><div class="hljs code-wrapper"><pre><code class="hljs javascript">defineReactive (  ...) &#123;  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> Dep()  ...  <span class="hljs-built_in">Object</span>.defineProperty(obj, key, &#123;    enumerable: <span class="hljs-literal">true</span>,    configurable: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// renderå‡½æ•°æ¥è§¦dataè§¦å‘getter</span>    get: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reactiveGetter</span> (<span class="hljs-params"></span>) </span>&#123;      <span class="hljs-keyword">if</span> (Dep.target) &#123;        <span class="hljs-comment">// æ­¤æ—¶Dep.targetå·²ç»æ˜¯æ¸²æŸ“watcher</span>        <span class="hljs-comment">// æ‰§è¡Œdepend</span>â­ï¸        dep.depend()        <span class="hljs-keyword">if</span> (childOb) &#123;          ...        &#125;      &#125;      <span class="hljs-keyword">return</span> value    &#125;,    set: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reactiveSetter</span> (<span class="hljs-params">newVal</span>) </span>&#123;      <span class="hljs-keyword">if</span> (newVal === value || (newVal !== newVal &amp;&amp; value !== value)) &#123;        <span class="hljs-keyword">return</span>      &#125;      val = newValğŸ”¥    dep.notify()    &#125;  &#125;)&#125;</code></pre></div><h3 id="mountComponent"><a href="#mountComponent" class="headerlink" title="mountComponent "></a><code>mountComponent </code></h3><div class="hljs code-wrapper"><pre><code class="hljs javascript">mountComponent (...): Component &#123;  callHook(vm, <span class="hljs-string">&#x27;beforeMount&#x27;</span>)  <span class="hljs-keyword">let</span> updateComponent;â­ï¸ <span class="hljs-comment">// renderå‡½æ•°ç”Ÿæˆè™šæ‹ŸDOMï¼ŒæœŸé—´ä¼šè®¿é—®æ•°æ®</span>  updateComponent = <span class="hljs-function">() =&gt;</span> &#123;    vm._update(vm._render(), hydrating);  &#125;;â­ï¸ <span class="hljs-comment">//ç»„ä»¶`mount`è¿‡ç¨‹ä¸­ä¼šå®ä¾‹åŒ–ä¸€ä¸ªæ¸²æŸ“`watcher`ï¼Œä¼ å…¥updateComponentå‡½æ•°</span>  vm._watcher = <span class="hljs-keyword">new</span> Watcher(vm, updateComponent, noop, &#123;    before () &#123;      <span class="hljs-keyword">if</span> (vm._isMounted) &#123;        callHook(vm, <span class="hljs-string">&#x27;beforeUpdate&#x27;</span>)      &#125;    &#125;  &#125;, <span class="hljs-literal">true</span> <span class="hljs-comment">/* isRenderWatcher */</span>)  <span class="hljs-keyword">if</span> (vm.$vnode == <span class="hljs-literal">null</span>) &#123;    vm._isMounted = <span class="hljs-literal">true</span>    callHook(vm, <span class="hljs-string">&#x27;mounted&#x27;</span>)  &#125;&#125;</code></pre></div><h3 id="Watcherå¯¹è±¡"><a href="#Watcherå¯¹è±¡" class="headerlink" title="Watcherå¯¹è±¡"></a><code>Watcher</code>å¯¹è±¡</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Watcher</span> </span>&#123;  <span class="hljs-title">constructor</span> (<span class="hljs-params"></span><span class="hljs-params">    vm,</span><span class="hljs-params">    expOrFn,</span><span class="hljs-params">    cb,</span><span class="hljs-params">    options</span><span class="hljs-params">  </span>) &#123;    <span class="hljs-built_in">this</span>.vm = vm;    vm._watchers.push(<span class="hljs-built_in">this</span>);    <span class="hljs-built_in">this</span>.deps = [];    <span class="hljs-built_in">this</span>.newDeps = [];    <span class="hljs-built_in">this</span>.depIds = <span class="hljs-keyword">new</span> _Set();    <span class="hljs-built_in">this</span>.newDepIds = <span class="hljs-keyword">new</span> _Set();    <span class="hljs-comment">// parse expression for getter</span>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> expOrFn === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;â­ï¸ <span class="hljs-comment">// getteræ­¤æ—¶ä¸ºä¼ å…¥çš„updateComponentå‡½æ•°</span>      <span class="hljs-built_in">this</span>.getter = expOrFn;    &#125;  &#125;  get () &#123;â­ï¸  <span class="hljs-comment">//é¦–å…ˆè§¦å‘watcherä¸­çš„getï¼ˆï¼‰</span>    <span class="hljs-comment">// pushTargetæ–¹æ³•</span>    pushTarget(<span class="hljs-built_in">this</span>)    <span class="hljs-keyword">let</span> valueâ­ï¸  <span class="hljs-comment">// è°ƒç”¨getter</span>    value = <span class="hljs-built_in">this</span>.getter.call(vm, vm)    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.deep) &#123;      traverse(value)    &#125;â­ï¸ <span class="hljs-comment">// å½“å‰ç»„ä»¶æ”¶é›†å®Œæˆåæ¸…ç†</span>    popTarget()    <span class="hljs-built_in">this</span>.cleanupDeps()    <span class="hljs-keyword">return</span> value  &#125;  addDep (dep: Dep) &#123;    <span class="hljs-keyword">const</span> id = dep.id    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.newDepIds.has(id)) &#123;      <span class="hljs-built_in">this</span>.newDepIds.add(id)      <span class="hljs-built_in">this</span>.newDeps.push(dep)      <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.depIds.has(id)) &#123;      â­ï¸ <span class="hljs-comment">// æ·»åŠ è®¢é˜…</span>        dep.addSub(<span class="hljs-built_in">this</span>)      &#125;    &#125;  &#125;â­ï¸<span class="hljs-comment">// å¯¹æ¯”æ–°æ—§è®¢é˜…åˆ—è¡¨ï¼Œæ¸…ç©ºä¾èµ–</span>  cleanupDeps () &#123;    <span class="hljs-keyword">let</span> i = <span class="hljs-built_in">this</span>.deps.length    <span class="hljs-keyword">while</span> (i--) &#123;      <span class="hljs-keyword">const</span> dep = <span class="hljs-built_in">this</span>.deps[i]      <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.newDepIds.has(dep.id)) &#123;        <span class="hljs-comment">//æ¸…ç©ºä¾èµ–</span>        dep.removeSub(<span class="hljs-built_in">this</span>)      &#125;    &#125;    <span class="hljs-comment">// æ¯æ¬¡æ›´æ–°é¡µé¢ï¼Œrenderä¾èµ–æ”¶é›†çš„æ—¶å€™</span>    <span class="hljs-comment">// å°†ä¸å±•ç¤ºäºé¡µé¢ä¸Šçš„æ•°æ®çš„ä¾èµ–ç§»é™¤</span>    <span class="hljs-comment">// è€ƒè™‘v-if</span>    [<span class="hljs-built_in">this</span>.depIds,<span class="hljs-built_in">this</span>.newDepIds]=[<span class="hljs-built_in">this</span>.newDepIds,<span class="hljs-built_in">this</span>.depIds]    <span class="hljs-built_in">this</span>.newDepIds.clear()    [<span class="hljs-built_in">this</span>.deps,<span class="hljs-built_in">this</span>.newDeps] = [<span class="hljs-built_in">this</span>.newDeps,<span class="hljs-built_in">this</span>.deps]    <span class="hljs-built_in">this</span>.newDeps.length = <span class="hljs-number">0</span>  &#125;ğŸ”¥  update () &#123;    <span class="hljs-comment">/* istanbul ignore else */</span>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.lazy) &#123;      <span class="hljs-built_in">this</span>.dirty = <span class="hljs-literal">true</span>;    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.sync) &#123;      <span class="hljs-comment">// åŒæ­¥ç«‹å³run</span>      <span class="hljs-built_in">this</span>.run();    &#125; <span class="hljs-keyword">else</span> &#123;ğŸ”¥    queueWatcher(<span class="hljs-built_in">this</span>);    &#125;  &#125;  <span class="hljs-comment">// é€šè¿‡ä¸€ä¸ªé˜Ÿåˆ—queueç®¡ç†éœ€è¦æ›´æ–°çš„watcherï¼Œé‡å¤çš„å°†ä¼šåªæ‰§è¡Œæœ€åä¸€ä¸ª</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">queueWatcher</span> (<span class="hljs-params">watcher</span>) </span>&#123;    <span class="hljs-keyword">var</span> id = watcher.id;    <span class="hljs-keyword">if</span> (has[id] == <span class="hljs-literal">null</span>) &#123;      has[id] = <span class="hljs-literal">true</span>;      <span class="hljs-keyword">if</span> (!flushing) &#123;        queue.push(watcher);      &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-comment">// if already flushing, splice the watcher based on its id</span>        <span class="hljs-comment">// if already past its id, it will be run next immediately.</span>        <span class="hljs-keyword">var</span> i = queue.length - <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (i &gt; index &amp;&amp; queue[i].id &gt; watcher.id) &#123;          i--;        &#125;        queue.splice(i + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, watcher);      &#125;      <span class="hljs-comment">// queue the flush</span>      <span class="hljs-keyword">if</span> (!waiting) &#123;        waiting = <span class="hljs-literal">true</span>;        <span class="hljs-keyword">if</span> (!config.async) &#123;          flushSchedulerQueue();          <span class="hljs-keyword">return</span>        &#125;        <span class="hljs-comment">// åœ¨ä¸‹ä¸€ä¸ªtickæ‰§è¡Œè¿™ä¸ªé˜Ÿåˆ—</span>        nextTick(flushSchedulerQueue);      &#125;    &#125;  &#125;&#125;</code></pre></div><h3 id="Depå¯¹è±¡"><a href="#Depå¯¹è±¡" class="headerlink" title="Depå¯¹è±¡"></a><code>Dep</code>å¯¹è±¡</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dep</span> </span>&#123;  <span class="hljs-keyword">static</span> target: ?Watcher;  id: number;  subs: <span class="hljs-built_in">Array</span>&lt;Watcher&gt;;  <span class="hljs-title">constructor</span> (<span class="hljs-params"></span>) &#123;    <span class="hljs-built_in">this</span>.id = uid++    <span class="hljs-built_in">this</span>.subs = []  &#125; <span class="hljs-comment">// å°†watcheråŠ å…¥subs</span>  addSub (sub: Watcher) &#123;    <span class="hljs-built_in">this</span>.subs.push(sub)  &#125;  removeSub (sub: Watcher) &#123;    remove(<span class="hljs-built_in">this</span>.subs, sub)  &#125;  depend () &#123;    <span class="hljs-keyword">if</span> (Dep.target) &#123;     <span class="hljs-comment">// æ‰§è¡Œå½“å‰watcherä¸­çš„addDepå‡½æ•°</span>      Dep.target.addDep(<span class="hljs-built_in">this</span>)    &#125;  &#125;ğŸ”¥  notify () &#123;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = subs.length; i &lt; l; i++) &#123;      subs[i].update()    &#125;  &#125;&#125;â­ï¸ <span class="hljs-comment">// targetç½®ç©º</span>Dep.target = <span class="hljs-literal">null</span><span class="hljs-keyword">const</span> targetStack = []<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pushTarget</span> (<span class="hljs-params">_target: ?Watcher</span>) </span>&#123;  <span class="hljs-keyword">if</span> (Dep.target) targetStack.push(Dep.target)  â­ï¸ <span class="hljs-comment">// å°†Dep.target æŒ‡å‘å½“å‰watcher</span>  Dep.target = _target&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popTarget</span> (<span class="hljs-params"></span>) </span>&#123;  Dep.target = targetStack.pop()&#125;</code></pre></div><h2 id="â­ï¸-æ”¶é›†ä¾èµ–-â­ï¸"><a href="#â­ï¸-æ”¶é›†ä¾èµ–-â­ï¸" class="headerlink" title="â­ï¸ æ”¶é›†ä¾èµ– â­ï¸"></a>â­ï¸ æ”¶é›†ä¾èµ– â­ï¸</h2><ol><li><p>å®ä¾‹åˆå§‹åŒ–é˜¶æ®µä¸ºæ¯ä¸ªæ ‡è®°ä¸ºå“åº”å¼çš„æ•°æ®ï¼ˆæ‹¥æœ‰ä¸å¯æšä¸¾å±æ€§<code>__ob__</code>ï¼‰è¿›è¡Œå“åº”å¼ç»‘å®šï¼Œç”Ÿæˆå„è‡ªçš„<code>Dep</code>å®ä¾‹ï¼›</p></li><li><p>ç»„ä»¶æ¸²æŸ“å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­å®ä¾‹åŒ–ä¸€ä¸ªæ¸²æŸ“<code>Watcher</code>ï¼Œå¹¶æŒ‡å®šä¸ºæ­¤æ—¶çš„<code>Dep.target</code>ï¼ˆDep çš„ Target æŒ‡å‘ä¸æ˜¯å›ºå®šçš„ï¼Œåœ¨æ¸²æŸ“å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šä¸€ç›´å˜åŒ–æ¥ä¸ºå„ç±»æ•°æ® <code>data</code> <code>prop</code> <code>computed</code> <code>watch</code>ï¼‰åˆ›å»ºç»´æŠ¤ subs æ•°ç»„ï¼›</p></li><li><p>å½“æ¸²æŸ“å‡½æ•°è®¿é—®åˆ°ç»‘å®šäº†å“åº”å¼çš„æ•°æ®æ—¶ï¼Œè§¦å‘æ•°æ®çš„ getterï¼Œå°†å½“å‰ç»„ä»¶æ¸²æŸ“<code>Watcher</code>æ·»åŠ åˆ°è¯¥æ•°æ®æŒæœ‰çš„<code>Dep.subs</code>æ•°ç»„ä¸­ï¼›</p></li><li><p>åŒæ—¶æ¸²æŸ“<code>Watcher</code>è‡ªå·±ä¹Ÿæœ‰ä¸€ä¸ª<code>deps</code>æ•°ç»„ä¿å­˜ï¼Œç”¨æ¥è®°å½•è‡ªå·±è®¢é˜…äº†è°ï¼Œè¿™æ ·åšçš„æ„ä¹‰æ˜¯åœ¨ä¸‹æ¬¡<code>Watcher.update</code>æ—¶å°†ä¸å†æ˜¾ç¤ºé¡µé¢ä¸Šçš„æ•°æ®ç»‘å®šç§»é™¤(å¯¹æ¯”æ–°æ—§<code>deps</code>æ•°ç»„)</p><blockquote><p>å¯ä»¥ç†è§£æˆ data æ•°æ®çš„ subs æ•°ç»„ä¸­æ¯ä¸ª watcher å³ä»£è¡¨ä¸€ä¸ªå—è¯¥æ•°æ®å“åº”å¼å½±å“çš„ç»„ä»¶å®ä¾‹</p></blockquote></li></ol><h2 id="ğŸ”¥-æ´¾å‘æ›´æ–°-ğŸ”¥"><a href="#ğŸ”¥-æ´¾å‘æ›´æ–°-ğŸ”¥" class="headerlink" title="ğŸ”¥ æ´¾å‘æ›´æ–° ğŸ”¥"></a>ğŸ”¥ æ´¾å‘æ›´æ–° ğŸ”¥</h2><ol><li>ä¿®æ”¹æ•°æ®è§¦å‘ setterï¼Œæ‰§è¡Œè¯¥æ•°æ®æŒæœ‰çš„<code>Dep.notify</code>æ–¹æ³•</li><li>éå†å½“å‰æ•°æ®<code>Dep.subs</code>ä¸­çš„æ¯ä¸€ä¸ª<code>Watcher</code>ï¼Œæ‰§è¡Œå…¶<code>Watcher.update()</code></li><li>vue ä¸ä¼šæ¯æ¬¡æ•°æ®æ›´æ–°å°±ç«‹åˆ»å»æ›´æ–°è§†å›¾ï¼Œè€Œæ˜¯ç”¨é˜Ÿåˆ—ç®¡ç†è¿™äº›å›è°ƒä»»åŠ¡<code>queueWatcher</code></li><li>é˜Ÿåˆ—ä¼šåˆ¤æ–­ watcher æ˜¯å¦é‡å¤ï¼Œå¹¶ä¸”è¿›è¡Œæ’åºã€å…ˆçˆ¶åå­ã€‘ã€è‡ªå®šä¹‰ watcher&gt; æ¸²æŸ“ watcherã€‘</li><li>åœ¨ä¸‹ä¸€ä¸ª <code>tick</code> æ‰§è¡Œè¿™ä¸ªé˜Ÿåˆ—çš„å›è°ƒ<code>updateComponent</code>å‡½æ•°ï¼Œ<code>patch</code>å®ä¾‹ï¼ˆdiff å¹¶æ›´æ¢æ–° DOMï¼‰</li></ol><h1 id="nextTick"><a href="#nextTick" class="headerlink" title="nextTick"></a><code>nextTick</code></h1><ul><li>jsäº‹ä»¶å¾ªç¯ï¼Œä¸»çº¿ç¨‹çš„ä¸€è½®å¾ªç¯å°±æ˜¯ä¸€ä¸ª<code>tick</code>ï¼Œåªæœ‰åœ¨æ‰§è¡Œå®Œæ‰€æœ‰åŒæ­¥å‡½æ•°å’Œ<code>macrotask</code>ï¼Œ<code>microtask</code>åæ‰èƒ½è¿›å…¥ä¸‹ä¸€ä¸ª<code>tick</code></li><li>æ´¾å‘æ›´æ–°æ—¶<code>queueWatcher</code>è°ƒç”¨<code>nextTick()</code>æ¥æ‰§è¡Œéœ€è¦æ›´æ–°çš„Watcheré˜Ÿåˆ—</li><li>æ‰‹åŠ¨è°ƒç”¨<code>nextTick</code>çš„å›è°ƒä¹Ÿä¼šåŠ å…¥callbackæ•°ç»„ï¼Œåœ¨ä¸‹ä¸€ä¸ª<code>tick</code>æ‰§è¡Œ<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> callbacks = []<span class="hljs-keyword">let</span> pending = <span class="hljs-literal">false</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flushCallbacks</span> (<span class="hljs-params"></span>) </span>&#123;  pending = <span class="hljs-literal">false</span>  <span class="hljs-keyword">const</span> copies = callbacks.slice(<span class="hljs-number">0</span>)  callbacks.length = <span class="hljs-number">0</span>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; copies.length; i++) &#123;    copies[i]()  &#125;&#125;<span class="hljs-keyword">let</span> microTimerFunc <span class="hljs-comment">// åœ¨ä¸‹ä¸€è½®å¾®ä»»åŠ¡æ‰§è¡Œcbæ•°ç»„</span><span class="hljs-keyword">let</span> macroTimerFunc <span class="hljs-comment">// åœ¨ä¸‹ä¸€è½®å®ä»»åŠ¡æ‰§è¡Œcbæ•°ç»„</span><span class="hljs-keyword">let</span> useMacroTask = <span class="hljs-literal">false</span><span class="hljs-comment">// ä¾æ¬¡å°è¯•ä½¿ç”¨setImmediate,messageChanel,setTimeoutæ¥å®ç°macroTimerFunc</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> setImmediate !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; isNative(setImmediate)) &#123;  macroTimerFunc = <span class="hljs-function">() =&gt;</span> &#123;    setImmediate(flushCallbacks)  &#125;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> MessageChannel !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; (  isNative(MessageChannel) ||  <span class="hljs-comment">// PhantomJS</span>  MessageChannel.toString() === <span class="hljs-string">&#x27;[object MessageChannelConstructor]&#x27;</span>)) &#123;  <span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> MessageChannel()  <span class="hljs-keyword">const</span> port = channel.port2  channel.port1.onmessage = flushCallbacks  macroTimerFunc = <span class="hljs-function">() =&gt;</span> &#123;    port.postMessage(<span class="hljs-number">1</span>)  &#125;&#125; <span class="hljs-keyword">else</span> &#123;  macroTimerFunc = <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-built_in">setTimeout</span>(flushCallbacks, <span class="hljs-number">0</span>)  &#125;&#125;<span class="hljs-comment">//</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Promise</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; isNative(<span class="hljs-built_in">Promise</span>)) &#123;  <span class="hljs-keyword">const</span> p = <span class="hljs-built_in">Promise</span>.resolve()  microTimerFunc = <span class="hljs-function">() =&gt;</span> &#123;    p.then(flushCallbacks)  &#125;&#125; <span class="hljs-keyword">else</span> &#123;  <span class="hljs-comment">// å›é€€åˆ°ä½¿ç”¨macroTimerFunc</span>  microTimerFunc = macroTimerFunc&#125;<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nextTick</span> (<span class="hljs-params">cb?: <span class="hljs-built_in">Function</span>, ctx?: <span class="hljs-built_in">Object</span></span>) </span>&#123;  <span class="hljs-keyword">let</span> _resolve  callbacks.push(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (cb) &#123;      <span class="hljs-keyword">try</span> &#123;        cb.call(ctx)      &#125; <span class="hljs-keyword">catch</span> (e) &#123;        handleError(e, ctx, <span class="hljs-string">&#x27;nextTick&#x27;</span>)      &#125;    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_resolve) &#123;      _resolve(ctx)    &#125;  &#125;)  <span class="hljs-keyword">if</span> (!pending) &#123;    pending = <span class="hljs-literal">true</span>    <span class="hljs-keyword">if</span> (useMacroTask) &#123;      macroTimerFunc()    &#125; <span class="hljs-keyword">else</span> &#123;      microTimerFunc()    &#125;  &#125;  <span class="hljs-comment">// å¦‚æœè°ƒç”¨äº†nextTickä½†æ²¡ä¼ cbï¼Œé»˜è®¤ç»™ä¸€ä¸ªPromise.resolve()æ¥resolve</span>  <span class="hljs-keyword">if</span> (!cb &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Promise</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> &#123;      _resolve = resolve    &#125;)  &#125;&#125;</code></pre></div></li></ul><h1 id="ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå…³ç³»"><a href="#ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå…³ç³»" class="headerlink" title="ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå…³ç³»"></a>ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå…³ç³»</h1><ul><li>  ç»„ä»¶çš„è°ƒç”¨é¡ºåºéƒ½æ˜¯å…ˆçˆ¶åå­,æ¸²æŸ“å®Œæˆçš„é¡ºåºæ˜¯å…ˆå­åçˆ¶ã€‚</li><li>  ç»„ä»¶çš„é”€æ¯æ“ä½œæ˜¯å…ˆçˆ¶åå­ï¼Œé”€æ¯å®Œæˆçš„é¡ºåºæ˜¯å…ˆå­åçˆ¶ã€‚</li></ul><h3 id="åŠ è½½æ¸²æŸ“è¿‡ç¨‹"><a href="#åŠ è½½æ¸²æŸ“è¿‡ç¨‹" class="headerlink" title="åŠ è½½æ¸²æŸ“è¿‡ç¨‹"></a>åŠ è½½æ¸²æŸ“è¿‡ç¨‹</h3><p>çˆ¶ beforeCreate-&gt;çˆ¶ created-&gt;çˆ¶ beforeMount-&gt;å­ beforeCreate-&gt;å­ created-&gt;å­ beforeMount- &gt;å­ mounted-&gt;çˆ¶ mounted</p><h3 id="å­ç»„ä»¶æ›´æ–°è¿‡ç¨‹"><a href="#å­ç»„ä»¶æ›´æ–°è¿‡ç¨‹" class="headerlink" title="å­ç»„ä»¶æ›´æ–°è¿‡ç¨‹"></a>å­ç»„ä»¶æ›´æ–°è¿‡ç¨‹</h3><p>çˆ¶ beforeUpdate-&gt;å­ beforeUpdate-&gt;å­ updated-&gt;çˆ¶ updated</p><h3 id="é”€æ¯è¿‡ç¨‹"><a href="#é”€æ¯è¿‡ç¨‹" class="headerlink" title="é”€æ¯è¿‡ç¨‹"></a>é”€æ¯è¿‡ç¨‹</h3><p>çˆ¶ beforeDestroy-&gt;å­ beforeDestroy-&gt;å­ destroyed-&gt;çˆ¶ destroyed</p><h1 id="è®¡ç®—å±æ€§å’Œä¾¦å¬å±æ€§"><a href="#è®¡ç®—å±æ€§å’Œä¾¦å¬å±æ€§" class="headerlink" title="è®¡ç®—å±æ€§å’Œä¾¦å¬å±æ€§"></a>è®¡ç®—å±æ€§å’Œä¾¦å¬å±æ€§</h1><h2 id="Computed"><a href="#Computed" class="headerlink" title="Computed"></a><code>Computed</code></h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">initComputed (vm: Component, <span class="hljs-attr">computed</span>: <span class="hljs-built_in">Object</span>) &#123;  <span class="hljs-keyword">const</span> watchers = vm._computedWatchers = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>)  <span class="hljs-keyword">const</span> isSSR = isServerRendering()  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> computed) &#123;    <span class="hljs-keyword">const</span> userDef = computed[key]    <span class="hljs-keyword">const</span> getter = <span class="hljs-keyword">typeof</span> userDef === <span class="hljs-string">&#x27;function&#x27;</span> ? userDef : userDef.get    ...â­ï¸<span class="hljs-number">1</span>      watchers[key] = <span class="hljs-keyword">new</span> Watcher(        vm,        getter || noop,        noop,        &#123; <span class="hljs-attr">computed</span>: <span class="hljs-literal">true</span> &#125;      )    <span class="hljs-keyword">if</span> (!(key <span class="hljs-keyword">in</span> vm)) &#123;â­ï¸<span class="hljs-number">2</span>      defineComputed(vm, key, userDef)    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">&#x27;production&#x27;</span>) &#123;      <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> vm.$data) &#123;        <span class="hljs-comment">// ... keyåç§°è¢«dataæˆ–è€…propå ç”¨çš„è­¦å‘Š</span>      &#125;    &#125;  &#125;&#125;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript">createComputedGetter (key) &#123;  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">computedGetter</span> (<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-keyword">const</span> watcher = <span class="hljs-built_in">this</span>._computedWatchers &amp;&amp; <span class="hljs-built_in">this</span>._computedWatchers[key]    <span class="hljs-keyword">if</span> (watcher) &#123;â­ï¸<span class="hljs-number">2</span>      watcher.depend()      <span class="hljs-keyword">return</span> watcher.evaluate()    &#125;  &#125;&#125;</code></pre></div><ol><li>å®ä¾‹ initState é˜¶æ®µéå† Computed å†…çš„ keyï¼Œä¸ºæ¯ä¸ª key åˆ›å»º computed watcher</li><li>åˆ©ç”¨ Object.defineProperty ç»™ key å€¼æ·»åŠ  getter</li><li>æ¸²æŸ“å‡½æ•°è®¿é—®åˆ° computed å†…çš„å±æ€§æ—¶å€™è§¦å‘ getterï¼Œç”Ÿæˆä¸€ä¸ª Dep å®ä¾‹ï¼Œå¹¶ä¸”æ­¤æ—¶ Dep.target æ˜¯æ¸²æŸ“ watcherï¼Œæ¸²æŸ“ watcher å°±è®¢é˜…äº†è¿™ä¸ª key çš„å˜åŒ–</li><li>æ‰§è¡Œè¿™ä¸ª compute key çš„è®¡ç®—é€»è¾‘ï¼Œè®¿é—®ä¾èµ–çš„æ•°æ®ä¼šè§¦å‘å…¶ä¸­å“åº”å¼æ•°æ®çš„ getterï¼Œåˆ™ computed watcher ä¹Ÿå°±è®¢é˜…äº† data çš„å˜åŒ–ï¼Œæœ€åä¹Ÿè¿”å›è®¡ç®—å€¼å¹¶ç¼“å­˜èµ·æ¥</li><li>å½“ä¾èµ–çš„å“åº”å¼æ•°æ®å˜åŒ–æ—¶ï¼Œå“åº”çš„ computed watcher ä¼šæ”¶åˆ°é€šçŸ¥</li><li>computed watcher ä¼šé‡æ–°æ±‚å€¼ï¼Œæ¯”è¾ƒä¸¤æ¬¡è¿ç®—ç»“æœï¼Œç»“æœæ”¹å˜æ—¶æ‰ä¼šé€šçŸ¥æ¸²æŸ“ watcher æ›´æ–°</li></ol><h2 id="Watch"><a href="#Watch" class="headerlink" title="Watch"></a><code>Watch</code></h2><ul><li>  deep</li><li>  immediate</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript">initWatch (vm: Component, <span class="hljs-attr">watch</span>: <span class="hljs-built_in">Object</span>) &#123;  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> watch) &#123;    <span class="hljs-keyword">const</span> handler = watch[key]    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(handler)) &#123;      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; handler.length; i++) &#123;        <span class="hljs-comment">// éå†handlers</span>        createWatcher(vm, key, handler[i])      &#125;    &#125; <span class="hljs-keyword">else</span> &#123;      createWatcher(vm, key, handler)    &#125;  &#125;&#125;</code></pre></div><ol><li>éå† Watch å†…çš„ key</li><li>éå†æ¯ä¸€ä¸ª handlerï¼Œä¸ºæ¯ä¸€ä¸ª handler åˆ›å»º user watcher</li><li>user watcher ä¼šè¢«æ·»åŠ è¿›è®¢é˜…å“åº”æ•°æ®çš„ subs æ•°ç»„å®Œæˆè®¢é˜…</li><li>å“åº”å¼æ•°æ®çš„å˜åŒ–ä¼šé€šçŸ¥åˆ° user watcher</li><li>æ¸²æŸ“å‡½æ•°å¦‚æœè®¿é—®è¿™ä¸ª watch å±æ€§ï¼Œä¹ŸåŒç†ä¼šè¢«æ¨å…¥è¯¥ watch å±æ€§çš„ subs æ•°ç»„,è®¢é˜…å…¶å˜åŒ–</li></ol><h1 id="Vueäº‹ä»¶"><a href="#Vueäº‹ä»¶" class="headerlink" title="Vueäº‹ä»¶"></a>Vueäº‹ä»¶</h1><p>Vue æ”¯æŒ 2 ç§äº‹ä»¶ç±»å‹ï¼ŒåŸç”Ÿ DOM äº‹ä»¶å’Œè‡ªå®šä¹‰äº‹ä»¶ï¼Œå®ƒä»¬ä¸»è¦çš„åŒºåˆ«åœ¨äºæ·»åŠ å’Œåˆ é™¤äº‹ä»¶çš„æ–¹å¼ä¸ä¸€æ ·</p><ul><li>åŸç”Ÿäº‹ä»¶ä½¿ç”¨<code>add/removeEventListener</code>ç›´æ¥æ·»åŠ åˆ°<code>el</code>ä¸Š</li><li>è‡ªå®šä¹‰äº‹ä»¶ä½¿ç”¨ä¸€ä¸ªäº‹ä»¶ä¸­å¿ƒæ¥ç»´æŠ¤</li><li>è‡ªå®šä¹‰äº‹ä»¶çš„æ´¾å‘æ˜¯å¾€å½“å‰å®ä¾‹ä¸Šæ´¾å‘</li><li>åªæœ‰ç»„ä»¶èŠ‚ç‚¹æ‰å¯ä»¥æ·»åŠ è‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶ä¸”æ·»åŠ åŸç”Ÿ DOM äº‹ä»¶éœ€è¦ä½¿ç”¨ <code>.native</code> ä¿®é¥°ç¬¦ï¼›è€Œæ™®é€šå…ƒç´ ä½¿ç”¨ <code>.native</code> ä¿®é¥°ç¬¦æ˜¯æ²¡æœ‰ä½œç”¨çš„ï¼Œä¹Ÿåªèƒ½æ·»åŠ åŸç”Ÿ DOM äº‹ä»¶ã€‚<blockquote><p>vue3ä¸­å·²ç»èˆå¼ƒ.nativeï¼Œå…¨å±€çš„æ‰€æœ‰äº‹ä»¶éƒ½äº¤ç”±vueç®¡ç†</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ç®€åŒ–</span><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">eventsMixin</span> (<span class="hljs-params">Vue</span>) </span>&#123;  Vue.prototype.$on = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event, fn</span>)</span>&#123;    <span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">this</span>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(event)) &#123;      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = event.length; i &lt; l; i++) &#123;        <span class="hljs-built_in">this</span>.$on(event[i], fn)      &#125;    &#125; <span class="hljs-keyword">else</span> &#123;      (vm._events[event] || (vm._events[event] = [])).push(fn)    &#125;    <span class="hljs-keyword">return</span> vm  &#125;  Vue.prototype.$once = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event, fn</span>)</span>&#123;    <span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">this</span>    vm.$on(event, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-comment">/*å‚æ•°*/</span></span>)</span>&#123;      vm.$off(event, on)      fn.apply(vm, <span class="hljs-built_in">arguments</span>)    &#125;)    <span class="hljs-keyword">return</span> vm  &#125;  Vue.prototype.$off = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event, fn</span>)</span>&#123;    <span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">this</span>    <span class="hljs-comment">// all</span>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">arguments</span>.length) &#123;      vm._events = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>)      <span class="hljs-keyword">return</span> vm    &#125;    <span class="hljs-comment">// array of events</span>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(event)) &#123;      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = event.length; i &lt; l; i++) &#123;        <span class="hljs-built_in">this</span>.$off(event[i], fn)      &#125;      <span class="hljs-keyword">return</span> vm    &#125;    <span class="hljs-comment">// specific event</span>    <span class="hljs-keyword">const</span> cbs = vm._events[event]    <span class="hljs-keyword">if</span> (!cbs) &#123;      <span class="hljs-keyword">return</span> vm    &#125;    <span class="hljs-keyword">if</span> (!fn) &#123;      vm._events[event] = <span class="hljs-literal">null</span>      <span class="hljs-keyword">return</span> vm    &#125;    <span class="hljs-keyword">if</span> (fn) &#123;      <span class="hljs-comment">// specific handler</span>      <span class="hljs-keyword">let</span> cb      <span class="hljs-keyword">let</span> i = cbs.length      <span class="hljs-keyword">while</span> (i--) &#123;        cb = cbs[i]        <span class="hljs-keyword">if</span> (cb === fn || cb.fn === fn) &#123;          cbs.splice(i, <span class="hljs-number">1</span>)          <span class="hljs-keyword">break</span>        &#125;      &#125;    &#125;    <span class="hljs-keyword">return</span> vm  &#125;  Vue.prototype.$emit = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event,...args</span>)</span>&#123;    <span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">this</span>    <span class="hljs-keyword">let</span> cbs = vm._events[event]    <span class="hljs-keyword">if</span> (cbs) &#123;      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = cbs.length; i &lt; l; i++) &#123;        <span class="hljs-keyword">try</span> &#123;          cbs[i].apply(vm, args)        &#125; <span class="hljs-keyword">catch</span> (e) &#123;          <span class="hljs-comment">// handle Error</span>        &#125;      &#125;    &#125;    <span class="hljs-keyword">return</span> vm  &#125;&#125;</code></pre></div></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>vue</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>æºç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>axioså’Œfetch</title>
    <link href="/2022/02/24/axios%E5%92%8Cfetch/"/>
    <url>/2022/02/24/axios%E5%92%8Cfetch/</url>
    
    <content type="html"><![CDATA[<h1 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h1><blockquote><p>åŸºäºXHRçš„Promiseå°è£…</p></blockquote><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ol><li>PromiseAPI</li><li>å®¢æˆ·ç«¯é˜²æ­¢<code>CSRF</code></li><li>æä¾›å¹¶å‘è¯·æ±‚çš„æ¥å£</li><li>ä»nodeåˆ›å»ºhttpè¯·æ±‚</li><li>æ‹¦æˆªå™¨</li><li>å–æ¶ˆè¯·æ±‚abort</li></ol><h2 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h2><ul><li><p>æ·»åŠ æ‹¦æˆªå™¨</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">axios.interceptors.request.use(  (config) =&gt; &#123;    &lt;!-- åŠ å…¥å‚æ•° --&gt;    config.params = &#123;<span class="hljs-attr">a</span>:<span class="hljs-number">666</span>&#125;    <span class="hljs-keyword">return</span> config  &#125;,  (err) =&gt; &#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject(err)  &#125;);</code></pre></div></li><li><p>æ‰§è¡Œé¡ºåº</p><ul><li>è¯·æ±‚æ‹¦æˆªå™¨ åé¢çš„æ‹¦æˆªå™¨å…ˆæ‰§è¡Œ</li><li>å“åº”æ‹¦æˆªå™¨ å‰é¢çš„æ‹¦æˆªå™¨å…ˆæ‰§è¡Œ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript">axios.interceptors.request.use(<span class="hljs-function"><span class="hljs-params">config</span>=&gt;</span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;request1&#x27;</span>)&#125;,<span class="hljs-function"><span class="hljs-params">err</span>=&gt;</span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;err1&#x27;</span>)&#125;)axios.interceptors.request.use(<span class="hljs-function"><span class="hljs-params">config</span>=&gt;</span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;request2&#x27;</span>)&#125;,<span class="hljs-function"><span class="hljs-params">err</span>=&gt;</span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;err2&#x27;</span>)&#125;)axios.interceptors.response.use(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;response1&#x27;</span>)&#125;ï¼Œerr=&gt;&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;resErr1&#x27;</span>)&#125;)axios.interceptors.response.use(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;response2&#x27;</span>)&#125;ï¼Œerr=&gt;&#123;  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;resErr2&#x27;</span>)&#125;)&lt;!-- <span class="hljs-built_in">console</span> --&gt;request2request1response1response2</code></pre></div></li></ul><h2 id="å–æ¶ˆè¯·æ±‚"><a href="#å–æ¶ˆè¯·æ±‚" class="headerlink" title="å–æ¶ˆè¯·æ±‚"></a>å–æ¶ˆè¯·æ±‚</h2>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> CancelToken = axios.CancelToken;<span class="hljs-keyword">let</span> cancel = <span class="hljs-literal">null</span>btn.onclick = <span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">if</span>(cancel !== <span class="hljs-literal">null</span>) cancel()  &lt;!-- æ‰§è¡Œå–æ¶ˆå‡½æ•° --&gt;  axios(&#123;    method:<span class="hljs-string">&#x27;GET&#x27;</span>,    url:<span class="hljs-string">&#x27;http://xxxxxxx&#x27;</span>,    &lt;!--  --&gt;    cancelToken : <span class="hljs-keyword">new</span> CancelToken(<span class="hljs-function"><span class="hljs-params">c</span>=&gt;</span>&#123;      cancel = c      &lt;!-- cancelToken --&gt;    &#125;)  &#125;)&#125;.then(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>&#123;  cancel = <span class="hljs-literal">null</span>&#125;)</code></pre></div><h1 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h1><blockquote><p>åŸç”Ÿapi</p></blockquote><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ol><li>åªé’ˆå¯¹ç½‘ç»œè¯·æ±‚æŠ¥é”™(è¯·æ±‚ä¸èƒ½å®Œæˆ)</li><li>æºå¸¦cookieè¦æ·»åŠ é…ç½®</li><li>ä¸æ”¯æŒå–æ¶ˆè¯·æ±‚abort</li><li>æ— æ³•æ£€æµ‹è¯·æ±‚è¿›åº¦</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSSé¢è¯•é¢˜</title>
    <link href="/2022/02/24/css%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/2022/02/24/css%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="CSSé€‰æ‹©å™¨"><a href="#CSSé€‰æ‹©å™¨" class="headerlink" title="CSSé€‰æ‹©å™¨"></a>CSSé€‰æ‹©å™¨</h2><ul><li><p><code>*</code>ã€0ã€‘</p></li><li><p>ç±»é€‰æ‹©å™¨<code>class</code>ã€10ã€‘</p></li><li><p><code>id</code>é€‰æ‹©å™¨ã€100ã€‘</p></li><li><p>æ ‡ç­¾é€‰æ‹©å™¨<code>tag</code>ã€1ã€‘</p></li><li><p>ç»„åˆ</p>  <div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">a</span>,<span class="hljs-selector-tag">b</span>&#123;<span class="hljs-selector-tag">a</span> or <span class="hljs-selector-tag">b</span>&#125; <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">b</span>&#123;<span class="hljs-selector-tag">b</span>æ˜¯<span class="hljs-selector-tag">a</span>çš„åä»£èŠ‚ç‚¹&#125;<span class="hljs-selector-tag">a</span>+<span class="hljs-selector-tag">b</span>&#123;<span class="hljs-selector-tag">b</span>æ˜¯<span class="hljs-selector-tag">a</span>çš„å…„å¼Ÿä¸‹ä¸€ä¸ªèŠ‚ç‚¹&#125;<span class="hljs-selector-tag">a</span>&gt;<span class="hljs-selector-tag">b</span>&#123;<span class="hljs-selector-tag">b</span>æ˜¯<span class="hljs-selector-tag">a</span>çš„ç›´æ¥å­èŠ‚ç‚¹&#125;<span class="hljs-selector-tag">a</span>~<span class="hljs-selector-tag">b</span>&#123;<span class="hljs-selector-tag">b</span>æ˜¯<span class="hljs-selector-tag">a</span>ä¹‹åçš„ä»»æ„å…„å¼ŸèŠ‚ç‚¹&#125;</code></pre></div></li><li><p>å±æ€§é€‰æ‹©å™¨ï¼Œå­ä¸²å€¼é€‰æ‹©å™¨</p>  <div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">div</span><span class="hljs-selector-attr">[key]</span> // æœ‰å±æ€§key<span class="hljs-selector-tag">div</span><span class="hljs-selector-attr">[key=val]</span> // å±æ€§keyå€¼ä¸ºval<span class="hljs-selector-tag">div</span><span class="hljs-selector-attr">[key~=val]</span> // keyçš„å€¼åŒ…å«val<span class="hljs-selector-tag">div</span><span class="hljs-selector-attr">[key|=val]</span>  // keyçš„å€¼<span class="hljs-selector-tag">div</span><span class="hljs-selector-attr">[key^=val]</span> // keyçš„å€¼ä»¥valå¼€å¤´<span class="hljs-selector-tag">div</span><span class="hljs-selector-attr">[key$=val]</span>// keyçš„å€¼ä»¥valç»“å°¾<span class="hljs-selector-tag">div</span><span class="hljs-selector-attr">[key*=val]</span>// keyçš„å€¼åŒ…å«val</code></pre></div></li><li><p>ä¼ªç±»</p><p>  æœŸæœ›å…ƒç´ åœ¨ç‰¹å®šæƒ…å†µä¸‹å‘ˆç°ä¸åŒæ ·å¼ï¼Œå¦‚é¼ æ ‡æ»‘è¿‡<code>hover</code>ï¼Œé€‰ä¸­<code>checked</code>ï¼Œæ¿€æ´»çŠ¶æ€<code>active</code>ç­‰ã€‚ä¼ªç±»å¼€å¤´ä¸ºå•å†’å·<code>:</code>ã€‚</p></li><li><p>ä¼ªå…ƒç´ </p><p>  ä¼ªå…ƒç´ ä»¥ç±»ä¼¼æ–¹å¼è¡¨ç°ï¼Œä¸è¿‡è¡¨ç°å¾—æ˜¯åƒä½ å¾€æ ‡è®°æ–‡æœ¬ä¸­åŠ å…¥å…¨æ–°çš„HTMLå…ƒç´ ä¸€æ ·ï¼Œè€Œä¸æ˜¯å‘ç°æœ‰çš„å…ƒç´ ä¸Šåº”ç”¨ç±»ï¼Œå¸¸è§çš„åƒ<code>after``before</code>ã€‚ä¼ªå…ƒç´ å¼€å¤´ä¸ºåŒå†’å·<code>::</code>ã€‚</p></li></ul><h2 id="CSS3-æ–°ç‰¹æ€§"><a href="#CSS3-æ–°ç‰¹æ€§" class="headerlink" title="CSS3 æ–°ç‰¹æ€§"></a>CSS3 æ–°ç‰¹æ€§</h2><ul><li>  è¾¹æ¡†å±æ€§<code>border-radius</code>ï¼Œ<code>box-shadow</code>ï¼Œ<code>border-image</code></li><li>  èƒŒæ™¯æ§åˆ¶<code>background-size,background-origin</code></li><li>  æ–‡å­—æ•ˆæœå’Œè‡ªåŠ¨æ¢è¡Œ<code>text-shadow,word-wrap</code></li><li>  è‡ªå®šä¹‰å­—ä½“<code>@font-face</code></li><li>  2d/3d å˜æ¢ï¼Œè¿‡æ¸¡å’ŒåŠ¨ç”»<code>transition``animation</code></li><li>  CSS å¤šåˆ—å¸ƒå±€<code>CSS Multi-column Layout</code></li><li>  ç›’æ¨¡å‹å±æ€§<code>box-sizing</code></li><li>  å¼¹æ€§ç›’å­<code>flex</code></li><li>  æ›´å¼ºå¤§çš„å¤šåª’ä½“æŸ¥è¯¢</li></ul><h2 id="å±‚å ä¸Šä¸‹æ–‡"><a href="#å±‚å ä¸Šä¸‹æ–‡" class="headerlink" title="å±‚å ä¸Šä¸‹æ–‡"></a>å±‚å ä¸Šä¸‹æ–‡</h2><p>æˆ‘ä»¬å‡å®šç”¨æˆ·æ­£é¢å‘ï¼ˆæµè§ˆå™¨ï¼‰è§†çª—æˆ–ç½‘é¡µï¼Œè€Œ HTML å…ƒç´ æ²¿ç€å…¶ç›¸å¯¹äºç”¨æˆ·çš„ä¸€æ¡è™šæ„çš„ z è½´æ’å¼€ï¼Œå±‚å ä¸Šä¸‹æ–‡å°±æ˜¯å¯¹è¿™äº› HTML å…ƒç´ çš„ä¸€ä¸ªä¸‰ç»´æ„æƒ³ã€‚</p><p>æ–‡æ¡£ä¸­çš„å±‚å ä¸Šä¸‹æ–‡ç”±æ»¡è¶³ä»¥ä¸‹ä»»æ„ä¸€ä¸ªæ¡ä»¶çš„å…ƒç´ å½¢æˆï¼š</p><ul><li>æ ¹å…ƒç´ <code>&lt;html&gt;</code>ï¼›</li><li><code>position</code> å€¼ä¸º <code>absolute</code>ï¼ˆç»å¯¹å®šä½ï¼‰æˆ–  <code>relative</code>ï¼ˆç›¸å¯¹å®šä½ï¼‰ä¸” <code>z-index</code> å€¼ä¸ä¸º <code>auto</code> çš„å…ƒç´ ï¼›</li><li><code>position</code> å€¼ä¸º <code>fixed</code>ï¼ˆå›ºå®šå®šä½ï¼‰æˆ– <code>sticky</code>ï¼ˆç²˜æ»å®šä½ï¼‰çš„å…ƒç´ </li><li><code>flex</code> å®¹å™¨çš„å­å…ƒç´ ï¼Œä¸” <code>z-index</code> å€¼ä¸ä¸º <code>auto</code>ï¼›</li><li><code>grid</code> å®¹å™¨çš„å­å…ƒç´ ï¼Œä¸” <code>z-index</code> å€¼ä¸ä¸º <code>auto</code>ï¼›</li><li><code>opacity</code> å±æ€§å€¼å°äº1ï¼›</li><li>ä»¥ä¸‹ä»»æ„å±æ€§å€¼ä¸ä¸º none çš„å…ƒç´ ï¼š<ul><li><code>transform</code></li><li><code>filter</code></li><li><code>perspective</code></li><li><code>clip-path</code><ul><li><code>mask / mask-image / mask-border</code></li><li><code>isolation</code> å±æ€§å€¼ä¸º <code>isolate</code> çš„å…ƒç´ ï¼›</li><li><code>-webkit-overflow-scrolling</code> å±æ€§å€¼ä¸º <code>touch</code> çš„å…ƒç´ ï¼›</li><li><code>will-change</code> å€¼è®¾å®šäº†ä»»ä¸€å±æ€§</li></ul></li></ul></li></ul><blockquote><p>å±‚å æ°´å¹³ä¸èƒ½è·¨çº§åˆ«æ¯”è¾ƒï¼Œåªèƒ½åœ¨åŒä¸€ä¸Šä¸‹æ–‡ä¸­æ‰æœ‰æ„ä¹‰</p></blockquote><blockquote><p>æ²¡æœ‰åˆ›å»ºå±‚å ä¸Šä¸‹æ–‡çš„å…ƒç´ å…¶å±‚å æ°´å¹³åˆçˆ¶çº§å±‚å ä¸Šä¸‹æ–‡å†³å®š</p></blockquote><h2 id="æµè§ˆå™¨å…¼å®¹"><a href="#æµè§ˆå™¨å…¼å®¹" class="headerlink" title="æµè§ˆå™¨å…¼å®¹"></a>æµè§ˆå™¨å…¼å®¹</h2><ul><li><p>IE</p><ul><li>åŒè¾¹è·<ul><li>  <code>display:inline</code></li></ul></li><li>é»˜è®¤é«˜åº¦<code>16px</code><ul><li>  <code>font-size:0</code></li><li>  <code>overflow:hidden</code></li></ul></li><li>è¶…é“¾æ¥å†… img ä¼šæœ‰è¾¹æ¡†<ul><li>  <code>border:0</code></li></ul></li></ul></li><li><p>3px bug</p><ul><li>  <code>display:block</code></li><li>  <code>vertical-align:top</code></li></ul></li></ul><h2 id="position-è·Ÿ-displayã€margin-collapseã€overflowã€float-è¿™äº›ç‰¹æ€§ç›¸äº’å åŠ åä¼šæ€æ ·"><a href="#position-è·Ÿ-displayã€margin-collapseã€overflowã€float-è¿™äº›ç‰¹æ€§ç›¸äº’å åŠ åä¼šæ€æ ·" class="headerlink" title="position è·Ÿ displayã€margin collapseã€overflowã€float è¿™äº›ç‰¹æ€§ç›¸äº’å åŠ åä¼šæ€æ ·"></a>position è·Ÿ displayã€margin collapseã€overflowã€float è¿™äº›ç‰¹æ€§ç›¸äº’å åŠ åä¼šæ€æ ·</h2><ul><li>  å¦‚æœå…ƒç´ çš„ display ä¸º noneï¼Œé‚£ä¹ˆå…ƒç´ ä¸è¢«æ¸²æŸ“ï¼Œpositionï¼Œfloat ä¸èµ·ä½œç”¨ï¼›</li><li>  å¦‚æœå…ƒç´ æ‹¥æœ‰ position:absolute;æˆ– position:fixed;å±æ€§ï¼Œé‚£ä¹ˆå…ƒç´ å°†ä¸ºç»å¯¹å®šä½ï¼Œfloat ä¸èµ·ä½œç”¨ã€‚</li><li>  å¦‚æœå…ƒç´  float å±æ€§ä¸æ˜¯ noneï¼Œå…ƒç´ ä¼šè„±ç¦»æ–‡æ¡£æµï¼Œæ ¹æ® float å±æ€§å€¼æ¥æ˜¾ç¤ºã€‚</li><li>  æœ‰æµ®åŠ¨ã€ç»å¯¹å®šä½ï¼Œinline-block å±æ€§çš„å…ƒç´ ï¼Œmargin ä¸ä¼šå’Œå‚ç›´æ–¹å‘ä¸Šçš„å…¶ä»–å…ƒç´  margin æŠ˜å ã€‚</li></ul><h2 id="ç”»ä¸‰è§’å½¢"><a href="#ç”»ä¸‰è§’å½¢" class="headerlink" title="ç”»ä¸‰è§’å½¢"></a>ç”»ä¸‰è§’å½¢</h2><ul><li>  ä¸åŒè¾¹ border ä¹‹é—´ 45 åº¦æ‹¼æ¥</li></ul><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-selector-tag">div</span>&#123;  <span class="hljs-attribute">width</span>:<span class="hljs-number">0</span>;  <span class="hljs-attribute">height</span>:<span class="hljs-number">0</span>;  <span class="hljs-attribute">border-top</span>:<span class="hljs-number">50px</span> red solid;  <span class="hljs-attribute">border-left</span>:<span class="hljs-number">50px</span> $(èƒŒæ™¯è‰²) solid;  <span class="hljs-attribute">border-right</span>: <span class="hljs-number">50px</span> $(èƒŒæ™¯è‰²) solid;&#125;</code></pre></div><h2 id="ç”»æ¤­åœ†"><a href="#ç”»æ¤­åœ†" class="headerlink" title="ç”»æ¤­åœ†"></a>ç”»æ¤­åœ†</h2><p><code>border-radiuså±æ€§</code></p><ul><li>border-radius æ˜¯ç®€å†™å±æ€§<ul><li>  border-top-left-radius</li><li>  border-top-right-radius</li><li>  border-bottom-right-radius</li><li>  border-bottom-left-radius</li><li>  top å·¦å³ï¼Œbottom å³å·¦ï¼Œé¡ºæ—¶é’ˆé¡ºåº</li><li>  â€œ/â€œ ç”¨æ¥åˆ†éš”æ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘</li></ul></li></ul><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-comment">/* ç»˜åˆ¶åŠæ¤­åœ† */</span><span class="hljs-selector-tag">div</span>&#123; <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">border-style</span>: solid; <span class="hljs-attribute">border-color</span>: <span class="hljs-number">#f00</span>; <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>/<span class="hljs-number">100%</span> <span class="hljs-number">100%</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>ï¼› /* æ°´å¹³æ–¹å‘ä¸Šå››ä¸ªè§’çš„åŠå¾„éƒ½ä¸º<span class="hljs-number">50%</span> /  å‚ç›´æ–¹å‘ å·¦å³ä¸ŠåŠå¾„ä¸º<span class="hljs-number">100%</span>ï¼Œå·¦å³ä¸‹ä¸º<span class="hljs-number">0</span>*/&#125;</code></pre></div><h2 id="æ–‡æœ¬æ§åˆ¶"><a href="#æ–‡æœ¬æ§åˆ¶" class="headerlink" title="æ–‡æœ¬æ§åˆ¶"></a>æ–‡æœ¬æ§åˆ¶</h2><ul><li>  å•è¡Œæ–‡æœ¬å±…ä¸­ï¼Œå¤šè¡Œæ–‡æœ¬å·¦å¯¹é½</li></ul><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-selector-tag">div</span>&#123;  <span class="hljs-attribute">text-align</span>:center&#125;<span class="hljs-selector-tag">p</span>&#123;  <span class="hljs-attribute">display</span>:inline-block;  <span class="hljs-attribute">text-align</span><span class="hljs-selector-pseudo">:left</span>&#125;</code></pre></div><ul><li>  å¤šè¡Œæ–‡æœ¬çœç•¥å·</li></ul><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-selector-tag">p</span>:after&#123;  content:<span class="hljs-string">&#x27;...&#x27;</span>&#125;</code></pre></div><ul><li>  å•è¡Œæ–‡æœ¬æº¢å‡ºçœç•¥</li></ul><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-attribute">overflow</span>: hiddenï¼›/* ï¼ˆæ–‡å­—é•¿åº¦è¶…å‡ºé™å®šå®½åº¦ï¼Œåˆ™éšè—è¶…å‡ºçš„å†…å®¹ï¼‰ */white-space: nowrapï¼›/* ï¼ˆè®¾ç½®æ–‡å­—åœ¨ä¸€è¡Œæ˜¾ç¤ºï¼Œä¸èƒ½æ¢è¡Œï¼‰ */text-overflow: ellipsisï¼›/* ï¼ˆè§„å®šå½“æ–‡æœ¬æº¢å‡ºæ—¶ï¼Œæ˜¾ç¤ºçœç•¥ç¬¦å·æ¥ä»£è¡¨è¢«ä¿®å‰ªçš„æ–‡æœ¬ï¼‰ */</code></pre></div><ul><li>  å¤šè¡Œæ–‡æœ¬æº¢å‡º</li></ul><div class="hljs code-wrapper"><pre><code class="hljs CSS">-webkit-line-clamp: <span class="hljs-number">2</span>ï¼›/* ï¼ˆç”¨æ¥é™åˆ¶åœ¨ä¸€ä¸ªå—å…ƒç´ æ˜¾ç¤ºçš„æ–‡æœ¬çš„è¡Œæ•°ï¼Œ<span class="hljs-number">2</span> è¡¨ç¤ºæœ€å¤šæ˜¾ç¤º <span class="hljs-number">2</span> è¡Œã€‚ä¸ºäº†å®ç°è¯¥æ•ˆæœï¼Œå®ƒéœ€è¦ç»„åˆå…¶ä»–çš„ WebKit å±æ€§ï¼‰ */display: -webkit-boxï¼›/* ï¼ˆå’Œ <span class="hljs-number">1</span> ç»“åˆä½¿ç”¨ï¼Œå°†å¯¹è±¡ä½œä¸ºå¼¹æ€§ä¼¸ç¼©ç›’å­æ¨¡å‹æ˜¾ç¤º ï¼‰ */-webkit-box-orient: verticalï¼›/* ï¼ˆå’Œ <span class="hljs-number">1</span> ç»“åˆä½¿ç”¨ ï¼Œè®¾ç½®æˆ–æ£€ç´¢ä¼¸ç¼©ç›’å¯¹è±¡çš„å­å…ƒç´ çš„æ’åˆ—æ–¹å¼ ï¼‰ */overflow: hiddenï¼›/* ï¼ˆæ–‡æœ¬æº¢å‡ºé™å®šçš„å®½åº¦å°±éšè—å†…å®¹ï¼‰ */text-overflow: ellipsisï¼›/* ï¼ˆå¤šè¡Œæ–‡æœ¬çš„æƒ…å†µä¸‹ï¼Œç”¨çœç•¥å· â€œâ€¦â€ éšè—æº¢å‡ºèŒƒå›´çš„æ–‡æœ¬) */</code></pre></div><h2 id="dpr-1px-è¾¹æ¡†"><a href="#dpr-1px-è¾¹æ¡†" class="headerlink" title="dpr 1px è¾¹æ¡†"></a>dpr 1px è¾¹æ¡†</h2><ul><li>  ä¼ªå…ƒç´ é…åˆåª’ä½“æŸ¥è¯¢<code>transform:scale()</code></li></ul><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-selector-class">.onePx_border</span>:after&#123;    /* æ•´ä¸ªdivè¾¹æ¡† */    content: <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-attribute">position</span>: absolute;    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;    <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#cccccc</span>;    <span class="hljs-comment">/* æ³¨æ„å®½é«˜å’Œåœ†è§’å•ä½éƒ½è¦é…åˆåª’ä½“æŸ¥è¯¢ */</span>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">26px</span>;ï¼Ÿï¼Ÿï¼Ÿ    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>/<span class="hljs-number">200%</span>/<span class="hljs-number">333%</span>    height: <span class="hljs-number">100%</span>/<span class="hljs-number">200%</span>/<span class="hljs-number">333%</span>    /* å•ç‹¬ä¸€è¾¹çš„è¾¹æ¡† */    content: <span class="hljs-string">&#x27;&#x27;</span>;    <span class="hljs-attribute">position</span>: absolute;    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;    <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;    <span class="hljs-attribute">background</span>: <span class="hljs-number">#cccccc</span>;    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;    <span class="hljs-attribute">height</span>: <span class="hljs-number">1px</span>;&#125;<span class="hljs-keyword">@media</span> <span class="hljs-keyword">only</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">-webkit-min-device-pixel-ratio</span>: <span class="hljs-number">2</span>) &#123;  <span class="hljs-selector-class">.onePx_border</span>:after &#123;    -webkit-transform: <span class="hljs-built_in">scaleY</span>(<span class="hljs-number">0.5</span>);    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scaleY</span>(<span class="hljs-number">0.5</span>);    -webkit-<span class="hljs-attribute">transform-origin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;    <span class="hljs-attribute">transform-origin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;  &#125;<span class="hljs-keyword">@media</span> <span class="hljs-keyword">only</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">-webkit-min-device-pixel-ratio</span>: <span class="hljs-number">3</span>) &#123;  <span class="hljs-selector-class">.onePx_border</span>:after &#123;    -webkit-transform: <span class="hljs-built_in">scaleY</span>(<span class="hljs-number">0.3</span>);    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scaleY</span>(<span class="hljs-number">0.3</span>);    -webkit-<span class="hljs-attribute">transform-origin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;    <span class="hljs-attribute">transform-origin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;  &#125;&#125;</code></pre></div><ul><li><p>rem + viewport</p><ol><li>æ•´ä½“ç¼©æ”¾ px å•ä½</li></ol>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;script&gt;  (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-comment">// scale</span>    <span class="hljs-keyword">var</span> clientWidth = <span class="hljs-built_in">window</span>.screen.width;    <span class="hljs-keyword">var</span> dpr = <span class="hljs-built_in">window</span>.devicePixelRatio;    <span class="hljs-keyword">var</span> vp = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;meta&#x27;</span>);    vp.name = <span class="hljs-string">&#x27;viewport&#x27;</span>;    vp.content = <span class="hljs-string">`initial-scale=<span class="hljs-subst">$&#123;<span class="hljs-number">1.0</span> * <span class="hljs-number">1</span> <span class="hljs-regexp">/ dpr&#125;, maximum-scale=$&#123;1.0 * 1 /</span> dpr&#125;</span>, minimum-scale=<span class="hljs-subst">$&#123;<span class="hljs-number">1.0</span> * <span class="hljs-number">1</span> / dpr&#125;</span>, user-scalable=no, width=device-width`</span>;    <span class="hljs-keyword">var</span> m = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">&#x27;meta&#x27;</span>)[<span class="hljs-number">0</span>];    m.parentNode.insertBefore(vp, m);    <span class="hljs-comment">// rem</span>    <span class="hljs-built_in">document</span>.documentElement.style.fontSize = ?  &#125;)();&lt;/script&gt;</code></pre></div><ol start="2"><li>å…¶ä»–å…ƒç´ ä½¿ç”¨ rem å•ä½</li></ol></li></ul><h2 id="å‚ç›´å±…ä¸­-div"><a href="#å‚ç›´å±…ä¸­-div" class="headerlink" title="å‚ç›´å±…ä¸­ div"></a>å‚ç›´å±…ä¸­ div</h2><ul><li>  ç»å¯¹å®šä½+ä¸Šä¸‹å·¦å³ 0+ margin:auto</li><li>  ç»å¯¹å®šä½+ä¸Š50%å·¦50%+è´Ÿ<code>margin</code>è‡ªèº«å®½é«˜ä¸€åŠ</li><li>  ç»å¯¹å®šä½+ä¸Š50%å·¦50%+è´Ÿ<code>translate</code>è‡ªå·±å®½é«˜ä¸€åŠ</li><li>  <code>flex</code>+<code>justify-content</code>+<code>align-items</code></li><li>  <code>table-cell</code>+<code>vertical-align:middle</code></li></ul><h2 id="ä¸‰æ å¸ƒå±€-å·¦å³å›ºå®šä¸­é—´è‡ªé€‚åº”"><a href="#ä¸‰æ å¸ƒå±€-å·¦å³å›ºå®šä¸­é—´è‡ªé€‚åº”" class="headerlink" title="ä¸‰æ å¸ƒå±€(å·¦å³å›ºå®šä¸­é—´è‡ªé€‚åº”)"></a>ä¸‰æ å¸ƒå±€(å·¦å³å›ºå®šä¸­é—´è‡ªé€‚åº”)</h2><ol><li><p>ç»å¯¹å®šä½</p></li><li><p>å·¦å³æµ®åŠ¨ã€è‡ªé€‚åº”å…ƒç´ è¦æ”¾åœ¨æœ€åã€‘</p> <div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>* &#123;<span class="css"><span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span><span class="css"><span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;</span>&#125;<span class="css"><span class="hljs-selector-tag">body</span> &#123;</span><span class="css"><span class="hljs-attribute">min-width</span>: <span class="hljs-number">550px</span>;</span>&#125;.container &#123;<span class="css"><span class="hljs-attribute">overflow</span>: hidden;</span>&#125;.column &#123;<span class="css"><span class="hljs-attribute">min-height</span>: <span class="hljs-number">100px</span>;</span>&#125;.left &#123;<span class="css"><span class="hljs-attribute">float</span>: left;</span><span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;</span><span class="css"><span class="hljs-attribute">background</span>: <span class="hljs-number">#ffbbff</span>;</span>&#125;.center &#123;<span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;</span><span class="css"><span class="hljs-attribute">background</span>: <span class="hljs-number">#bfefff</span>;</span>&#125;.right &#123;<span class="css"><span class="hljs-attribute">float</span>: right;</span><span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;</span><span class="css"><span class="hljs-attribute">background</span>: <span class="hljs-number">#eeee00</span>;</span>&#125;/*å·¦å³æµ®åŠ¨è‡³å·¦å³å¹¶å¤„äºåŒä¸€è¡Œ          *æœªæµ®åŠ¨çš„centerå†…å®¹ä¼šè¢«æµ®åŠ¨å…ƒç´ ç¯ç»•          */<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column left&quot;</span>&gt;</span>left<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column right&quot;</span>&gt;</span>right<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column center&quot;</span>&gt;</span>center<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div></li><li><p>å…¨éƒ¨å·¦æµ®ï¼Œ-margin ç§»åˆ°ä¸Šä¸€è¡Œã€è‡ªé€‚åº”å…ƒç´ æ”¾åœ¨æœ€å‰ã€‘</p> <div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>* &#123;<span class="css"><span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span><span class="css"><span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;</span>&#125;<span class="css"><span class="hljs-selector-tag">body</span> &#123;</span><span class="css"><span class="hljs-attribute">min-width</span>: <span class="hljs-number">550px</span>;</span>&#125;.container &#123;<span class="css"><span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">150px</span> <span class="hljs-number">0</span> <span class="hljs-number">200px</span>;</span><span class="css"><span class="hljs-attribute">overflow</span>: hidden;</span>&#125;.column &#123;<span class="css"><span class="hljs-attribute">position</span>: relative;</span>/**<span class="css">        *è®¾ç½®å®šä½ï¼Œå…ƒç´ éœ€è¦æ‰‹åŠ¨ç§»åŠ¨è‡³<span class="hljs-attribute">padding</span>ç©ºéš™ä¸­</span>        */<span class="css"><span class="hljs-attribute">float</span>: left;</span><span class="css"><span class="hljs-attribute">min-height</span>: <span class="hljs-number">100px</span>;</span>&#125;.left &#123;<span class="css"><span class="hljs-attribute">right</span>: <span class="hljs-number">200px</span>;</span><span class="css"><span class="hljs-attribute">margin-left</span>: -<span class="hljs-number">100%</span>;</span><span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;</span><span class="css"><span class="hljs-attribute">background</span>: <span class="hljs-number">#ffbbff</span>;</span>&#125;.center &#123;<span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;</span><span class="css"><span class="hljs-attribute">background</span>: <span class="hljs-number">#bfefff</span>;</span>&#125;.right &#123;<span class="css"><span class="hljs-attribute">left</span>: <span class="hljs-number">150px</span>;</span><span class="css"><span class="hljs-attribute">margin-left</span>: -<span class="hljs-number">150px</span>;</span><span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;</span><span class="css"><span class="hljs-attribute">background</span>: <span class="hljs-number">#eeee00</span>;</span>&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column center&quot;</span>&gt;</span>center<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column left&quot;</span>&gt;</span>left<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column right&quot;</span>&gt;</span>right<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div></li><li><p>å…¨éƒ¨å·¦æµ®ï¼Œcenter å…ƒç´ éœ€è¦æ’‘å¼€ center-wrapperã€è‡ªé€‚åº”å…ƒç´ æ”¾åœ¨æœ€å‰ã€‘</p> <div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>* &#123;<span class="css"><span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span><span class="css"><span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;</span>&#125;<span class="css"><span class="hljs-selector-tag">body</span> &#123;</span><span class="css"><span class="hljs-attribute">min-width</span>: <span class="hljs-number">550px</span>;</span>&#125;.container &#123;<span class="css"><span class="hljs-attribute">overflow</span>: hidden;</span>&#125;.column &#123;<span class="css"><span class="hljs-attribute">float</span>: left;</span><span class="css"><span class="hljs-attribute">min-height</span>: <span class="hljs-number">100px</span>;</span>&#125;.left &#123;<span class="css"><span class="hljs-attribute">margin-left</span>: -<span class="hljs-number">100%</span>;</span><span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;</span><span class="css"><span class="hljs-attribute">background</span>: <span class="hljs-number">#ffbbff</span>;</span>&#125;.center-wrapper &#123;<span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;</span>&#125;.center &#123;<span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;</span><span class="css"><span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">150px</span> <span class="hljs-number">0</span> <span class="hljs-number">200px</span>;</span><span class="css"><span class="hljs-attribute">background</span>: <span class="hljs-number">#bfefff</span>;</span><span class="css"><span class="hljs-attribute">min-height</span>: <span class="hljs-number">100px</span>;</span>&#125;.right &#123;<span class="css"><span class="hljs-attribute">margin-left</span>: -<span class="hljs-number">150px</span>;</span><span class="css"><span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;</span><span class="css"><span class="hljs-attribute">background</span>: <span class="hljs-number">#eeee00</span>;</span>&#125;/**       *3ï¼Œ4æ–¹æ³•ç±»ä¼¼<span class="css">       * -<span class="hljs-number">100%</span>çš„<span class="hljs-attribute">margin-left</span>å°†å…ƒç´ ç§»åˆ°ä¸Šè¡Œæœ€å·¦</span><span class="css">       * -è‡ªèº«å®½åº¦<span class="hljs-attribute">margin-left</span>å°†å…ƒç´ ç§»åˆ°ä¸Šè¡Œæœ€å³</span><span class="css">       * å¹¶é€šè¿‡ç»™centeråŠ <span class="hljs-attribute">padding</span></span>       */<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column center-wrapper&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>center<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column left&quot;</span>&gt;</span>left<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column right&quot;</span>&gt;</span>right<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div></li><li><p>flex</p><p> <code>flex-grow</code>:1 è‡ªé€‚åº”å¡«å……å‰©ä½™ç©ºé—´</p></li><li><p>grid</p><p> <code>grid-template-column/row</code>ä¸­ç»™è‡ªé€‚åº”å…ƒç´ å†™ auto å¤§å°</p></li><li><p>table<br> table ä¸‹çš„<code>table-cell</code>ä¼šè‡ªåŠ¨è‡ªé€‚åº”æ²¡å†™ width çš„å…ƒç´ </p> <div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.wrapper</span> &#123;<span class="hljs-attribute">display</span>: table;<span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;&#125;<span class="hljs-selector-class">.wrapper</span> <span class="hljs-selector-tag">div</span> &#123;<span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;<span class="hljs-attribute">display</span>: table-cell;&#125;<span class="hljs-selector-class">.main</span> &#123;<span class="hljs-attribute">background</span>: pink;&#125;<span class="hljs-selector-class">.left</span> &#123;<span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;<span class="hljs-attribute">background</span>: red;&#125;<span class="hljs-selector-class">.right</span> &#123;<span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;<span class="hljs-attribute">background</span>: yellow;&#125;</code></pre></div></li></ol><h2 id="ç§»åŠ¨ç«¯"><a href="#ç§»åŠ¨ç«¯" class="headerlink" title="ç§»åŠ¨ç«¯"></a>ç§»åŠ¨ç«¯</h2><h3 id="åƒç´ "><a href="#åƒç´ " class="headerlink" title="åƒç´ "></a>åƒç´ </h3><ul><li>  ç‰©ç†åƒç´ :ç‰©ç†æˆåƒç‚¹</li><li>  css åƒç´ :å¼€å‘é€»è¾‘å•ä½</li><li>  è®¾å¤‡ç‹¬ç«‹åƒç´ :è®¾å¤‡å±å¹•å‘ˆç°çš„åƒç´ é‡</li><li>  dpi è®¾å¤‡åƒç´ æ¯”:ç‰©ç†åƒç´ /è®¾å¤‡ç‹¬ç«‹åƒç´ (ç”¨å¤šå°‘ä¸ªç‰©ç†åƒç´ æ¸²æŸ“ä¸€ä¸ªè®¾å¤‡ç‹¬ç«‹åƒç´ )</li></ul><h3 id="ç§»åŠ¨ç«¯é€‚é…"><a href="#ç§»åŠ¨ç«¯é€‚é…" class="headerlink" title="ç§»åŠ¨ç«¯é€‚é…"></a>ç§»åŠ¨ç«¯é€‚é…</h3><ul><li>ä½¿ç”¨rem<code>postcss-pxtorem</code> / å¤§å±è®¾å¤‡æ˜¾ç¤ºè¿‡å¤§</li><li>ä½¿ç”¨vw/vh<code>postcss-px-to-viewport</code> / å¤§å±è®¾å¤‡æ˜¾ç¤ºè¿‡å¤§</li><li>ç™¾åˆ†æ¯”å•ä½</li><li>px ä¸ºä¸»ï¼Œæ­é… vw/vhã€åª’ä½“æŸ¥è¯¢ä¸ flex è¿›è¡Œå¸ƒå±€</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>divé«˜åº¦ä¸ºå®½åº¦ä¸€åŠ</title>
    <link href="/2022/02/24/div%E9%AB%98%E5%BA%A6%E4%B8%BA%E9%AB%98%E5%BA%A6%E4%B8%80%E5%8D%8A/"/>
    <url>/2022/02/24/div%E9%AB%98%E5%BA%A6%E4%B8%BA%E9%AB%98%E5%BA%A6%E4%B8%80%E5%8D%8A/</url>
    
    <content type="html"><![CDATA[<h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><h2 id="positionå±æ€§"><a href="#positionå±æ€§" class="headerlink" title="positionå±æ€§"></a>positionå±æ€§</h2><ul><li><code>static</code><ul><li>æ­£å¸¸æµï¼Œé»˜è®¤å€¼</li><li>top, right, bottom, left å’Œ z-index å±æ€§æ— æ•ˆã€‚</li></ul></li><li><code>relative</code><ul><li>ç›¸å¯¹æ­£å¸¸æµåç§»</li><li>åŸä½ç½®æœ‰é¢„ç•™ç©ºé—´</li></ul></li><li><code>absolute</code><ul><li>ç§»å‡ºæ­£å¸¸æ–‡æ¡£æµ</li><li>ç›¸å¯¹äºæœ€è¿‘çš„ éstatic å®šä½ç¥–å…ˆå…ƒç´ åç§»</li><li>ä¸ä¸ºå…ƒç´ é¢„ç•™ç©ºé—´</li></ul></li><li><code>fixed</code><ul><li>ç§»å‡ºæ­£å¸¸æ–‡æ¡£æµ</li><li>ç›¸å¯¹äºå±å¹•è§†å£ï¼ˆviewportï¼‰çš„ä½ç½®æ¥æŒ‡å®šå…ƒç´ ä½ç½®</li><li>ä¸ä¸ºå…ƒç´ é¢„ç•™ç©ºé—´<blockquote><p>å½“å…ƒç´ ç¥–å…ˆçš„ transform, perspective æˆ– filter å±æ€§é none æ—¶ï¼Œå®¹å™¨ç”±è§†å£æ”¹ä¸ºè¯¥ç¥–å…ˆã€‚</p></blockquote></li></ul></li><li><code>sticky</code><ul><li>ç›¸å¯¹å®šä½å’Œå›ºå®šå®šä½çš„æ··åˆ</li><li>é¡»æŒ‡å®š top, right, bottom æˆ– left å››ä¸ªé˜ˆå€¼å…¶ä¸­ä¹‹ä¸€ï¼Œæ‰å¯ä½¿ç²˜æ€§å®šä½ç”Ÿæ•ˆã€‚å¦åˆ™å…¶è¡Œä¸ºä¸ç›¸å¯¹å®šä½ç›¸åŒã€‚</li><li>è·¨è¶Šç‰¹å®šé˜ˆå€¼å‰ä¸ºç›¸å¯¹å®šä½ï¼Œä¹‹åä¸ºå›ºå®šå®šä½</li></ul></li></ul><h2 id="åŒ…å«å—"><a href="#åŒ…å«å—" class="headerlink" title="åŒ…å«å—"></a>åŒ…å«å—</h2><h3 id="åŒ…å«å—çš„ä½œç”¨"><a href="#åŒ…å«å—çš„ä½œç”¨" class="headerlink" title="åŒ…å«å—çš„ä½œç”¨"></a>åŒ…å«å—çš„ä½œç”¨</h3><p>  å…ƒç´ çš„å°ºå¯¸åŠä½ç½®ï¼Œå¸¸å¸¸ä¼šå—å®ƒçš„åŒ…å«å—æ‰€å½±å“ã€‚å¯¹äºä¸€äº›å±æ€§ï¼Œä¾‹å¦‚ width,height,padding,marginï¼Œç»å¯¹å®šä½å…ƒç´ çš„åç§»å€¼ï¼ˆæ¯”å¦‚ position è¢«ç½®ä¸º absolute æˆ– fixedï¼‰ï¼Œå½“æˆ‘ä»¬å¯¹å…¶èµ‹äºˆç™¾åˆ†æ¯”å€¼æ—¶ï¼Œå…¶å‚è€ƒå€¼æ˜¯åŒ…å«å—çš„å°ºå¯¸ã€‚</p><h3 id="ç¡®å®šåŒ…å«å—"><a href="#ç¡®å®šåŒ…å«å—" class="headerlink" title="ç¡®å®šåŒ…å«å—"></a>ç¡®å®šåŒ…å«å—</h3><blockquote><p>ä¸€ä¸ªå…ƒç´ çš„åŒ…å«å—å¹¶ä¸ä¸€å®šçˆ¶å…ƒç´ çš„å†…å®¹åŒº</p></blockquote><p>å…ƒç´ çš„åŒ…å«å—ç”±å…¶<code>position</code>å†³å®šï¼š</p><ul><li><code>static ã€ relative æˆ– sticky </code>ï¼ŒåŒ…å«å—å¯èƒ½ç”±å®ƒçš„æœ€è¿‘çš„ç¥–å…ˆå—å…ƒç´ ï¼ˆæ¯”å¦‚è¯´inline-block, block æˆ– list-itemå…ƒç´ ï¼‰çš„å†…å®¹åŒºçš„è¾¹ç¼˜ç»„æˆï¼ˆ<code>content</code>ï¼‰</li><li><code>absolute</code> ï¼ŒåŒ…å«å—å°±æ˜¯ç”±å®ƒçš„æœ€è¿‘çš„ <code>position çš„å€¼ä¸æ˜¯ static</code> ï¼ˆä¹Ÿå°±æ˜¯å€¼ä¸ºfixed, absolute, relative æˆ– stickyï¼‰çš„ç¥–å…ˆå…ƒç´ çš„å†…è¾¹è·åŒºçš„è¾¹ç¼˜ç»„æˆï¼ˆ<code>content+padding</code>ï¼‰</li><li><code>fixed</code>ï¼Œåœ¨è¿ç»­åª’ä½“çš„æƒ…å†µä¸‹(continuous media)åŒ…å«å—æ˜¯ viewport ,åœ¨åˆ†é¡µåª’ä½“(paged media)ä¸‹çš„æƒ…å†µä¸‹åŒ…å«å—æ˜¯åˆ†é¡µåŒºåŸŸ(page area)ã€‚<blockquote><p>å½“å…ƒç´ ç¥–å…ˆçš„ transform, perspective æˆ– filter å±æ€§é none æ—¶,åŒ…å«å—æ˜¯è¿™ä¸ªå…ƒç´ çš„å†…è¾¹è·åŒº content+padding</p></blockquote></li></ul><h3 id="æ ¹æ®åŒ…å«å—è®¡ç®—"><a href="#æ ¹æ®åŒ…å«å—è®¡ç®—" class="headerlink" title="æ ¹æ®åŒ…å«å—è®¡ç®—"></a>æ ¹æ®åŒ…å«å—è®¡ç®—</h3><ul><li>è¦è®¡ç®— <code>height</code> <code>top</code> åŠ <code>bottom</code> ä¸­çš„ç™¾åˆ†å€¼ï¼Œæ˜¯é€šè¿‡åŒ…å«å—çš„ <code>height</code> çš„å€¼</li><li>è¦è®¡ç®— <code>width</code>, <code>left</code>, <code>right</code>, <strong><code>padding</code>!, <code>margin</code></strong> è¿™äº›å±æ€§ç”±åŒ…å«å—çš„ <code>width</code> å±æ€§çš„å€¼æ¥è®¡ç®—å®ƒçš„ç™¾åˆ†å€¼ã€‚</li></ul><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><ol><li><p>å®ç°ä¸€ä¸ªdivå‚ç›´æ°´å¹³å±…ä¸­é«˜åº¦ä¸ºå®½åº¦çš„ä¸€åŠè‡ªé€‚åº”</p><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-comment">/* å¤–å±‚wrapper */</span><span class="hljs-selector-class">.outer-wrapper</span>&#123;  <span class="hljs-attribute">height</span>:<span class="hljs-number">100vh</span>;  <span class="hljs-attribute">width</span>:<span class="hljs-number">100%</span>;  <span class="hljs-attribute">display</span>:flex;  <span class="hljs-comment">/* flexé»˜è®¤è¡Œæ’åˆ—ï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®ä¾§è½´å¯¹é½ */</span>  <span class="hljs-attribute">align-items</span>:center&#125;<span class="hljs-comment">/* å†…å±‚wrapper */</span><span class="hljs-selector-class">.inner-wrapper</span>&#123;  <span class="hljs-attribute">position</span>:relative;  <span class="hljs-attribute">width</span>:<span class="hljs-number">100%</span>;  <span class="hljs-attribute">height</span>:<span class="hljs-number">0</span>;  <span class="hljs-attribute">padding-bottom</span>:<span class="hljs-number">50%</span>;  <span class="hljs-comment">/* padding,marginå€¼çš„ç™¾åˆ†æ¯”æ˜¯ç›¸è¾ƒäºçˆ¶å…ƒç´ width */</span>&#125;<span class="hljs-selector-class">.div</span>&#123;  <span class="hljs-attribute">position</span>:absolute;  <span class="hljs-comment">/* ä¸¤ä¸ªpositionè®¾ç½®éƒ½æ˜¯ä¸ºäº†ç¡®å®šåŒ…å«å— */</span>  <span class="hljs-attribute">width</span>:<span class="hljs-number">100%</span>;  <span class="hljs-attribute">height</span>:<span class="hljs-number">100%</span>;  <span class="hljs-comment">/* è¿™é‡Œçš„é«˜åº¦å°±=&gt;inner-wrapper[height+padding]=&gt;outer-wrapper[width]*50% */</span>&#125;</code></pre></div></li><li><p>å®ç°divæ­£æ–¹å½¢å¤§å°è‡ªé€‚åº”</p></li></ol><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.wrapper</span>&#123;  <span class="hljs-attribute">position</span>:relative;  <span class="hljs-attribute">padding-top</span>:<span class="hljs-number">50%</span>;  <span class="hljs-attribute">width</span>:<span class="hljs-number">50%</span>;  <span class="hljs-comment">/* åŒæ ·ç›¸è¾ƒäºåŒ…å«å—çš„å°ºå¯¸ç™¾åˆ†æ¯” */</span>  <span class="hljs-comment">/* widthå’Œpaddingéƒ½ç­‰äºwrapperåŒ…å«å—çš„å®½åº¦çš„ä¸€åŠ */</span>&#125;<span class="hljs-selector-class">.div</span>&#123;  <span class="hljs-attribute">position</span>:absolute;  <span class="hljs-attribute">top</span>:<span class="hljs-number">0</span>;  <span class="hljs-attribute">left</span>:<span class="hljs-number">0</span>;  <span class="hljs-comment">/* åç§»åˆ°wrapperä½ç½® */</span>  <span class="hljs-attribute">width</span>:<span class="hljs-number">100%</span>;  <span class="hljs-attribute">height</span>:<span class="hljs-number">100%</span>;&#125;<span class="hljs-comment">/* ä¹Ÿå¯ä½¿ç”¨ä¼ªå…ƒç´ æ’‘å¼€é«˜åº¦ */</span><span class="hljs-selector-class">.div</span>&#123;  <span class="hljs-attribute">width</span>:<span class="hljs-number">50%</span>;  <span class="hljs-comment">/* è§¦å‘BFCé¿å…å¡Œé™· */</span>  <span class="hljs-attribute">display</span>:flow-root&#125;<span class="hljs-selector-class">.div</span><span class="hljs-selector-pseudo">::after</span>&#123;  <span class="hljs-attribute">content</span>:<span class="hljs-string">&#x27;&#x27;</span>;  <span class="hljs-attribute">margin-top</span>:<span class="hljs-number">100%</span>;  <span class="hljs-attribute">display</span>:block&#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
      <tag>css</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>es6~nowæ–°ç‰¹æ€§</title>
    <link href="/2022/02/24/es6%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    <url>/2022/02/24/es6%E6%96%B0%E7%89%B9%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Javascript = Web Api + ECMAScript</p></blockquote><blockquote><p>ES2015 åéƒ½ä½¿ç”¨å¹´ä»½åšç‰ˆæœ¬</p></blockquote><h2 id="ã€let-constã€‘"><a href="#ã€let-constã€‘" class="headerlink" title="ã€let / constã€‘"></a>ã€let / constã€‘</h2><ul><li>éƒ½ç”¨äºå£°æ˜å˜é‡</li><li>ä¸å­˜åœ¨å˜é‡æå‡ï¼Œæš‚æ—¶æ€§æ­»åŒº</li><li>ä¸èƒ½é‡å¤å£°æ˜</li><li>å—çº§ä½œç”¨åŸŸ <code>[]</code></li></ul><h3 id="let"><a href="#let" class="headerlink" title="let"></a>let</h3><ul><li>å¯ä»¥é‡æ–°èµ‹å€¼<h3 id="const"><a href="#const" class="headerlink" title="const"></a>const</h3></li><li>å£°æ˜æ—¶éœ€èµ‹å€¼</li><li>åªè¯»ä¸å¯æ”¹å˜ï¼ˆå¯¹äºå¤æ‚å˜é‡ï¼Œå¯ä»¥ä¿®æ”¹å˜é‡å†…å®¹ï¼Œå˜é‡å†…å­˜åœ°å€æœªæ”¹å˜ï¼‰</li></ul><h2 id="ã€è§£æ„èµ‹å€¼ã€‘"><a href="#ã€è§£æ„èµ‹å€¼ã€‘" class="headerlink" title="ã€è§£æ„èµ‹å€¼ã€‘"></a>ã€è§£æ„èµ‹å€¼ã€‘</h2><p>åªæœ‰å¯éå†ï¼ˆå…·å¤‡éå†å™¨<code>[Symbol.Iterator]</code>ï¼‰çš„æ•°æ®ç»“æ„æ‰èƒ½è§£æ„èµ‹å€¼</p><h3 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h3><ul><li><p>äº¤æ¢å˜é‡</p></li><li><p>æå–å¯¹è±¡ä¸­çš„æ•°æ®</p></li><li><p>è§£æ„é»˜è®¤å€¼</p></li><li><p>å‰©ä½™è¿ç®—ç¬¦<code>...</code></p></li><li><p>æ•°ç»„ç»“æ„ <code>const [a,b,c] = [1,2,3]</code></p></li><li><p>å¯¹è±¡ç»“æ„ </p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> obj = &#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;xxx&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">14</span>&#125;<span class="hljs-keyword">const</span> &#123;name,age&#125; = obj<span class="hljs-comment">// åˆ«å</span><span class="hljs-keyword">const</span> &#123;<span class="hljs-attr">name</span>:trueName&#125; = obj<span class="hljs-built_in">console</span>.log(trueName)</code></pre></div></li></ul><h2 id="ã€å­—ç¬¦ä¸²ã€‘"><a href="#ã€å­—ç¬¦ä¸²ã€‘" class="headerlink" title="ã€å­—ç¬¦ä¸²ã€‘"></a>ã€å­—ç¬¦ä¸²ã€‘</h2><ul><li>æ–¹æ³•<ul><li><code>includes()</code></li><li><code>startsWith()</code></li><li><code>endsWith()</code> </li><li><code>padStart(len,x)</code>// è¡¥å…¨åçš„æœ€å°é•¿åº¦ï¼Œä¸è¶³åˆ™ç”¨xåœ¨å¼€å¤´å¡«å……</li><li><code>padEnd()</code>// åœ¨æœ«å°¾å¡«å……</li><li><code>repeat()</code>// é‡å¤</li></ul></li><li>æ¨¡ç‰ˆå­—ç¬¦ä¸²<ul><li>å¤šè¡Œ</li><li>æ’å€¼<code>$&#123;x&#125;</code></li></ul></li></ul><h2 id="ã€æ•°å€¼ã€‘"><a href="#ã€æ•°å€¼ã€‘" class="headerlink" title="ã€æ•°å€¼ã€‘"></a>ã€æ•°å€¼ã€‘</h2><blockquote><p>æ™®é€šnumberç±»å‹åªèƒ½ä¿ç•™53ä¸ªäºŒè¿›åˆ¶ä½/16ä¸ª10è¿›åˆ¶ä½çš„ç²¾åº¦</p></blockquote><ul><li>æœ€å¤§æœ€å°å®‰å…¨æ•´æ•°<code>Number.MAX_SAFE_INTEGER</code>,<code>Number.MAX_SAFE_INTEGER</code></li><li>è¯†åˆ«<ul><li><code>Number.isSafeInteger()</code></li><li><code>Number.isFinite()</code></li></ul></li><li>å¤§æ•°<code>BigInt</code>ç±»å‹ï¼Œåè¦åŠ ä¸Šå­—æ¯n<code>123n</code>ï¼Œæ²¡æœ‰ä½æ•°é™åˆ¶ </li><li>æŒ‡æ•°è¿ç®—<code>**</code></li></ul><h2 id="ã€æ•°ç»„ã€‘"><a href="#ã€æ•°ç»„ã€‘" class="headerlink" title="ã€æ•°ç»„ã€‘"></a>ã€æ•°ç»„ã€‘</h2><ul><li>æ–¹æ³•<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.from() <span class="hljs-comment">// ä»ä¸€ä¸ªç±»ä¼¼æ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œæµ…æ‹·è´çš„æ•°ç»„å®ä¾‹ã€‚</span><span class="hljs-built_in">Array</span>.of() <span class="hljs-comment">// Array()åªä¼ ä¸€ä¸ªå‚æ•°å°±ä½œä¸ºæ–°å»ºçš„æ•°ç»„é•¿åº¦</span>includes()copyWithin()fill()find() / findIndex()keys(),values(),entries()flat()</code></pre></div></li><li>æ‰©å±•è¿ç®—ç¬¦<code>...</code></li></ul><h2 id="ã€å¯¹è±¡ã€‘"><a href="#ã€å¯¹è±¡ã€‘" class="headerlink" title="ã€å¯¹è±¡ã€‘"></a>ã€å¯¹è±¡ã€‘</h2><ul><li>æ–¹æ³•<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Object</span>.is(a,b)<span class="hljs-comment">// æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸¥æ ¼ç›¸ç­‰ï¼Œä¸ï¼ˆ===ï¼‰åŸºæœ¬ç±»ä¼¼</span><span class="hljs-comment">// Object.isä¸å…¨ç­‰çš„åŒºåˆ«</span><span class="hljs-comment">//  Object.is(+0,-0);  //false</span><span class="hljs-comment">//  +0 === -0  //true</span><span class="hljs-comment">//  Object.is(NaN,NaN); //true</span><span class="hljs-comment">//  NaN === NaN  //false</span><span class="hljs-built_in">Object</span>.assign() <span class="hljs-comment">// æ½œæ‹·è´</span></code></pre></div></li><li>æ‰©å±•è¿ç®—ç¬¦<code>...</code></li></ul><h2 id="ã€å‡½æ•°ã€‘"><a href="#ã€å‡½æ•°ã€‘" class="headerlink" title="ã€å‡½æ•°ã€‘"></a>ã€å‡½æ•°ã€‘</h2><ul><li>ç®­å¤´å‡½æ•°<ul><li>ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„this,é™æ€ç»‘å®šä¹¦å†™æ—¶çš„ä¸Šä¸‹æ–‡</li><li>ç®­å¤´å‡½æ•°æ²¡æœ‰<code>prototype</code> â€”&gt; <strong>ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ï¼Œä¸èƒ½ new</strong></li><li>ç®­å¤´å‡½æ•°æ²¡æœ‰<code>arguments</code>å±æ€§</li><li>ä¸èƒ½ç”¨ä½œ<code>generator</code>å‡½æ•°</li></ul></li><li>å‡½æ•°å‚æ•°é»˜è®¤å€¼<code>function fn1(arg1=&#39;xxx&#39;)&#123;&#125;</code></li><li>å‡½æ•°å‰©ä½™å‚æ•°<code>function(a, b, ...theArgs)</code></li></ul><h2 id="ã€Symbolã€‘"><a href="#ã€Symbolã€‘" class="headerlink" title="ã€Symbolã€‘"></a>ã€Symbolã€‘</h2><p>ç‹¬ä¸€æ— äºŒçš„å€¼,<code>Symbol()</code>å£°æ˜ä¸éœ€è¦new</p><ul><li><p>ä½œä¸ºä¸å˜çš„å¸¸é‡</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> FLAG1 = <span class="hljs-built_in">Symbol</span>()<span class="hljs-keyword">const</span> FLAG2 = <span class="hljs-built_in">Symbol</span>()</code></pre></div></li><li><p>ç§æœ‰å˜é‡</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> obj1 = (<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-keyword">let</span> var1 = symbol(<span class="hljs-string">&#x27;var1&#x27;</span>)  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Inner</span></span>&#123;    <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span>&#123;      <span class="hljs-built_in">this</span>[var1] = <span class="hljs-string">&#x27;abcde&#x27;</span>    &#125;    <span class="hljs-function"><span class="hljs-title">getVar</span>(<span class="hljs-params"></span>)</span>&#123;      <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>[var1]    &#125;  &#125;  <span class="hljs-keyword">return</span> Inner&#125;)()<span class="hljs-keyword">const</span> o1 = obj1()<span class="hljs-built_in">console</span>.log(o1)<span class="hljs-comment">// &#123;Symbol(var1):&#x27;abcde&#x27;&#125;</span><span class="hljs-comment">// ä¸èƒ½ç›´æ¥è®¿é—®</span></code></pre></div><h2 id="ã€Set-WeakSetã€‘"><a href="#ã€Set-WeakSetã€‘" class="headerlink" title="ã€Set/WeakSetã€‘"></a>ã€Set/WeakSetã€‘</h2></li><li><p>Setç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ‹¥æœ‰è¿­ä»£å™¨</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">sizeadd()<span class="hljs-keyword">delete</span>()has()clear()</code></pre></div></li><li><p>WeakSetçš„æˆå‘˜åªèƒ½æ˜¯å¯¹è±¡ï¼Œã€å¼±å¼•ç”¨ã€‘ï¼Œã€ä¸å¯éå†ã€‘</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">add()<span class="hljs-keyword">delete</span>()has()</code></pre></div></li></ul><h2 id="ã€Map-WeakMapã€‘"><a href="#ã€Map-WeakMapã€‘" class="headerlink" title="ã€Map/WeakMapã€‘"></a>ã€Map/WeakMapã€‘</h2><ul><li>Objectçš„é”®ä¼ ç»Ÿä¸Šåªèƒ½ä½¿ç”¨å­—ç¬¦ä¸²ï¼ŒMapæ— æ­¤é™åˆ¶ï¼Œæ‹¥æœ‰è¿­ä»£å™¨<div class="hljs code-wrapper"><pre><code class="hljs javascript">sizeset(key,value) <span class="hljs-comment">// è¿”å›æ•´ä¸ª Map ç»“æ„</span>get() <span class="hljs-comment">// æ‰¾ä¸åˆ°è¯¥ key è¿”å› undefined</span>has()<span class="hljs-keyword">delete</span>() <span class="hljs-comment">// åˆ é™¤å¤±è´¥è¿”å› false</span>clear() <span class="hljs-comment">// æ— è¿”å›å€¼</span></code></pre></div></li><li>WeakMapåªæ¥å—å¯¹è±¡ä½œä¸ºé”®åï¼ˆé™¤äº†nullï¼‰ï¼Œã€é”®åå¼±å¼•ç”¨ã€‘<div class="hljs code-wrapper"><pre><code class="hljs javascript">set()get()has()<span class="hljs-keyword">delete</span>()</code></pre></div></li><li>mapå’Œobjectçš„åŒºåˆ«<ol><li>é”®çš„å˜é‡ç±»å‹é™åˆ¶</li><li>mapåŸç”Ÿå…·æœ‰éå†å™¨</li><li>mapéå†æ—¶ä¿æŒæ’å…¥æ—¶çš„é¡ºåº(objectéå†æ—¶ä¼šå¯¹æ•´æ•°é”®åæ’åº)</li><li>map.size()è¿”å›é•¿åº¦</li></ol></li></ul><h2 id="ã€Proxyã€‘"><a href="#ã€Proxyã€‘" class="headerlink" title="ã€Proxyã€‘"></a>ã€Proxyã€‘</h2><p>æ‹¦æˆªå™¨/ä»£ç† <code>const _proxy1 = new Proxy(target,handler)</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å¸¸ç”¨handlers</span>getPrototypeOf()<span class="hljs-comment">// Object.getPrototypeOf æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>setPrototypeOf()<span class="hljs-comment">// Object.setPrototypeOf æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>getOwnPropertyDescriptor()<span class="hljs-comment">// Object.getOwnPropertyDescriptor æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>defineProperty()<span class="hljs-comment">// Object.defineProperty æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>has()<span class="hljs-comment">// in æ“ä½œç¬¦çš„æ•æ‰å™¨ã€‚</span>get()<span class="hljs-comment">// å±æ€§è¯»å–æ“ä½œçš„æ•æ‰å™¨ã€‚</span>set()<span class="hljs-comment">// å±æ€§è®¾ç½®æ“ä½œçš„æ•æ‰å™¨ã€‚</span>deleteProperty()<span class="hljs-comment">// delete æ“ä½œç¬¦çš„æ•æ‰å™¨ã€‚</span>ownKeys()<span class="hljs-comment">// Object.getOwnPropertyNames æ–¹æ³•å’Œ Object.getOwnPropertySymbols æ–¹æ³•çš„æ•æ‰å™¨ã€‚</span>apply()<span class="hljs-comment">// å‡½æ•°è°ƒç”¨æ“ä½œçš„æ•æ‰å™¨ã€‚</span>construct()<span class="hljs-comment">// new æ“ä½œç¬¦çš„æ•æ‰å™¨ã€‚</span></code></pre></div><h2 id="ã€Reflectã€‘"><a href="#ã€Reflectã€‘" class="headerlink" title="ã€Reflectã€‘"></a>ã€Reflectã€‘</h2><p>æ“ä½œå¯¹è±¡çš„API</p><ul><li>å¯¹è±¡æ“ä½œèƒ½è¿”å›å¸ƒå°”å€¼</li><li>å°†å¯¹è±¡æ“ä½œå‡½æ•°åŒ–<blockquote><p>æŸäº›Objectæ“ä½œæ˜¯å‘½ä»¤å¼ï¼Œæ¯”å¦‚name in objå’Œdelete obj[name]ï¼Œè€ŒReflect.has(obj, name)å’ŒReflect.deleteProperty(obj, name)è®©å®ƒä»¬å˜æˆäº†å‡½æ•°è¡Œä¸ºã€‚</p></blockquote></li><li>ä¸Proxyä¸­æ–¹æ³•å‡å¯¹åº”<h2 id="ã€Promiseã€‘"><a href="#ã€Promiseã€‘" class="headerlink" title="ã€Promiseã€‘"></a>ã€Promiseã€‘</h2></li><li>å¤„ç†å¼‚æ­¥æ“ä½œï¼Œé¿å…å›è°ƒåµŒå¥—</li><li>çŠ¶æ€ä¸å¯é€†</li><li>ä¸­é€”ä¸å¯åœæ­¢</li><li>éœ€è¦æ•è·promiseå†…é”™è¯¯</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>((resolve,reject))<span class="hljs-built_in">Promise</span>.prototype.then(onFulfilled,onRejected)<span class="hljs-built_in">Promise</span>.prototype.catch()<span class="hljs-comment">// promiseä¸­çš„é”™è¯¯ä¼šä¸€ç›´å†’æ³¡åˆ°æœ€åï¼Œæ²¡æœ‰æ•è·åˆ™æŠ¥é”™</span><span class="hljs-built_in">Promise</span>.prototype.finally()<span class="hljs-built_in">Promise</span>.all() <span class="hljs-comment">// å…¨éƒ¨fulfilledæˆ–è€…æœ‰è°rejected</span><span class="hljs-built_in">Promise</span>.allSettled() <span class="hljs-comment">// å…¨éƒ¨å¾—åˆ°ä¸ç®¡ä»€ä¹ˆçŠ¶æ€</span><span class="hljs-built_in">Promise</span>.race() <span class="hljs-comment">// æœ€å…ˆæ”¹å˜status</span><span class="hljs-built_in">Promise</span>.any() <span class="hljs-comment">// æœ€å…ˆfulfilledæˆ–è€…å…¨éƒ¨rejected</span><span class="hljs-built_in">Promise</span>.resolve()<span class="hljs-built_in">Promise</span>.reject()<span class="hljs-built_in">Promise</span>.try()</code></pre></div><h2 id="ã€Iteratorè¿­ä»£å™¨ã€‘"><a href="#ã€Iteratorè¿­ä»£å™¨ã€‘" class="headerlink" title="ã€Iteratorè¿­ä»£å™¨ã€‘"></a>ã€Iteratorè¿­ä»£å™¨ã€‘</h2><h3 id="Symbol-Iterator"><a href="#Symbol-Iterator" class="headerlink" title="[Symbol.Iterator]"></a>[Symbol.Iterator]</h3><ul><li>ç»Ÿä¸€çš„éå†é›†åˆæ•°æ®çš„å€Ÿå£</li><li>åªè¦æ‹¥æœ‰<code>[Symbol.Iterator]</code>çš„æ•°æ®ç»“æ„éƒ½å¯ä»¥ç”¨forâ€¦oféå†</li></ul><h3 id="åŸç”Ÿå…·å¤‡-Iterator-æ¥å£çš„æ•°æ®ç»“æ„å¦‚ä¸‹ã€‚"><a href="#åŸç”Ÿå…·å¤‡-Iterator-æ¥å£çš„æ•°æ®ç»“æ„å¦‚ä¸‹ã€‚" class="headerlink" title="åŸç”Ÿå…·å¤‡ Iterator æ¥å£çš„æ•°æ®ç»“æ„å¦‚ä¸‹ã€‚"></a>åŸç”Ÿå…·å¤‡ Iterator æ¥å£çš„æ•°æ®ç»“æ„å¦‚ä¸‹ã€‚</h3><ul><li>Array</li><li>Map</li><li>Set</li><li>String</li><li>TypedArray</li><li>å‡½æ•°çš„ arguments</li><li>Dom Node</li></ul><h2 id="ã€Generatorã€‘"><a href="#ã€Generatorã€‘" class="headerlink" title="ã€Generatorã€‘"></a>ã€Generatorã€‘</h2><ul><li>è°ƒç”¨ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°å¹¶ä¸ä¼šé©¬ä¸Šæ‰§è¡Œå®ƒé‡Œé¢çš„è¯­å¥ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªè¿™ä¸ªç”Ÿæˆå™¨çš„ <code>è¿­ä»£å™¨</code> ï¼ˆ iterator ï¼‰å¯¹è±¡ã€‚</li><li>å½“è¿™ä¸ªè¿­ä»£å™¨çš„ <code>next()</code> æ–¹æ³•è¢«è°ƒç”¨æ—¶è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œ<code>&#123;value:å½“å‰çš„è¿”å›,done:æ˜¯å¦è¿­ä»£å®Œ&#125;</code>ï¼Œå…¶å†…çš„è¯­å¥ä¼šæ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ª<code>yield</code>çš„ä½ç½®ï¼Œ<code>yield</code> åç´§è·Ÿè¿­ä»£å™¨è¦è¿”å›çš„å€¼ã€‚  </li><li>æˆ–è€…å¦‚æœç”¨çš„æ˜¯ <code>yield*</code>ï¼Œåˆ™è¡¨ç¤ºå°†æ‰§è¡Œæƒç§»äº¤ç»™å¦ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ï¼ˆå½“å‰ç”Ÿæˆå™¨æš‚åœæ‰§è¡Œï¼‰ã€‚</li><li>å½“åœ¨ç”Ÿæˆå™¨å‡½æ•°ä¸­æ˜¾å¼ <code>return</code> æ—¶ï¼Œä¼šå¯¼è‡´ç”Ÿæˆå™¨ç«‹å³å˜ä¸ºå®ŒæˆçŠ¶æ€ï¼Œå¦‚æœ <code>return</code> åé¢è·Ÿäº†ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼ä¼šä½œä¸ºå½“å‰è°ƒç”¨ <code>next()</code> æ–¹æ³•è¿”å›å€¼ã€‚</li><li>è°ƒç”¨ <code>next()</code>æ–¹æ³•æ—¶ï¼Œå¦‚æœä¼ å…¥äº†å‚æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°ä¼šä¼ ç»™ä¸Šä¸€æ¡æ‰§è¡Œçš„ <code>yield</code>è¯­å¥å·¦è¾¹çš„å˜é‡ï¼Œä¾‹å¦‚ä¸‹é¢ä¾‹å­ä¸­çš„ x ï¼š<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> *<span class="hljs-title">gen</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">yield</span> <span class="hljs-number">10</span>;    x=<span class="hljs-keyword">yield</span> <span class="hljs-string">&#x27;foo&#x27;</span>;    <span class="hljs-keyword">yield</span> x;&#125;<span class="hljs-keyword">var</span> gen_obj=gen();<span class="hljs-built_in">console</span>.log(gen_obj.next());<span class="hljs-comment">// æ‰§è¡Œ yield 10ï¼Œè¿”å› 10</span><span class="hljs-built_in">console</span>.log(gen_obj.next());<span class="hljs-comment">// æ‰§è¡Œ yield &#x27;foo&#x27;ï¼Œè¿”å› &#x27;foo&#x27;</span><span class="hljs-built_in">console</span>.log(gen_obj.next(<span class="hljs-number">100</span>));<span class="hljs-comment">// å°† 100 èµ‹ç»™ä¸Šä¸€æ¡ yield &#x27;foo&#x27; çš„å·¦å€¼ï¼Œå³æ‰§è¡Œ x=100ï¼Œè¿”å› 100</span><span class="hljs-built_in">console</span>.log(gen_obj.next());<span class="hljs-comment">// æ‰§è¡Œå®Œæ¯•ï¼Œvalue ä¸º undefinedï¼Œdone ä¸º true</span></code></pre></div></li></ul><h2 id="ã€async-awaitã€‘"><a href="#ã€async-awaitã€‘" class="headerlink" title="ã€async/awaitã€‘"></a>ã€async/awaitã€‘</h2><p>è‡ªæ‰§è¡Œçš„Generatorå‡½æ•°è¯­æ³•ç³–ã€‚</p><h2 id="ã€Classã€‘"><a href="#ã€Classã€‘" class="headerlink" title="ã€Classã€‘"></a>ã€Classã€‘</h2><ol><li><p>ç±»è¡¨è¾¾å¼å’Œç±»å£°æ˜</p> <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> A = <span class="hljs-class"><span class="hljs-keyword">class</span> </span>&#123;&#125;<span class="hljs-comment">// or</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;&#125;</code></pre></div><blockquote><p>ç±»å£°æ˜å’Œç±»è¡¨è¾¾å¼çš„ä¸»ä½“éƒ½æ‰§è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹</p></blockquote></li><li><p>ç»§æ‰¿</p><p>æœ¬è´¨ä½¿ç”¨çš„æ˜¯åŸå‹å¼ç»§æ‰¿</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">name</span>)</span>&#123;    <span class="hljs-built_in">this</span>.name = name  &#125;  <span class="hljs-function"><span class="hljs-title">fun1</span>(<span class="hljs-params"></span>)</span>&#123;&#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> <span class="hljs-title">extend</span> <span class="hljs-title">B</span></span>&#123;  <span class="hljs-title">constructor</span> (<span class="hljs-params">name</span>)&#123;    <span class="hljs-built_in">super</span>(name) <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° // </span>  &#125;  <span class="hljs-function"><span class="hljs-title">fun2</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">super</span>.fun1() <span class="hljs-comment">// è°ƒç”¨ä¸€ä¸ªçˆ¶ç±»æ–¹æ³•</span>  &#125;&#125;</code></pre></div></li><li><p>é™æ€å­—æ®µï¼Œç§æœ‰å­—æ®µï¼Œç§æœ‰å®ä¾‹å­—æ®µ</p> <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span></span>&#123;  <span class="hljs-comment">//é™æ€å­—æ®µ</span>  <span class="hljs-keyword">static</span> attr1 = <span class="hljs-number">123</span>  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">func1</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;im func1&#x27;</span>&#125;  <span class="hljs-comment">//åªåœ¨ç±»å£°æ˜ä¸­å­˜åœ¨ï¼Œå®ä¾‹ä¸èƒ½è®¿é—®</span>  <span class="hljs-comment">// å…¬æœ‰å­—æ®µ</span>  attr2 = <span class="hljs-number">666</span>  <span class="hljs-function"><span class="hljs-title">func2</span>(<span class="hljs-params"></span>)</span>&#123;&#125;  <span class="hljs-comment">// æ¯ä¸ªå®ä¾‹éƒ½å¤åˆ¶ä¸€ä»½</span>  <span class="hljs-comment">//ç§æœ‰å®ä¾‹å­—æ®µ</span>  <span class="hljs-comment">//ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œé—­åŒ…è®¿é—®</span>  #attr3  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">name</span>)</span>&#123;    <span class="hljs-built_in">this</span>.#attr3 = name  &#125;  <span class="hljs-function"><span class="hljs-title">getPrivate</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.#attr3  &#125;  #func3 = <span class="hljs-function">() =&gt;</span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;im private&#x27;</span>);  &#125;  <span class="hljs-function"><span class="hljs-title">getPrivateFunc</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.#func3()  &#125;&#125;</code></pre></div></li><li><p>getter / setter</p><p> å½“ä½¿ç”¨ get å…³é”®å­—æ—¶ï¼Œå±æ€§å°†è¢«å®šä¹‰åœ¨å®ä¾‹çš„åŸå‹ä¸Šï¼Œå½“ä½¿ç”¨Object.defineProperty()æ—¶ï¼Œå±æ€§å°†è¢«å®šä¹‰åœ¨å®ä¾‹è‡ªèº«ä¸Šã€‚</p> <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> </span>&#123;  <span class="hljs-keyword">get</span> <span class="hljs-title">hello</span>() &#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;world&#x27;</span>;  &#125;&#125;<span class="hljs-keyword">const</span> obj = <span class="hljs-keyword">new</span> Example();<span class="hljs-built_in">console</span>.log(obj.hello);<span class="hljs-comment">// &quot;world&quot;</span><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="hljs-string">&#x27;hello&#x27;</span>));<span class="hljs-comment">// undefined</span></code></pre></div><h2 id="ã€æ¨¡å—åŒ–-ES-moduleã€‘"><a href="#ã€æ¨¡å—åŒ–-ES-moduleã€‘" class="headerlink" title="ã€æ¨¡å—åŒ– ES moduleã€‘"></a>ã€æ¨¡å—åŒ– ES moduleã€‘</h2></li><li><p>è¯­æ³•</p></li></ol><p><code>export / export</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// è¿™æ˜¯ Node ä¸­å‘å¤–æš´éœ²æˆå‘˜çš„å½¢å¼ï¼š</span><span class="hljs-comment">// module.exports = &#123;&#125;</span><span class="hljs-comment">// ES6ä¸­å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨ import æ¨¡å—åç§° from &#x27;æ¨¡å—æ ‡è¯†ç¬¦&#x27; import &#x27;è¡¨ç¤ºè·¯å¾„&#x27;</span><span class="hljs-comment">// åœ¨ ES6 ä¸­ï¼Œä½¿ç”¨ export default å’Œ export å‘å¤–æš´éœ²æˆå‘˜ï¼š</span><span class="hljs-keyword">var</span> info = &#123;  name: <span class="hljs-string">&quot;zs&quot;</span>,  age: <span class="hljs-number">20</span>&#125;;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> info;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  address: <span class="hljs-string">&quot;æ·±åœ³&quot;</span>&#125;;<span class="hljs-comment">// æ³¨æ„ï¼š export default å‘å¤–æš´éœ²çš„æˆå‘˜ï¼Œå¯ä»¥ä½¿ç”¨ä»»æ„çš„å˜é‡æ¥æ¥æ”¶</span><span class="hljs-comment">// æ³¨æ„ï¼š åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œexport default åªå…è®¸å‘å¤–æš´éœ²1æ¬¡</span><span class="hljs-comment">// æ³¨æ„ï¼š åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨ export default å’Œ export å‘å¤–æš´éœ²æˆå‘˜</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">var</span> title = <span class="hljs-string">&quot;å°æ˜Ÿæ˜Ÿ&quot;</span>;<span class="hljs-keyword">export</span> <span class="hljs-keyword">var</span> content = <span class="hljs-string">&quot;å“ˆå“ˆå“ˆ&quot;</span>;<span class="hljs-comment">// æ³¨æ„ï¼š ä½¿ç”¨ export å‘å¤–æš´éœ²çš„æˆå‘˜ï¼Œåªèƒ½ä½¿ç”¨ &#123; &#125; çš„å½¢å¼æ¥æ¥æ”¶ï¼Œè¿™ç§å½¢å¼ï¼Œå«åš ã€æŒ‰éœ€å¯¼å‡ºã€‘</span><span class="hljs-comment">// æ³¨æ„ï¼š export å¯ä»¥å‘å¤–æš´éœ²å¤šä¸ªæˆå‘˜ï¼Œ åŒæ—¶ï¼Œå¦‚æœæŸäº›æˆå‘˜ï¼Œæˆ‘ä»¬åœ¨ import çš„æ—¶å€™ï¼Œä¸éœ€è¦ï¼Œåˆ™å¯ä»¥ä¸åœ¨ &#123;&#125; ä¸­å®šä¹‰</span><span class="hljs-comment">// æ³¨æ„ï¼š ä½¿ç”¨ export å¯¼å‡ºçš„æˆå‘˜ï¼Œå¿…é¡»ä¸¥æ ¼æŒ‰ç…§ å¯¼å‡ºæ—¶å€™çš„åç§°ï¼Œæ¥ä½¿ç”¨ &#123;&#125; æŒ‰éœ€æ¥æ”¶ï¼›</span><span class="hljs-comment">// æ³¨æ„ï¼š ä½¿ç”¨ export å¯¼å‡ºçš„æˆå‘˜ï¼Œå¦‚æœ å°±æƒ³ æ¢ä¸ª åç§°æ¥æ¥æ”¶ï¼Œå¯ä»¥ä½¿ç”¨ as æ¥èµ·åˆ«åï¼›</span><span class="hljs-comment">// åœ¨Nodeä¸­ ä½¿ç”¨ var åç§° = require(&#x27;æ¨¡å—æ ‡è¯†ç¬¦&#x27;)</span><span class="hljs-comment">// module.exports å’Œ exports æ¥æš´éœ²æˆå‘˜</span></code></pre></div><ol start="2"><li><p>ä½¿ç”¨ babel ç¼–è¯‘ ES6 è¯­æ³•</p><p>Babel æ˜¯ä¸€ä¸ªå·¥å…·é“¾ï¼Œä¸»è¦ç”¨äºåœ¨æ—§çš„æµè§ˆå™¨æˆ–ç¯å¢ƒä¸­å°† ECMAScript 2015+ ä»£ç è½¬æ¢ä¸ºå‘åå…¼å®¹ç‰ˆæœ¬çš„ JavaScript ä»£ç </p></li><li><p>æ¨¡å—åŒ–å·¥å…· webpack,rollup</p></li></ol><h2 id="è£…é¥°å™¨è¯­æ³•"><a href="#è£…é¥°å™¨è¯­æ³•" class="headerlink" title="è£…é¥°å™¨è¯­æ³•"></a>è£…é¥°å™¨è¯­æ³•</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">@demo<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span></span>&#123;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">demo</span>(<span class="hljs-params">target</span>)</span>&#123;  target.value = <span class="hljs-number">666</span>&#125;<span class="hljs-comment">// ç­‰ä»·äº</span>MyClass = demo(MyClass)</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>ES6</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>flexå¸ƒå±€</title>
    <link href="/2022/02/24/flex/"/>
    <url>/2022/02/24/flex/</url>
    
    <content type="html"><![CDATA[<p>ref:<a href="http://www.ruanyifeng.com/blog/2015/07/flex-examples.html">é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></p><h2 id="å®¹å™¨çš„å±æ€§"><a href="#å®¹å™¨çš„å±æ€§" class="headerlink" title="å®¹å™¨çš„å±æ€§"></a>å®¹å™¨çš„å±æ€§</h2><ul><li><p><code>flex-direction</code> ä¸»è½´çš„æ–¹å‘ </p><ul><li><code>row(é»˜è®¤ä½) | row-reverse</code> æ¨ªå‘æ’åˆ—</li><li><code>column | column-reverse</code>çºµå‘æ’åˆ—</li></ul></li><li><p><code>flex-wrap</code> æ¢è¡Œ</p><ul><li><code>nowrap</code>ä¸æ¢è¡Œ</li><li><code>wrap</code>æ¢è¡Œ</li><li><code>wrap-reverse</code>é€†åºæ¢è¡Œ</li></ul></li><li><p><code>flex-flow</code>(ä¸Šè¿°ä¸¤ç§çš„ç®€å†™)</p></li><li><p><code>justify-content</code> ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼</p><ul><li><code>flex-start</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå·¦å¯¹é½ </li><li><code>flex-end</code>ï¼šå³å¯¹é½</li><li><code>center</code>ï¼š å±…ä¸­</li><li><code>space-between</code>ï¼šä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰</li><li><code>space-around</code>ï¼šæ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€</li></ul></li><li><p><code>align-items</code> ä¾§è½´ä¸Šå¦‚ä½•å¯¹é½ </p><ul><li><code>flex-start</code>ï¼šäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½</li><li><code>flex-end</code>ï¼šäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½</li><li><code>center</code>ï¼šäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½</li><li><code>baseline</code>: é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½</li><li><code>stretch</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå¦‚æœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦</li></ul></li><li><p><code>align-content</code> å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼</p><ul><li><code>flex-start</code>ï¼šä¸äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½</li><li><code>flex-end</code>ï¼šä¸äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½</li><li><code>center</code>ï¼šä¸äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½</li><li><code>space-between</code>ï¼šä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒ</li><li><code>space-around</code>ï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€</li><li><code>stretch</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šè½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´</li></ul></li></ul><h2 id="é¡¹ç›®çš„å±æ€§"><a href="#é¡¹ç›®çš„å±æ€§" class="headerlink" title="é¡¹ç›®çš„å±æ€§"></a>é¡¹ç›®çš„å±æ€§</h2><ul><li><p><code>order</code></p><p>é¡¹ç›®çš„æ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œæ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º0</p></li><li><p><code>flex-grow</code></p><p>å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œ1æ”¾å¤§ï¼Œ0ä¸æ”¾å¤§</p></li><li><p><code>flex-shrink</code></p><p>å¦‚æœç©ºé—´ä¸è¶³ï¼Œ1ç¼©å°ï¼Œ0ä¸ç¼©å°</p></li><li><p><code>flex-basis</code></p><p>  åŸºç¡€å¤§å°</p></li><li><p><code>flex</code>æ˜¯ä¸Šè¿°ä¸‰ç§çš„ç®€å†™</p><p><code>[flex-grow] [flex-shrink] [flex-basis]</code></p></li><li><p><code>align-self</code></p><p>é‡‡ç”¨ä¸å…¶ä»–å…„å¼Ÿé¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼,å‚è€ƒ<code>[align-item]</code></p><h2 id="å¸ƒå±€å®ä¾‹"><a href="#å¸ƒå±€å®ä¾‹" class="headerlink" title="å¸ƒå±€å®ä¾‹"></a>å¸ƒå±€å®ä¾‹</h2></li></ul><ol><li><p>åœ£æ¯å¸ƒå±€</p><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color:burlywood&quot;</span>&gt;</span>header<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;body&quot;</span>&gt;</span>    <span class="hljs-comment">&lt;!-- æŒ‰ç…§é¡ºåºæ¸²æŸ“ï¼Œå¦‚æœéœ€æå‰ä¿®æ”¹å…ƒç´ orderå±æ€§ï¼Œè¶Šå°è¶Šä¼˜å…ˆ --&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color:chocolate&quot;</span>&gt;</span>nav<span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color:blueviolet&quot;</span>&gt;</span>main<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">aside</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color:cadetblue&quot;</span>&gt;</span>aside<span class="hljs-tag">&lt;/<span class="hljs-name">aside</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">footer</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color:darkslateblue&quot;</span>&gt;</span>footer<span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs css">*&#123;  <span class="hljs-attribute">padding</span>:<span class="hljs-number">0</span>;  <span class="hljs-attribute">margin</span>:<span class="hljs-number">0</span>;&#125;<span class="hljs-selector-tag">body</span>&#123;  <span class="hljs-attribute">display</span>: flex;  <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;  <span class="hljs-comment">/* å‚ç›´æ–¹å‘ */</span>  <span class="hljs-attribute">flex-direction</span>: column;&#125;<span class="hljs-selector-tag">header</span>,<span class="hljs-selector-tag">footer</span>&#123;  <span class="hljs-comment">/* 6em ä¸ºæœ¬èº«çš„å›ºå®šå®½åº¦ */</span>  <span class="hljs-attribute">flex</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">6em</span>;&#125;<span class="hljs-selector-class">.body</span>&#123;  <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;  <span class="hljs-attribute">display</span>: flex;&#125;<span class="hljs-selector-class">.body</span> <span class="hljs-selector-tag">nav</span>,<span class="hljs-selector-class">.body</span> <span class="hljs-selector-tag">aside</span>&#123;  <span class="hljs-comment">/* 10em ä¸ºæœ¬èº«çš„å›ºå®šå®½åº¦ */</span>  <span class="hljs-attribute">flex</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10em</span>;&#125;<span class="hljs-selector-class">.body</span> <span class="hljs-selector-tag">main</span>&#123;  <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>&#125;</code></pre></div></li><li><p>å›ºå®šçš„åº•æ </p><div class="hljs code-wrapper"><pre><code class="hljs css">*&#123;  <span class="hljs-attribute">padding</span>:<span class="hljs-number">0</span>;  <span class="hljs-attribute">margin</span>:<span class="hljs-number">0</span>;&#125;<span class="hljs-selector-tag">body</span>&#123;  <span class="hljs-attribute">display</span>: flex;  <span class="hljs-comment">/* æ”¹å˜flexæœå‘ */</span>  <span class="hljs-attribute">flex-direction</span>:column;  <span class="hljs-comment">/* å æ»¡è§†å£é«˜åº¦ */</span> &lt;----------------  <span class="hljs-attribute">min-height</span>:<span class="hljs-number">100vh</span>;&#125;<span class="hljs-selector-tag">header</span>&#123;  <span class="hljs-attribute">height</span>:<span class="hljs-number">30px</span>;  <span class="hljs-attribute">background</span>: blue;&#125;<span class="hljs-selector-tag">main</span>&#123;  <span class="hljs-comment">/* ä¸»é¢˜å†…å®¹å¡«æ»¡å‰©ä½™ç©ºé—´ */</span>  <span class="hljs-attribute">flex</span>:<span class="hljs-number">1</span>&#125;<span class="hljs-selector-tag">footer</span>&#123;  <span class="hljs-attribute">background</span>:black;&#125;</code></pre></div></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
      <tag>css</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTMLé¢è¯•é¢˜</title>
    <link href="/2022/02/24/html%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/2022/02/24/html%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="HTML5-æ–°ç‰¹æ€§"><a href="#HTML5-æ–°ç‰¹æ€§" class="headerlink" title="HTML5 æ–°ç‰¹æ€§"></a>HTML5 æ–°ç‰¹æ€§</h1><h3 id="ç§»é™¤"><a href="#ç§»é™¤" class="headerlink" title="ç§»é™¤"></a>ç§»é™¤</h3><ul><li><p>çº¯è¡¨ç°çš„å…ƒç´ /å¯ä»¥ç”¨csså®ç°çš„å…ƒç´ ï¼š<code>basefont</code>ï¼Œ<code>big</code>ï¼Œ<code>center</code>ï¼Œ<code>font</code>, <code>s</code>ï¼Œ<code>strike</code></p></li><li><p>å¯¹å¯ç”¨æ€§äº§ç”Ÿè´Ÿé¢å½±å“çš„å…ƒç´ ï¼š<code>frame</code>,<code>frameset</code></p></li><li><p>è¯­æ„åŒ–æ›´å¥½çš„æ ‡ç­¾ï¼Œæ¯”å¦‚<code>header,nav,section,article,footer,aside</code></p></li><li><p>å¢å¼ºäº†<code>input</code>ç±»å‹:<code>color</code>,<code>date</code>,<code>datetime-local</code>,<code>range</code>,<code>tel</code>,<code>search</code>,<code>url</code></p></li><li><p>æ–°çš„è¡¨å•å…ƒç´ :<code>datalist,progress,meter,output,keygen</code></p></li><li><p>è¡¨å•æ ¡éªŒ(æ•°æ®æ ¼å¼ï¼Œæ•°æ®èŒƒå›´ï¼Œå ä½ç¬¦ï¼Œå¿…å¡«ç­‰)</p></li><li><p><code>canvas</code> APIå’Œå†…è” <code>svg</code></p></li><li><p><code>audio/video</code> éŸ³è§†é¢‘å…ƒç´ </p></li><li><p><code>manifest</code>webåº”ç”¨ç¦»çº¿ç¼“å­˜</p></li><li><p>åœ°ç†å®šä½<code>geolocation</code> API</p></li><li><p><code>webworker</code>å°†JSè®¡ç®—äº¤ç»™åå°çº¿ç¨‹</p></li><li><p><code>websocket</code>å…¨åŒå·¥çš„æ”¯æŒæœåŠ¡ç«¯æ¨é€çš„æŒä¹…åŒ–è¿æ¥åè®®</p></li><li><p>webStorageï¼š<code>localStorage sessionStorage</code></p></li><li><p><code>history</code>API</p></li></ul><h3 id="HTML5-å“ªäº›æ ‡ç­¾å¯ä»¥åš-SEO"><a href="#HTML5-å“ªäº›æ ‡ç­¾å¯ä»¥åš-SEO" class="headerlink" title="HTML5 å“ªäº›æ ‡ç­¾å¯ä»¥åš SEO"></a>HTML5 å“ªäº›æ ‡ç­¾å¯ä»¥åš SEO</h3><p><code>titleã€metaã€headerã€footerã€navã€articleã€aside</code></p><h1 id="metaå…ƒæ•°æ®æ ‡ç­¾"><a href="#metaå…ƒæ•°æ®æ ‡ç­¾" class="headerlink" title="metaå…ƒæ•°æ®æ ‡ç­¾"></a>metaå…ƒæ•°æ®æ ‡ç­¾</h1><ul><li><code>charset</code> å­—ç¬¦ç¼–ç </li><li><code>keywords</code>å…³é”®è¯å’Œçˆ¬è™«</li><li><code>viewport</code> scaleé¡µé¢ç¼©æ”¾</li><li><code>CSP</code>å†…å®¹å®‰å…¨ç­–ç•¥</li></ul><h1 id="HTML5-çš„ç¦»çº¿å­˜å‚¨"><a href="#HTML5-çš„ç¦»çº¿å­˜å‚¨" class="headerlink" title="HTML5 çš„ç¦»çº¿å­˜å‚¨"></a>HTML5 çš„ç¦»çº¿å­˜å‚¨</h1><p>åœ¨ç”¨æˆ·æ²¡æœ‰è”ç½‘æ—¶ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®ç«™ç‚¹æˆ–åº”ç”¨ï¼›åœ¨è”ç½‘çš„æƒ…å†µä¸‹ï¼Œæ›´æ–°ç”¨æˆ·æœºå™¨ä¸Šçš„ç¼“å­˜æ–‡ä»¶ã€‚</p><ol><li>é¡µé¢å¤´éƒ¨åŠ å…¥ä¸€ä¸ª manifest çš„å±æ€§</li><li>åœ¨ cache.manifest æ–‡ä»¶çš„ç¼–å†™ç¦»çº¿å­˜å‚¨çš„èµ„æº</li><li>åœ¨ç¦»çº¿çŠ¶æ€ä¸‹ï¼Œæ“ä½œ window.applicationCache è¿›è¡Œéœ€æ±‚å®ç°</li></ol><h4 id="æµè§ˆå™¨æ˜¯å¦‚ä½•å¯¹-HTML5-çš„ç¦»çº¿å­˜å‚¨èµ„æºè¿›è¡Œç®¡ç†å’ŒåŠ è½½çš„"><a href="#æµè§ˆå™¨æ˜¯å¦‚ä½•å¯¹-HTML5-çš„ç¦»çº¿å­˜å‚¨èµ„æºè¿›è¡Œç®¡ç†å’ŒåŠ è½½çš„" class="headerlink" title="æµè§ˆå™¨æ˜¯å¦‚ä½•å¯¹ HTML5 çš„ç¦»çº¿å­˜å‚¨èµ„æºè¿›è¡Œç®¡ç†å’ŒåŠ è½½çš„"></a>æµè§ˆå™¨æ˜¯å¦‚ä½•å¯¹ HTML5 çš„ç¦»çº¿å­˜å‚¨èµ„æºè¿›è¡Œç®¡ç†å’ŒåŠ è½½çš„</h4><ul><li><p>åœ¨çº¿çš„æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å‘ç° HTML å¤´éƒ¨æœ‰ manifest å±æ€§ï¼Œå®ƒä¼šè¯·æ±‚ manifest æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è®¿é—® appï¼Œæµè§ˆå™¨ä¼šæ ¹æ® manifest æ–‡ä»¶çš„å†…å®¹ä¸‹è½½ç›¸åº”çš„èµ„æºå¹¶ä¸”è¿›è¡Œç¦»çº¿å­˜å‚¨ã€‚</p></li><li><p>å¦‚æœå·²ç»è®¿é—®è¿‡ appï¼Œå¹¶ä¸”èµ„æºå·²ç»ç¦»çº¿å­˜å‚¨ï¼Œæµè§ˆå™¨ä¼šä½¿ç”¨ç¦»çº¿çš„èµ„æºåŠ è½½é¡µé¢ï¼Œç„¶åæµè§ˆå™¨ä¼šå¯¹æ¯”æ–°çš„ manifest æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¸åšä»»ä½•æ“ä½œï¼Œå¦åˆ™å°±ä¼šé‡æ–°ä¸‹è½½æ–‡ä»¶ä¸­çš„èµ„æºå¹¶è¿›è¡Œç¦»çº¿å­˜å‚¨ã€‚</p></li><li><p>ç¦»çº¿çš„æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ç›´æ¥ä½¿ç”¨ç¦»çº¿å­˜å‚¨çš„èµ„æºã€‚</p></li></ul><h1 id="ç›’æ¨¡å‹"><a href="#ç›’æ¨¡å‹" class="headerlink" title="ç›’æ¨¡å‹"></a>ç›’æ¨¡å‹</h1><p>HTML æ–‡æ¡£ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ä½¿ç”¨ä¸€ä¸ªçŸ©å½¢ç›’å­æ¥æè¿°å…¶å ç”¨ç©ºé—´ï¼Œè¿™ä¸ªæ¨¡å‹ç§°ä¸ºç›’æ¨¡å‹ã€‚ç›’æ¨¡å‹åŒ…å«å››ä¸ªåŒºåŸŸï¼š<code>margin</code>ï¼ˆå¤–è¾¹è·ï¼‰ï¼Œ<code>border</code>ï¼ˆè¾¹æ¡†ï¼‰ï¼Œ<code>padding</code>ï¼ˆå†…è¾¹è·ï¼‰ï¼Œ<code>content</code>ï¼ˆå†…å®¹åŒºåŸŸï¼‰</p><blockquote><p>outlineå’Œbox-shadowéƒ½ä¼šä»margin boxåŒºåŸŸå¼€å§‹è®¡ç®—</p></blockquote><h2 id="æ ‡å‡†æ¨¡å‹å’Œ-IE-æ¨¡å‹"><a href="#æ ‡å‡†æ¨¡å‹å’Œ-IE-æ¨¡å‹" class="headerlink" title="æ ‡å‡†æ¨¡å‹å’Œ IE æ¨¡å‹"></a>æ ‡å‡†æ¨¡å‹å’Œ IE æ¨¡å‹</h2><ul><li>æ ‡å‡†æ¨¡å‹<code>box-sizing:content-box</code>,å¯¹å…¶è®¾ç½®å®½é«˜åªä½œç”¨äº<code>content box</code>åŒºåŸŸ</li><li>ie æ¨¡å‹<code>box-sizing:border-box</code>,å¯¹å…¶è®¾ç½®å®½é«˜ä¼šä½œç”¨äº<code>content box</code>,<code>padding box</code>å’Œ <code>border box</code>åŒºåŸŸ</li></ul><h2 id="å—çº§å…ƒç´ "><a href="#å—çº§å…ƒç´ " class="headerlink" title="å—çº§å…ƒç´ "></a>å—çº§å…ƒç´ </h2><p><code>display block</code></p><ol><li><p>ç‹¬å ä¸€è¡Œ</p></li><li><p>å¯ä»¥è®¾ç½® widthï¼Œheightï¼Œmarginï¼Œpaddingï¼Œborder å±æ€§</p></li><li><p>é»˜è®¤å®½åº¦æ˜¯å®¹å™¨çš„ 100%</p></li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript">article; <span class="hljs-comment">// h5</span>div;header; <span class="hljs-comment">// h5</span>section; <span class="hljs-comment">// h5</span>address; <span class="hljs-comment">// h5</span>ol;ul;aside; <span class="hljs-comment">// h5</span>footer; <span class="hljs-comment">// h5</span>audio; <span class="hljs-comment">// h5</span>video; <span class="hljs-comment">// h5</span>canvas; <span class="hljs-comment">// h5</span>hgroup; <span class="hljs-comment">// h5</span>p;h1 - h6;table;form;</code></pre></div><h2 id="è¡Œå†…å…ƒç´ "><a href="#è¡Œå†…å…ƒç´ " class="headerlink" title="è¡Œå†…å…ƒç´ "></a>è¡Œå†…å…ƒç´ </h2><p><code>display inline</code></p><ol><li>è¡Œå†…æ’åˆ—</li><li>ä¸èƒ½è®¾ç½® <code>width</code>ã€<code>height</code>,é»˜è®¤é«˜åº¦å’Œå®½åº¦å°±æ˜¯å†…å®¹çš„é«˜åº¦å’Œå®½åº¦</li><li>å¯ä»¥è®¾ç½® <code>margin-left/right</code>ï¼Œæ— æ³•è®¾ç½® <code>margin-top\bottom</code></li><li><code>border</code> å’Œ <code>padding</code> å¯ä»¥è®¾ç½®ï¼Œä½†æ˜¯ <code>border-top</code> å’Œ <code>padding-top</code> åˆ°é¡µé¢é¡¶éƒ¨åå°±ä¸å†å¢åŠ </li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript">img; <span class="hljs-comment">//å¯ä»¥è®¾ç½®å®½é«˜</span>span;label;strong;a;input; <span class="hljs-comment">//å¯ä»¥è®¾ç½®å®½é«˜</span>select; <span class="hljs-comment">//å¯ä»¥è®¾ç½®å®½é«˜</span>textarea; <span class="hljs-comment">//å¯ä»¥è®¾ç½®å®½é«˜</span></code></pre></div><h2 id="è¡Œå†…å—å…ƒç´ "><a href="#è¡Œå†…å—å…ƒç´ " class="headerlink" title="è¡Œå†…å—å…ƒç´ "></a>è¡Œå†…å—å…ƒç´ </h2><p><code>display line-block</code></p><p>åœ¨è¡Œå†…æ’åˆ—çš„å—çº§å…ƒç´ </p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å…¼å®¹</span>div &#123;    displayï¼š inline-blockï¼›    zoomï¼š <span class="hljs-number">1</span>ï¼›   <span class="hljs-comment">//åœ¨IEä¸‹è§¦å‘hasLayout</span>    displayï¼šinlineï¼›<span class="hljs-comment">//ä¸€æ—¦è§¦å‘äº†hasLayoutè®¾ç½®displayï¼šinlineå’Œdisplayï¼šblockæ•ˆæœç›¸ä¼¼ã€‚</span>&#125;</code></pre></div><h1 id="DOMå…ƒç´ çš„å°ºå¯¸å’Œä½ç½®"><a href="#DOMå…ƒç´ çš„å°ºå¯¸å’Œä½ç½®" class="headerlink" title="DOMå…ƒç´ çš„å°ºå¯¸å’Œä½ç½®"></a>DOMå…ƒç´ çš„å°ºå¯¸å’Œä½ç½®</h1><ol><li><p><code>HTMLElement.style</code>ã€åªèƒ½è·å–å†…è”æ ·å¼ã€‘</p></li><li><p><code>window.getComputedStyle(HTMLElement)</code>ã€è·å–åŒ…å«æ‰€æœ‰æ ·å¼å±æ€§çš„å¯¹è±¡</p></li><li><p><code>HTMLElement.getBoundingClientRect()</code>ã€æç»˜å…ƒç´ ä¸ºç›¸å¯¹çª—å£çš„çŸ©å½¢ç›’å­ã€‘</p></li><li><p><code>HTMLElement.offsetWidth/offsetHeight </code> ã€content+padding+border+scrollbarã€‘</p></li><li><p><code>HTMLElement.clientWidth/clientHeight</code> ã€content+paddingã€‘</p></li><li><p><code>HTMLElement.scrollWidth/scrollHeight </code>// ã€åŒ…å«æ»šå‡ºå¯æ˜¯åŒºåŸŸéƒ¨åˆ†çš„clientWidth/clientHeightã€‘</p></li><li><p><code>HTMLElement.scrollTop</code>// ã€ä»å…ƒç´ çš„å·¦ä¸Šè§’å¼€å§‹ï¼Œæ»šåŠ¨å‡ºå…ƒç´ çš„ä¸ŠåŠéƒ¨åˆ†çš„ width/heightã€‘</p></li></ol><p>ï¼æ»šåŠ¨åˆ°åº•</p><blockquote><p>ele.scrollHeight - ele.scrollTop === ele.clientHeight</p></blockquote><p>ï¼å…ƒç´ è¿›å…¥å¯è§†èŒƒå›´(æ‡’åŠ è½½)</p><blockquote><p>è¦åŠ è½½å…ƒç´ çš„.offsetTop - å®¹å™¨.scrollTop &lt;= document.documentElement.clientHeight</p></blockquote><blockquote><p>è¦åŠ è½½å…ƒç´ getBoundingClientRect()åçš„top &lt;= document.documentElement.clientHeight<br>ï¼jsè·å–è¿™äº›å±æ€§ä¼šè§¦å‘é‡æ’</p></blockquote><h1 id="BFC"><a href="#BFC" class="headerlink" title="BFC"></a>BFC</h1><p>ï¼ˆBlock Formatting Contextï¼‰ å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡,æ˜¯ä¸€ä¸ªå¯¹å—çº§ç›’å­çš„å¸ƒå±€åŠæµ®åŠ¨ç›¸äº’å½±å“æœ‰ç‰¹æ®Šè§„åˆ™çš„åŒºåŸŸ</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><blockquote><p>ä¸€å¥è¯å°±æ˜¯BFCå†…å¤–ä¸ä¼šäº’ç›¸å½±å“ã€‚ã€‚ã€‚</p></blockquote><ul><li><p>BFCå†…ç›’å­ä¹‹é—´ä¼šå‘ç”Ÿå¤–è¾¹è·åˆå¹¶</p></li><li><p>BFCå†…æµ®åŠ¨å…ƒç´ å‚ä¸é«˜åº¦è®¡ç®—ï¼ˆé«˜åº¦å¡Œé™·ï¼‰</p></li><li><p>BFCå†…ç›’å­ä¸ä¼šè¶…å‡ºBFCè¾¹ç•Œï¼ˆæµ®åŠ¨è¦†ç›–ï¼‰</p><h3 id="ä¸‹åˆ—æ–¹å¼ä¼šåˆ›å»ºBFCï¼š"><a href="#ä¸‹åˆ—æ–¹å¼ä¼šåˆ›å»ºBFCï¼š" class="headerlink" title="ä¸‹åˆ—æ–¹å¼ä¼šåˆ›å»ºBFCï¼š"></a>ä¸‹åˆ—æ–¹å¼ä¼šåˆ›å»ºBFCï¼š</h3><ul><li>æ ¹å…ƒç´ <code>HTML</code></li><li>æµ®åŠ¨å…ƒç´ ï¼š<code>float</code> ä¸ä¸º <code>none</code></li><li>ç»å¯¹å®šä½å…ƒç´ ï¼š<code>position</code> ä¸º <code>absolute</code> æˆ– <code>fixed</code></li><li><code>overflow</code> ä¸ä¸º <code>visible</code></li><li><code>display</code> ä¸º <code>flow-root</code></li><li>è¡Œå†…å—å…ƒç´ <code>display</code> ä¸º <code>inline-block</code></li><li>å¼¹æ€§å…ƒç´ <code>display</code> ä¸º <code>flex</code> æˆ– <code>inline-flex</code> å…ƒç´ çš„ç›´æ¥å­å…ƒç´ </li><li>ç½‘æ ¼å…ƒç´ <code>display</code> ä¸º <code>grid</code> æˆ– <code>inline-grid</code> å…ƒç´ çš„ç›´æ¥å­å…ƒç´ </li><li>è¡¨æ ¼å…ƒç´ <code>display</code> ä¸º <code>table``table-cell</code>æˆ–<code>table-xxx</code>ç­‰åŒ¿åè¡¨æ ¼å…ƒç´ </li></ul></li></ul><h3 id="æ¸…é™¤æµ®åŠ¨"><a href="#æ¸…é™¤æµ®åŠ¨" class="headerlink" title="æ¸…é™¤æµ®åŠ¨"></a>æ¸…é™¤æµ®åŠ¨</h3><ul><li>ç”¨çˆ¶å…ƒç´ ä¼ªç±»æ¸…é™¤æµ®åŠ¨</li></ul><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-comment">/* é€šç”¨ */</span><span class="hljs-selector-class">.clearfather</span>:after &#123;  content: <span class="hljs-string">&quot;&quot;</span>;  <span class="hljs-attribute">clear</span>: both;  <span class="hljs-attribute">display</span>: block;  <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;  <span class="hljs-attribute">overflow</span>: hidden;&#125;<span class="hljs-selector-class">.clearfather</span> &#123;  *zoom: <span class="hljs-number">1</span>; <span class="hljs-comment">/* ie6/7 */</span>&#125;</code></pre></div><ul><li>ç©º div æ¸…é™¤æµ®åŠ¨</li></ul><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-selector-class">.clearfloat</span> &#123;  <span class="hljs-attribute">clear</span>: both;&#125;</code></pre></div><ul><li>çˆ¶å…ƒç´  BFC</li></ul><p>è®¾ç½®èƒ½è§¦å‘ BFC çš„å±æ€§å‡å¯</p><h1 id="è¶…é“¾æ¥ä¼ªç±»é¡ºåº"><a href="#è¶…é“¾æ¥ä¼ªç±»é¡ºåº" class="headerlink" title="è¶…é“¾æ¥ä¼ªç±»é¡ºåº"></a>è¶…é“¾æ¥ä¼ªç±»é¡ºåº</h1><p>è¢«ç‚¹å‡»è®¿é—®è¿‡çš„è¶…é“¾æ¥æ ·å¼ä¸åœ¨å…·æœ‰ hover å’Œ active äº†è§£å†³æ–¹æ³•æ˜¯æ”¹å˜ CSS å±æ€§æ’åˆ—é¡ºåº: <code>L-V-H-A</code></p><div class="hljs code-wrapper"><pre><code class="hljs CSS"><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:link</span> &#123;&#125;<span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:visited</span> &#123;&#125;<span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span> &#123;&#125;<span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:active</span> &#123;&#125;</code></pre></div><h1 id="ä¼˜é›…é™çº§å’Œæ¸è¿›å¢å¼º"><a href="#ä¼˜é›…é™çº§å’Œæ¸è¿›å¢å¼º" class="headerlink" title="ä¼˜é›…é™çº§å’Œæ¸è¿›å¢å¼º"></a>ä¼˜é›…é™çº§å’Œæ¸è¿›å¢å¼º</h1><p>_ä¼˜é›…é™çº§_ï¼šWeb ç«™ç‚¹åœ¨æ‰€æœ‰æ–°å¼æµè§ˆå™¨ä¸­éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œå¦‚æœç”¨æˆ·ä½¿ç”¨çš„æ˜¯æ—§å¼æµè§ˆå™¨ï¼Œåˆ™ä»£ç ä¼šé’ˆå¯¹æ—§ç‰ˆæœ¬çš„ IE è¿›è¡Œé™çº§å¤„ç†ï¼Œä½¿ä¹‹åœ¨æ—§å¼æµè§ˆå™¨ä¸Šä»¥æŸç§å½¢å¼é™çº§ä½“éªŒè€Œä¸è‡³äºå®Œå…¨ä¸èƒ½ä½¿ç”¨ã€‚</p><p>_æ¸è¿›å¢å¼º_ï¼šä»è¢«æ‰€æœ‰æµè§ˆå™¨æ”¯æŒçš„åŸºæœ¬åŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥åœ°æ·»åŠ é‚£äº›åªæœ‰æ–°ç‰ˆæœ¬æµè§ˆå™¨æ‰æ”¯æŒçš„åŠŸèƒ½ï¼Œå‘é¡µé¢å¢åŠ ä¸å½±å“åŸºç¡€æµè§ˆå™¨çš„é¢å¤–æ ·å¼å’ŒåŠŸèƒ½ã€‚å½“æµè§ˆå™¨æ”¯æŒæ—¶ï¼Œå®ƒä»¬ä¼šè‡ªå®šåœ°å‘ˆç°å‡ºæ¥å¹¶å‘æŒ¥ä½œç”¨ã€‚</p><h1 id="å¸¸è§ç©º-VOID-å…ƒç´ "><a href="#å¸¸è§ç©º-VOID-å…ƒç´ " class="headerlink" title="å¸¸è§ç©º VOID å…ƒç´ "></a>å¸¸è§ç©º VOID å…ƒç´ </h1><p><code>brã€hrã€imgã€inputã€linkã€meta</code></p><h1 id="window-load-å’Œ-DOMContentLoaded-çš„åŒºåˆ«"><a href="#window-load-å’Œ-DOMContentLoaded-çš„åŒºåˆ«" class="headerlink" title="window.load å’Œ DOMContentLoaded çš„åŒºåˆ«"></a><code>window.load</code> å’Œ <code>DOMContentLoaded</code> çš„åŒºåˆ«</h1><ul><li><code>window.load</code>å½“æ•´ä¸ªé¡µé¢åŠæ‰€æœ‰ä¾èµ–èµ„æºå¦‚æ ·å¼è¡¨å’Œå›¾ç‰‡éƒ½å·²å®ŒæˆåŠ è½½æ—¶ï¼Œå°†è§¦å‘loadäº‹ä»¶ã€‚</li><li><code>DOMContentLoaded</code>ä»…å½“HTMLå’Œå†…è”å¤–è”jsè„šæœ¬åŠ è½½å¹¶åŒæ­¥ä»£ç éƒ½æ‰§è¡Œå®Œã€‚</li></ul><h1 id="visibilityState"><a href="#visibilityState" class="headerlink" title="visibilityState"></a><code>visibilityState</code></h1><p>é€šè¿‡<code>visibilityState</code>çš„å€¼æ£€æµ‹é¡µé¢å½“å‰æ˜¯å¦å¯è§ï¼Œä»¥åŠæ‰“å¼€é¡µé¢çš„æ—¶é—´ç­‰<br>åœ¨é¡µé¢è¢«åˆ‡æ¢åˆ°å…¶ä»–åå°è¿›ç¨‹çš„æ—¶å€™ï¼Œè‡ªåŠ¨æš‚åœéŸ³ä¹æˆ–è§†é¢‘çš„æ’­æ”¾</p><h1 id="å¤–è¾¹è·é‡å "><a href="#å¤–è¾¹è·é‡å " class="headerlink" title="å¤–è¾¹è·é‡å "></a>å¤–è¾¹è·é‡å </h1><ol><li>åŒå±‚ç›¸é‚»å—çº§å…ƒç´ ä¹‹é—´å¤–è¾¹è·é‡å </li><li>å­å…ƒç´ ä¸çˆ¶å…ƒç´ çš„å¤–è¾¹è·é‡å </li><li>ç©ºå…ƒç´ (margin-topç›´æ¥è´´åˆ°margin-bottomæ—¶)</li></ol><h1 id="link-å’Œ-import-æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#link-å’Œ-import-æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="link å’Œ@import æœ‰ä»€ä¹ˆåŒºåˆ«"></a>link å’Œ@import æœ‰ä»€ä¹ˆåŒºåˆ«</h1><ul><li><p><code>link</code>  æ˜¯ XHTML æ ‡ç­¾ï¼Œé™¤äº†åŠ è½½ CSS å¤–ï¼Œè¿˜å¯ä»¥å®šä¹‰ RSS ï¼Œrelå’Œå›¾æ ‡ç­‰ï¼›<code>@import</code> åªèƒ½åŠ è½½ CSSã€‚</p></li><li><p><code>link</code> æ”¯æŒå¹¶è¡Œä¸‹è½½ï¼›<code>@import</code> ä¸²è¡Œä¸‹è½½ä¸”éœ€æ”¾åœ¨æ ·å¼è¡¨é¡¶å±‚ã€‚</p></li><li><p><code>@import</code> æ˜¯åœ¨ CSS2.1 æå‡ºçš„ï¼Œä½ç‰ˆæœ¬çš„æµè§ˆå™¨ï¼ˆIE5 ä»¥ä¸‹ï¼‰ä¸æ”¯æŒã€‚</p></li><li><p><code>link</code> æ”¯æŒä½¿ç”¨ Javascript æ§åˆ¶ DOM å»æ”¹å˜æ ·å¼ï¼›è€Œ<code>@import</code> ä¸æ”¯æŒã€‚</p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
      <tag>HTML</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jsæ•°æ®ç±»å‹çš„åˆ¤æ–­ä¸è½¬æ¢</title>
    <link href="/2022/02/24/js%E4%B8%AD%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/"/>
    <url>/2022/02/24/js%E4%B8%AD%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="ECAMScript-ä¸­ä¸èƒ½è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œåªèƒ½ä¸ºä¸‹åˆ—-7-ç§"><a href="#ECAMScript-ä¸­ä¸èƒ½è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œåªèƒ½ä¸ºä¸‹åˆ—-7-ç§" class="headerlink" title="ECAMScript ä¸­ä¸èƒ½è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œåªèƒ½ä¸ºä¸‹åˆ— 7 ç§"></a>ECAMScript ä¸­ä¸èƒ½è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œåªèƒ½ä¸ºä¸‹åˆ— 7 ç§</h1><h2 id="ç®€å•æ•°æ®ç±»å‹ï¼ˆåŸå§‹ç±»å‹ï¼‰"><a href="#ç®€å•æ•°æ®ç±»å‹ï¼ˆåŸå§‹ç±»å‹ï¼‰" class="headerlink" title="ç®€å•æ•°æ®ç±»å‹ï¼ˆåŸå§‹ç±»å‹ï¼‰"></a>ç®€å•æ•°æ®ç±»å‹ï¼ˆåŸå§‹ç±»å‹ï¼‰</h2><ul><li><p><code>String</code></p></li><li><p><code>Number</code></p><ul><li><code>NaN</code><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">typeof</span> <span class="hljs-literal">NaN</span> === <span class="hljs-string">&#x27;number&#x27;</span>å”¯ä¸€ä¸€ä¸ªè‡ªç›¸åçš„å€¼<span class="hljs-literal">NaN</span> !== <span class="hljs-literal">NaN</span></code></pre></div></li></ul></li><li><p><code>Boolean</code></p><ul><li>åœ¨æ¡ä»¶åˆ¤æ–­æ—¶ï¼Œé™¤äº† <code>undefined</code>ï¼Œ <code>null</code>ï¼Œ <code>false</code>ï¼Œ <code>NaN</code>ï¼Œ <code>&#39;&#39;</code>ï¼Œ <code>0</code>ï¼Œ <code>-0</code>ï¼Œå…¶ä»–æ‰€æœ‰å€¼éƒ½è½¬ä¸º trueï¼ŒåŒ…æ‹¬æ‰€æœ‰å¯¹è±¡ã€‚</li><li>å¸ƒå°”å€¼ä¸å…¶ä»–ç±»å‹æ¯”è¾ƒéƒ½ä¼šè½¬ä¸ºæ•°å­—</li></ul></li><li><p><code>null</code></p><ul><li><code>typeof null = object</code>,<em>null è¡¨ç¤ºä¸€ä¸ªç©ºå¯¹è±¡æŒ‡é’ˆ</em></li><li>null å¿…é¡»æ‰‹åŠ¨è®¾ç½®ï¼Œå¸¸ç”¨äºä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¯´æ˜è¯¥å‚æ•°ä¸æ˜¯å¯¹è±¡</li><li>è®¾ç½®ä¸º null çš„å˜é‡æˆ–è€…å¯¹è±¡ä¼šè¢«å†…å­˜æ”¶é›†å™¨å›æ”¶</li><li><code>null</code> è½¬ä¸ºæ•°å­—ç±»å‹å€¼ä¸º <code>0</code></li></ul></li></ul><ul><li><p><code>undefined</code></p><ul><li>è°ƒç”¨ä¸€ä¸ªå€¼è€Œå®ƒæœ¬èº«æ²¡æœ‰èµ‹å€¼</li><li><code>undefined == null</code> </li><li><code>undefined</code> è½¬ä¸ºæ•°å­—ç±»å‹ä¸º <code>NaN</code></li></ul></li><li><p><code>Symbol</code>[ES6 æ–°å¢]</p><ul><li>è¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼</li></ul></li></ul><h2 id="å¤æ‚ç±»å‹"><a href="#å¤æ‚ç±»å‹" class="headerlink" title="å¤æ‚ç±»å‹"></a>å¤æ‚ç±»å‹</h2><p><code>Object</code></p><ul><li>å¼•ç”¨ç±»å‹çš„å€¼æ˜¯æŒ‡å‘ä¿å­˜åœ¨å †ä¸­çš„å¯¹è±¡çš„æŒ‡é’ˆ</li><li>ä½¿ç”¨æ—¶è¦å…ˆä»æ ˆä¸­è¯»å–å†…å­˜åœ°å€ï¼Œå†æ²¿ç€æŒ‡é’ˆæ‰¾åˆ°å †ä¸­çš„å¯¹è±¡</li><li>Object</li><li>Array<ul><li>æ•°ç»„çš„æ¯ä¸€é¡¹å¯ä»¥ç”¨æ¥ä¿å­˜ä»»ä½•ç±»å‹çš„æ•°æ®</li></ul></li><li>Function<ul><li>æ¯ä¸ªå‡½æ•°éƒ½æ˜¯ Function çš„å®ä¾‹</li></ul></li></ul><h1 id="ç±»å‹åˆ¤æ–­"><a href="#ç±»å‹åˆ¤æ–­" class="headerlink" title="ç±»å‹åˆ¤æ–­"></a>ç±»å‹åˆ¤æ–­</h1><h2 id="typeOf"><a href="#typeOf" class="headerlink" title="typeOf"></a><code>typeOf</code></h2><ul><li>å¯¹æœªå£°æ˜çš„å˜é‡ï¼Œåªæœ‰å¯¹å®ƒè°ƒç”¨<code>typeof</code>ä¸æŠ¥é”™ï¼Œreturn <code>undefined</code></li><li>ç‰¹æ®Šçš„å‡ ä¸ª</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">typeof</span> <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// &#x27;undefined&#x27;</span><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Symbol</span>(); <span class="hljs-comment">// &#x27;symbol&#x27;</span><span class="hljs-keyword">typeof</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// &#x27;object&#x27;</span><span class="hljs-keyword">typeof</span> <span class="hljs-literal">NaN</span>; <span class="hljs-comment">// number</span></code></pre></div><h2 id="isNaN"><a href="#isNaN" class="headerlink" title="isNaN"></a><code>isNaN</code></h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">isNaN</span>(<span class="hljs-literal">NaN</span>));    <span class="hljs-comment">//true</span><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">isNaN</span>(<span class="hljs-number">10</span>));     <span class="hljs-comment">//false</span><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">isNaN</span>(<span class="hljs-string">&quot;10&quot;</span>));   <span class="hljs-comment">//false</span><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">isNaN</span>(<span class="hljs-string">&quot;blue&quot;</span>)); <span class="hljs-comment">//true</span><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">isNaN</span>(<span class="hljs-literal">true</span>));   <span class="hljs-comment">//false</span></code></pre></div><h2 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a><code>instanceof</code></h2><p><code>instanceof</code> è¿ç®—ç¬¦ç”¨æ¥æµ‹è¯•ä¸€ä¸ª<em>å¯¹è±¡</em>åœ¨å…¶åŸå‹é“¾ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ„é€ å‡½æ•°çš„ <code>prototype</code> å±æ€§ï¼Œä½†å®ƒä¸èƒ½æ£€æµ‹<code>null</code> å’Œ <code>undefined</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript">[] <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span> <span class="hljs-comment">// true</span>&#123;&#125; <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Object</span> <span class="hljs-comment">// true</span><span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span> <span class="hljs-comment">// true</span><span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>() <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span> <span class="hljs-comment">// true</span><span class="hljs-literal">null</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-literal">null</span> <span class="hljs-comment">// error</span><span class="hljs-literal">undefined</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-literal">undefined</span> <span class="hljs-comment">// error</span></code></pre></div><h2 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a><code>constructor</code></h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> arr = [];<span class="hljs-keyword">const</span> obj = &#123;&#125;;<span class="hljs-built_in">console</span>.log(arr.constructor); <span class="hljs-comment">// [Function: Array]</span><span class="hljs-built_in">console</span>.log(obj.constructor); <span class="hljs-comment">// [Function: Object]</span></code></pre></div><h2 id="Object-prototype-toString-call"><a href="#Object-prototype-toString-call" class="headerlink" title="Object.prototype.toString.call()"></a><code>Object.prototype.toString.call()</code></h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Object</span>.prototype.toString.call(); <span class="hljs-comment">// [object Undefined]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-string">&quot;&quot;</span>); <span class="hljs-comment">// [object String]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-number">1</span>); <span class="hljs-comment">// [object Number]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-literal">true</span>); <span class="hljs-comment">// [object Boolean]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-literal">undefined</span>); <span class="hljs-comment">// [object Undefined]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-literal">null</span>); <span class="hljs-comment">// [object Null]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Function</span>()); <span class="hljs-comment">// [object Function]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()); <span class="hljs-comment">// [object Date]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>()); <span class="hljs-comment">// [object RegExp]</span><span class="hljs-built_in">Object</span>.prototype.toString.call([]); <span class="hljs-comment">// [object Array]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(&#123;&#125;); <span class="hljs-comment">// [object Object]</span><span class="hljs-built_in">Object</span>.prototype.toString.call(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>()); <span class="hljs-comment">// [object Error]</span></code></pre></div><h1 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h1><h2 id="è½¬ä¸ºæ•°å€¼"><a href="#è½¬ä¸ºæ•°å€¼" class="headerlink" title="è½¬ä¸ºæ•°å€¼"></a>è½¬ä¸ºæ•°å€¼</h2><h3 id="Number-é€‚ç”¨äºä»»ä½•ç±»å‹"><a href="#Number-é€‚ç”¨äºä»»ä½•ç±»å‹" class="headerlink" title="Number() é€‚ç”¨äºä»»ä½•ç±»å‹"></a>Number() é€‚ç”¨äºä»»ä½•ç±»å‹</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num1 = <span class="hljs-built_in">Number</span>(<span class="hljs-string">&quot;Hello world!&quot;</span>);  <span class="hljs-comment">// NaN</span><span class="hljs-keyword">let</span> num2 = <span class="hljs-built_in">Number</span>(<span class="hljs-string">&quot;&quot;</span>); <span class="hljs-comment">// 0</span><span class="hljs-keyword">let</span> num3 = <span class="hljs-built_in">Number</span>(<span class="hljs-string">&quot;000011&quot;</span>); <span class="hljs-comment">// 11</span><span class="hljs-keyword">let</span> num4 = <span class="hljs-built_in">Number</span>(<span class="hljs-literal">true</span>); <span class="hljs-comment">// 1</span></code></pre></div><h3 id="parseInt-string-radix-ä¸»è¦ç”¨äºå­—ç¬¦ä¸²"><a href="#parseInt-string-radix-ä¸»è¦ç”¨äºå­—ç¬¦ä¸²" class="headerlink" title="parseInt(string, radix) ä¸»è¦ç”¨äºå­—ç¬¦ä¸²"></a>parseInt(string, radix) ä¸»è¦ç”¨äºå­—ç¬¦ä¸²</h3><ul><li>å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯æ•°å€¼å­—ç¬¦ã€åŠ å·æˆ–å‡å·ï¼Œç«‹å³è¿”å›NaN<br>,è¿™æ„å‘³ç€ç©ºå­—ç¬¦ä¸²ä¹Ÿä¼šè¿”å› NaN<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num2 = <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&quot;&quot;</span>);  <span class="hljs-comment">// NaN</span><span class="hljs-keyword">let</span> num3 = <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&quot;0xA&quot;</span>); <span class="hljs-comment">// 10</span><span class="hljs-keyword">let</span> num4 = <span class="hljs-built_in">parseInt</span>(<span class="hljs-number">22.5</span>); <span class="hljs-comment">//22</span><span class="hljs-keyword">let</span> num5 = <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&quot;abc&quot;</span>); <span class="hljs-comment">// NaN</span><span class="hljs-keyword">let</span> num6 = <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&quot;123abc&quot;</span>) <span class="hljs-comment">// 123</span>[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>].map(<span class="hljs-built_in">parseInt</span>)<span class="hljs-comment">//Â [1, NaN, NaN]</span><span class="hljs-comment">// mapè°ƒç”¨çš„å›è°ƒä¼šé»˜è®¤ä¼ å…¥ä¸‰ä¸ªå‚æ•°ã€å½“å‰å…ƒç´ ï¼Œå½“å‰ç´¢å¼•ï¼Œå½“å‰æ•°ç»„ã€‘</span><span class="hljs-comment">// parseInt(1,0) =&gt; 1</span><span class="hljs-comment">// parseInt(2,1) =&gt; radix&gt;=2,NaN</span><span class="hljs-comment">// parseInt(3,2) =&gt; æœ¨æœ‰äºŒè¿›åˆ¶è¡¨ç¤ºçš„3,NaN</span></code></pre></div><h3 id="parseFloat-string-ä¸»è¦ç”¨äºå­—ç¬¦ä¸²"><a href="#parseFloat-string-ä¸»è¦ç”¨äºå­—ç¬¦ä¸²" class="headerlink" title="parseFloat(string) ä¸»è¦ç”¨äºå­—ç¬¦ä¸²"></a>parseFloat(string) ä¸»è¦ç”¨äºå­—ç¬¦ä¸²</h3></li><li>åªè§£æåè¿›åˆ¶</li><li>å¿½ç•¥2æ¬¡å‡ºç°çš„å°æ•°ç‚¹<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num1 = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-string">&quot;1234blue&quot;</span>); <span class="hljs-comment">// 1234</span><span class="hljs-keyword">let</span> num2 = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-string">&quot;0xA&quot;</span>); <span class="hljs-comment">// 0</span><span class="hljs-keyword">let</span> num3 = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-string">&quot;22.5&quot;</span>); <span class="hljs-comment">// 22.5</span><span class="hljs-keyword">let</span> num4 = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-string">&quot;22.34.5&quot;</span>); <span class="hljs-comment">// 22.34</span><span class="hljs-keyword">let</span> num5 = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-string">&quot;0908.5&quot;</span>);  <span class="hljs-comment">//908.5</span><span class="hljs-keyword">let</span> num6 = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-string">&quot;3.125e7&quot;</span>); <span class="hljs-comment">// 31250000</span></code></pre></div></li></ul><h2 id="è½¬ä¸ºå­—ç¬¦ä¸²"><a href="#è½¬ä¸ºå­—ç¬¦ä¸²" class="headerlink" title="è½¬ä¸ºå­—ç¬¦ä¸²"></a>è½¬ä¸ºå­—ç¬¦ä¸²</h2><h3 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString()"></a>toString()</h3><p>  nullå’Œundefinedæ²¡æœ‰toString()æ–¹æ³•</p><h3 id="String"><a href="#String" class="headerlink" title="String()"></a>String()</h3><ul><li><em>ä¼˜å…ˆè°ƒç”¨toString()</em></li><li>null è½¬æ¢ä¸º â€˜nullâ€™</li><li>undefined è½¬æ¢ä¸º â€˜undefinedâ€™</li></ul><h2 id="è½¬ä¸ºå¸ƒå°”å€¼"><a href="#è½¬ä¸ºå¸ƒå°”å€¼" class="headerlink" title="è½¬ä¸ºå¸ƒå°”å€¼"></a>è½¬ä¸ºå¸ƒå°”å€¼</h2><ul><li>Boolean()<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//é™¤äº†ä»¥ä¸‹å…­ä¸ªè½¬ä¸º false å…¶ä»–å…¨éƒ¨éƒ½ä¸º true</span><span class="hljs-literal">undefined</span><span class="hljs-literal">null</span><span class="hljs-number">0</span>-<span class="hljs-number">0</span><span class="hljs-literal">NaN</span><span class="hljs-string">&#x27;&#x27;</span></code></pre></div></li></ul><h1 id="éšå¼è½¬æ¢"><a href="#éšå¼è½¬æ¢" class="headerlink" title="éšå¼è½¬æ¢"></a>éšå¼è½¬æ¢</h1><p>åœ¨ js ä¸­ï¼Œå½“è¿ç®—ç¬¦åœ¨è¿ç®—æ—¶ï¼Œå¦‚æœä¸¤è¾¹æ•°æ®ä¸ç»Ÿä¸€ï¼ŒCPU å°±æ— æ³•è®¡ç®—ï¼Œè¿™æ—¶æˆ‘ä»¬ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†è¿ç®—ç¬¦ä¸¤è¾¹çš„æ•°æ®åšä¸€ä¸ªæ•°æ®ç±»å‹è½¬æ¢ï¼Œè½¬æˆä¸€æ ·çš„æ•°æ®ç±»å‹å†è®¡ç®—.è¿™ç§æ— éœ€ç¨‹åºå‘˜æ‰‹åŠ¨è½¬æ¢ï¼Œè€Œç”±ç¼–è¯‘å™¨è‡ªåŠ¨è½¬æ¢çš„æ–¹å¼å°±ç§°ä¸ºéšå¼è½¬æ¢</p><h2 id="éšå¼è½¬æ¢è§„åˆ™"><a href="#éšå¼è½¬æ¢è§„åˆ™" class="headerlink" title="éšå¼è½¬æ¢è§„åˆ™"></a>éšå¼è½¬æ¢è§„åˆ™</h2><ul><li>è½¬æˆ string ç±»å‹ï¼š <code>+</code>ï¼ˆå­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼‰</li><li>è½¬æˆ number ç±»å‹ï¼š<code>++/--</code>(è‡ªå¢è‡ªå‡è¿ç®—ç¬¦) <code>+ - * / %</code>(ç®—æœ¯è¿ç®—ç¬¦) <code>&gt; &lt; &gt;= &lt;= == != === !===</code> (å…³ç³»è¿ç®—ç¬¦)</li><li>è½¬æˆ boolean ç±»å‹ï¼š<code>!</code>ï¼ˆé€»è¾‘éè¿ç®—ç¬¦ï¼‰</li></ul><h2 id="å­—ç¬¦ä¸²è¿æ¥ç¬¦ä¸ç®—æœ¯è¿ç®—ç¬¦"><a href="#å­—ç¬¦ä¸²è¿æ¥ç¬¦ä¸ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="å­—ç¬¦ä¸²è¿æ¥ç¬¦ä¸ç®—æœ¯è¿ç®—ç¬¦"></a>å­—ç¬¦ä¸²è¿æ¥ç¬¦ä¸ç®—æœ¯è¿ç®—ç¬¦</h2><p><code>+</code>å·¦å³æœ‰å­—ç¬¦ä¸²åˆ™è½¬ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå¦åˆ™è½¬ä¸ºæ•°å­—è®¡ç®—</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//+æ˜¯å­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼š String(1) + &#x27;true&#x27; = &#x27;1true&#x27;</span><span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span> + <span class="hljs-string">&quot;true&quot;</span>); <span class="hljs-comment">//1true</span><span class="hljs-comment">//+æ˜¯ç®—æœ¯è¿ç®—ç¬¦ ï¼š 1 + Number(true) = 1 + 1 = 2</span><span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span> + <span class="hljs-literal">true</span>); <span class="hljs-comment">//2</span><span class="hljs-comment">// +æ˜¯ç®—æœ¯è¿ç®—ç¬¦ ï¼š 1 + Number(undefined) = 1 + NaN = NaN</span><span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span> + <span class="hljs-literal">undefined</span>); <span class="hljs-comment">//   NaN</span><span class="hljs-comment">// +æ˜¯ç®—æœ¯è¿ç®—ç¬¦ ï¼š 1 + Number(null) = 1 + 0 = 1</span><span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span> + <span class="hljs-literal">null</span>); <span class="hljs-comment">//1</span><span class="hljs-comment">//</span></code></pre></div><h2 id="å…³ç³»è¿ç®—ç¬¦"><a href="#å…³ç³»è¿ç®—ç¬¦" class="headerlink" title="å…³ç³»è¿ç®—ç¬¦"></a>å…³ç³»è¿ç®—ç¬¦</h2><p>ä¼šæŠŠå…¶ä»–æ•°æ®ç±»å‹è½¬æ¢æˆ number ä¹‹åå†æ¯”è¾ƒå…³ç³»</p><p><em>æ­¤æ—¶å¹¶ä¸æ˜¯æŒ‰ç…§ Number()çš„å½¢å¼è½¬æˆæ•°å­—ï¼Œè€Œæ˜¯æŒ‰ç…§å­—ç¬¦ä¸²å¯¹åº”çš„ unicode ç¼–ç æ¥è½¬æˆæ•°å­—</em></p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;2&quot;</span> &gt; <span class="hljs-string">&quot;10&quot;</span>); <span class="hljs-comment">//true     &#x27;2&#x27;.charCodeAt() &gt; &#x27;10&#x27;.charCodeAt() = 50 &gt; 49 = true</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;2&quot;</span>.charCodeAt()); <span class="hljs-comment">//æ•°å­—50</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;10&quot;</span>.charCodeAt()); <span class="hljs-comment">//æ•°å­—49ï¼ˆé»˜è®¤è¿”å›ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç¼–ç ï¼Œå¦‚æœæƒ³è¦æŸ¥è¯¢ç¬¬äºŒä¸ªå­—ç¬¦å¯ä»¥ä¼ å‚ä¸‹æ ‡ï¼‰</span><span class="hljs-comment">//å¤šä¸ªå­—ç¬¦ä»å·¦å¾€å³ä¾æ¬¡æ¯”è¾ƒ</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;abc&quot;</span> &gt; <span class="hljs-string">&quot;b&quot;</span>); <span class="hljs-comment">//false     å…ˆæ¯”è¾ƒ&#x27;a&#x27; å’Œ &#x27;b&#x27;ï¼Œ &#x27;a&#x27; ä¸ &#x27;b&#x27;ä¸ç­‰ï¼Œåˆ™ç›´æ¥å¾—å‡ºç»“æœ</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;abc&quot;</span> &gt; <span class="hljs-string">&quot;aad&quot;</span>); <span class="hljs-comment">//true     å…ˆæ¯”è¾ƒ&#x27;a&#x27;å’Œ&#x27;a&#x27;ï¼Œä¸¤è€…ç›¸ç­‰ï¼Œç»§ç»­æ¯”è¾ƒç¬¬äºŒä¸ªå­—ç¬¦ &#x27;b&#x27; ä¸ &#x27;a&#x27; ,å¾—å‡ºç»“æœ</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;a&quot;</span>.charCodeAt()); <span class="hljs-comment">//æ•°å­—97</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;b&quot;</span>.charCodeAt()); <span class="hljs-comment">//æ•°å­—98</span><span class="hljs-comment">//2.3 ç‰¹æ®Šæƒ…å†µ(æ— è§†è§„åˆ™)ï¼šå¦‚æœæ•°æ®ç±»å‹æ˜¯undefinedä¸nullï¼Œï¼Œå¾—å‡ºå›ºå®šçš„ç»“æœ</span><span class="hljs-built_in">console</span>.log(<span class="hljs-literal">undefined</span> == <span class="hljs-literal">undefined</span>); <span class="hljs-comment">//true</span><span class="hljs-built_in">console</span>.log(<span class="hljs-literal">undefined</span> == <span class="hljs-literal">null</span>); <span class="hljs-comment">//true</span><span class="hljs-built_in">console</span>.log(<span class="hljs-literal">null</span> == <span class="hljs-literal">null</span>); <span class="hljs-comment">//true</span><span class="hljs-comment">//2.4 ç‰¹æ®Šæƒ…å†µï¼ˆæ— è§†è§„åˆ™ï¼‰ï¼šNaNä¸ä»»ä½•æ•°æ®æ¯”è¾ƒéƒ½æ˜¯NaN</span><span class="hljs-built_in">console</span>.log(<span class="hljs-literal">NaN</span> == <span class="hljs-literal">NaN</span>); <span class="hljs-comment">//false</span></code></pre></div><h2 id="å¤æ‚æ•°æ®ç±»å‹çš„éšå¼è½¬æ¢"><a href="#å¤æ‚æ•°æ®ç±»å‹çš„éšå¼è½¬æ¢" class="headerlink" title="å¤æ‚æ•°æ®ç±»å‹çš„éšå¼è½¬æ¢"></a>å¤æ‚æ•°æ®ç±»å‹çš„éšå¼è½¬æ¢</h2><ol><li>å…ˆä½¿ç”¨<code>valueOf()</code>æ–¹æ³•è·å–å…¶åŸå§‹å€¼ï¼Œå¦‚æœåŸå§‹å€¼ä¸æ˜¯<code>number</code>ç±»å‹ï¼Œåˆ™ä½¿ç”¨ <code>toString()</code>æ–¹æ³•è½¬æˆ<code>string</code></li><li>å†å°† <code>string</code> è½¬æˆ <code>number</code> è¿ç®—</li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript">[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>] == <span class="hljs-string">&quot;1,2&quot;</span>; <span class="hljs-comment">//true     å…ˆå°†å·¦è¾¹æ•°ç»„è½¬æˆstringï¼Œç„¶åå³è¾¹ä¹Ÿæ˜¯stringåˆ™è½¬æˆunicodeç¼–ç è¿ç®—</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>].valueOf(); <span class="hljs-comment">// [1,2]</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>].toString(); <span class="hljs-comment">// &#x27;1,2&#x27;</span><span class="hljs-keyword">var</span> a = &#123;&#125;;a == <span class="hljs-string">&quot;[object Object]&quot;</span>; <span class="hljs-comment">//true</span>a.valueOf().toString(); <span class="hljs-comment">//[object Object]</span></code></pre></div><h2 id="é€»è¾‘ééšå¼è½¬æ¢ä¸å…³ç³»è¿ç®—ç¬¦"><a href="#é€»è¾‘ééšå¼è½¬æ¢ä¸å…³ç³»è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘ééšå¼è½¬æ¢ä¸å…³ç³»è¿ç®—ç¬¦"></a>é€»è¾‘ééšå¼è½¬æ¢ä¸å…³ç³»è¿ç®—ç¬¦</h2><blockquote><p>å¦‚æœä¸¤ä¸ªå¼•ç”¨ç±»å‹æ¯”è¾ƒ,ä¼šæ¯”è¾ƒå†…å­˜åœ°å€,æ³¨æ„è¦æ˜¯å…¶ä¸­æœ‰é€»è¾‘éè¿ç®—ç¬¦,éè¿ç®—ä¼˜å…ˆçº§ä¼šå¤§äºæ¯”è¾ƒæ“ä½œ</p></blockquote><ul><li>ç©ºæ•°ç»„çš„ toString()æ–¹æ³•ä¼šå¾—åˆ°ç©ºå­—ç¬¦ä¸²<code>&#39;&#39;</code></li><li>ç©ºå¯¹è±¡çš„ toString()æ–¹æ³•ä¼šå¾—åˆ°å­—ç¬¦ä¸²<code>[object Object]</code> </li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Boolean</span>([])); <span class="hljs-comment">// true</span><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Boolean</span>(![])); <span class="hljs-comment">// false</span><span class="hljs-comment">// Booleané™¤äº†0,-0,null,undefined,false,&#x27;&#x27;éƒ½è½¬ä¸ºtrue</span><span class="hljs-comment">//å¤§å‘</span><span class="hljs-built_in">console</span>.log([] == <span class="hljs-number">0</span>); <span class="hljs-comment">//true []è½¬æ•°å­—ä¸º0</span><span class="hljs-built_in">console</span>.log(![] == <span class="hljs-number">0</span>); <span class="hljs-comment">//true  </span><span class="hljs-comment">// è¿™é‡Œæœ‰é€»è¾‘éè¿ç®—ç¬¦,ä¼šå…ˆè½¬Boolean,![]è½¬å¸ƒå°”falseï¼Œè½¬æ•°å­—ä¸º0</span><span class="hljs-comment">//ç¥å‘</span><span class="hljs-built_in">console</span>.log([] == ![]); <span class="hljs-comment">//true</span><span class="hljs-comment">// ![]è½¬å¸ƒå°”false=&gt;0,0å’Œ[]æ¯”è¾ƒ,[]è½¬æ•°å­—ä¸º0</span><span class="hljs-built_in">console</span>.log([] == []); <span class="hljs-comment">//false // å†…å­˜åœ°å€ä¸åŒ</span><span class="hljs-comment">//å²è¯—çº§å‘</span><span class="hljs-built_in">console</span>.log(&#123;&#125; == !&#123;&#125;); <span class="hljs-comment">//false</span><span class="hljs-comment">// &#123;&#125;æœ€ç»ˆè½¬numberä¸ºNaN,å³è¾¹è½¬æ•°å­—ä¸º0</span><span class="hljs-built_in">console</span>.log(&#123;&#125; == &#123;&#125;); <span class="hljs-comment">//false // å†…å­˜åœ°å€ä¸åŒ</span></code></pre></div><h2 id="å€¼çš„æ¯”è¾ƒ"><a href="#å€¼çš„æ¯”è¾ƒ" class="headerlink" title="å€¼çš„æ¯”è¾ƒ"></a>å€¼çš„æ¯”è¾ƒ</h2><h3 id="es6-æ–°å¢Object-is-åˆ¤æ–­"><a href="#es6-æ–°å¢Object-is-åˆ¤æ–­" class="headerlink" title="es6 æ–°å¢Object.is()åˆ¤æ–­"></a>es6 æ–°å¢<code>Object.is()</code>åˆ¤æ–­</h3><p>ä¿®å¤äº†è½¬å¸ƒå°”å€¼çš„bug</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Object</span>.is(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>); <span class="hljs-comment">// true</span><span class="hljs-built_in">Object</span>.is(<span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// true</span><span class="hljs-built_in">Object</span>.is(<span class="hljs-number">0</span>, -<span class="hljs-number">0</span>); <span class="hljs-comment">// false</span><span class="hljs-built_in">Object</span>.is(<span class="hljs-number">0</span>, +<span class="hljs-number">0</span>); <span class="hljs-comment">// true</span><span class="hljs-built_in">Object</span>.is(-<span class="hljs-number">0</span>, -<span class="hljs-number">0</span>); <span class="hljs-comment">// true</span><span class="hljs-built_in">Object</span>.is(<span class="hljs-literal">NaN</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// false</span><span class="hljs-built_in">Object</span>.is(<span class="hljs-literal">NaN</span>, <span class="hljs-number">0</span> / <span class="hljs-number">0</span>); <span class="hljs-comment">// true</span></code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_Object</span>.<span class="hljs-title">is</span>(<span class="hljs-params">x,y</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">Object</span>.is)&#123;    <span class="hljs-keyword">if</span>(x===y)&#123;      <span class="hljs-keyword">return</span> x!==<span class="hljs-number">0</span> || <span class="hljs-number">1</span>/x === <span class="hljs-number">1</span>/y    &#125;<span class="hljs-keyword">else</span>&#123;      <span class="hljs-keyword">return</span> x!==x &amp;&amp; y!== y    &#125;  &#125;&#125;</code></pre></div><h1 id="hackæŠ€å·§"><a href="#hackæŠ€å·§" class="headerlink" title="hackæŠ€å·§"></a>hackæŠ€å·§</h1><ul><li>è½¬string<br><code>123+&#39;&#39;</code>  // â€˜123â€™</li><li>è½¬number<br><code>+123</code> // 123</li><li>ä½è¿ç®—<ul><li>å‘ä¸‹å–æ•´<div class="hljs code-wrapper"><pre><code class="hljs javascript">~~<span class="hljs-number">1.9</span> = <span class="hljs-number">1</span><span class="hljs-number">1.9</span> &gt;&gt; <span class="hljs-number">0</span> = <span class="hljs-number">1</span></code></pre></div></li><li>Math.floor(N/2)<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-number">124.9</span> &gt;&gt; <span class="hljs-number">1</span> = <span class="hljs-number">62</span></code></pre></div></li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPåè®®</title>
    <link href="/2022/02/24/HTTP/"/>
    <url>/2022/02/24/HTTP/</url>
    
    <content type="html"><![CDATA[<h1 id="HTTPï¼ˆHyperText-Transfer-Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®"><a href="#HTTPï¼ˆHyperText-Transfer-Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®" class="headerlink" title="HTTPï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®"></a>HTTPï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®</h1><p>HTTP æ˜¯åŸºäº TCP/IP åè®®çš„åº”ç”¨å±‚åè®®ï¼Œç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡</p><blockquote><p>é“¾è·¯å±‚ï¼Œç½‘ç»œå±‚ï¼Œä¼ è¾“å±‚ï¼Œåº”ç”¨å±‚</p></blockquote><h2 id="HTTP-æŠ¥æ–‡ç»„æˆéƒ¨åˆ†"><a href="#HTTP-æŠ¥æ–‡ç»„æˆéƒ¨åˆ†" class="headerlink" title="HTTP æŠ¥æ–‡ç»„æˆéƒ¨åˆ†"></a>HTTP æŠ¥æ–‡ç»„æˆéƒ¨åˆ†</h2><ul><li><p>è¯·æ±‚æŠ¥æ–‡</p><ul><li>  è¯·æ±‚è¡Œ <code>Request Method</code>,<code>Request URL</code></li><li>  è¯·æ±‚å¤´ åŒ…å«è‹¥å¹²å±æ€§ï¼Œkey:value å€¼</li><li>  ç©ºè¡Œ</li><li>  è¯·æ±‚ä½“</li></ul></li><li><p>å“åº”æŠ¥æ–‡</p><ul><li>  çŠ¶æ€è¡Œ <code>Request Version</code>,<code>Status Code</code></li><li>  å“åº”å¤´ åŒ…å«è‹¥å¹²å±æ€§ï¼Œkey:value å€¼</li><li>  ç©ºè¡Œ</li><li>  å“åº”ä½“</li></ul></li></ul><h3 id="å­—æ®µ"><a href="#å­—æ®µ" class="headerlink" title="å­—æ®µ"></a>å­—æ®µ</h3><ul><li><p>ç¼“å­˜ç›¸å…³</p><ul><li>  <code>Cache-Control</code></li><li>  <code>Pragma</code></li><li>  <code>Expires</code>å®ä½“é¦–éƒ¨</li><li>  <code>Last-Modified</code>å®ä½“é¦–éƒ¨</li><li>  <code>If-Modified-Since</code></li><li>  <code>ETag</code></li><li>  <code>If-None-Match</code></li></ul></li><li><p>Cookie ç›¸å…³</p><ul><li>  <code>Cookie</code></li><li>  <code>Set-Cookie</code></li></ul></li><li><p>è·¨åŸŸç›¸å…³</p><ul><li>  <code>Origin</code></li><li>  <code>Access-Control-Request-Method</code></li><li>  <code>Access-Control-Allow-Origin</code></li><li>  <code>Access-Control-Allow-Methods</code></li><li>  <code>Access-Control-Max-Age</code></li><li>  <code>Access-Control-Allow-Credentials</code></li></ul></li><li><p>è¯·æ±‚æ¥æº</p><ul><li>  <code>Connection</code>:keep-alive / close / upgrade</li><li>  <code>Referer</code>è¯·æ±‚æ¥æºåŸŸ</li><li><code>Origin</code>è¯·æ±‚æ¥æºåŸŸ<blockquote><p>è¿™ä¸ªå•è¯æ˜¯é”™çš„</p></blockquote></li><li>  <code>Host</code>æœåŠ¡å™¨åŸŸå</li><li>  <code>Upgrade</code>:websocket</li></ul></li></ul><h2 id="HTTP-çš„å“åº”çŠ¶æ€ç "><a href="#HTTP-çš„å“åº”çŠ¶æ€ç " class="headerlink" title="HTTP çš„å“åº”çŠ¶æ€ç "></a>HTTP çš„å“åº”çŠ¶æ€ç </h2><blockquote><p>æ¶ˆæ¯</p></blockquote><ul><li>  100 ç»§ç»­å‘é€</li><li>  101 åè®®å‡çº§<blockquote><p>è¯·æ±‚æˆåŠŸ</p></blockquote></li><li>  200 OK</li><li>  206 å¤„ç†äº†éƒ¨åˆ†è¯·æ±‚<blockquote><p>é‡å®šå‘</p></blockquote></li><li>  301 æ°¸ä¹…æ€§é‡å®šå‘ï¼Œèµ„æºå·²ç»åˆ†é…äº†æ–°çš„ URl</li><li>  302 ä¸´æ—¶é‡å®šå‘</li><li>303 è¡¨ç¤ºèµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ª URLï¼Œåº”ä½¿ç”¨ GET æ–¹æ³•è·å–èµ„æº<blockquote><p>å¯¹äº 301/302/303 å“åº”ï¼Œå‡ ä¹æ‰€æœ‰æµè§ˆå™¨éƒ½ä¼šåˆ é™¤æŠ¥æ–‡ä¸»ä½“å¹¶è‡ªåŠ¨ç”¨ GET é‡æ–°è¯·æ±‚</p></blockquote></li><li>  304 èµ„æºæœªä¿®æ”¹<blockquote><p>è¯·æ±‚é”™è¯¯</p></blockquote></li><li>  400 Bad Request è¯·æ±‚æŠ¥æ–‡è¯­æ³•é”™è¯¯</li><li>  401 Unauthorized éœ€è¦è®¤è¯</li><li>  403 Forbidden ç¦æ­¢è®¿é—®</li><li>  404 Not Found</li><li>  405 è¯·æ±‚æ–¹æ³•éæ³•</li><li>  408 è¯·æ±‚è¶…æ—¶<blockquote><p>æœåŠ¡å™¨é”™è¯¯</p></blockquote></li><li>  500 æœåŠ¡å™¨é”™è¯¯</li><li>  503 æœåŠ¡å™¨è¿‡è½½</li><li>  505 ä¸æ”¯æŒè¯¥ç‰ˆæœ¬ HTTP åè®®</li></ul><h2 id="HTTP-å‘å±•å†ç¨‹"><a href="#HTTP-å‘å±•å†ç¨‹" class="headerlink" title="HTTP å‘å±•å†ç¨‹"></a>HTTP å‘å±•å†ç¨‹</h2><h3 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP 0.9"></a>HTTP 0.9</h3><ul><li>  <code>GET</code></li><li>  åªèƒ½ä¸”ç›´æ¥è¿”å› html</li></ul><h3 id="HTTP1-0"><a href="#HTTP1-0" class="headerlink" title="HTTP1.0"></a>HTTP1.0</h3><ul><li><p>  ä¸²è¡Œè¿æ¥ï¼šæ¯æ¬¡é€šä¿¡å®Œåæ–­å¼€ TCP é€šé“ï¼Œæ¯ä¸ªæ–°è¯·æ±‚éƒ½éœ€è¦å»ºç«‹æ–°çš„è¿æ¥</p></li><li><p><code>GET</code></p><ol><li>è¯·æ±‚æ”¾åœ¨å‚æ•°æ”¾åœ¨ URL åœ°å€å</li><li>åˆ·æ–°æ— å‰¯ä½œç”¨</li><li>èƒ½ä¿å­˜ä¹¦ç­¾ï¼Œä¼šè¢«æµè§ˆå™¨ç¼“å­˜ï¼ŒåŠ å…¥å†å²è®°å½•</li><li>ç¼–ç  urlencoded</li><li>æµè§ˆå™¨æˆ–è€…æœåŠ¡å™¨ä¼šå¯¹ URL é•¿åº¦åšé™åˆ¶</li></ol></li><li><p><code>POST</code></p><ol><li>è¯·æ±‚å‚æ•°æ”¾åœ¨ body ä¸­</li><li>åˆ·æ–°æç¤ºå†æ¬¡æäº¤ï¼Ÿ</li><li>ä¸ç¼“å­˜ä¸ä¿å­˜ä¸è®°å½•</li><li>æ•°æ®ç±»å‹æ— é™åˆ¶</li></ol></li><li><p>  <code>HEAD</code> ä¸ get ç›¸åŒçš„è¯·æ±‚ï¼Œä¸è¿‡åªè¯·æ±‚å¤´éƒ¨ï¼Œè·å–å…¶ä¸­â€œå…³äºè¯¥èµ„æºçš„ä¿¡æ¯â€(å…ƒä¿¡æ¯æˆ–ç§°å…ƒæ•°æ®)</p></li></ul><h3 id="HTTP1-1"><a href="#HTTP1-1" class="headerlink" title="HTTP1.1"></a>HTTP1.1</h3><ul><li><p>  æŒä¹…è¿æ¥ï¼šä¸€å®šæ—¶é—´å†…ï¼Œåªè¦ä¸æ˜¯ä¸»åŠ¨æ–­å¼€åˆ™ä¿æŒè¿æ¥ï¼ˆkeep-alive è®¾å®šè¿™ä¸ªæ—¶é•¿ï¼‰ï¼Œä½†æ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚å¿…é¡»ç­‰å¾…ä¸Šä¸€ä¸ªè¯·æ±‚å“åº”å®Œæˆï¼ˆçº¿å¤´é˜»å¡ï¼‰</p></li><li><p>  ç®¡çº¿åŒ–æŒä¹…è¿æ¥ï¼šåœ¨åŒä¸€æ¡é•¿è¿æ¥ä¸Šå‘å‡ºè¿ç»­çš„è¯·æ±‚ï¼Œè€Œä¸ç”¨ç­‰å¾…åº”ç­”è¿”å›,åªèƒ½ç”¨äº<code>GET</code>,<code>HEAD</code>,<code>PUT</code>,<code>DELETE</code>è¯·æ±‚</p></li><li><p>  <code>OPTIONS</code>è¯¢é—®è·å–å½“å‰èµ„æºæ‰€æ”¯æŒçš„æ–¹æ³•</p></li><li><p>  <code>PUT</code>ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€æ–°æ–‡ä»¶</p></li><li><p>  <code>PATCH</code>æ˜¯å¯¹ PUT æ–¹æ³•çš„è¡¥å……ï¼Œç”¨æ¥å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–° ã€‚</p></li><li><p>  <code>DELETE</code>è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šæ–‡ä»¶</p></li><li><p>  <code>TRACE</code>å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚</p></li><li><p>  <code>CONNECT</code> HTTP/1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚</p></li></ul><h3 id="SPDY"><a href="#SPDY" class="headerlink" title="SPDY"></a>SPDY</h3><ul><li>  2009 å¹´æ¨å‡ºï¼Œè¯•éªŒæ€§</li><li>  ä½äº HTTP ä¸ SSl ä¹‹é—´ï¼Œæ˜¯å¯¹ HTTP çš„å¢å¼º</li></ul><blockquote><p>ç‰¹æ€§ï¼š</p></blockquote><ol><li><p>å¤šè·¯å¤ç”¨ï¼šé€šè¿‡ä¸€ä¸ª TCP è¿æ¥ï¼Œå¯ä»¥æ— é™åˆ¶å¤„ç†å¤šä¸ª HTTP è¯·æ±‚ã€‚</p></li><li><p>èµ‹äºˆè¯·æ±‚ä¼˜å…ˆçº§ï¼šç»™è¯·æ±‚é€ä¸ªåˆ†é…ä¼˜å…ˆçº§é¡ºåºã€‚å¯ä»¥è§£å†³åœ¨å‘é€å¤šä¸ªè¯·æ±‚æ—¶ï¼Œå› å¸¦å®½ä½è€Œå¯¼è‡´å“åº”å˜æ…¢çš„é—®é¢˜ã€‚</p></li><li><p>å‹ç¼© HTTP å¤´éƒ¨ï¼šå‹ç¼©æ–¹å¼ï¼šDELEFT</p></li><li><p>æœåŠ¡ç«¯æ¨é€</p></li><li><p>SPDY ä½äº HTTP ä¸‹ï¼ŒTCP å’Œ SSL ä¹‹ä¸Šï¼Œå¯ä»¥å…¼å®¹è€ç‰ˆæœ¬ http åŒæ—¶ä½¿ç”¨å¯ç”¨çš„ ssl åŠŸèƒ½</p></li><li><p>SPDY å¼ºåˆ¶ä½¿ç”¨ SSL</p></li></ol><h3 id="HTTP2"><a href="#HTTP2" class="headerlink" title="HTTP2"></a>HTTP2</h3><ul><li><p>  2015 å¹´å‘å¸ƒï¼ŒåŸºäº SPDY åè®®</p></li><li><p>  http/1.x æ˜¯ä¸€ä¸ªè¶…æ–‡æœ¬åè®®ï¼Œè€Œ http2 æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åè®®</p></li></ul><blockquote><p>ç‰¹æ€§ï¼š</p></blockquote><ol><li><p>äºŒè¿›åˆ¶åˆ†å¸§</p><p> å½“å®¢æˆ·ç«¯åŒæ—¶å‘æœåŠ¡ç«¯å‘èµ·å¤šä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆè¿™äº›è¯·æ±‚ä¼šè¢«åˆ†è§£æˆä¸€ä¸€ä¸ªçš„å¸§ï¼Œæ¯ä¸ªå¸§éƒ½ä¼šåœ¨ä¸€ä¸ª TCP é“¾è·¯ä¸­æ— åºçš„ä¼ è¾“ï¼Œå½“å¸§åˆ°è¾¾æœåŠ¡ç«¯ä¹‹åï¼Œå°±å¯ä»¥æ ¹æ® <code>Stream Identifier</code> æ¥é‡æ–°ç»„åˆå¾—åˆ°å®Œæ•´çš„è¯·æ±‚ã€‚</p></li><li><p>å¤´éƒ¨å‹ç¼©</p><ul><li>è¯·æ±‚å’Œå“åº”é¦–éƒ¨å‹ç¼©</li><li><code>HPACK</code> ç®—æ³•ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å»ºç«‹å­—å…¸ï¼ˆé¦–éƒ¨è¡¨ï¼‰é‡å¤å¤´éƒ¨ä¸ç”¨å†å‘é€</li></ul></li><li><p>æœåŠ¡ç«¯æ¨é€<code>Server Push</code></p><ul><li>æœåŠ¡ç«¯èƒ½ä¸»åŠ¨è¿”å›å¤šçš„è§‰å¾—å®¢æˆ·ç«¯ä¼šç”¨åˆ°çš„èµ„æº</li></ul></li><li><p>å¤šè·¯å¤ç”¨</p><ul><li>åŒåŸŸåçš„é€šä¿¡éƒ½åœ¨å•ä¸ªè¿æ¥ä¸Šå®Œæˆ(åªå ç”¨ä¸€ä¸ª tcp è¿æ¥</li><li>å•è¿æ¥å¯ä»¥æ‰¿å—ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµ</li></ul></li></ol><h3 id="HTTP3"><a href="#HTTP3" class="headerlink" title="HTTP3"></a>HTTP3</h3><ul><li>  http3 ä½¿ç”¨æ–°çš„ UDP åè®®<code>QUIC</code>ä»£æ›¿ TCP</li><li>  è§£å†³ http2 æ—¶ä»£ä¸¢åŒ…é˜»å¡</li><li>  åˆ‡æ¢ç½‘ç»œæ—¶çš„è¿æ¥ä¿æŒï¼ˆå¿«é€Ÿé‡å¯ä¼šè¯ï¼‰</li><li>  åŠ å¯†ä¼ è¾“</li></ul><h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><h3 id="TLS-SSl"><a href="#TLS-SSl" class="headerlink" title="TLS/SSl"></a>TLS/SSl</h3><ul><li><p>  ä¼ è¾“å±‚å®‰å…¨æ€§åè®®ï¼ˆè‹±è¯­ï¼šTransport Layer Securityï¼Œç¼©å†™ä½œ TLSï¼‰ï¼ŒåŠå…¶å‰èº«å®‰å…¨å¥—æ¥å±‚ï¼ˆSecure Sockets Layerï¼Œç¼©å†™ä½œ SSLï¼‰æ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œç›®çš„æ˜¯ä¸ºäº’è”ç½‘é€šä¿¡æä¾›å®‰å…¨åŠæ•°æ®å®Œæ•´æ€§ä¿éšœã€‚</p></li><li><p>  TLS åè®®çš„ç‰¹ç‚¹æ˜¯ä¸åº”ç”¨å±‚åè®®ï¼ˆHTTPï¼ŒFTPï¼‰æ— è€¦åˆï¼Œåº”ç”¨å±‚åè®®èƒ½é€æ˜è¿è¡Œåœ¨ TLS åè®®ä¸Šå±‚ï¼ˆHTTP ä¸ TCP ä¹‹é—´ï¼‰</p></li></ul><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><ul><li><p>ã€éå¯¹ç§°åŠ å¯†ã€‘</p><p>  åªæœ‰ä½¿ç”¨ç§é’¥æ‰èƒ½è§£å¼€å…¬é’¥åŠ å¯†</p></li><li><p>ã€æ‘˜è¦ç®—æ³•ã€‘</p><p>  è¾“å‡ºå›ºå®šé•¿åº¦çš„æ•°æ®ï¼Œç”¨æ¥è®¡ç®—æ•°æ®æŒ‡çº¹ï¼Œæ¯”å¦‚ SHA256</p></li><li><p>ã€æ•°å­—ç­¾åã€‘<br>  ä½¿ç”¨ç§é’¥å¯¹æ‘˜è¦ç®—æ³•å¾—å‡ºçš„æŒ‡çº¹åŠ å¯†</p></li></ul><h3 id="SSL-è¯ä¹¦"><a href="#SSL-è¯ä¹¦" class="headerlink" title="SSL è¯ä¹¦"></a>SSL è¯ä¹¦</h3><ul><li>  è¯ä¹¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šç”³è¯·è€…å…¬é’¥ã€ç”³è¯·è€…çš„ç»„ç»‡ä¿¡æ¯å’Œä¸ªäººä¿¡æ¯ã€ç­¾å‘æœºæ„ CA çš„ä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ã€è¯ä¹¦åºåˆ—å·ï¼Œæ‘˜è¦ç®—æ³•ç­‰ä¿¡æ¯çš„æ˜æ–‡</li><li>  CA ä½¿ç”¨ CA ç§é’¥å¯¹è¯ä¹¦æ˜æ–‡æ‘˜è¦ç®—æ³•åå¾—å‡ºçš„æŒ‡çº¹è¿›è¡ŒåŠ å¯†å¾—åˆ°ç­¾å</li></ul><h3 id="æµè§ˆå™¨éªŒè¯è¯ä¹¦åˆæ³•æ€§"><a href="#æµè§ˆå™¨éªŒè¯è¯ä¹¦åˆæ³•æ€§" class="headerlink" title="æµè§ˆå™¨éªŒè¯è¯ä¹¦åˆæ³•æ€§"></a>æµè§ˆå™¨éªŒè¯è¯ä¹¦åˆæ³•æ€§</h3><ol><li>ä»æ“ä½œç³»ç»Ÿä¸­æ‰¾åˆ°ç›¸åº”çš„<code>CAæœºæ„è¯ä¹¦</code></li><li>ä½¿ç”¨<code>CAè¯ä¹¦</code>çš„å…¬é’¥<code>è§£å¯†``ç«™ç‚¹è¯ä¹¦</code>çš„<code>ç­¾å</code>å¾—åˆ°æ ¡éªŒç  1</li><li>ä½¿ç”¨è¯ä¹¦åˆ¶å®šçš„æ‘˜è¦ç®—æ³•å¯¹<code>ç«™ç‚¹è¯ä¹¦</code>æ˜æ–‡è®¡ç®—å¾—åˆ°æ ¡éªŒç  2</li><li>æ¯”è¾ƒä¸¤ä¸ªæ ¡éªŒç ç›¸åŒåˆ™è¯´æ˜è¯ä¹¦æ²¡è¢«ç¯¡æ”¹</li><li>åé¢å°±å¼€å§‹æŸ¥çœ‹è¯ä¹¦æ˜¯å¦åœ¨æœ‰æ•ˆæœŸï¼Œæ˜¯å¦å¯¹åº”å½“å‰åŸŸåï¼Œæ˜¯å¦åœ¨åŠé”€åˆ—è¡¨ä¸­ç­‰</li></ol><h3 id="HTTPS-å·¥ä½œæµç¨‹"><a href="#HTTPS-å·¥ä½œæµç¨‹" class="headerlink" title="HTTPS å·¥ä½œæµç¨‹"></a>HTTPS å·¥ä½œæµç¨‹</h3><ol><li>ç”¨æˆ·è®¿é—®:443,å‘é€å®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†ç®—æ³•åˆ—è¡¨å’Œéšæœºæ•°<code>Random_C</code></li><li>æœåŠ¡å™¨æ ¹æ®æ”¯æŒçš„è´¾æ¯ç®—æ³•è®¡ç®—å¹¶è¿”å›è¯ä¹¦å’Œéšæœºæ•°<code>Random_S</code></li><li>ç”¨æˆ·æµè§ˆå™¨ä½¿ç”¨ <strong><em>CA å…¬é’¥</em></strong> æ‰“å¼€å¹¶éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§å¾—åˆ°è¯ä¹¦ä¸­çš„ <strong><em>æœåŠ¡å™¨å…¬é’¥</em></strong></li><li>ç”¨æˆ·ç”Ÿæˆç”Ÿæ–°çš„éšæœºæ•°<code>Premaster secret</code>ï¼Œå¹¶ä½¿ç”¨ <strong><em>æœåŠ¡å™¨å…¬é’¥</em></strong> åŠ å¯†å‘é€ç»™æœåŠ¡å™¨</li><li>æœåŠ¡å™¨ä½¿ç”¨è‡ªå·±çš„ <strong><em>æœåŠ¡å™¨ç§é’¥</em></strong> è§£å¯†ï¼Œå¾—åˆ° <code>Premaster secret</code></li><li>æ­¤ååŒæ–¹ä½¿ç”¨åŒæ ·çš„åŠ å¯†ç®—æ³•å¯¹ä¸‰ä¸ªéšæœºæ•°è¿›è¡Œè®¡ç®—å¾—åˆ°å¯¹ç§°çš„å¯†é’¥<code>enc_key</code></li><li>è‡³æ­¤åŒæ–¹å¾—åˆ°äº†å¯¹ç§°åŠ å¯†å¯†é’¥,ä¹‹åçš„è¿æ¥éƒ½åªä½¿ç”¨å¯¹ç§°åŠ å¯†</li></ol><h2 id="TCP-æ¡æ‰‹"><a href="#TCP-æ¡æ‰‹" class="headerlink" title="TCP æ¡æ‰‹"></a>TCP æ¡æ‰‹</h2><h3 id="ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹</h3><ol><li>ä¸ºäº†ç¡®ä¿é€šä¿¡åŒæ–¹æ”¶å‘èƒ½åŠ›æ­£å¸¸</li><li>æŒ‡å®šè‡ªå·±çš„åˆå§‹åŒ–åºåˆ—å·ï¼Œä¸ºåé¢çš„å¯é ä¼ é€åšå‡†å¤‡</li><li>è¿‡ç¨‹ï¼š<ul><li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š<br>å®¢æˆ·ç«¯ç»™æœåŠ¡ç«¯å‘ä¸€ä¸ª <code>SYN</code> æŠ¥æ–‡ï¼Œå¹¶æŒ‡æ˜å®¢æˆ·ç«¯çš„åˆå§‹åŒ–åºåˆ—å· <code>ISN(c)</code>ã€‚æ­¤æ—¶å®¢æˆ·ç«¯å¤„äº <code>SYN_Send</code> çŠ¶æ€ã€‚</li><li>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š<br>æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ <code>SYN</code> æŠ¥æ–‡ä¹‹åï¼Œä¼šä»¥è‡ªå·±çš„ <code>SYN</code> æŠ¥æ–‡ä½œä¸ºåº”ç­”ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯æŒ‡å®šäº†è‡ªå·±çš„åˆå§‹åŒ–åºåˆ—å· <code>ISN(s)</code>ï¼ŒåŒæ—¶ä¼šæŠŠå®¢æˆ·ç«¯çš„ <code>ISN(c) + 1</code> ä½œä¸º <code>ACK(ç¡®è®¤å­—ç¬¦)</code> çš„å€¼ï¼Œè¡¨ç¤ºè‡ªå·±å·²ç»æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„ <code>SYN</code>ï¼Œæ­¤æ—¶æœåŠ¡å™¨å¤„äº <code>SYN_REVD</code> çš„çŠ¶æ€ã€‚</li><li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š<br>å®¢æˆ·ç«¯æ”¶åˆ° <code>SYN</code> æŠ¥æ–‡ä¹‹åï¼Œä¼šå‘é€ä¸€ä¸ª <code>ACK</code> æŠ¥æ–‡ï¼Œå½“ç„¶ï¼Œä¹Ÿæ˜¯ä¸€æ ·æŠŠæœåŠ¡å™¨çš„ <code>ISN(s) + 1</code> ä½œä¸º <code>ACK</code> çš„å€¼ï¼Œè¡¨ç¤ºå·²ç»æ”¶åˆ°äº†æœåŠ¡ç«¯çš„ <code>SYN</code> æŠ¥æ–‡ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¤„äº <code>establised</code> çŠ¶æ€ã€‚<blockquote><p>åŒæ—¶è¯¥ tcp æ ˆå·²ç»å…è®¸è¯·æ±‚æ•°æ®ï¼Œä¾‹å¦‚å¯ä»¥åŒæ—¶å¸¦ä¸Šä¸€ä¸ª GET è¯·æ±‚</p></blockquote></li><li>æœåŠ¡å™¨æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œä¹Ÿå¤„äº <code>establised</code> çŠ¶æ€ï¼Œæ­¤æ—¶ï¼ŒåŒæ–¹ä»¥å»ºç«‹èµ·äº†é“¾æ¥ã€‚</li></ul></li></ol><blockquote><p><code>åŠè¿æ¥é˜Ÿåˆ—</code>ï¼šåœ¨ TCP åè®®ä¸‰æ¬¡æ¡æ‰‹çš„è¿æ¥è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸€ä¸ªç”¨æˆ·å‘æœåŠ¡å™¨å‘é€äº† SYN æŠ¥æ–‡ï¼ŒæœåŠ¡å™¨åˆå‘å‡º SYN+ACK åº”ç­”æŠ¥æ–‡åæœªæ”¶åˆ°å®¢æˆ·ç«¯çš„ ACK æŠ¥æ–‡å›åº”ï¼Œè¿™ç§æƒ…å†µä¸‹æœåŠ¡å™¨ç«¯ä¼šå†æ¬¡å‘é€ SYN+ACK ç»™å®¢æˆ·ç«¯ï¼Œå¹¶ç­‰å¾…ä¸€æ®µæ—¶é—´åä¸¢å¼ƒè¿™ä¸ªæœªå®Œæˆçš„è¿æ¥ï¼Œè¿™æ®µæ—¶é—´çš„é•¿åº¦ç§°ä¸º SYN Timeoutï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ—¶é—´æ˜¯åˆ†é’Ÿçº§ã€‚</p></blockquote><blockquote><p><code>æ³›æ´ªæ”»å‡»</code>ï¼šSYN æ³›æ´ªæ”»å‡»é€šè¿‡å‘é€å¤§é‡çš„ä¼ªé€  TCP è¿æ¥æŠ¥æ–‡è€Œé€ æˆå¤§é‡çš„ TCP åŠè¿æ¥,æœåŠ¡å™¨ç«¯å°†ä¸ºäº†ç»´æŠ¤è¿™æ ·ä¸€ä¸ªåºå¤§çš„åŠè¿æ¥åˆ—è¡¨è€Œæ¶ˆè€—éå¸¸å¤šçš„èµ„æºã€‚è¿™æ ·æœåŠ¡å™¨ç«¯å°†å¿™äºå¤„ç†æ”»å‡»è€…ä¼ªé€ çš„ TCP è¿æ¥è¯·æ±‚è€Œæ— æ³•å¤„ç†æ­£å¸¸è¿æ¥è¯·æ±‚,ç”šè‡³ä¼šå¯¼è‡´å †æ ˆçš„æº¢å‡ºå´©æºƒã€‚</p></blockquote><h3 id="å››æ¬¡æŒ¥æ‰‹"><a href="#å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="å››æ¬¡æŒ¥æ‰‹"></a>å››æ¬¡æŒ¥æ‰‹</h3><ol><li>æ–­å¼€ tcp è¿æ¥</li><li>è¿‡ç¨‹ï¼š<ul><li>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼š<br>å®¢æˆ·ç«¯å‘é€<code>FIN</code> æŠ¥æ–‡ï¼ŒæŠ¥æ–‡ä¸­ä¼šæŒ‡å®šä¸€ä¸ªåºåˆ—å·<code>SYN(c)</code>ã€‚æ­¤æ—¶å®¢æˆ·ç«¯å¤„äº <code>FIN_WAIT1</code> çŠ¶æ€ã€‚</li><li>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š<br>æœåŠ¡ç«¯æ”¶åˆ° <code>FIN</code> ä¹‹åï¼Œä¼šæŠŠå®¢æˆ·ç«¯çš„åºåˆ—å·å€¼<code>SYN(c) + 1</code> ä½œä¸º <code>ACK</code> æŠ¥æ–‡çš„åºåˆ—å·å€¼å¹¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œè¡¨æ˜å·²ç»æ”¶åˆ°å®¢æˆ·ç«¯çš„æŠ¥æ–‡äº†ï¼Œæ­¤æ—¶æœåŠ¡ç«¯å¤„äº <code>CLOSE_WAIT</code>çŠ¶æ€ã€‚</li><li>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼š<br>å¦‚æœæœåŠ¡ç«¯ä¹Ÿæƒ³æ–­å¼€è¿æ¥äº†ï¼Œå’Œå®¢æˆ·ç«¯çš„ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ä¸€æ ·ï¼Œå‘ç»™ <code>FIN</code> æŠ¥æ–‡ï¼Œä¸”æŒ‡å®šä¸€ä¸ªåºåˆ—å·<code>SYN(s)</code>ã€‚æ­¤æ—¶æœåŠ¡ç«¯å¤„äº <code>LAST_ACK</code> çš„çŠ¶æ€ã€‚</li><li>ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼š<br>å®¢æˆ·ç«¯æ”¶åˆ° FIN ä¹‹åï¼Œä¹ŸæŠŠæœåŠ¡ç«¯çš„åºåˆ—å·å€¼<code>SYN(s) + 1</code> ä½œä¸ºè‡ªå·± <code>ACK</code> æŠ¥æ–‡çš„åºåˆ—å·å€¼å¹¶å‘é€ç»™æœåŠ¡ç«¯,æ­¤æ—¶å®¢æˆ·ç«¯å¤„äº <code>TIME_WAIT</code> çŠ¶æ€ã€‚ä¹‹åæ‰ä¼šè¿›å…¥ <code>CLOSED</code> çŠ¶æ€</li><li>æœåŠ¡ç«¯æ”¶åˆ° <code>ACK</code> æŠ¥æ–‡ä¹‹åï¼Œå°±å¤„äºå…³é—­è¿æ¥äº†ï¼Œå¤„äº <code>CLOSED</code> çŠ¶æ€ã€‚</li></ul></li></ol><blockquote><p><code>TIME_WAIT</code> çŠ¶æ€:å®¢æˆ·ç«¯å‘é€ ACK ä¹‹åä¸ç›´æ¥å…³é—­ï¼Œè€Œæ˜¯è¦ç­‰ä¸€é˜µå­æ‰å…³é—­,ç¡®ä¿æœåŠ¡å™¨æ˜¯å¦å·²ç»æ”¶åˆ°äº† ACK æŠ¥æ–‡ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°çš„è¯ï¼ŒæœåŠ¡å™¨ä¼šé‡æ–°å‘ FIN æŠ¥æ–‡ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å†æ¬¡æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œå°±çŸ¥é“ä¹‹å‰çš„ ACK æŠ¥æ–‡ä¸¢å¤±äº†ï¼Œç„¶åå†æ¬¡å‘é€ ACK æŠ¥æ–‡ã€‚</p></blockquote><blockquote><p>ä¹Ÿå¯ç¼©çŸ­ä¸ºä¸‰æ¬¡æŒ¥æ‰‹ï¼Œä¸Šè¿°äºŒä¸‰æ­¥éª¤åˆå¹¶ï¼ŒæœåŠ¡å™¨åŒæ—¶å›å¤ ACK å’Œ FIN</p></blockquote><h2 id="Websocket"><a href="#Websocket" class="headerlink" title="Websocket"></a>Websocket</h2><ul><li>  websocket çš„å‡ºç°è§£å†³äº†ä¼ ç»Ÿ http è¯·æ±‚åªèƒ½ç”±å®¢æˆ·ç«¯å‘èµ·çš„ç¼ºé™·</li><li>  http æ— æ³•å¾—çŸ¥æœåŠ¡å™¨è¿ç»­çš„çŠ¶æ€å˜åŒ–ï¼Œåªèƒ½é è½®è¯¢</li><li>  ws æ„é€ å‡½æ•°å°±è¦ä¼ å…¥<code>ç»å¯¹URL</code>ï¼Œä¸”è¿æ¥ä¸èƒ½è½¬å‘åªèƒ½æ˜¯ç›´æ¥è¿æ¥</li><li>  å…¨åŒå·¥ï¼ŒåŒå‘é€šä¿¡</li><li>  æœåŠ¡ç«¯æ¨é€</li><li>  æŒä¹…è¿æ¥</li><li>  åŸºäº TCP ä¼ è¾“ï¼Œå¤ç”¨ HTTP çš„æ¡æ‰‹é€šé“</li><li>åè®®å‡çº§ä¸º ws<ol><li>å®¢æˆ·ç«¯è¯·æ±‚<div class="hljs code-wrapper"><pre><code class="hljs javascript">Connection: Upgrade;Upgrade: websocket;</code></pre></div></li><li>æœåŠ¡ç«¯å“åº”åè®®å‡çº§<div class="hljs code-wrapper"><pre><code class="hljs javascript">HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">101</span> Switching Protocols</code></pre></div></li></ol></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
      <tag>http</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jsè¿è¡Œæœºåˆ¶</title>
    <link href="/2022/02/24/js%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/"/>
    <url>/2022/02/24/js%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/</url>
    
    <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/10714ad38f9a">ref:javascript è¿è¡Œæœºåˆ¶ EventLoop</a></p><h2 id="JS-çš„å•çº¿ç¨‹"><a href="#JS-çš„å•çº¿ç¨‹" class="headerlink" title="JS çš„å•çº¿ç¨‹"></a>JS çš„å•çº¿ç¨‹</h2><p>JavaScript çš„å•çº¿ç¨‹ï¼Œä¸å®ƒçš„ç”¨é€”æœ‰å…³ã€‚ä½œä¸ºæµè§ˆå™¨è„šæœ¬è¯­è¨€ï¼ŒJavaScript çš„ä¸»è¦ç”¨é€”æ˜¯ä¸ç”¨æˆ·äº’åŠ¨ï¼Œä»¥åŠæ“ä½œ DOMã€‚è¿™å†³å®šäº†å®ƒåªèƒ½æ˜¯å•çº¿ç¨‹,ä¿è¯æ‰§è¡Œä»»åŠ¡çš„æœ‰åºå¹¶é¿å¼€å¤æ‚çš„åŒæ­¥é—®é¢˜ã€‚</p><h2 id="EventLoop"><a href="#EventLoop" class="headerlink" title="EventLoop"></a>EventLoop</h2><ul><li>js æ˜¯å•çº¿ç¨‹è¿è¡Œçš„</li><li>æµè§ˆå™¨æ˜¯å¤šçº¿ç¨‹çš„</li></ul><p>åœ¨ä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œé€šè¿‡å°†ä¸åŒå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å‹å…¥æ‰§è¡Œæ ˆä¸­æ¥ä¿è¯ä»£ç çš„æœ‰åºæ‰§è¡Œã€‚å¦‚æœé‡åˆ°äº†å¼‚æ­¥ä»»åŠ¡ï¼Œjs å¼•æ“å¹¶ä¸ä¼šä¸€ç›´ç­‰å¾…å…¶è¿”å›ç»“æœï¼Œè€Œæ˜¯ä¼šå°†è¿™ä¸ªäº‹ä»¶çš„å›è°ƒæ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œç»§ç»­æ‰§è¡Œæ‰§è¡Œæ ˆä¸­çš„å…¶ä»–ä»»åŠ¡ã€‚å½“æ‰§è¡Œæ ˆæ¸…ç©ºåï¼Œå†å»ä»»åŠ¡é˜Ÿåˆ—è¯»å–å¼‚æ­¥å‡½æ•°çš„å›è°ƒåŠ å…¥æ‰§è¡Œæ ˆä¸­æ‰§è¡Œã€‚</p><ul><li><p>äº‹ä»¶å¾ªç¯</p><ol><li>jsåŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œåœ¨è¿™æœŸé—´å¯èƒ½æ¨å…¥å¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡</li><li>æ‰§è¡ŒåŒæ­¥å‡½æ•°</li><li>å°†å¼‚æ­¥å‡½æ•°å°†å…¶å›è°ƒåˆ†åˆ«åŠ å…¥<em>å®ä»»åŠ¡é˜Ÿåˆ—</em>å’Œ<em>å¾®ä»»åŠ¡é˜Ÿåˆ—</em></li><li>æ‰§è¡Œæ ˆä¸ºç©ºåï¼ˆåŒæ­¥å‡½æ•°æ‰§è¡Œå®Œï¼‰ï¼Œè¯»å–å¾®ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œ</li><li>æ‰§è¡Œæ ˆä¸ºç©ºåï¼Œè¯»å–å®ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œ</li><li>æ‰§è¡Œæ ˆä¸ºç©ºåï¼Œå¦‚æœè¯¥å®ä»»åŠ¡ç»§ç»­äº§ç”Ÿå¾®ä»»åŠ¡åˆ™éœ€è¦æ‰§è¡Œå®Œæ–°çš„å¾®ä»»åŠ¡<ol><li>æ‰§è¡Œå®Œæœ¬è½®ä»»åŠ¡</li></ol></li></ol></li></ul><h2 id="ä»»åŠ¡é˜Ÿåˆ—"><a href="#ä»»åŠ¡é˜Ÿåˆ—" class="headerlink" title="ä»»åŠ¡é˜Ÿåˆ—"></a>ä»»åŠ¡é˜Ÿåˆ—</h2><p>å¼‚æ­¥ä»»åŠ¡é€šè¿‡ä»»åŠ¡é˜Ÿåˆ—æ¥ç®¡ç†ï¼Œä»»åŠ¡è¢«åˆ†ä¸ºä¸¤ç±»ï¼šå¾®ä»»åŠ¡ï¼ˆ<code>micro task</code>ï¼‰å’Œå®ä»»åŠ¡ï¼ˆ<code>macro task</code>ï¼‰</p><ul><li><p>å¾®ä»»åŠ¡ï¼ˆjså¼•æ“è‡ªå·±å‘èµ·çš„ä»»åŠ¡ï¼‰åŒ…æ‹¬ <code>process.nextTick</code> ï¼Œ<code>promise.then</code> ï¼Œ<code>catch</code>,<code>finally</code> ï¼Œ<code>MutationObserver</code></p><ul><li>  NOTE:<code>nextTick</code>ä¼šæå‡åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—çš„æ ˆé¡¶</li><li>  NOTE:é‡åˆ° <code>await</code>æ—¶,å¯¹<code>await</code>å³ä¾§è¿›è¡Œè®¡ç®—,æ¥ç€å…ˆå»å»æ‰§è¡Œ<code>async</code>å¤–éƒ¨çš„åŒæ­¥å‡½æ•°,åå†å›åˆ°<code>async</code>å‡½æ•°ä¸­</li></ul></li><li><p>  å®ä»»åŠ¡ï¼ˆå®¿ä¸»ç¯å¢ƒ[æµè§ˆå™¨ï¼Œnode]ä¸‹å‘çš„ä»»åŠ¡ï¼‰åŒ…æ‹¬ <code>setTimeout</code> ï¼Œ<code>setInterval</code> ï¼Œ<code>setImmediate</code> ï¼Œ<code>I/O</code>æ“ä½œ ï¼Œ<code>UI</code>æ¸²æŸ“</p></li></ul><h2 id="é¢è¯•é¢˜"><a href="#é¢è¯•é¢˜" class="headerlink" title="é¢è¯•é¢˜"></a>é¢è¯•é¢˜</h2><ol><li><p>```javascript<br> // 1<br> console.log(â€œscript startâ€); // 1</p><p> setTimeout(function () {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;setTimeout&quot;); // 4</code></pre></div><p> }, 0);</p><p> Promise.resolve()</p><div class="hljs code-wrapper"><pre><code class="hljs"> .then(function () &#123;     console.log(&quot;promise1&quot;); //2 &#125;) .then(function () &#123;     console.log(&quot;promise2&quot;); //3 &#125;);</code></pre></div> <div class="hljs code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-number">1.</span>  ```<span class="javascript">javascript</span><span class="javascript">    <span class="hljs-comment">// 2</span></span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;1&quot;</span>); <span class="hljs-comment">//1</span></span><span class="javascript">    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;2&quot;</span>); <span class="hljs-comment">// 5</span></span><span class="javascript">    process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;3&quot;</span>); <span class="hljs-comment">//7</span></span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;4&quot;</span>); <span class="hljs-comment">//6</span></span><span class="javascript">    resolve();</span><span class="javascript">    &#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;5&quot;</span>); <span class="hljs-comment">//8</span></span><span class="javascript">    &#125;);</span><span class="javascript">    &#125;);</span><span class="javascript">    process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;6&quot;</span>); <span class="hljs-comment">//3</span></span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;7&quot;</span>); <span class="hljs-comment">//2</span></span><span class="javascript">    resolve();</span><span class="javascript">    &#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;8&quot;</span>); <span class="hljs-comment">//4</span></span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;9&quot;</span>); <span class="hljs-comment">//9</span></span><span class="javascript">    process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;10&quot;</span>); <span class="hljs-comment">//11</span></span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;11&quot;</span>); <span class="hljs-comment">//10</span></span><span class="javascript">    resolve();</span><span class="javascript">    &#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;12&quot;</span>);</span><span class="javascript">    &#125;); <span class="hljs-comment">//12</span></span><span class="javascript">    &#125;);</span></code></pre></div></li><li><p>```javascript<br> // 3<br> async function async1() {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(1); //1 new Promise(() =&gt; &#123;     console.log(2); //2 &#125;); Promise.resolve().then(() =&gt; &#123;     console.log(&quot;å¼‚æ­¥3&quot;); //6 &#125;); console.log(&quot;åŒæ­¥3&quot;); //3</code></pre></div><p> }</p><p> Promise.resolve().then(() =&gt; {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(4); //5</code></pre></div><p> });</p><p> setTimeout(() =&gt; {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(5); //7</code></pre></div><p> });</p><p> async1();</p><p> console.log(6); //4</p> <div class="hljs code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-number">1.</span>  ```<span class="javascript">javascript</span><span class="javascript">    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;å®šæ—¶å™¨å¼€å§‹å•¦&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;é©¬ä¸Šæ‰§è¡Œforå¾ªç¯å•¦&quot;</span>);</span><span class="javascript">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) &#123;</span><span class="javascript">    i == <span class="hljs-number">99</span> &amp;&amp; resolve();</span><span class="javascript">    &#125;</span><span class="javascript">    &#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;æ‰§è¡Œthenå‡½æ•°å•¦&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;ä»£ç æ‰§è¡Œç»“æŸ&quot;</span>);</span><span class="javascript">    <span class="hljs-comment">// é©¬ä¸Šæ‰§è¡Œforå¾ªç¯å•¦</span></span><span class="javascript">    <span class="hljs-comment">// ä»£ç æ‰§è¡Œç»“æŸ</span></span><span class="javascript">    <span class="hljs-comment">// æ‰§è¡Œthenå‡½æ•°å•¦</span></span><span class="javascript">    <span class="hljs-comment">// å®šæ—¶å™¨å¼€å§‹å•¦</span></span></code></pre></div></li><li><p>```javascript<br> setTimeout(function () {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;setTimeout&quot;);</code></pre></div><p> });</p><p> new Promise(function (resolve) {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;promise&quot;); resolve();</code></pre></div><p> }).then(function () {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;then&quot;);</code></pre></div><p> });</p><p> console.log(â€œconsoleâ€);</p><p> // promise<br> // console<br> // then<br> // setTimeout</p> <div class="hljs code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-number">1.</span>  ```<span class="javascript">javascript</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;1&quot;</span>);</span><span class="javascript">    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-comment">// console.log(&#x27;2&#x27;);</span></span><span class="javascript">    process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;3&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;</span><span class="javascript">    <span class="hljs-comment">// console.log(&#x27;4&#x27;);</span></span><span class="javascript">    resolve();</span><span class="javascript">    &#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;5&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    &#125;);</span><span class="javascript">    process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;6&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;7&quot;</span>);</span><span class="javascript">    resolve();</span><span class="javascript">    &#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;8&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;10&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;</span><span class="javascript">    resolve();</span><span class="javascript">    &#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;12&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    &#125;);</span></code></pre></div></li><li><p>```javascript<br> setTimeout(() =&gt; {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(1);</code></pre></div><p> }, 0);<br> Promise.resolve().then(() =&gt; {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(2);</code></pre></div><p> });<br> console.log(3);</p><p> // 3 2<br> // 1</p> <div class="hljs code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-number">1.</span>  ```<span class="javascript">javascript</span><span class="javascript">    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>);</span><span class="javascript">    &#125;, <span class="hljs-number">0</span>);</span><span class="javascript">    <span class="hljs-keyword">let</span> a = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>);</span><span class="javascript">    resolve();</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">3</span>);</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">4</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">5</span>);</span><span class="javascript">    <span class="hljs-comment">// 2 5 3 4</span></span><span class="javascript">    <span class="hljs-comment">// 1</span></span></code></pre></div></li><li><p>```javascript<br> let a = new Promise((resolve) =&gt; {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(2); resolve();</code></pre></div><p> }).then(() =&gt; {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(5);</code></pre></div><p> });<br> a.then(() =&gt; {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(3);</code></pre></div><p> });<br> a.then(() =&gt; {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(4);</code></pre></div><p> });</p><p> // 2 5 3 4</p> <div class="hljs code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-number">1.</span>  ```<span class="javascript">javascript</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise1&quot;</span>);</span><span class="javascript">    resolve();</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then11&quot;</span>);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise2&quot;</span>);</span><span class="javascript">    resolve();</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then21&quot;</span>);</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then23&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then12&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-comment">// promise1,then11,promise2,then21,then12,then23</span></span></code></pre></div></li><li><p>```javascript<br> new Promise((resolve, reject) =&gt; {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;promise1&quot;); resolve();</code></pre></div><p> })</p><div class="hljs code-wrapper"><pre><code class="hljs"> .then(() =&gt; &#123;     console.log(&quot;then11&quot;);     return new Promise((resolve, reject) =&gt; &#123;         console.log(&quot;promise2&quot;);         resolve();     &#125;)         .then(() =&gt; &#123;             console.log(&quot;then21&quot;);         &#125;)         .then(() =&gt; &#123;             console.log(&quot;then23&quot;);         &#125;); &#125;) .then(() =&gt; &#123;     console.log(&quot;then12&quot;); &#125;);</code></pre></div><p> // promise1 then11  promise2 then21 then12  then23</p> <div class="hljs code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-number">1.</span>  ```<span class="javascript">javascript</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise1&quot;</span>);</span><span class="javascript">    resolve();</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then11&quot;</span>);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise2&quot;</span>);</span><span class="javascript">    resolve();</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then21&quot;</span>);</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then23&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    &#125;)</span><span class="javascript">    .then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then12&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise3&quot;</span>);</span><span class="javascript">    resolve();</span><span class="javascript">    &#125;).then(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then31&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-comment">//promise1 promise3 then11 promise2 then31 then21 then12 then23</span></span></code></pre></div></li><li><p>```javascript<br> async function async1() {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;async1 start&quot;); await async2(); console.log(&quot;async1 end&quot;);</code></pre></div><p> }</p><p> async function async2() {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;async2&quot;);</code></pre></div><p> }</p><p> console.log(â€œscript startâ€);</p><p> setTimeout(function () {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;settimeout&quot;);</code></pre></div><p> }, 0);</p><p> async1();</p><p> new Promise(function (resolve) {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;promise1&quot;); resolve();</code></pre></div><p> }).then(function () {</p><div class="hljs code-wrapper"><pre><code class="hljs"> console.log(&quot;promise2&quot;);</code></pre></div><p> });<br> console.log(â€œscript endâ€);</p><p> // script start,async1 start,async2,promise1,script end,async1 end,promise2<br> // settimeout</p> <div class="hljs code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-number">1.</span>  ```<span class="javascript">javascript</span><span class="javascript">    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async1</span>(<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;async1 start&quot;</span>); <span class="hljs-comment">// 2</span></span><span class="javascript">    <span class="hljs-keyword">await</span> async2();</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;async1 end&quot;</span>); <span class="hljs-comment">//  7</span></span><span class="javascript">    &#125;</span><span class="javascript">    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async2</span>(<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;async2&quot;</span>); <span class="hljs-comment">// 3</span></span><span class="javascript">    &#125;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;script start&quot;</span>); <span class="hljs-comment">// 1</span></span><span class="javascript">    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;settimeout&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    async1();</span><span class="javascript">    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise1&quot;</span>); <span class="hljs-comment">//4</span></span><span class="javascript">    resolve();</span><span class="javascript">    &#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise2&quot;</span>); <span class="hljs-comment">// 8</span></span><span class="javascript">    &#125;);</span><span class="javascript">    setImmediate(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;setImmediate&quot;</span>);</span><span class="javascript">    &#125;);</span><span class="javascript">    process.nextTick(<span class="hljs-function">() =&gt;</span> &#123;</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;process&quot;</span>); <span class="hljs-comment">// 6</span></span><span class="javascript">    &#125;);</span><span class="javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;script end&quot;</span>); <span class="hljs-comment">// 5</span></span><span class="javascript">    <span class="hljs-comment">//script start,async1 start,async2,promise1,script end,process,async1 end,promise2</span></span><span class="javascript">    <span class="hljs-comment">//sttimeout,setImmediate</span></span></code></pre></div></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¾…æ•´ç†çš„jsç‰‡æ®µ</title>
    <link href="/2022/02/24/js%E7%89%87%E6%AE%B5/"/>
    <url>/2022/02/24/js%E7%89%87%E6%AE%B5/</url>
    
    <content type="html"><![CDATA[<ul><li>å­—æ¯çš„æ‰€æœ‰ç»„åˆ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> anagrams = <span class="hljs-function"><span class="hljs-params">str</span> =&gt;</span> &#123;  <span class="hljs-keyword">if</span>(str.length===<span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> [str , str[<span class="hljs-number">1</span>] + str[<span class="hljs-number">0</span>]]  <span class="hljs-comment">// æ‰‹å†™é•¿åº¦ä¸º2æ—¶å€™çš„æ’åˆ—</span>  <span class="hljs-comment">// è¿™é‡Œä½¿ç”¨reduceçš„ç¬¬ä¸‰ä¸ªå‚æ•°indexï¼Œæ­£åœ¨å¤„ç†çš„å…ƒç´ </span>  <span class="hljs-comment">// å¦‚æœæä¾›äº†initialValueï¼Œåˆ™èµ·å§‹ç´¢å¼•å·ä¸º0ï¼Œå¦åˆ™ä»ç´¢å¼•1èµ·å§‹ã€‚</span>  <span class="hljs-keyword">return</span> str.split(<span class="hljs-string">&#x27;&#x27;</span>).reduce(<span class="hljs-function">(<span class="hljs-params">acc,cur,index</span>)=&gt;</span>&#123;    <span class="hljs-keyword">let</span> other = str.slice(<span class="hljs-number">0</span>,index)+str.slice(index+<span class="hljs-number">1</span>)    <span class="hljs-comment">// otherä¸ºé™¤äº†å½“å‰å¤„ç†å…ƒç´ å¤–çš„å­—æ¯</span>    <span class="hljs-comment">// a bcd =&gt;</span>    <span class="hljs-comment">// b cd =&gt; bcd bdc</span>    <span class="hljs-comment">// c bd =&gt; cbd cdb</span>    <span class="hljs-comment">// d bc =&gt; dbc dcb</span>    <span class="hljs-comment">// b...</span>    <span class="hljs-keyword">return</span> acc.push(anagrams(other).map(<span class="hljs-function"><span class="hljs-params">char</span>=&gt;</span>cur+char))    <span class="hljs-comment">// é€’å½’è‡³ä¸¤ä½æ•°æ•°ç»„é¢ å€’æ’åº,å¹¶å°†æ‰€æœ‰å¯èƒ½ä¸å½“å‰å¤„ç†å…ƒç´ ç»„åˆ</span>  &#125;,[])  <span class="hljs-comment">// æŒ‡å®šinitialValue</span>&#125;anagrams(<span class="hljs-string">&#x27;abcd&#x27;</span>) =&gt; [  <span class="hljs-string">&#x27;abcd&#x27;</span>, <span class="hljs-string">&#x27;abdc&#x27;</span>, <span class="hljs-string">&#x27;acbd&#x27;</span>,  <span class="hljs-string">&#x27;acdb&#x27;</span>, <span class="hljs-string">&#x27;adbc&#x27;</span>, <span class="hljs-string">&#x27;adcb&#x27;</span>,  <span class="hljs-string">&#x27;bacd&#x27;</span>, <span class="hljs-string">&#x27;badc&#x27;</span>, <span class="hljs-string">&#x27;bcad&#x27;</span>,  <span class="hljs-string">&#x27;bcda&#x27;</span>, <span class="hljs-string">&#x27;bdac&#x27;</span>, <span class="hljs-string">&#x27;bdca&#x27;</span>,  <span class="hljs-string">&#x27;cabd&#x27;</span>, <span class="hljs-string">&#x27;cadb&#x27;</span>, <span class="hljs-string">&#x27;cbad&#x27;</span>,  <span class="hljs-string">&#x27;cbda&#x27;</span>, <span class="hljs-string">&#x27;cdab&#x27;</span>, <span class="hljs-string">&#x27;cdba&#x27;</span>,  <span class="hljs-string">&#x27;dabc&#x27;</span>, <span class="hljs-string">&#x27;dacb&#x27;</span>, <span class="hljs-string">&#x27;dbac&#x27;</span>,  <span class="hljs-string">&#x27;dbca&#x27;</span>, <span class="hljs-string">&#x27;dcab&#x27;</span>, <span class="hljs-string">&#x27;dcba&#x27;</span>]</code></pre></div><ul><li>Deep flatten array</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> deepFlatten = <span class="hljs-function">(<span class="hljs-params">arr</span>) =&gt;</span>  arr.reduce(<span class="hljs-function">(<span class="hljs-params">a, v</span>) =&gt;</span> a.concat(<span class="hljs-built_in">Array</span>.isArray(v) ? deepFlatten(v) : v), []);<span class="hljs-comment">// deepFlatten([1,[2],[[3],4],5]) -&gt; [1,2,3,4,5]</span></code></pre></div><ul><li>bifurcate</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> bifurcate = <span class="hljs-function">(<span class="hljs-params">arr, filter</span>) =&gt;</span>  arr.reduce(<span class="hljs-function">(<span class="hljs-params">acc, val, i</span>) =&gt;</span> (acc[filter[i] ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>].push(val), acc), [    [],    [],  ]);bifurcate([<span class="hljs-string">&quot;beep&quot;</span>, <span class="hljs-string">&quot;boop&quot;</span>, <span class="hljs-string">&quot;foo&quot;</span>, <span class="hljs-string">&quot;bar&quot;</span>], [<span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);<span class="hljs-comment">// [ [&#x27;beep&#x27;, &#x27;boop&#x27;, &#x27;bar&#x27;], [&#x27;foo&#x27;] ]</span></code></pre></div><ul><li>é˜¶ä¹˜</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> factorial = <span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> (n &lt;= <span class="hljs-number">1</span> ? <span class="hljs-number">1</span> : n * factorial(n - <span class="hljs-number">1</span>));<span class="hljs-comment">// factorial(6) -&gt; 720</span></code></pre></div><ul><li>æ–æ³¢é‚£å¥‘æ•°ç»„ç”Ÿæˆå™¨</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> fibonacci = <span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span>  <span class="hljs-built_in">Array</span>(n)    .fill(<span class="hljs-number">0</span>)    .reduce(      (acc, val, i) =&gt; acc.concat(i &gt; <span class="hljs-number">1</span> ? acc[i - <span class="hljs-number">1</span>] + acc[i - <span class="hljs-number">2</span>] : i),      []    );<span class="hljs-comment">// fibonacci(5) -&gt; [0,1,1,2,3]</span><span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">fib</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-keyword">let</span> [pre, cur] = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>];  <span class="hljs-keyword">for</span> (;;) &#123;    <span class="hljs-comment">// æ­»å¾ªç¯çš„å¦ä¸€ç§å†™æ³•</span>    <span class="hljs-comment">// while(true)</span>    [pre, cur] = [cur, cur + pre];    <span class="hljs-keyword">yield</span> cur;  &#125;&#125;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x <span class="hljs-keyword">of</span> fib()) &#123;  <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">100</span>) <span class="hljs-keyword">return</span>;  <span class="hljs-built_in">console</span>.log(x);&#125;</code></pre></div><ul><li>æ•°ç»„ä¸­å”¯ä¸€å€¼</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> filterNonUnique = <span class="hljs-function">(<span class="hljs-params">arr</span>) =&gt;</span>  arr.filter(<span class="hljs-function">(<span class="hljs-params">i</span>) =&gt;</span> arr.indexOf(i) === arr.lastIndexOf(i));<span class="hljs-comment">// filterNonUnique([1,2,2,3,4,4,5]) -&gt; [1,3,5]</span></code></pre></div><ul><li>æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰</li></ul><p>ä½¿ç”¨é€’å½’ã€‚åŸºæœ¬æƒ…å†µæ˜¯å½“ y ç­‰äº 0 æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿”å› xã€‚å¦åˆ™ï¼Œè¿”å› y çš„ GCD å’Œ x / y çš„å…¶ä½™éƒ¨åˆ†ã€‚</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> gcd = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> (!y ? x : gcd(y, x % y));<span class="hljs-comment">// gcd (8, 36) -&gt; 4</span></code></pre></div><ul><li>èŒƒå›´å†…ç”Ÿæˆæ•°ç»„</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> initializeArrayRange = <span class="hljs-function">(<span class="hljs-params">end, start = <span class="hljs-number">0</span></span>) =&gt;</span>  <span class="hljs-built_in">Array</span>.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">Array</span>(end - start)).map(<span class="hljs-function">(<span class="hljs-params">v, i</span>) =&gt;</span> i + start);<span class="hljs-comment">// initializeArrayRange(5) -&gt; [0,1,2,3,4]</span></code></pre></div><ul><li>function è®¡æ—¶</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> timeTaken = <span class="hljs-function">(<span class="hljs-params">callback</span>) =&gt;</span> &#123;  <span class="hljs-built_in">console</span>.time(<span class="hljs-string">&quot;timeTaken&quot;</span>);  <span class="hljs-keyword">const</span> r = callback();  <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">&quot;timeTaken&quot;</span>);  <span class="hljs-keyword">return</span> r;&#125;;<span class="hljs-comment">// timeTaken(() =&gt; Math.pow(2, 10)) -&gt; 1024</span><span class="hljs-comment">// (logged): timeTaken: 0.02099609375ms</span></code></pre></div><ul><li>RGB è½¬åå…­è¿›åˆ¶</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> rgbToHex = <span class="hljs-function">(<span class="hljs-params">r, g, b</span>) =&gt;</span>  ((r &lt;&lt; <span class="hljs-number">16</span>) + (g &lt;&lt; <span class="hljs-number">8</span>) + b).toString(<span class="hljs-number">16</span>).padStart(<span class="hljs-number">6</span>, <span class="hljs-string">&quot;0&quot;</span>);<span class="hljs-comment">// rgbToHex(255, 165, 1) -&gt; &#x27;ffa501&#x27;</span></code></pre></div><ul><li>å­—ç¬¦ä¸²æŒ‰å­—æ¯æ’åº</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> sortCharactersInString = <span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span>  str    .split(<span class="hljs-string">&quot;&quot;</span>)    .sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.localeCompare(b))    .join(<span class="hljs-string">&quot;&quot;</span>);<span class="hljs-comment">// sortCharactersInString(&#x27;cabbage&#x27;) -&gt; &#x27;aabbceg&#x27;</span></code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jsæ¨¡å—åŒ–</title>
    <link href="/2022/02/24/js%E6%A8%A1%E5%9D%97%E5%8C%96/"/>
    <url>/2022/02/24/js%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æ¨¡å—åŒ–çš„æ¼”è¿›è¿‡ç¨‹</p></blockquote><ol><li>æ–‡ä»¶åˆ’åˆ†</li><li>å‘½åç©ºé—´ (å°†æ¯ä¸ªæ¨¡å—æš´éœ²åœ¨å…¨å±€å¯¹è±¡</li><li>IIFE ç«‹å³æ‰§è¡Œå‡½æ•° </li></ol><h2 id="æ¨¡å—åŒ–å¼€å‘çš„æ€æƒ³"><a href="#æ¨¡å—åŒ–å¼€å‘çš„æ€æƒ³" class="headerlink" title="æ¨¡å—åŒ–å¼€å‘çš„æ€æƒ³"></a>æ¨¡å—åŒ–å¼€å‘çš„æ€æƒ³</h2><p>æ¨¡å—åŒ–çš„å¼€å‘æ–¹å¼å¯ä»¥æé«˜ä»£ç å¤ç”¨ç‡ï¼Œæ–¹ä¾¿è¿›è¡Œä»£ç çš„ç®¡ç†ã€‚é€šå¸¸ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œåªå‘å¤–æš´éœ²ç‰¹å®šçš„å˜é‡å’Œå‡½æ•°ã€‚</p><h3 id="CommonJS-Node-js"><a href="#CommonJS-Node-js" class="headerlink" title="CommonJS (Node.js)"></a>CommonJS (Node.js)</h3><ul><li><p>è¿è¡Œåœ¨æœåŠ¡ç«¯</p></li><li><p>ä»£ç åŒæ­¥åŠ è½½</p></li><li><p>ä»£ç å¯ä»¥å¤šæ¬¡åŠ è½½ï¼Œä½†æ˜¯è¿è¡Œç»“æœä¼šè¢«ç¼“å­˜</p></li><li><p><code>require(&#39;xxx&#39;)</code>åŠ è½½æ¨¡å—</p></li><li><p><code>module.exports=&#123;&#125;</code>(å…¨å±€å˜é‡æˆ–æ–¹æ³•)æˆ–<code>exports</code>å®šä¹‰å¯¹å¤–çš„æ¥å£</p></li></ul><h3 id="AMD-require-js"><a href="#AMD-require-js" class="headerlink" title="AMD (require.js)"></a>AMD (require.js)</h3><ul><li><code>Async Module Definition</code></li><li>ä¾èµ–å‰ç½®ï¼Œå®šä¹‰æ¨¡å—æ—¶å°±è¦å£°æ˜ä¾èµ–</li><li>ä»£ç å¼‚æ­¥åŠ è½½ï¼Œä¸”è°å…ˆåŠ è½½å®Œæ‰§è¡Œè°  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// AMD</span>define(<span class="hljs-string">&quot;fooModule&quot;</span>,[<span class="hljs-string">&quot;./a&quot;</span>, <span class="hljs-string">&quot;./b&quot;</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params"></span>)</span>&#123;        a.doSomething();        b.doSomething();    <span class="hljs-comment">// ...å¯èƒ½bæ¯”aå…ˆæ‰§è¡Œäº†</span>    &#125;    <span class="hljs-keyword">return</span>&#123;        foo    &#125;    <span class="hljs-built_in">exports</span>.xxx = ...    <span class="hljs-built_in">module</span>.exports = ...&#125;);<span class="hljs-built_in">require</span>([<span class="hljs-string">&quot;fooModule&quot;</span>,<span class="hljs-string">&#x27;./fooModule.js&#x27;</span>],<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-built_in">module</span>,file</span>) </span>&#123;&#125;)</code></pre></div></li></ul><h3 id="CMD-sea-js"><a href="#CMD-sea-js" class="headerlink" title="CMD (sea.js)"></a>CMD (sea.js)</h3><ul><li><code>Common Module Definition</code></li><li> å®šä¹‰å’ŒåŠ è½½ä¸AMDç›¸åŒ</li><li> ä¾èµ–å¯ä»¥å°±è¿‘ä¹¦å†™</li><li>ä¾èµ–å…¨éƒ¨åŠ è½½å®Œæ‰æŒ‰é¡ºåºæ‰§è¡Œ  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// CMD</span>define(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-built_in">require</span>, <span class="hljs-built_in">exports</span>, <span class="hljs-built_in">module</span></span>) </span>&#123;    <span class="hljs-keyword">var</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./a&quot;</span>);    a.doSomething();    <span class="hljs-keyword">var</span> b = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./b&quot;</span>);     b.doSomething();    <span class="hljs-built_in">exports</span>.xxx = ...    <span class="hljs-built_in">module</span>.exports = ...&#125;);</code></pre></div></li></ul><h3 id="UMD"><a href="#UMD" class="headerlink" title="UMD"></a>UMD</h3><ul><li> <code>Universal Module Definition</code></li><li> å†™æ³•æ˜¯ä¸€ä¸ªè‡ªè¿è¡Œå‡½æ•°</li><li> å…¼å®¹CMD/AMD/å‘½åç©ºé—´</li></ul><h3 id="ES6-MODULE"><a href="#ES6-MODULE" class="headerlink" title="ES6 MODULE"></a>ES6 MODULE</h3><ul><li><p>ï¼ES6æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œ<code>import</code>æŒ‡å‘çš„æ˜¯æ¨¡å—çš„çš„åªè¯»å¼•ç”¨ï¼ˆ<strong>åŠ¨æ€å¼•ç”¨</strong>ï¼‰ï¼Œ<code>export</code>åªæ˜¯æ˜¾å¼æŒ‡å®šè¾“å‡ºçš„ä»£ç </p></li><li><p>ç¼–è¯‘æ—¶åŠ è½½,ç”¨åˆ°æ‰æ‰§è¡Œ</p></li><li><p><code>export</code>å¯¼å‡ºæ¨¡å—,æä¾›<code>export default</code>åˆ¶å®šé»˜è®¤è¾“å‡º</p></li><li><p><code>import</code>å¼•å…¥</p></li><li><p><code>import</code>å’Œ<code>export</code>å‘½ä»¤åªèƒ½å†™åœ¨ä»£ç é¡¶å±‚</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// modules.js</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">x, y</span>) </span>&#123;    <span class="hljs-keyword">return</span> x * y;&#125;<span class="hljs-keyword">export</span> &#123;add <span class="hljs-keyword">as</span> <span class="hljs-keyword">default</span>&#125;;<span class="hljs-comment">// ç­‰åŒäº</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> add;<span class="hljs-comment">// app.js</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> foo &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;modules&#x27;</span>;<span class="hljs-comment">// ç­‰åŒäº</span><span class="hljs-keyword">import</span> foo <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;modules&#x27;</span>;</code></pre></div></li></ul><h3 id="ES6-MODULEå’ŒCommonJSçš„åŒºåˆ«"><a href="#ES6-MODULEå’ŒCommonJSçš„åŒºåˆ«" class="headerlink" title="ES6 MODULEå’ŒCommonJSçš„åŒºåˆ«"></a>ES6 MODULEå’ŒCommonJSçš„åŒºåˆ«</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// CommonJSæ¨¡å—</span><span class="hljs-comment">// è¿è¡Œæ—¶åŠ è½½</span><span class="hljs-keyword">let</span> &#123; stat, exists, readFile &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<span class="hljs-comment">// ç­‰åŒäº</span><span class="hljs-keyword">let</span> _fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<span class="hljs-keyword">let</span> stat = _fs.stat;<span class="hljs-keyword">let</span> exists = _fs.exists;<span class="hljs-keyword">let</span> readfile = _fs.readfile;<span class="hljs-comment">//ä¸Šé¢ä»£ç çš„å®è´¨æ˜¯æ•´ä½“åŠ è½½fsæ¨¡å—ï¼ˆå³åŠ è½½fsçš„æ‰€æœ‰æ–¹æ³•ï¼‰ï¼Œç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼ˆ_fsï¼‰ï¼Œç„¶åå†ä»è¿™ä¸ªå¯¹è±¡ä¸Šé¢è¯»å– 3 ä¸ªæ–¹æ³•ã€‚è¿™ç§åŠ è½½ç§°ä¸ºâ€œè¿è¡Œæ—¶åŠ è½½â€</span>modules.exports xxx<span class="hljs-comment">//CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ï¼Œè¾“å‡ºåæ¨¡å—å†…éƒ¨çš„å˜åŒ–å°±å½±å“ä¸åˆ°è¿™ä¸ªå€¼</span><span class="hljs-comment">// ES6</span><span class="hljs-comment">// ç¼–è¯‘æ—¶åŠ è½½</span><span class="hljs-keyword">import</span> &#123; stat, exists, readFile &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;fs&#x27;</span>;<span class="hljs-comment">//ç¼–è¯‘æ—¶å°±å®Œæˆæ¨¡å—åŠ è½½ï¼Œï¼ˆç¡®å®šäº†æŒ‡é’ˆ</span><span class="hljs-comment">//å½“ç„¶ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†æ²¡æ³•å¼•ç”¨ ES6 æ¨¡å—æœ¬èº«ï¼Œå› ä¸ºå®ƒä¸æ˜¯å¯¹è±¡</span><span class="hljs-built_in">exports</span> <span class="hljs-keyword">default</span> xxx<span class="hljs-comment">// ES6 MODULESè¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œè¿è¡Œæ—¶æ‰åˆ°æŒ‡å®šæ¨¡å—ä¸­å–å€¼</span></code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jsé¢è¯•é¢˜é›†</title>
    <link href="/2022/02/24/js%E9%9D%A2%E8%AF%95%E9%A2%98%E9%9B%86/"/>
    <url>/2022/02/24/js%E9%9D%A2%E8%AF%95%E9%A2%98%E9%9B%86/</url>
    
    <content type="html"><![CDATA[<ul><li>  æ‰§è¡Œé¡ºåº</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;setTimeout&quot;</span>);&#125;);<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promishe&quot;</span>);&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;then&quot;</span>);&#125;);<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;console&quot;</span>);<span class="hljs-comment">//æ‰§è¡Œç»“æœ</span><span class="hljs-comment">//promise</span><span class="hljs-comment">//console</span><span class="hljs-comment">//then</span><span class="hljs-comment">//setTimeout</span><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;1&quot;</span>);&#125;);<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;2&quot;</span>);resolve();&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;3&quot;</span>);&#125;);<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;4&quot;</span>);<span class="hljs-comment">//2</span><span class="hljs-comment">//4</span><span class="hljs-comment">//3</span><span class="hljs-comment">//1</span><span class="hljs-comment">//thenæ˜¯Promiseçš„å¾®ä»»åŠ¡,new Promise</span></code></pre></div><ul><li><p>æµ…æ‹·è´</p><ol><li><code>Object.assign()</code></li><li>å±•å¼€è¿ç®—ç¬¦</li></ol></li><li><p>æ·±æ‹·è´</p><ol><li><p><code>JSON.parse(JSON.stringify(source))</code></p><ul><li><p>å…ˆ JSON.stringify è½¬æˆå­—ç¬¦ä¸²ï¼Œå† JSON.parse æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ–°çš„å¯¹è±¡</p></li><li><p><strong>é‡åˆ° Symbol å’Œå‡½æ•°åˆ™æŠ¥é”™</strong></p></li></ul></li><li><p>æ‰‹åŠ¨å®ç° deepClone</p></li></ol>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> isObject = <span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> obj !== <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">&quot;object&quot;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepClone</span>(<span class="hljs-params">source, cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakSet</span>()</span>) </span>&#123;<span class="hljs-comment">// WeakSetåªèƒ½ä¿å­˜å¯¹è±¡å¼•ç”¨ï¼ï¼ä¸”å¼±å¼•ç”¨</span><span class="hljs-keyword">if</span> (!isObject(source) || cache.has(source)) <span class="hljs-keyword">return</span> source;<span class="hljs-keyword">const</span> <span class="hljs-title">constructor</span> = <span class="hljs-title">source</span>.<span class="hljs-title">constructor</span>;<span class="hljs-keyword">const</span> res = <span class="hljs-title">constructor</span> === <span class="hljs-title">Object</span> ? &#123;&#125; : <span class="hljs-keyword">new</span> <span class="hljs-title">constructor</span>(<span class="hljs-params">source</span>);<span class="hljs-comment">// ç”¨constructoråˆ¤æ–­å¤„ç†å…¶ä»–å¤æ‚ç±»å‹çš„å¯¹è±¡</span><span class="hljs-comment">// eg:Dateå¯¹è±¡å¦‚æœä½¿ç”¨typeof è¿”å›object</span><span class="hljs-comment">// åŠ å…¥ç¼“å­˜ä¸­</span><span class="hljs-comment">// å¤„ç†å¾ªç¯å¼•ç”¨</span>cache.add(source);<span class="hljs-built_in">Reflect</span>.ownKeys(source).forEach(<span class="hljs-function">(<span class="hljs-params">k</span>) =&gt;</span> &#123;res[k] = deepClone(source[k], cache);&#125;);<span class="hljs-keyword">return</span> res;&#125;</code></pre></div></li><li><p>forâ€¦in /forâ€¦of</p><ul><li><p>forâ€¦in è¯­å¥ä»¥ä»»æ„é¡ºåºéå†ä¸€ä¸ªå¯¹è±¡çš„é™¤ Symbol ä»¥å¤–çš„<em>å¯æšä¸¾</em>å±æ€§,é™¤äº†éå†å¯¹è±¡ä¸­çš„å…ƒç´ ä¹‹å¤–ï¼Œè¿˜å›å»éå†è‡ªå®šä¹‰çš„å±æ€§ï¼Œç”šè‡³åŸå‹é“¾ä¸Šçš„å±æ€§<br>  <code>javascript const o = &#123;a:1,b:2&#125; Object.defineProperty(o,&#39;c&#39;,&#123;enumerable:false, value:30&#125;) for(let i in o)&#123; console.log(i) &#125; // a // b </code></p></li><li><p>  forâ€¦of åˆ™åªè°ƒç”¨å¯è¿­ä»£å¯¹è±¡çš„[Symbol.Iterator]æ¥å£éå†å¯¹è±¡</p></li></ul>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype.extraFn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;extraFn&quot;</span>;&#125;;<span class="hljs-keyword">var</span> myArray = [<span class="hljs-string">&quot;1&quot;</span>, &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;mmm&quot;</span> &#125;, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>];myArray.name = <span class="hljs-string">&quot;å•¦å•¦å•¦&quot;</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> value <span class="hljs-keyword">of</span> myArray) &#123;<span class="hljs-built_in">console</span>.log(value);&#125;<span class="hljs-comment">//1 &#123;name: &quot;mmm&quot;&#125; 3 4 5 6 7</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> index <span class="hljs-keyword">in</span> myArray) &#123;<span class="hljs-built_in">console</span>.log(myArray[index]);&#125;<span class="hljs-comment">// 1</span><span class="hljs-comment">// &#123; name: &#x27;mmm&#x27; &#125;</span><span class="hljs-comment">// 4</span><span class="hljs-comment">// 5</span><span class="hljs-comment">// 6</span><span class="hljs-comment">// 7</span><span class="hljs-comment">// å•¦å•¦å•¦</span><span class="hljs-comment">// [Function]</span></code></pre></div></li><li><p>  é˜»æ­¢å†’æ³¡å’Œé»˜è®¤äº‹ä»¶</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stopBubble</span>(<span class="hljs-params">e</span>) </span>&#123;<span class="hljs-keyword">if</span> (e &amp;&amp; e.stopPropagation) &#123;e.stopPropagation();&#125; <span class="hljs-keyword">else</span> <span class="hljs-built_in">window</span>.event.cancelBubble = <span class="hljs-literal">true</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stopDefault</span>(<span class="hljs-params">e</span>) </span>&#123;<span class="hljs-keyword">if</span> (e &amp;&amp; e.preventDefault) e.preventDefault();<span class="hljs-keyword">else</span> <span class="hljs-built_in">window</span>.event.returnValue = <span class="hljs-literal">false</span>;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#125;</code></pre></div><ul><li><p>for å¾ªç¯å®ç°éå†æ–¹æ³•</p><ul><li><p>for å¾ªç¯å®ç° forEach</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype._forEach = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, context</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;this is null or undefined&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(callback + <span class="hljs-string">&quot;must be a function&quot;</span>);&#125;context = context || <span class="hljs-built_in">this</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">this</span>.length; i++) &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.hasOwnProperty(i)) &#123;callback.call(context, <span class="hljs-built_in">this</span>[i], i, <span class="hljs-built_in">this</span>);&#125;&#125;&#125;;</code></pre></div></li><li><p>for å¾ªç¯å®ç° map</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype._map = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, thisArg</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;this is null or undefined&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(callback + <span class="hljs-string">&quot;must be a function&quot;</span>);&#125;<span class="hljs-keyword">const</span> result = [];thisArg = thisArg || <span class="hljs-built_in">this</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">this</span>.length; i++) &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.hasOwnProperty(i)) &#123;result[i] = callback.call(thisArg, <span class="hljs-built_in">this</span>[i], i, <span class="hljs-built_in">this</span>);&#125;&#125;<span class="hljs-keyword">return</span> result;&#125;;</code></pre></div></li><li><p>for å¾ªç¯å®ç° filter</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype._filter_ = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, thisArg</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;this is null or undefined&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(callback + <span class="hljs-string">&quot;must be a function&quot;</span>);&#125;<span class="hljs-keyword">const</span> result = [];thisArg = thisArg || <span class="hljs-built_in">this</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">this</span>.length; i++) &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.hasOwnProperty(i)) &#123;<span class="hljs-keyword">if</span> (callback.call(thisArg, <span class="hljs-built_in">this</span>[i], i, <span class="hljs-built_in">this</span>)) &#123;result.push(<span class="hljs-built_in">this</span>[i]);&#125;&#125;&#125;<span class="hljs-keyword">return</span> result;&#125;;</code></pre></div></li><li><p>for å¾ªç¯å®ç° some</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype._some = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, thisArg</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;this is null or undefined&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(callback + <span class="hljs-string">&quot;must be a function&quot;</span>);&#125;thisArg = thisArg || <span class="hljs-built_in">this</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">this</span>.length; i++) &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.hasOwnProperty(i)) &#123;<span class="hljs-keyword">if</span> (callback.call(thisArg, <span class="hljs-built_in">this</span>[i], i, <span class="hljs-built_in">this</span>)) &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#125;&#125;&#125;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#125;;</code></pre></div></li><li><p>for å¾ªç¯å®ç° every</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype._every = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, thisArg</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;this is null or undefined&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(callback + <span class="hljs-string">&quot;must be a function&quot;</span>);&#125;thisArg = thisArg || <span class="hljs-built_in">this</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">this</span>.length; i++) &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.hasOwnProperty(i)) &#123;<span class="hljs-keyword">if</span> (!callback.call(thisArg, <span class="hljs-built_in">this</span>[i], i, <span class="hljs-built_in">this</span>)) &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#125;&#125;&#125;<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#125;;</code></pre></div></li><li><p>for å¾ªç¯å®ç° reduce</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype._reduce = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, initialValue</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;this is null or undefined&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(callback + <span class="hljs-string">&quot;must be a function&quot;</span>);&#125;<span class="hljs-keyword">let</span> res;<span class="hljs-keyword">let</span> initialIndex = <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> (!initialValue) &#123;<span class="hljs-keyword">for</span> (; initialIndex &lt; <span class="hljs-built_in">this</span>.length; initialIndex++) &#123;<span class="hljs-comment">// æœªæŒ‡å®šåˆå§‹å€¼åˆ™è‡ªè¡ŒæŸ¥æ‰¾ç¬¬ä¸€ä¸ªéç©ºä¸‹æ ‡</span><span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.hasOwnProperty(initialIndex)) &#123;res = <span class="hljs-built_in">this</span>[i];<span class="hljs-keyword">break</span>;&#125;&#125;&#125; <span class="hljs-keyword">else</span> &#123;res = initialValue;&#125;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = initialIndex + <span class="hljs-number">1</span>; j &lt; <span class="hljs-built_in">this</span>.length; j++) &#123;res = callback.call(<span class="hljs-literal">null</span>, res, <span class="hljs-built_in">this</span>[j], j, <span class="hljs-built_in">this</span>);&#125;<span class="hljs-keyword">return</span> res;&#125;;</code></pre></div></li></ul></li><li><p>reduce å®ç°éå†æ–¹æ³•</p><ul><li>  reduce å®ç° forEach</li></ul>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype._forEach = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, thisArg</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;this is null or undefined&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(callback + <span class="hljs-string">&quot;must be a function&quot;</span>);&#125;<span class="hljs-comment">/*æ— è¿”å›*/</span><span class="hljs-built_in">this</span>.reduce(<span class="hljs-function">(<span class="hljs-params">pre, acc, index</span>) =&gt;</span> &#123;<span class="hljs-keyword">return</span> [...pre, callback.call(thisArg, acc, index, <span class="hljs-built_in">this</span>)];&#125;, []);&#125;;</code></pre></div><ul><li>  reduce å®ç° map</li></ul>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"> <span class="hljs-built_in">Array</span>.prototype._map = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, thisArg</span>) </span>&#123; <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == <span class="hljs-literal">null</span>) &#123; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;this is null or undefined&quot;</span>); &#125; <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(callback + <span class="hljs-string">&quot;must be a function&quot;</span>); &#125;<span class="hljs-comment">/*æœ‰è¿”å›*/</span><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.reduce(<span class="hljs-function">(<span class="hljs-params">pre,acc,index</span>)=&gt;</span>&#123;<span class="hljs-keyword">return</span> pre.concat(callback.call(thisArg, acc, index, <span class="hljs-built_in">this</span>))&#125;,[]) &#125;;</code></pre></div><ul><li>  reduce å®ç° filter</li></ul>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Array</span>.prototype._filter = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, thisArg</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&quot;this is null or undefined&quot;</span>);&#125;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">&quot;function&quot;</span>) &#123;<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(callback + <span class="hljs-string">&quot;must be a function&quot;</span>);&#125;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.reduce(<span class="hljs-function">(<span class="hljs-params">pre, acc</span>) =&gt;</span> &#123;<span class="hljs-keyword">return</span> callback.call(thisArg, acc, index, <span class="hljs-built_in">this</span>) ? [...pre, cur] : [...pre];&#125;, []);&#125;;</code></pre></div></li><li><p>æ•°ç»„çš„æ‰€æœ‰æ’åˆ—ç»„åˆ</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exchange</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-comment">//[[1,2,3],[4,5,6],[7,8,9]]</span><span class="hljs-comment">// æ¯ä¸ªæ•°ç»„ä¸­å–ä¸€ä¸ªå€¼ç»„æˆæ–°çš„æ•°å­—</span><span class="hljs-comment">// åˆ—å‡ºæ‰€æœ‰çš„æ’åˆ—å¯èƒ½æ€§</span><span class="hljs-keyword">let</span> len = arr.length;<span class="hljs-keyword">if</span> (len &gt;= <span class="hljs-number">2</span>) &#123;<span class="hljs-keyword">let</span> len1 = arr[<span class="hljs-number">0</span>].length;<span class="hljs-keyword">let</span> len2 = arr[<span class="hljs-number">1</span>].length;<span class="hljs-keyword">let</span> lenBoth = len1 * len2;<span class="hljs-keyword">let</span> items = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(lenBoth);<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len1; i++) &#123;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; len2; j++) &#123;items[index] = [].concat(arr[<span class="hljs-number">0</span>][i]).concat(arr[<span class="hljs-number">1</span>][j]);index++;&#125;&#125;<span class="hljs-comment">// æ±‚å‡ºå‰ä¸¤ä¸ªæ•°ç»„çš„ç»„åˆ</span><span class="hljs-comment">// æ¥ä¸‹æ¥è°ƒæ•´æ•°ç»„ï¼Œé€’å½’è°ƒç”¨</span><span class="hljs-comment">// æ‹¼æ¥å‰©ä½™å‚æ•°æ•°ç»„</span><span class="hljs-keyword">return</span> exchange(items, ...arr.slice(<span class="hljs-number">2</span>));&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> arr[<span class="hljs-number">0</span>];&#125;&#125;</code></pre></div></li><li><p>  å±æ€§åè¡¨è¾¾å¼</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> a = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">10</span> &#125;;<span class="hljs-keyword">let</span> b = &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">10</span> &#125;;<span class="hljs-keyword">let</span> obj = &#123;  a: <span class="hljs-number">10</span>,&#125;;obj[b] = <span class="hljs-number">20</span>;<span class="hljs-built_in">console</span>.log(obj[a]); <span class="hljs-comment">// 20</span><span class="hljs-comment">//obj.bå’Œobj[b]çš„ä¸åŒ</span>obj[éœ€è¦æ˜¯å·²ç»å£°æ˜çš„å˜é‡å]obj.åˆ™ä¸å—é™åˆ¶obj.c = <span class="hljs-number">20</span> ===&gt; obj:&#123;<span class="hljs-attr">c</span>:<span class="hljs-number">20</span>,<span class="hljs-attr">a</span>:<span class="hljs-number">10</span>&#125;obj[c] <span class="hljs-comment">//æŠ¥é”™</span><span class="hljs-comment">//åŸé¢˜ä¸­obj[b]åæ‰“å°å¾—åˆ°</span>obj = &#123;  a:<span class="hljs-number">10</span>,  <span class="hljs-string">&#x27;[object:object]&#x27;</span> : <span class="hljs-number">20</span>  <span class="hljs-comment">//b = &#123; b: 10 &#125; ===&gt; &#x27;[object:object]&#x27;</span>&#125;åå†è®¿é—®obj[a]æ—¶ä¹Ÿå°±æ˜¯è®¿é—®obj[<span class="hljs-string">&#x27;[object:object]&#x27;</span>] = <span class="hljs-number">20</span></code></pre></div><ul><li>  this çš„æŒ‡å‘</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;<span class="hljs-keyword">var</span> obj = &#123;a: <span class="hljs-number">20</span>,say: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.a);&#125;,&#125;;obj.say();<span class="hljs-comment">// æ‰“å°å‡º10çš„æ–¹æ³•</span><span class="hljs-comment">// 1</span><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;<span class="hljs-keyword">var</span> obj = &#123;a: <span class="hljs-number">20</span>,say: <span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.a);&#125;,&#125;;obj.say();<span class="hljs-comment">// 2</span><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;<span class="hljs-keyword">var</span> obj = &#123;a: <span class="hljs-number">20</span>,say: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.a);&#125;,&#125;;<span class="hljs-keyword">let</span> say = obj.say;say();<span class="hljs-comment">// 3</span><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;<span class="hljs-keyword">var</span> obj = &#123;a: <span class="hljs-number">20</span>,say: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.a);&#125;,&#125;;obj.say.call(<span class="hljs-built_in">this</span>);</code></pre></div><ul><li>  js æ‰§è¡Œé¡ºåº</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// jsæ‰§è¡Œé¡ºåº</span><span class="hljs-comment">// 1</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;script start&quot;</span>); <span class="hljs-comment">// 1</span><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;setTimeout&quot;</span>); <span class="hljs-comment">// 4</span>&#125;, <span class="hljs-number">0</span>);<span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise1&quot;</span>); <span class="hljs-comment">//2</span>&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;promise2&quot;</span>); <span class="hljs-comment">//3</span>&#125;);<span class="hljs-comment">// 2</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;1&quot;</span>); <span class="hljs-comment">//1</span><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;2&quot;</span>); <span class="hljs-comment">// 5</span>process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;3&quot;</span>); <span class="hljs-comment">//7</span>&#125;);<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;4&quot;</span>); <span class="hljs-comment">//6</span>resolve();&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;5&quot;</span>); <span class="hljs-comment">//8</span>&#125;);&#125;);process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;6&quot;</span>); <span class="hljs-comment">//3</span>&#125;);<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;7&quot;</span>); <span class="hljs-comment">//2</span>resolve();&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;8&quot;</span>); <span class="hljs-comment">//4</span>&#125;);<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;9&quot;</span>); <span class="hljs-comment">//9</span>process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;10&quot;</span>); <span class="hljs-comment">//11</span>&#125;);<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;11&quot;</span>); <span class="hljs-comment">//10</span>resolve();&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;12&quot;</span>);&#125;); <span class="hljs-comment">//12</span>&#125;);<span class="hljs-comment">// 3</span><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async1</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>); <span class="hljs-comment">//1</span><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>); <span class="hljs-comment">//2</span>&#125;);<span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;3-1&quot;</span>); <span class="hljs-comment">//6</span>&#125;);<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;3-2&quot;</span>); <span class="hljs-comment">//3</span>&#125;<span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-number">4</span>); <span class="hljs-comment">//5</span>&#125;);<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-number">5</span>); <span class="hljs-comment">//7</span>&#125;);async1();<span class="hljs-built_in">console</span>.log(<span class="hljs-number">6</span>); <span class="hljs-comment">//4</span></code></pre></div><ul><li>  js æ‰§è¡Œä¼˜å…ˆçº§</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Foo</span>(<span class="hljs-params"></span>) </span>&#123;getName = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>);&#125;;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;&#125;Foo.getName = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>);&#125;;Foo.prototype.getName = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-number">3</span>);&#125;;<span class="hljs-keyword">var</span> getName = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-number">4</span>);&#125;;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getName</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-number">5</span>);&#125;Foo.getName();getName();Foo().getName();<span class="hljs-comment">// function changeThis()&#123;</span><span class="hljs-comment">//   return this</span><span class="hljs-comment">// &#125;</span><span class="hljs-comment">// changeThis().fn666 = ()=&gt;&#123;</span><span class="hljs-comment">//   console.log(666);</span><span class="hljs-comment">// &#125;</span><span class="hljs-comment">// global.fn666()</span>getName();<span class="hljs-keyword">new</span> Foo.getName();<span class="hljs-keyword">new</span> Foo().getName();<span class="hljs-keyword">new</span> <span class="hljs-keyword">new</span> Foo().getName();</code></pre></div><ul><li>  å®ç°ä¸€ä¸ª setTimeout</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_setTimeout</span>(<span class="hljs-params">cb, timeout, ...args</span>) </span>&#123;<span class="hljs-keyword">const</span> start = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loop</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">window</span>.requestAnimationFrame(loop);<span class="hljs-keyword">const</span> now = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();<span class="hljs-keyword">if</span> (now - start &gt;= timeout) &#123;cb.apply(<span class="hljs-built_in">this</span>, args);<span class="hljs-built_in">window</span>.cancelAnimationFrame(timer);&#125;&#125;<span class="hljs-built_in">window</span>.requestAnimationFrame(loop);&#125;</code></pre></div><ul><li>  ä½¿ç”¨ setTimeout æ¨¡æ‹Ÿ setInterval</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// setInterval çš„é—®é¢˜</span><span class="hljs-comment">// å®šæ—¶å¾€äº‹ä»¶é˜Ÿåˆ—ä¸­æ·»åŠ å›è°ƒå‡½æ•°ï¼Œå¦‚æœä¸»çº¿ç¨‹è¿è¡Œæ—¶é—´è¿‡é•¿åˆ°å¤§é‡å›è°ƒè¶…æ—¶ï¼Œåˆ™æœ‰å¯èƒ½åŒæ—¶æ‰§è¡Œå¤§é‡å¼‚æ­¥å›è°ƒï¼Œè¿èƒŒä½¿ç”¨æ„å›¾</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_setInterval</span>(<span class="hljs-params">fn,timeout,...args</span>)</span>&#123;  <span class="hljs-keyword">const</span> controller = &#123;    stop = <span class="hljs-literal">false</span>    <span class="hljs-comment">// æ§åˆ¶å™¨</span>  &#125;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_interval</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">if</span>(!controller.stop)&#123;      fn.apply(<span class="hljs-built_in">this</span>,args)      <span class="hljs-built_in">setTimeout</span>(_interval,timeout)    &#125;  &#125;  <span class="hljs-built_in">setTimeout</span>(_interval,timeout)  <span class="hljs-keyword">return</span> controller&#125;</code></pre></div><ul><li>  æ¨¡ç‰ˆå­—ç¬¦ä¸²</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> reg = <span class="hljs-regexp">/\&#123;\&#123;(w+)\&#125;\&#125;/g</span>;<span class="hljs-keyword">const</span> template = <span class="hljs-string">&quot;æˆ‘æ˜¯&#123;&#123;name&#125;&#125;ï¼Œå¹´é¾„&#123;&#123;age&#125;&#125;ï¼Œæ€§åˆ«&#123;&#123;sex&#125;&#125;&quot;</span>;<span class="hljs-keyword">const</span> data = &#123;name: <span class="hljs-string">&quot;æ£®ä¸‹ä¸Šå£«&quot;</span>,age: <span class="hljs-number">18</span>,&#125;;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">template, data</span>) </span>&#123;<span class="hljs-keyword">if</span> (reg.test(template)) &#123;<span class="hljs-keyword">const</span> tem = template.match(reg);tem.forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> p = key.slice(<span class="hljs-number">2</span>, -<span class="hljs-number">2</span>);<span class="hljs-comment">// &#123;&#123;xxx&#125;&#125; ==&gt; xxx</span>template = template.replace(key, data[p]);&#125;);&#125;<span class="hljs-keyword">return</span> template;&#125;</code></pre></div><ul><li>  js è·å–æ–‡ä»¶æ‰©å±•å</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getExt</span>(<span class="hljs-params">filename</span>) </span>&#123;<span class="hljs-keyword">return</span> filename.split(<span class="hljs-string">&quot;.&quot;</span>).pop();&#125;<span class="hljs-comment">// æŒ‰.åˆ†å‰²å­—ç¬¦ä¸²ä¸ºæ•°ç»„</span><span class="hljs-comment">// popåˆ é™¤æœ€åä¸€é¡¹å¹¶è¿”å›</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getExt</span>(<span class="hljs-params">filename</span>) </span>&#123;<span class="hljs-keyword">return</span> filename.replace(<span class="hljs-regexp">/.+\./</span>, <span class="hljs-string">&quot;&quot;</span>);&#125;</code></pre></div><ul><li>  åŒ¿åå‡½æ•°è‡ªæ‰§è¡Œ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ç›´æ¥åœ¨åŒ¿åå‡½æ•°ä¹‹ååŠ ï¼ˆï¼‰æ— æ•ˆ</span><span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]+<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>])&#125;(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>)<span class="hljs-comment">//åŠ å·</span>+<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]+<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>]);&#125;(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>);<span class="hljs-comment">//å‡å·</span>-<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]+<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>]);&#125;(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>);<span class="hljs-comment">//æ„Ÿå¹å·</span>!<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]+<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>]);&#125;(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>);<span class="hljs-comment">//æ‹¬å·</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]+<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>]);&#125;)(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>);(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]+<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>]);&#125;(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>));</code></pre></div><ul><li>  æ•°ç»„çš„å…¨æ’åˆ—</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">permute</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">const</span> res = [];<span class="hljs-comment">// å›æº¯ç®—æ³•</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">recursion</span>(<span class="hljs-params">path, set</span>) </span>&#123;<span class="hljs-keyword">if</span> (path.length === arr.length) &#123;<span class="hljs-keyword">return</span> res.push([...path]); <span class="hljs-comment">// æ½œæ‹·è´ä¸€æ¬¡</span>&#125;<span class="hljs-comment">// ä½¿ç”¨pathè®°å½•å›æº¯çš„è·¯å¾„</span><span class="hljs-comment">// [1,2,3,4]</span><span class="hljs-comment">// path[1,2]ï¼Œset[1,2]</span><span class="hljs-comment">// 1,2,å·²ç»ç”¨è¿‡</span><span class="hljs-comment">// åˆ†åˆ«éå†3ï¼Œ4</span><span class="hljs-comment">// æ·»åŠ [1,2,3,4],[1,2,4,3]è¿›ç»“æœ</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> num <span class="hljs-keyword">of</span> arr) &#123;<span class="hljs-keyword">if</span> (set.has(num)) <span class="hljs-keyword">continue</span>;path.push(num);set.add(num);recursion(path, set);path.pop();set.delete(num);&#125;&#125;recursion([], <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());<span class="hljs-keyword">return</span> res;&#125;</code></pre></div><ul><li>äºŒåˆ†æŸ¥æ‰¾å…ƒç´ <blockquote><p>è¯•ç”¨äºé¡ºåºæ•°ç»„</p></blockquote></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">binaryFind</span>(<span class="hljs-params">arr, target, s = <span class="hljs-number">0</span>, e = arr.length - <span class="hljs-number">1</span></span>) </span>&#123;<span class="hljs-keyword">const</span> i = <span class="hljs-built_in">Math</span>.floor((s + e) / <span class="hljs-number">2</span>);<span class="hljs-keyword">if</span> (arr[i] === target) &#123;<span class="hljs-keyword">return</span> i;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arr[i] &gt; target) &#123;<span class="hljs-keyword">return</span> binaryFind(arr, target, s, i - <span class="hljs-number">1</span>);&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arr[i] &lt; target) &#123;<span class="hljs-keyword">return</span> binaryFind(arr, target, i + <span class="hljs-number">1</span>, e);&#125;<span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">binaryFind2</span>(<span class="hljs-params">arr, target</span>) </span>&#123;<span class="hljs-keyword">let</span> s = <span class="hljs-number">0</span>,e = arr.length - <span class="hljs-number">1</span>,mid;<span class="hljs-keyword">while</span> (s &lt;= e) &#123;mid = <span class="hljs-built_in">Math</span>.floor((s + e) / <span class="hljs-number">2</span>);<span class="hljs-keyword">if</span> (arr[mid] === target) &#123;<span class="hljs-keyword">return</span> mid;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arr[mid] &gt; target) &#123;e = mid - <span class="hljs-number">1</span>;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arr[mid] &lt; target) &#123;s = mid + <span class="hljs-number">1</span>;&#125;&#125;<span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;</code></pre></div><ul><li>  å¯¹è±¡æ‰å¹³åŒ–ï¼ˆå±•å¼€æ•°ç»„</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> o = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, &#123; <span class="hljs-attr">c</span>: <span class="hljs-literal">true</span> &#125;], <span class="hljs-attr">d</span>: &#123; <span class="hljs-attr">e</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">f</span>: <span class="hljs-number">3</span> &#125;, <span class="hljs-attr">g</span>: <span class="hljs-literal">null</span> &#125;;<span class="hljs-comment">// &#123; &quot;a&quot;: 1, &quot;b[0]&quot;: 1, &quot;b[1]&quot;: 2, &quot;b[2].c&quot;: true, &quot;d.e&quot;: 2, ... &#125;</span><span class="hljs-keyword">const</span> isObject = <span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> obj !== <span class="hljs-literal">null</span> &amp;&amp; obj.constructor === <span class="hljs-built_in">Object</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">objectFlat</span>(<span class="hljs-params">obj</span>) </span>&#123;<span class="hljs-keyword">const</span> res = &#123;&#125;;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flat</span>(<span class="hljs-params">obj, path</span>) </span>&#123;<span class="hljs-keyword">if</span> (!isObject(obj)) &#123;res[path] = obj;<span class="hljs-keyword">return</span>;&#125;<span class="hljs-built_in">Object</span>.entries(obj).forEach(<span class="hljs-function">(<span class="hljs-params">[key, val]</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(val)) &#123;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; val.length; i++) &#123;flat(val[i], path ? path + <span class="hljs-string">&quot;.&quot;</span> + key + <span class="hljs-string">&quot;[&quot;</span> + i + <span class="hljs-string">&quot;]&quot;</span> : key + <span class="hljs-string">&quot;[&quot;</span> + i + <span class="hljs-string">&quot;]&quot;</span>);&#125;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isObject(val)) &#123;flat(val, path ? path + <span class="hljs-string">&quot;.&quot;</span> + key : key);&#125; <span class="hljs-keyword">else</span> &#123;res[path ? path + <span class="hljs-string">&quot;.&quot;</span> + key : key] = val;&#125;&#125;);&#125;flat(obj, <span class="hljs-string">&quot;&quot;</span>);<span class="hljs-keyword">return</span> res;&#125;</code></pre></div><ul><li><p>å˜é‡è¿ç»­èµ‹å€¼</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">a = b = <span class="hljs-number">3</span>;<span class="hljs-comment">// ä¸€èˆ¬æ¥è¯´æ‰§è¡Œé¡ºåºæ˜¯</span>b = <span class="hljs-number">3</span>;a = b;<span class="hljs-comment">// å½“é‡åˆ°`.`æ“ä½œç¬¦,æ“ä½œä¼˜å…ˆçº§ä¼šé«˜äºèµ‹å€¼</span><span class="hljs-keyword">let</span> a = &#123; <span class="hljs-attr">name</span>: <span class="hljs-number">666</span> &#125;;b = a;<span class="hljs-comment">// b : &#123;name:666&#125;</span>a.x = a = &#123; <span class="hljs-attr">name</span>: <span class="hljs-number">222</span> &#125;;<span class="hljs-comment">// å…ˆæ‰§è¡Œa.x = &#123;name:222&#125;</span><span class="hljs-comment">// b : &#123;name:666,x:&#123;name:222&#125;&#125;</span><span class="hljs-comment">// åæ”¹å˜aæŒ‡é’ˆ a = &#123;name:222&#125;</span>a.x; <span class="hljs-comment">// undefined</span>b.x; <span class="hljs-comment">// &#123;name:222&#125;</span></code></pre></div></li><li><p>  0.1+0.2==0.3?</p></li></ul><p>js ä¸­ä¸€èˆ¬æ•°å­—ç²¾åº¦æœ‰ä¸Šé™ï¼ˆåŒç²¾åº¦æµ®ç‚¹ï¼‰ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨<code>==</code>æˆ–è€…<code>===</code>æ¥æ¯”è¾ƒ<code>Number</code>ç±»å‹.<br>æ­£ç¡®çš„æ¯”è¾ƒæ–¹æ³•ï¼š<code>Math.abs(0.1+0.2-0.3)&lt;=Number.EPSILON</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MVC/MVP/MVVM</title>
    <link href="/2022/02/24/mvcmvpmvvm/"/>
    <url>/2022/02/24/mvcmvpmvvm/</url>
    
    <content type="html"><![CDATA[<h3 id="MVCModel-View-Controller"><a href="#MVCModel-View-Controller" class="headerlink" title="MVCModel-View-Controller"></a>MVC<code>Model-View-Controller</code></h3><div class="hljs code-wrapper"><pre><code class="hljs js">View-&gt;Controller-&gt;Model^                     ||                     v&lt;---------------------&lt;</code></pre></div><ul><li><code>View</code>å¯ä»¥è®¿é—®<code>Model</code>,ä¸å¯é¿å…çš„ä¼šåŒ…å«ä¸€äº›ä¸šåŠ¡é€»è¾‘ï¼Œå¯¼è‡´ç‰¹å®š<code>View</code>ä¾èµ–ç‰¹å®š<code>Model</code></li><li>è§†å›¾çš„æ›´æ–°é€»è¾‘ç”±<code>View</code>è‡ªå·±å®Œæˆ</li><li><code>View</code>ç›‘å¬<code>Model</code>æ”¹å˜çš„çš„å¹¿æ’­</li><li>ç”¨æˆ·å¯ä»¥æ“ä½œ<code>View</code>æˆ–è€…ç›´æ¥æ“ä½œ<code>Controller</code></li></ul><h3 id="MVPModel-View-Presenter"><a href="#MVPModel-View-Presenter" class="headerlink" title="MVPModel-View-Presenter"></a>MVP<code>Model-View-Presenter</code></h3><div class="hljs code-wrapper"><pre><code class="hljs javascript">View &lt;--&gt; Presenter &lt;==&gt; Model</code></pre></div><ul><li><p><code>View</code> ä¸ <code>Model</code> ä¹‹é—´é€šè¿‡ <code>Presenter</code>è§£å¶</p></li><li><p>ä¸»è¦çš„ç¨‹åºé€»éƒ½åœ¨<code>Presenter</code>ä¸­ï¼Œæ¥å—<code>Model</code>å±‚çš„æ•°æ®ï¼Œå¹¶ä¸”å¤„ç†ä¹‹åä¼ é€’ç»™<code>View</code>å±‚ï¼Œè¿˜éœ€è¦å¤„ç†<code>View</code>å±‚çš„ç”¨æˆ·äº¤äº’ç­‰æ“ä½œã€‚</p></li><li><p><code>View</code>ä¸éƒ¨ç½²ä»»ä½•ä¸šåŠ¡é€»è¾‘,è¢«åŠ¨è§†å›¾ï¼Œåªæä¾›æ¥å£</p></li><li><p><code>Model</code>æ”¹å˜çš„çš„å¹¿æ’­ç”±<code>Presenter</code>ç›‘å¬</p></li></ul><h3 id="MVVMModel-View-ViewModel"><a href="#MVVMModel-View-ViewModel" class="headerlink" title="MVVMModel-View-ViewModel"></a>MVVM<code>Model-View-ViewModel</code></h3><div class="hljs code-wrapper"><pre><code class="hljs javascript">View &lt;==&gt; ViewModel &lt;==&gt; Model</code></pre></div><ul><li><code>ViewModel</code>å¯ä»¥ç†è§£ä¸ºæ˜¯MVPä¸­<code>View</code>çš„æ•°æ®æ¨¡å‹å’Œ<code>Presenter</code>çš„åˆä½“</li><li>ä»¥å‰å…¨éƒ¨ç”±<code>Presenter</code>è´Ÿè´£çš„<code>View</code>å’Œ<code>Model</code>ä¹‹é—´æ•°æ®åŒæ­¥æ“ä½œäº¤ç”±æ¡†æ¶å®ç°åŒå‘ç»‘å®š</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nodeç›¸å…³çŸ¥è¯†ç‚¹</title>
    <link href="/2022/02/24/node%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    <url>/2022/02/24/node%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
    
    <content type="html"><![CDATA[<ul><li>å¼•ç”¨æ¨¡å—çš„ç›®å½•åˆ†æ<ol><li>åœ¨å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾package.json(CommonJSåŒ…è§„èŒƒå®šä¹‰çš„åŒ…æè¿°æ–‡ä»¶)ï¼Œé€šè¿‡JSON.parse()è§£æå‡ºåŒ…æè¿°å¯¹è±¡ï¼Œä»ä¸­å–å‡ºmainå±æ€§æŒ‡å®šçš„æ–‡ä»¶åè¿›è¡Œå®šä½ã€‚å¦‚æœæ–‡ä»¶ç¼ºå°‘æ‰©å±•åï¼Œå°†ä¼šè¿›å…¥æ‰©å±•ååˆ†æçš„æ­¥éª¤ã€‚ ã€€ã€€</li><li>è€Œå¦‚æœmainå±æ€§åˆ¶å®šçš„æ–‡ä»¶åé”™è¯¯ï¼Œæˆ–è€…å‹æ ¹æ²¡æœ‰package.jsonæ–‡ä»¶ï¼ŒNodeä¼šå°†indexå½“åšé»˜è®¤æ–‡ä»¶åï¼Œç„¶åä¾æ¬¡æŸ¥æ‰¾index.jsã€index.nodeã€index.json. ã€€ã€€</li><li>å¦‚æœåœ¨ç›®å½•åˆ†æçš„è¿‡ç¨‹ä¸­æ²¡æœ‰å®šä½æˆåŠŸä»»ä½•æ–‡ä»¶ï¼Œåˆ™è‡ªå®šä¹‰æ¨¡å—è¿›å…¥ä¸‹ä¸€ä¸ªæ¨¡å—è·¯å¾„è¿›è¡ŒæŸ¥æ‰¾ã€‚å¦‚æœæ¨¡å—è·¯å¾„æ•°ç»„éƒ½è¢«éå†å®Œæ¯•ï¼Œä¾ç„¶æ²¡æœ‰æŸ¥æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œåˆ™ä¼šæŠ›å‡ºæŸ¥æ‰¾å¤±è´¥å¼‚å¸¸ã€‚</li></ol></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>node</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>react-beginner</title>
    <link href="/2022/02/24/react_rookie/"/>
    <url>/2022/02/24/react_rookie/</url>
    
    <content type="html"><![CDATA[<h1 id="React"><a href="#React" class="headerlink" title="React"></a>React</h1><blockquote><p>æ„å»ºç”¨æˆ·é¡µé¢çš„ javascript åº“ï¼Œå¹¶ä¸æ˜¯å®Œæ•´çš„ MVC æ¡†æ¶</p></blockquote><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><h3 id="React-createElement"><a href="#React-createElement" class="headerlink" title="React.createElement"></a><code>React.createElement</code></h3><p>JSX å…ƒç´ åªæ˜¯è°ƒç”¨ <code>React.createElement(component, props, ...children)</code> çš„è¯­æ³•ç³–</p><h3 id="ReactDOM-render-element-container-callback"><a href="#ReactDOM-render-element-container-callback" class="headerlink" title="ReactDOM.render(element, container[, callback)"></a><code>ReactDOM.render(element, container[, callback)</code></h3><p>åœ¨æä¾›çš„ <code>container</code> é‡Œæ¸²æŸ“ä¸€ä¸ª React å…ƒç´ ï¼Œå¹¶è¿”å›å¯¹è¯¥ç»„ä»¶çš„å¼•ç”¨ï¼ˆæˆ–è€…é’ˆå¯¹æ— çŠ¶æ€ç»„ä»¶è¿”å› nullï¼‰ã€‚</p><p>å¦‚æœ React å…ƒç´ ä¹‹å‰å·²ç»åœ¨ <code>container</code> é‡Œæ¸²æŸ“è¿‡ï¼Œè¿™å°†ä¼šå¯¹å…¶æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œå¹¶ä»…ä¼šåœ¨å¿…è¦æ—¶æ”¹å˜ DOM ä»¥æ˜ å°„æœ€æ–°çš„ React å…ƒç´ ã€‚</p><p>å¦‚æœæä¾›äº†å¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå°†åœ¨ç»„ä»¶è¢«æ¸²æŸ“æˆ–æ›´æ–°ä¹‹åè¢«æ‰§è¡Œã€‚</p><h2 id="JSX-è¯­æ³•"><a href="#JSX-è¯­æ³•" class="headerlink" title="JSX è¯­æ³•"></a>JSX è¯­æ³•</h2><ul><li>  è¯­æ³•ç³–ï¼Œæ›´èƒ½ä½“ç° react çš„å£°æ˜å¼ç‰¹ç‚¹ï¼Œé€»è¾‘å’Œé¡µé¢æ ‡ç­¾å†™åœ¨ä¸€èµ·</li><li>  jsx ä¸æ˜¯æ ‡å‡†çš„ ECMAScript è¯­æ³•ï¼Œbabel ç¼–è¯‘</li></ul><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> title = (<span class="hljs-comment">// æ¨èä½¿ç”¨å°æ‹¬å·åŒ…è£¹</span>&lt;h1&gt;æˆ‘æ˜¯ä¸ªtitle&lt;/h1&gt;);</code></pre></div><ul><li>  jsx ä¸­çš„å±æ€§åé©¼å³°å‘½å</li><li>  <code>&#123;..ä¸­å¯ä»¥å†™jsè¡¨è¾¾å¼ï¼ŒåŒºåˆ«vueçš„åŒæ‹¬å·..&#125;</code></li></ul><h3 id="æ¡ä»¶æ¸²æŸ“"><a href="#æ¡ä»¶æ¸²æŸ“" class="headerlink" title="æ¡ä»¶æ¸²æŸ“"></a>æ¡ä»¶æ¸²æŸ“</h3><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// if else</span><span class="hljs-keyword">if</span>()&#123;  <span class="hljs-keyword">return</span> xxx&#125;<span class="hljs-keyword">else</span>&#123;  <span class="hljs-keyword">return</span> xxx&#125;<span class="hljs-comment">// ä¸‰å…ƒè¡¨è¾¾å¼</span><span class="hljs-keyword">return</span> flag ? (.&lt;dv&gt;..) : (..&lt;dv&gt;.)<span class="hljs-comment">// é€»è¾‘ä¸è¿ç®—ç¬¦</span><span class="hljs-keyword">return</span> flag &amp;&amp; (..&lt;dv&gt;.)</code></pre></div><h3 id="å¾ªç¯æ¸²æŸ“"><a href="#å¾ªç¯æ¸²æŸ“" class="headerlink" title="å¾ªç¯æ¸²æŸ“"></a>å¾ªç¯æ¸²æŸ“</h3><blockquote><p>key çš„ä½œç”¨å’Œ vue ä¸€æ ·ç”¨äº diff æ—¶å¤ç”¨èŠ‚ç‚¹</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> data = [&#123;&#125;...&#123;&#125;...&#123;&#125;]<span class="hljs-keyword">const</span> list = (  &#123;data.map(<span class="hljs-function"><span class="hljs-params">item</span>=&gt;</span>&#123;    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  &#125;)&#125;)</code></pre></div><h3 id="æ ·å¼"><a href="#æ ·å¼" class="headerlink" title="æ ·å¼"></a>æ ·å¼</h3><ul><li><p>è¡Œå†…æ ·å¼,åŒæ‹¬å·</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> title = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">color:</span> &quot;<span class="hljs-attr">red</span>&quot; &#125;&#125;&gt;</span>æˆ‘æ˜¯ä¸ªtitle<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;</code></pre></div></li><li><p>className</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> title = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;xxx&quot;</span>&gt;</span>æˆ‘æ˜¯ä¸ªtitle<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;</code></pre></div><blockquote><p>ç»„ä»¶æ˜¯ react ä¸€ç­‰å…¬æ°‘</p></blockquote></li></ul><blockquote><p>ç»„ä»¶ï¼šå¤ç”¨ï¼Œç‹¬ç«‹ï¼Œç»„åˆ</p></blockquote><h1 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h1><h2 id="å‡½æ•°ç»„ä»¶ï¼ˆä½¿ç”¨å‡½æ•°åˆ›å»ºï¼‰"><a href="#å‡½æ•°ç»„ä»¶ï¼ˆä½¿ç”¨å‡½æ•°åˆ›å»ºï¼‰" class="headerlink" title="å‡½æ•°ç»„ä»¶ï¼ˆä½¿ç”¨å‡½æ•°åˆ›å»ºï¼‰"></a>å‡½æ•°ç»„ä»¶ï¼ˆä½¿ç”¨å‡½æ•°åˆ›å»ºï¼‰</h2><ul><li>  å¤§å†™é¦–å­—æ¯</li><li>  å¿…é¡» return</li><li>  åŒ…æ‹¬ç®­å¤´å‡½æ•°</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Com1</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æˆ‘æ˜¯Com1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;&#125;ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Com1</span> /&gt;</span></span>, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;app&quot;</span>));</code></pre></div><blockquote><p>babel è½¬è¯‘å,function è¿è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹,ä¸¥æ ¼æ¨¡å¼çš„ this æŒ‡å‘ null</p></blockquote><h2 id="ç±»ç»„ä»¶"><a href="#ç±»ç»„ä»¶" class="headerlink" title="ç±»ç»„ä»¶"></a>ç±»ç»„ä»¶</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">-å¤§å†™é¦–å­—æ¯ - <span class="hljs-keyword">extends</span>è‡ª<span class="hljs-string">`React.Component`</span> - å¿…é¡»<span class="hljs-keyword">return</span>;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCom2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>&#123;<span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æˆ‘æ˜¯Com2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;&#125;&#125;</code></pre></div><h2 id="ã€Œstateã€"><a href="#ã€Œstateã€" class="headerlink" title="ã€Œstateã€"></a>ã€Œstateã€</h2><ul><li>  ä¸€èˆ¬å†™æ³•</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Com3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">this</span>.state = &#123;<span class="hljs-attr">xxx</span>:xxx&#125;    <span class="hljs-built_in">this</span>.func1 = <span class="hljs-built_in">this</span>.func1.bind(<span class="hljs-built_in">this</span>)  &#125;  <span class="hljs-function"><span class="hljs-title">func1</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">this</span>.setState(xxx:xxx)    <span class="hljs-comment">// éœ€è¦æ‰‹åŠ¨æ´¾å‘ `setState()`</span>  &#125;  render() =&gt; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">xxx</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.func1&#125;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">xxx</span>&gt;</span></span>&#125;</code></pre></div><ul><li>  ä½¿ç”¨èµ‹å€¼è¯­å¥ç®€å†™</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Com3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>&#123;  state = &#123;<span class="hljs-attr">xxx</span>:xxx&#125;  func1 = <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-built_in">this</span>.setState(xxx:xxx)  &#125;  render() =&gt; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">xxx</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.func1&#125;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">xxx</span>&gt;</span></span>&#125;</code></pre></div><h2 id="ã€Œpropsã€"><a href="#ã€Œpropsã€" class="headerlink" title="ã€Œpropsã€"></a>ã€Œpropsã€</h2><p>ç»„ä»¶å†…éƒ¨ä¸ç”¨å£°æ˜<code>props</code>,ç»„ä»¶å®ä¾‹æŒæœ‰æœ‰ä¸€ä¸ª<code>props</code>æ•°ç»„</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">return</span> (    &lt;Com1 prop1=<span class="hljs-string">&#x27;&#x27;</span> prop2=&#123;<span class="hljs-number">666</span>&#125;/&gt;  )&#125;</code></pre></div><ul><li>  æ ‡ç­¾å±æ€§å¯ä»¥ç”¨å±•å¼€è¿ç®—ç¬¦</li><li>  props æ ¡éªŒ<a href="https://react.docschina.org/docs/typechecking-with-proptypes.html">https://react.docschina.org/docs/typechecking-with-proptypes.html</a></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript">Com1.propTypes = &#123;  prop1:PropTypes.string.isRequired,<span class="hljs-comment">// isRequired</span>  prop2:PropTypes.number  prop3;PropTypes.func <span class="hljs-comment">// function</span>&#125;Com1.defaultProps = &#123;  prop1:<span class="hljs-string">&#x27;xxx&#x27;</span>,  prop2:<span class="hljs-number">123</span>&#125;</code></pre></div><ul><li>  åŒæ ·ä¹Ÿå¯ä»¥å†™åœ¨ class å†…</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Com3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>&#123;  state = &#123;<span class="hljs-attr">xxx</span>:xxx&#125;  func1 = <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-built_in">this</span>.setState(xxx:xxx)  &#125;  <span class="hljs-keyword">static</span> propTypes = &#123;    prop1:PropTypes.string.isRequired,<span class="hljs-comment">// isRequired</span>    prop2:PropTypes.number    prop3:PropTypes.func <span class="hljs-comment">// function</span>  &#125;  <span class="hljs-keyword">static</span> defaultProps = &#123;    prop1:<span class="hljs-string">&#x27;xxx&#x27;</span>,    prop2:<span class="hljs-number">123</span>  &#125;&#125;</code></pre></div><ul><li>  <code>constructor</code>ä¸­è¦ä½¿ç”¨<code>this.props</code>å°±å¿…é¡»æ¥æ”¶å¹¶<code>super</code></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">props</span>)</span>&#123;  <span class="hljs-built_in">super</span>(props)  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.props);&#125;</code></pre></div><h3 id="ã€Œrefsã€"><a href="#ã€Œrefsã€" class="headerlink" title="ã€Œrefsã€"></a>ã€Œrefsã€</h3><h4 id="1-å­—ç¬¦ä¸²å½¢å¼-è¿‡æ—¶-API"><a href="#1-å­—ç¬¦ä¸²å½¢å¼-è¿‡æ—¶-API" class="headerlink" title="1.å­—ç¬¦ä¸²å½¢å¼( è¿‡æ—¶ API )"></a>1.å­—ç¬¦ä¸²å½¢å¼( <em>è¿‡æ—¶ API</em> )</h4><div class="hljs code-wrapper"><pre><code class="hljs js">&lt;xxx ref=<span class="hljs-string">&quot;xxx&quot;</span>&gt;</code></pre></div><h4 id="2-å›è°ƒå‡½æ•°"><a href="#2-å›è°ƒå‡½æ•°" class="headerlink" title="2.å›è°ƒå‡½æ•°"></a>2.å›è°ƒå‡½æ•°</h4><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;xxx ref=&#123;<span class="hljs-function"><span class="hljs-params">c</span>=&gt;</span><span class="hljs-built_in">this</span>.input1=c&#125;&gt;<span class="hljs-comment">// å°±èƒ½æŒ‚è½½åœ¨ å®ä¾‹.input1 ä¸Š</span></code></pre></div><blockquote><p>ç»„ä»¶æ¸²æŸ“æ—¶å…ˆä¼šæŠŠ ref æ¸…ç©º(ä¸º null),å†èµ‹å€¼</p></blockquote><blockquote><p>ä½¿ç”¨ class å†…ç»‘å®šå‡½æ•°æ¥æ”¶ node å¯ä»¥é¿å…ä¸Šè¿°</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript">saveNode = <span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> <span class="hljs-built_in">this</span>.input1 = c<span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">return</span> (    &lt;input ref=&#123;<span class="hljs-built_in">this</span>.saveNode&#125;&gt;&lt;/input&gt;  )&#125;</code></pre></div><h4 id="3-createRef"><a href="#3-createRef" class="headerlink" title="3.createRef"></a>3.createRef</h4><p>å•ä¸€ ref ä¸“ç”¨</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">input1 = React.createRef()<span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">return</span> (    &lt;input ref=&#123;<span class="hljs-built_in">this</span>.input1&#125;&gt;&lt;/input&gt;  )&#125;<span class="hljs-comment">// this.input1.current</span></code></pre></div><h1 id="React-ç”Ÿå‘½å‘¨æœŸ"><a href="#React-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="React ç”Ÿå‘½å‘¨æœŸ"></a>React ç”Ÿå‘½å‘¨æœŸ</h1><h2 id="ğŸš®-æ—§ç”Ÿå‘½å‘¨æœŸ-lt-16"><a href="#ğŸš®-æ—§ç”Ÿå‘½å‘¨æœŸ-lt-16" class="headerlink" title="ğŸš® æ—§ç”Ÿå‘½å‘¨æœŸ(&lt;=16)"></a>ğŸš® æ—§ç”Ÿå‘½å‘¨æœŸ(&lt;=16)</h2><h3 id="åˆå§‹åŒ–é˜¶æ®µ"><a href="#åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="åˆå§‹åŒ–é˜¶æ®µ"></a>åˆå§‹åŒ–é˜¶æ®µ</h3><ul><li>  <code>constructor</code></li><li>  <code>componentWillMount</code></li><li>  <code>render</code></li><li>  <code>componentDidMount</code></li></ul><h3 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h3><ul><li>  <code>componentWillReceiveProps</code></li><li>  <code>shouldComponentUpdate</code>&lt;â€“ setState()</li><li>  <code>componentWillUpdate</code>&lt;â€”- forceUpdate()</li><li>  <code>render</code></li><li>  <code>componentDidUpdate</code></li></ul><h3 id="é”€æ¯"><a href="#é”€æ¯" class="headerlink" title="é”€æ¯"></a>é”€æ¯</h3><ul><li>  <code>componentWillUnmount</code></li></ul><h2 id="ğŸ’¡-æ–°ç”Ÿå‘½å‘¨æœŸ-gt-16"><a href="#ğŸ’¡-æ–°ç”Ÿå‘½å‘¨æœŸ-gt-16" class="headerlink" title="ğŸ’¡ æ–°ç”Ÿå‘½å‘¨æœŸ(&gt;16)"></a>ğŸ’¡ æ–°ç”Ÿå‘½å‘¨æœŸ(&gt;16)</h2><p><img src="../images/react_new.png" alt="ç”Ÿå‘½å‘¨æœŸ"><br>ç¤ºæ„å›¾:<a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/">https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/</a></p><h3 id="è¿‡æ—¶é’©å­"><a href="#è¿‡æ—¶é’©å­" class="headerlink" title="è¿‡æ—¶é’©å­"></a>è¿‡æ—¶é’©å­</h3><ul><li><p><code>UNSAFE_componentWillMount</code></p><blockquote><p>åœ¨æ­¤æ–¹æ³•ä¸­åŒæ­¥è°ƒç”¨ setState() ä¸ä¼šè§¦å‘é¢å¤–æ¸²æŸ“</p></blockquote></li><li><p><code>UNSAFE_componentWillReceiveProps</code></p><blockquote><p>åœ¨ç»„ä»¶æ¥å—æ–°çš„ props ä¹‹å‰è°ƒç”¨</p></blockquote></li><li><p>  <code>UNSAFE_componentWillUpdate</code></p></li></ul><h3 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 1.</span><span class="hljs-title">constructor</span>(<span class="hljs-params">props</span>)// 2.ä¸å¸¸ç”¨,ä»…é€‚ç”¨äº<span class="hljs-title">props</span>æ´¾ç”Ÿ<span class="hljs-title">state</span>çš„æƒ…å†µ,ä½†ä¼šåœ¨æ¯æ¬¡<span class="hljs-title">render</span>ä¹‹å‰è°ƒç”¨<span class="hljs-title">static</span> <span class="hljs-title">getDerivedStateFromProps</span>(<span class="hljs-params">prop,state</span>)// 3.çº¯å‡½æ•°<span class="hljs-title">render</span>// 4.ç»„ä»¶æŒ‚è½½åˆ°<span class="hljs-title">DOM</span>å<span class="hljs-title">componentDidMount</span></code></pre></div><h3 id="æ›´æ–°-1"><a href="#æ›´æ–°-1" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//1. ä¸å¸¸ç”¨</span><span class="hljs-keyword">static</span> getDerivedStateFromProps(prop,state)<span class="hljs-comment">//2.åˆ¤æ–­æ˜¯å¦æ›´æ–°ç»„ä»¶ï¼Œ</span><span class="hljs-comment">//  é»˜è®¤è¡Œä¸ºæ˜¯true</span><span class="hljs-comment">//  å½“ props æˆ– state å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒshouldComponentUpdate() ä¼šåœ¨æ¸²æŸ“æ‰§è¡Œä¹‹å‰è¢«è°ƒç”¨</span><span class="hljs-comment">// ä½¿ç”¨forceUpdateå¯ä»¥è·³è¿‡è¯¥æ–¹æ³•</span>shouldComponentUpdate = ():boolean<span class="hljs-comment">//3.</span>render<span class="hljs-comment">//4.è·å–æœ€è¿‘ä¸€æ¬¡DOMæ›´æ–°å‰çš„DOMä¿¡æ¯</span>getSnapshotBeforeUpdate = (prevProps,prevState):snapshot<span class="hljs-comment">//5.</span>componentDidUpdate(prevProps,preState,snapshot)</code></pre></div><h3 id="é”€æ¯-1"><a href="#é”€æ¯-1" class="headerlink" title="é”€æ¯"></a>é”€æ¯</h3><ul><li>  <code>componentWillUnmount</code></li></ul><h1 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h1><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// /src/setupProxy.js</span><span class="hljs-comment">// CommonJSè¯­æ³•</span><span class="hljs-keyword">const</span> proxy = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;http-proxy-middleware&quot;</span>);<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">app</span>) </span>&#123;app.use(proxy(<span class="hljs-string">&quot;/api1&quot;</span>, &#123;target: <span class="hljs-string">&quot;http://xxxxxx&quot;</span>,changeOrigin: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Hostå­—æ®µ</span>pathRewrite: &#123; <span class="hljs-string">&quot;/api1&quot;</span>: <span class="hljs-string">&quot;&quot;</span> &#125;,&#125;));&#125;;</code></pre></div><h1 id="ç»„ä»¶é—´é€šä¿¡"><a href="#ç»„ä»¶é—´é€šä¿¡" class="headerlink" title="ç»„ä»¶é—´é€šä¿¡"></a>ç»„ä»¶é—´é€šä¿¡</h1><ol><li><p><code>Props</code></p></li><li><p><code>PubSubJS</code>å‘å¸ƒè®¢é˜…æ¨¡å¼<br><a href="https://github.com/mroderick/PubSubJS">https://github.com/mroderick/PubSubJS</a></p> <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// create a function to subscribe to topics</span><span class="hljs-keyword">var</span> mySubscriber = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">msg, data</span>) </span>&#123;<span class="hljs-built_in">console</span>.log(msg, data);&#125;;<span class="hljs-comment">// add the function to the list of subscribers for a particular topic</span><span class="hljs-comment">// we&#x27;re keeping the returned token, in order to be able to unsubscribe</span><span class="hljs-comment">// from the topic later on</span><span class="hljs-keyword">var</span> token = PubSub.subscribe(<span class="hljs-string">&quot;MY TOPIC&quot;</span>, mySubscriber);<span class="hljs-comment">// publish a topic asynchronously</span>PubSub.publish(<span class="hljs-string">&quot;MY TOPIC&quot;</span>, <span class="hljs-string">&quot;hello world!&quot;</span>);<span class="hljs-comment">// publish a topic synchronously, which is faster in some environments,</span><span class="hljs-comment">// but will get confusing when one topic triggers new topics in the</span><span class="hljs-comment">// same execution chain</span><span class="hljs-comment">// USE WITH CAUTION, HERE BE DRAGONS!!!</span>PubSub.publishSync(<span class="hljs-string">&quot;MY TOPIC&quot;</span>, <span class="hljs-string">&quot;hello world!&quot;</span>);</code></pre></div></li><li><p><code>Context</code></p><blockquote><p>ç±»ä¼¼ vue çš„ provide å’Œ inject</p></blockquote> <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//ç¥–å…ˆç»„ä»¶ä¸­</span><span class="hljs-keyword">const</span> MyContext1 = React.createContext(defaultValue);<span class="hljs-keyword">const</span> MyContext2  = React.createContext(defaultValue);<span class="hljs-comment">// defaultValueåœ¨ä¸ä¼ valueæ—¶ç”Ÿæ•ˆ</span><span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">return</span> (    <span class="hljs-comment">// valueåº”ä½¿ç”¨stateå±æ€§é¿å…æ„å¤–çš„consumeræ›´æ–°</span>    &lt;Mycontext1.Provider value=&#123;&#125;&gt;      &lt;MyContext2.Provider value=&#123;&#125;&gt;        ...&lt;children /&gt;      &lt;/MyContext2.Provider&gt;    &lt;/Mycontext1.Provider&gt;  )&#125;</code></pre></div> <div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// å­ç»„ä»¶ä¸­</span><span class="hljs-comment">// class</span><span class="hljs-keyword">static</span> contextType = MyContext1<span class="hljs-comment">//åªé€‚ç”¨äºæ¶ˆè´¹ä¸€ä¸ªcontextçš„æƒ…å†µ</span><span class="hljs-built_in">this</span>.context<span class="hljs-comment">//å–å€¼</span><span class="hljs-comment">// class&amp;hooks</span>&lt;MyContext2.Consumer&gt;  &#123;    value=&gt;(      <span class="hljs-comment">// render...</span>    )  &#125;&lt;/MyContext2.Consumer&gt;</code></pre></div></li><li><p><code>Redux</code></p></li></ol><h1 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h1><h2 id="æ ¹è·¯ç”±æ ‡ç­¾"><a href="#æ ¹è·¯ç”±æ ‡ç­¾" class="headerlink" title="æ ¹è·¯ç”±æ ‡ç­¾"></a>æ ¹è·¯ç”±æ ‡ç­¾</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; BrowserRouter &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;<span class="hljs-keyword">import</span> &#123; HashRouter &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;ReactDOM.render(&lt;React.StrictMode&gt;&lt;BrowserRouter&gt;&lt;App&gt;&lt;/App&gt;&lt;/BrowserRouter&gt;<span class="hljs-comment">/* &lt;HashRouter&gt;</span><span class="hljs-comment">&lt;App /&gt;</span><span class="hljs-comment">&lt;/HashRouter&gt; */</span>&lt;/React.StrictMode&gt;,<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;root&quot;</span>));</code></pre></div><h2 id="åŒ¹é…è§„åˆ™"><a href="#åŒ¹é…è§„åˆ™" class="headerlink" title="åŒ¹é…è§„åˆ™"></a>åŒ¹é…è§„åˆ™</h2><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/xxx&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/xxx&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&quot;&#123;ComXXX1&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/xxx&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&quot;&#123;ComXXX2&#125;&quot;</span>&gt;</span> <span class="hljs-comment">&lt;!-- ComXXX1 ComXXX2éƒ½æ¸²æŸ“ --&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span>&lt;/Route&gt;</code></pre></div><h2 id="Switch"><a href="#Switch" class="headerlink" title="Switch"></a>Switch</h2><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Switch</span>&gt;</span>/* Switchæ ‡ç­¾å†…åªä¼šæ¸²æŸ“ç¬¬ä¸€ä¸ªåŒ¹é…æˆåŠŸçš„ç»„ä»¶ */<span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">exact</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&quot;&#123;Home&#125;&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/about&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&quot;&#123;About&#125;&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/:user&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&quot;&#123;User&#125;&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&quot;&#123;NoMatch&#125;&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Switch</span>&gt;</span></code></pre></div><h2 id="ä¸¥æ ¼æ¨¡å¼"><a href="#ä¸¥æ ¼æ¨¡å¼" class="headerlink" title="ä¸¥æ ¼æ¨¡å¼"></a>ä¸¥æ ¼æ¨¡å¼</h2><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">exact</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/xxx&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&quot;&#123;ComXXX1&#125;&quot;</span>&gt;</span> <span class="hljs-comment">&lt;!-- ä¸¥æ ¼åŒ¹é… --&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></code></pre></div><h2 id="è·¯ç”±ä¼ å‚"><a href="#è·¯ç”±ä¼ å‚" class="headerlink" title="è·¯ç”±ä¼ å‚"></a>è·¯ç”±ä¼ å‚</h2><ul><li><code>match</code><ul><li>  â­ï¸<code>params</code> - (object) keyï¼value ä¸åŠ¨æ€è·¯å¾„çš„ URL å¯¹åº”è§£æ</li></ul></li><li><code>location</code><ul><li>  <code>pathname</code> - (string ç±»å‹) URL è·¯å¾„</li><li>  â­ï¸<code>search</code>- (string ç±»å‹) URL ä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²</li><li>  <code>hash</code> - (string ç±»å‹) URL çš„å“ˆå¸Œç‰‡æ®µ</li><li>  â­ï¸<code>state </code>- (object ç±»å‹) æä¾›ç»™ä¾‹å¦‚ä½¿ç”¨ push(path, state) æ“å°† location æ”¾å…¥å †æ ˆæ—¶çš„ç‰¹å®š location çŠ¶æ€ã€‚åªåœ¨æµè§ˆå™¨å’Œå†…å­˜å†å²ä¸­å¯ç”¨ã€‚</li></ul></li><li>  <code>history</code></li></ul><h3 id="URL-ä¼ -params"><a href="#URL-ä¼ -params" class="headerlink" title="URL ä¼  params"></a>URL ä¼  params</h3><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=`/<span class="hljs-attr">xxx</span>/$&#123;<span class="hljs-attr">xxx.param1</span>&#125;`&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/xxx/param1:param1&quot;</span>&gt;</span> // props.match.params // &#123;param1:xxx&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></code></pre></div><h3 id="URL-ä¼ -search"><a href="#URL-ä¼ -search" class="headerlink" title="URL ä¼  search"></a>URL ä¼  search</h3><p>ä½¿ç”¨<code>querrystring</code>å¤„ç† urlencode</p><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=`/<span class="hljs-attr">xxx</span>?<span class="hljs-attr">param1</span>=<span class="hljs-string">$&#123;xxx.param1&#125;&amp;param2</span>=<span class="hljs-string">$&#123;xxx.param2&#125;</span>`&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/xxx&quot;</span>&gt;</span>// props.location.search // &quot;?param1=xxx&amp;param1=xxx&quot; // qs.parse(props.location.search.slice(1)) =&gt; &#123;...&#125;&lt;/Route&gt;</code></pre></div><h3 id="ä¼ -state"><a href="#ä¼ -state" class="headerlink" title="ä¼  state"></a>ä¼  state</h3><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&#123;&#123;pathname:</span>&#x27;/<span class="hljs-attr">xxx</span>&#x27;,<span class="hljs-attr">state:</span>&#123;<span class="hljs-attr">param1:xxx.param1</span>&#125;&#125;&#125;&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/xxx&quot;</span>&gt;</span> // props.location.state<span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></code></pre></div><h2 id="ç¼–ç¨‹å¼è·¯ç”±"><a href="#ç¼–ç¨‹å¼è·¯ç”±" class="headerlink" title="ç¼–ç¨‹å¼è·¯ç”±"></a>ç¼–ç¨‹å¼è·¯ç”±</h2><p><code>this.props.history</code></p><ul><li><code>history</code><ul><li>  <code>go</code>(n) - (function ç±»å‹) å°† history å †æ ˆä¸­çš„æŒ‡é’ˆè°ƒæ•´ n</li><li>  <code>goBack</code>() - (function ç±»å‹) ç­‰åŒäº go(-1)</li><li>  <code>goForward</code>() - (function ç±»å‹) ç­‰åŒäº go(1)</li><li>  <code>push</code>(path, [state]) - (function ç±»å‹) åœ¨ history å †æ ˆæ·»åŠ ä¸ªæ–°ç›®</li><li>  <code>replace</code>(path, [state]) - (function ç±»å‹) æ›¿æ¢åœ¨ history å †ä¸­çš„</li></ul></li></ul><h2 id="withRouter"><a href="#withRouter" class="headerlink" title="withRouter"></a>withRouter</h2><p>å¯ä»¥é€šè¿‡ <code>withRouter</code> é«˜é˜¶ç»„ä»¶è®¿é—® <code>history</code> å¯¹è±¡çš„å±æ€§å’Œæœ€è¿‘çš„ <code>&lt;Route&gt;</code> çš„ <code>match</code> ã€‚ å½“è·¯ç”±æ¸²æŸ“æ—¶ï¼Œ <code>withRouter</code> ä¼šå°†å·²ç»æ›´æ–°çš„ <code>match</code> ï¼Œ <code>location</code> å’Œ <code>history</code> å±æ€§ä¼ é€’ç»™è¢«åŒ…è£¹çš„ç»„ä»¶ã€‚</p><h1 id="ç»„ä»¶åº“"><a href="#ç»„ä»¶åº“" class="headerlink" title="ç»„ä»¶åº“"></a>ç»„ä»¶åº“</h1><ul><li><code>antd</code>çš„æ ·å¼æŒ‰éœ€å¼•å…¥<br>  (<a href="https://3x.ant.design/docs/react/use-with-create-react-app-cn)[https://3x.ant.design/docs/react/use-with-create-react-app-cn]">https://3x.ant.design/docs/react/use-with-create-react-app-cn)[https://3x.ant.design/docs/react/use-with-create-react-app-cn]</a></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ./config-overrides.js</span><span class="hljs-keyword">const</span> &#123; override, fixBabelImports, addLessLoader &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">`customize-cra`</span>);<span class="hljs-built_in">module</span>.exports = override(fixBabelImports(<span class="hljs-string">&quot;import&quot;</span>, &#123;libraryName: <span class="hljs-string">&quot;antd&quot;</span>,libraryDirectory: <span class="hljs-string">&quot;es&quot;</span>,style: <span class="hljs-literal">true</span>,&#125;));</code></pre></div><h1 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h1><h2 id="redux"><a href="#redux" class="headerlink" title="redux"></a>redux</h2><ul><li><code>action</code><ul><li>  åŒæ­¥<code>action&lt;object&gt;</code></li><li>å¼‚æ­¥<code>action&lt;function&gt;</code><br>åŸç”Ÿåªèƒ½å¤„ç†åŒæ­¥ action,action ä¸­çš„ switch æœºåˆ¶</li></ul></li><li>  <code>reducer</code></li><li><code>store</code><ul><li>  <code>dispatch</code></li><li>  <code>subscribe</code></li></ul></li></ul><h2 id="react-redux"><a href="#react-redux" class="headerlink" title="react-redux"></a>react-redux</h2><ul><li><p><code>reducer</code><br>  reducer æ˜¯ä¸€ä¸ªçº¯å‡½æ•°:æ¥æ”¶ <code>Action</code> å’Œ <code>State</code> å¹¶ä½œä¸ºå‚æ•°ï¼Œé€šè¿‡è®¡ç®—å¾—åˆ°æ–°çš„<code>Store</code></p><blockquote><p>çº¯å‡½æ•°:</p><ol><li>ä¸ä¿®æ”¹å‚æ•°</li><li>ä¸äº§ç”Ÿå‰¯ä½œç”¨</li><li>ä¸è°ƒç”¨ä¸çº¯çš„æ–¹æ³•<code>Math.random()``new Date()</code></li></ol></blockquote>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> initState = <span class="hljs-number">0</span>;interface Action &#123;type: string;data: number;&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">countReducer</span>(<span class="hljs-params">preState = initState, action: Action</span>) </span>&#123;<span class="hljs-keyword">const</span> &#123; type, data &#125; = action;<span class="hljs-keyword">switch</span> (type) &#123;<span class="hljs-keyword">case</span> <span class="hljs-string">&quot;increment&quot;</span>:<span class="hljs-keyword">return</span> preState + data;<span class="hljs-keyword">case</span> <span class="hljs-string">&quot;decrement&quot;</span>:<span class="hljs-keyword">return</span> preState - data;<span class="hljs-keyword">default</span>:<span class="hljs-keyword">return</span> preState;&#125;&#125;</code></pre></div></li><li><p><code>connect API</code></p><p>  ä½¿ç”¨å“Ÿ container åŒ…è£¹ ui ç»„ä»¶,container è´Ÿè´£ä¸ store çš„äº¤äº’,æ“ä½œå’Œæ•°æ®é€šè¿‡ props ä¼ ç»™ ui ç»„ä»¶.</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// container.ts</span><span class="hljs-keyword">import</span> &#123; connect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;<span class="hljs-keyword">import</span> xxç»„ä»¶ <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../XXX&quot;</span>;<span class="hljs-keyword">import</span> &#123;action1,action2&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../redux/ACTIONS&quot;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapStateToProps</span>(<span class="hljs-params">state,ownProps</span>) </span>&#123;  <span class="hljs-comment">// å°†storeä¸­çš„stateæ˜ å°„ä¸ºprops</span>  <span class="hljs-comment">// â­ï¸è¯¥å‡½æ•°å¿…é¡»æ˜¯åŒæ­¥çš„</span>  <span class="hljs-keyword">return</span> &#123;    ...    prop1:state.someState  &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapDispatchToProps</span>(<span class="hljs-params">dispatch</span>)</span>&#123;  <span class="hljs-comment">// æ˜ å°„dispatchä¸ºprops</span>  <span class="hljs-keyword">return</span>&#123;    ...    func1: <span class="hljs-function">() =&gt;</span> dispatch(&#123;<span class="hljs-attr">type</span>:<span class="hljs-string">&#x27;someType&#x27;</span>&#125;)  &#125;&#125;<span class="hljs-keyword">const</span> CountContainer = connect(mapStateToProps,mapDispatchToProps)(xxç»„ä»¶);<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> CountContainer;</code></pre></div></li><li><p><code>å¤šä¸ªreducer</code></p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// store.ts</span><span class="hljs-keyword">import</span> &#123; createStore, applyMiddleware, combineReducers &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span>;<span class="hljs-keyword">import</span> countReducer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./reducers/count&quot;</span>;<span class="hljs-keyword">import</span> peopleReducer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./reducers/peolple&quot;</span>;<span class="hljs-keyword">const</span> allReducer = combineReducers(&#123;count: countReducer,people: peopleReducer,&#125;);<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createStore(allReducer);</code></pre></div></li></ul><h2 id="å¼‚æ­¥-Action"><a href="#å¼‚æ­¥-Action" class="headerlink" title="å¼‚æ­¥ Action"></a>å¼‚æ­¥ Action</h2><p>é€šè¿‡ Redux çš„ä¸­é—´ä»¶(middleware)å®ç°å¼‚æ­¥<code>Action</code>;</p><ul><li>  <code>redux-thunk</code>ç­‰ä¸­é—´ä»¶å¯ä»¥è®©ä½ æä¾›ä¸€ä¸ªæ‹¦æˆªå™¨åœ¨ <code>Reducer</code> å¤„ç† <code>Action</code> ä¹‹å‰è¢«è°ƒç”¨;</li><li>  åœ¨è¿™ä¸ªæ‹¦æˆªå™¨ä¸­ï¼Œä½ å¯ä»¥è‡ªç”±å¤„ç†è·å¾—çš„ Action;</li><li>  å¦‚æœActionæ˜¯ä¸ªå‡½æ•°ï¼Œ<code>redux-thunk</code>å°†ä¼šå°è¯•å…ˆæ‰§è¡Œå‡½æ•°è€Œä¸æ˜¯ä¼ ç»™<code>Reducer</code>ï¼Œå¹¶<code>dispatch</code>ä¼ ç»™è¿™ä¸ªå‡½æ•°ã€‚<div class="hljs code-wrapper"><pre><code class="hljs javascript"></code></pre></div></li></ul><h2 id="redux-devtools"><a href="#redux-devtools" class="headerlink" title="redux-devtools"></a>redux-devtools</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">yarn add redux-devtools-extension<span class="hljs-comment">// store.ts</span><span class="hljs-keyword">import</span> &#123; composeWithDevtools&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux-devtools-extension&#x27;</span>...<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createStore(  allReducer, composeWithDevtools(applyMiddleware(thunk)))</code></pre></div><h2 id="å‡å°‘æ ·æ¿ä»£ç "><a href="#å‡å°‘æ ·æ¿ä»£ç " class="headerlink" title="å‡å°‘æ ·æ¿ä»£ç "></a>å‡å°‘æ ·æ¿ä»£ç </h2><ul><li><p>redux-actions<br>  <a href="https://github.com/redux-utilities/redux-actions">https://github.com/redux-utilities/redux-actions</a><br>  ååŠ©ç”Ÿæˆ action creator</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; createAction &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux-actions&#x27;</span>...<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> increment = createAction(<span class="hljs-string">&#x27;INCREMENT&#x27;</span>)<span class="hljs-keyword">import</span> &#123; handleActions &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux-action&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> handleActions(&#123;  INCREMENT:<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state + <span class="hljs-number">1</span>&#125;,<span class="hljs-number">0</span>)</code></pre></div></li><li><p>  cli(yeoman)</p></li></ul><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><h2 id="setState"><a href="#setState" class="headerlink" title="setState"></a>setState</h2><ul><li><p>å¯¹è±¡å¼</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">setState(<span class="hljs-string">`stateChange(çŠ¶æ€æ”¹å˜å¯¹è±¡)`</span>, [callBack]);</code></pre></div></li><li><p>å‡½æ•°å¼</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">setState(<span class="hljs-string">`updater(è¿”å›stateChangeå¯¹è±¡çš„å‡½æ•°)`</span>,[callback])<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updater</span>(<span class="hljs-params">state,props</span>)</span>&#123;  ... æ¥æ”¶stateå’Œpropså‚æ•°&#125;</code></pre></div></li><li><p>  <code>callback</code>åœ¨<code>render()</code>åè°ƒç”¨</p></li></ul><h2 id="è·¯ç”±æ‡’åŠ è½½"><a href="#è·¯ç”±æ‡’åŠ è½½" class="headerlink" title="è·¯ç”±æ‡’åŠ è½½"></a>è·¯ç”±æ‡’åŠ è½½</h2><p><code>React.lazy</code>ä½¿ç”¨ dynamic import æ ‡å‡†,è¿”å›ä¸€ä¸ª promise,åœ¨ pending çŠ¶æ€æœŸé—´æ¸²æŸ“ loading ç»„ä»¶</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123;lazy,Suspense&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><span class="hljs-keyword">const</span> Com1 = lazy(<span class="hljs-function">()=&gt;</span>&#123;<span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./Com1/index&#x27;</span>)&#125;)<span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">return</span> (    &lt;NavLink to=<span class="hljs-string">&quot;/com1&quot;</span>&gt;Com1&lt;/NavLink&gt;    &lt;Suspense fallback=&#123;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Loading</span> /&gt;</span></span>&#125;&gt;      &lt;Route path=<span class="hljs-string">&quot;/com1&quot;</span> component=&#123;Com1&#125; /&gt;    &lt;/Suspense&gt;  )&#125;</code></pre></div><h2 id="JSX-Fragment"><a href="#JSX-Fragment" class="headerlink" title="JSX Fragment"></a>JSX Fragment</h2><blockquote><p>ä»£æ›¿æ ¹ div</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs html">import &#123; Fragment &#125;&gt; from &#x27;react`<span class="hljs-tag">&lt;<span class="hljs-name">Fragment</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;&#125;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Fragment</span>&gt;</span><span class="hljs-comment">&lt;!-- å¯ä»¥æ‹¥æœ‰key --&gt;</span><span class="hljs-comment">&lt;!-- çŸ­è¯­æ³• --&gt;</span><span class="hljs-tag">&lt;&gt;</span>...<span class="hljs-tag">&lt;/&gt;</span></code></pre></div><h2 id="å­ç»„ä»¶æ›´æ–°"><a href="#å­ç»„ä»¶æ›´æ–°" class="headerlink" title="å­ç»„ä»¶æ›´æ–°"></a>å­ç»„ä»¶æ›´æ–°</h2><blockquote><p>ä¸€èˆ¬å­ç»„ä»¶å³ä½¿ props æ²¡æ”¹å˜æˆ–è€…æ²¡æ¥å— props ä¹Ÿä¼šéšçˆ¶ç»„ä»¶ rerender</p></blockquote><p><code>PureComponent</code>**_<strong>æµ…å±‚</strong>_**æ¯”è¾ƒ<code>props</code>å’Œ<code>state</code>,åŒæ—¶<code>shouldComponentUpdate</code> å°†è·³è¿‡æ‰€æœ‰å­ç»„ä»¶æ ‘çš„ <code>prop</code> æ›´æ–°</p><h2 id="ç»„ä»¶-composition"><a href="#ç»„ä»¶-composition" class="headerlink" title="ç»„ä»¶ composition"></a>ç»„ä»¶ composition</h2><blockquote><p>ç»„ä»¶å¯ä»¥æ¥å—ä»»æ„ propsï¼ŒåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹</p></blockquote><blockquote><p>å°† jsx å…ƒç´ ä»¥åŠå‡½æ•°é€šè¿‡ props ä¼ é€’å®ç°ç±»ä¼¼ vue slot æ•ˆæœ</p></blockquote><blockquote><p>å‘ç»„ä»¶å†…éƒ¨åŠ¨æ€ä¼ å…¥å†…å®¹</p></blockquote><ol><li><code>.children</code>è·å¾—ç»„ä»¶æ ‡ç­¾å†…å†…å®¹</li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FancyBorder</span>(<span class="hljs-params">props</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&#123;</span>&quot;<span class="hljs-attr">FancyBorder</span> <span class="hljs-attr">FancyBorder-</span>&quot; + <span class="hljs-attr">props.color</span>&#125;&gt;</span>&#123;props.children&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WelcomeDialog</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> (&lt;FancyBorder color=<span class="hljs-string">&quot;blue&quot;</span>&gt;&lt;h1 className=<span class="hljs-string">&quot;Dialog-title&quot;</span>&gt;Welcome&lt;/h1&gt;&lt;p className=<span class="hljs-string">&quot;Dialog-message&quot;</span>&gt;Thank you <span class="hljs-keyword">for</span> visiting our spacecraft!&lt;/p&gt;&lt;/FancyBorder&gt;);&#125;</code></pre></div><ol start="2"><li>æˆ–è€…ä½¿ç”¨çº¦å®šåç§°</li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SplitPane</span>(<span class="hljs-params">props</span>) </span>&#123;<span class="hljs-keyword">return</span> (&lt;div className=<span class="hljs-string">&quot;SplitPane&quot;</span>&gt;&lt;div className=<span class="hljs-string">&quot;SplitPane-left&quot;</span>&gt;&#123;props.left&#125;&lt;/div&gt;&lt;div className=<span class="hljs-string">&quot;SplitPane-right&quot;</span>&gt;&#123;props.right&#125;&lt;/div&gt;&lt;/div&gt;);&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">SplitPane</span> <span class="hljs-attr">left</span>=<span class="hljs-string">&#123;</span>&lt;<span class="hljs-attr">Contacts</span> /&gt;</span>&#125; right=&#123;<span class="hljs-tag">&lt;<span class="hljs-name">Chat</span> /&gt;</span>&#125; /&gt;</span>;&#125;</code></pre></div><ol start="3"><li>é€šè¿‡ props ä¼ é€’æºå¸¦å¦ä¸€ä¸ª props çš„å‡½æ•°</li></ol><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">A</span> <span class="hljs-attr">customizeFn</span>=<span class="hljs-string">&#123;(p1)</span>=&gt;</span>&#123;<span class="hljs-tag">&lt;<span class="hljs-name">B</span> <span class="hljs-attr">p1</span>=<span class="hljs-string">&#123;p1&#125;/</span>&gt;</span>&#125;&#125;/&gt;</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">A</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">const</span> [state,changeState] = React.useState(<span class="hljs-number">123</span>)  <span class="hljs-keyword">return</span> (    &lt;div&gt;æˆ‘æ˜¯Aç»„ä»¶&lt;/div&gt;    &#123;props.customizeFn(state)&#125;  )&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">B</span>(<span class="hljs-params">props</span>)</span>&#123;  <span class="hljs-keyword">return</span> (    &lt;div&gt;æˆ‘æ˜¯Bæˆ‘æ”¶åˆ°äº†&#123;props.p1&#125;&lt;/div&gt;  )&#125;</code></pre></div><h2 id="é”™è¯¯è¾¹ç•Œ"><a href="#é”™è¯¯è¾¹ç•Œ" class="headerlink" title="é”™è¯¯è¾¹ç•Œ"></a>é”™è¯¯è¾¹ç•Œ</h2><p>é”™è¯¯è¾¹ç•Œæ˜¯ä¸€ç§ React ç»„ä»¶ï¼Œè¿™ç§ç»„ä»¶å¯ä»¥æ•è·å‘ç”Ÿåœ¨å…¶å­ç»„ä»¶æ ‘ä»»ä½•ä½ç½®çš„ JavaScript é”™è¯¯ï¼Œå¹¶æ‰“å°è¿™äº›é”™è¯¯ï¼ŒåŒæ—¶å±•ç¤ºé™çº§ UIï¼Œè€Œå¹¶ä¸ä¼šæ¸²æŸ“é‚£äº›å‘ç”Ÿå´©æºƒçš„å­ç»„ä»¶æ ‘ã€‚é”™è¯¯è¾¹ç•Œåœ¨æ¸²æŸ“æœŸé—´ã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œæ•´ä¸ªç»„ä»¶æ ‘çš„æ„é€ å‡½æ•°ä¸­æ•è·é”™è¯¯ã€‚</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">getDerivedStateFromError</span>(<span class="hljs-params">error</span>)</span> &#123;  <span class="hljs-comment">// æ›´æ–° state ä½¿ä¸‹ä¸€æ¬¡æ¸²æŸ“èƒ½å¤Ÿæ˜¾ç¤ºé™çº§åçš„ UI</span>  <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span> &#125;;&#125;<span class="hljs-function"><span class="hljs-title">componentDidCatch</span>(<span class="hljs-params">error, errorInfo</span>)</span> &#123;  <span class="hljs-comment">// ä½ åŒæ ·å¯ä»¥å°†é”™è¯¯æ—¥å¿—ä¸ŠæŠ¥ç»™æœåŠ¡å™¨</span>  logErrorToMyService(error, errorInfo);&#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>react</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>reactæ‹¾é—</title>
    <link href="/2022/02/24/react%E6%8B%BE%E9%81%97/"/>
    <url>/2022/02/24/react%E6%8B%BE%E9%81%97/</url>
    
    <content type="html"><![CDATA[<h1 id="â­ï¸Redux"><a href="#â­ï¸Redux" class="headerlink" title="â­ï¸Redux"></a>â­ï¸Redux</h1><h2 id="createStore"><a href="#createStore" class="headerlink" title="createStore"></a><code>createStore</code></h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/*</span><span class="hljs-comment">* @param &#123;Function&#125; reducer</span><span class="hljs-comment">* @param &#123;any&#125; preloadedState åˆå§‹åŒ–çš„state</span><span class="hljs-comment">* @param &#123;Function&#125; enhancer ä¸­é—´ä»¶</span><span class="hljs-comment">*/</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createStore</span>(<span class="hljs-params">reducer,preloadedState,enhancer</span>)</span>&#123;  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> preloadedState === <span class="hljs-string">&#x27;function&#x27;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> enhancer === <span class="hljs-string">&#x27;undefined&#x27;</span>)&#123;    <span class="hljs-comment">// å¦‚æœpreloadedStateæ˜¯ä¸ªä¸­é—´ä»¶</span>    enhancer = preloadedState    preloadedState = <span class="hljs-literal">undefined</span>  &#125;  <span class="hljs-keyword">let</span> currentReducer = reducer  <span class="hljs-keyword">let</span> currentState = preloadedState <span class="hljs-comment">// ä¿å­˜state</span>  <span class="hljs-keyword">let</span> currentListeners = [] <span class="hljs-comment">// ç›‘å¬è€…æ•°ç»„</span>  <span class="hljs-keyword">let</span> nextListeners = currentListeners  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getState</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">return</span> currentState  &#125;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subscribe</span>(<span class="hljs-params">listener</span>)</span>&#123;    <span class="hljs-keyword">if</span>(nextListeners === currentListeners)&#123;      nextListeners = [...currentListeners]      <span class="hljs-comment">// æµ…æ‹·è´ä¸€æ¬¡,é¿å…å½±å“åˆ«çš„åœ°æ–¹ä¿®æ”¹currentListeners</span>    &#125;    nextListeners.push(listener)    <span class="hljs-comment">// æ·»åŠ ç›‘å¬</span>    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unsubscribe</span>(<span class="hljs-params"></span>)</span>&#123;      <span class="hljs-keyword">if</span>(nextListeners === currentListeners)&#123;        nextListeners = [...currentListeners]      &#125;      <span class="hljs-keyword">const</span> index = nextListeners.indexOf(listener)      nextListeners.splice(index,<span class="hljs-number">1</span>)      <span class="hljs-comment">// ç§»é™¤ç›‘å¬</span>    &#125;  &#125;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dispatch</span>(<span class="hljs-params">action</span>) </span>&#123;    currentState = currentReducer(currentState,action) <span class="hljs-comment">// è®¡ç®—æ–°state</span>    <span class="hljs-keyword">const</span> listeners = (currentListeners = nextListeners) <span class="hljs-comment">// æ›´æ–°currentListenersæ•°ç»„</span>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ;i&lt;listener.length;i++&gt;)&#123;      listeners[i]()    &#125;    <span class="hljs-keyword">return</span> action  &#125;  dispatch(&#123;<span class="hljs-attr">type</span>:<span class="hljs-string">&#x27;INIT&#x27;</span>&#125;)  <span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡dispatch,åˆå§‹åŒ–state</span>  <span class="hljs-keyword">return</span>&#123;    getState,    subscribe,    dispatch  &#125;&#125;</code></pre></div><h1 id="â­ï¸React-redux"><a href="#â­ï¸React-redux" class="headerlink" title="â­ï¸React-redux"></a>â­ï¸React-redux</h1><h2 id="connect-APIåœ¨Classç»„ä»¶ä¸­"><a href="#connect-APIåœ¨Classç»„ä»¶ä¸­" class="headerlink" title="connect APIåœ¨Classç»„ä»¶ä¸­"></a><code>connect APIåœ¨Classç»„ä»¶ä¸­</code></h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// connect(...)(UIç»„ä»¶)</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">connect</span>(<span class="hljs-params">mapStateToProps = state =&gt; state,mapDispatchToToProps = ()=&gt;&#123;&#125;</span>) =&gt; (<span class="hljs-params">WrapComponent</span>) =&gt; </span>&#123;  <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConnectComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>&#123;    <span class="hljs-keyword">static</span> contextTypes = &#123;      store:PropTypes.object    &#125;    <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">props,context</span>)</span>&#123;      <span class="hljs-comment">// contextç”±ä¸Šå±‚Providerä¼ ä¸‹</span>      <span class="hljs-built_in">super</span>(props,context)      <span class="hljs-built_in">this</span>.state = &#123;        props:&#123;&#125;      &#125;    &#125;    <span class="hljs-function"><span class="hljs-title">componentDidMount</span>(<span class="hljs-params"></span>)</span>&#123;      <span class="hljs-keyword">const</span> &#123; store &#125; = <span class="hljs-built_in">this</span>.context      store.subscribe(<span class="hljs-function">()=&gt;</span><span class="hljs-built_in">this</span>.update()) <span class="hljs-comment">// storeæ·»åŠ åŠ updateè¿™ä¸ªå›è°ƒ</span>      <span class="hljs-comment">// storeä¸­stateæ”¹å˜æ—¶è§¦å‘è¿™ä¸ªupdateæ–¹æ³•</span>      <span class="hljs-built_in">this</span>.update()    &#125;    <span class="hljs-function"><span class="hljs-title">update</span>(<span class="hljs-params"></span>)</span>&#123;      <span class="hljs-comment">// updateæ–¹æ³•å°†æœ€æ–°çš„storeå±æ€§æ”¶é›†å¹¶ä¼ ç»™uiç»„ä»¶</span>      <span class="hljs-keyword">const</span> &#123; store &#125; = <span class="hljs-built_in">this</span>.context      <span class="hljs-keyword">const</span> stateProps = mapStateToProps(store.getState())      <span class="hljs-keyword">const</span> dispatchProps = mapDispatchToToProps(store.dispatch)      <span class="hljs-comment">// å–å¾—storeä¸­çš„stateå’Œdispatch</span>      <span class="hljs-built_in">this</span>.setState(&#123;        props:&#123;          ...this.state.props,          ...stateProps,          ...dispatchProps        &#125;      &#125;)      <span class="hljs-comment">// setStateå¯¼è‡´render(),æ›´æ–°å­ç»„ä»¶props</span>    &#125;    <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>&#123;      <span class="hljs-keyword">return</span> (        <span class="hljs-comment">// ä½œä¸ºæ­£å¸¸propsä¸€è‚¡è„‘ä¸¢ç»™UIç»„ä»¶</span>        &lt;WrapComponent &#123;...this.state.props&#125; /&gt;      )    &#125;  &#125;&#125;</code></pre></div><h1 id="â­ï¸-é¢è¯•é¢˜"><a href="#â­ï¸-é¢è¯•é¢˜" class="headerlink" title="â­ï¸ é¢è¯•é¢˜"></a>â­ï¸ é¢è¯•é¢˜</h1><ul><li><p><code>useEffect</code>(fn,[])å’Œ componentDidMount çš„åŒºåˆ«</p><ol><li><code>useEffect</code>(fn,[])åœ¨<code>commit</code>æ‰§è¡Œå®Œä¹‹åå¼‚æ­¥æ‰§è¡Œ fn å›è°ƒ</li><li><code>componentDidMount</code>åœ¨<code>commitä¸­çš„mutation</code>æ‰§è¡Œå®Œæ—¶å€™å’Œ<code>layout</code>åŒæ­¥æ‰§è¡Œ</li><li><code>useLayoutEffect</code>èƒ½å®ç°å’Œ<code>ğŸ‘†</code>ä¸€æ ·çš„æ•ˆæœ</li></ol></li><li><p><code>react-redux</code>å¦‚ä½•å°† store çš„ state æ³¨å…¥ç»„ä»¶</p><p>  é€šè¿‡<code>connect</code>å‡½æ•°åœ¨ ui ç»„ä»¶ä¸Šå¥—å£³,å°†æ¥è‡ª provider çš„ context ä¸­å–å‡º store å¹¶å°†å…¶å±æ€§ä½œä¸º props ä¼ ç»™ ui ç»„ä»¶,åŒæ—¶è®¢é˜… store çš„æ›´æ–°ä¿è¯ props æ•°æ®ä¹Ÿæ˜¯æœ€æ–°çš„</p></li><li><p><code>redux-thunk</code>ä¸­é—´ä»¶</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span>;<span class="hljs-keyword">import</span> thunk <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux-thunk&quot;</span>;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createStore(xxx-reducer, applyMiddleware(thunk));</code></pre></div><p>  åå°±å¯ä»¥ä½¿ç”¨ function ä½œä¸º action</p></li><li><p><code>setStateçš„åŒæ­¥å’Œå¼‚æ­¥</code></p><ol><li>åˆæˆäº‹ä»¶å’Œç”Ÿå‘½å‘¨æœŸä¸­çš„<code>setState</code>æ˜¯å¼‚æ­¥çš„</li><li>åŸç”Ÿäº‹ä»¶å’Œ<code>setTimeout</code>ä¸­çš„<code>setState</code>æ˜¯åŒæ­¥çš„</li><li>ä½¿ç”¨<code>setState</code>çš„<code>callback</code>æ€»èƒ½æ‹¿åˆ°æœ€æ–°çš„å€¼</li><li>setStateè‡ªå¸¦æ‰¹å¤„ç†ä¼˜åŒ–ï¼Œå¤šæ¬¡è°ƒç”¨åªä¼šæ‰§è¡Œæœ€æ–°çš„ä¸€æ¬¡</li></ol></li><li><p>åˆæˆäº‹ä»¶</p><p>Reactå¯¹åŸç”ŸDOMäº‹ä»¶éƒ½åšäº†ä»£ç†ï¼Œä¸”äº‹ä»¶éƒ½æ˜¯ç»‘å®šåˆ°appæ ¹èŠ‚ç‚¹ä¸Šï¼Œ<br>é€šè¿‡äº‹ä»¶å†’æ³¡æ—¶çš„ <code>srcElement</code>æŸ¥æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ä¸Šçš„äº‹ä»¶æ ‡è¯†ï¼Œå†å»åˆæˆäº‹ä»¶åº“ä¸­å¯»æ‰¾ç›¸åº”çš„å›è°ƒã€‚</p></li></ul><ul><li>Reactçš„æ€§èƒ½ä¼˜åŒ–<ol><li><code>useCallback</code>ç®¡ç†å‡½æ•°çš„æ‰§è¡Œ</li><li><code>useMemo</code>ç®¡ç†å€¼çš„è®¡ç®—</li><li><code>PureComponent</code>æµ…å±‚æ¯”è¾ƒ<code>state</code>å’Œ<code>prop</code>ä¸é‡å¤æ¸²æŸ“</li><li><code>React.memo HOC</code>æµ…å±‚æ¯”è¾ƒ<code>prop</code></li><li>æ³¨æ„<code>Context provide</code>è§¦å‘çš„æ¸²æŸ“æ— æ³•é¿å…</li><li><code>Redux connect</code>ä¸­ç»™ç»„ä»¶ä¼ çš„<code>state</code>éƒ½ä¼šè§¦å‘æ¸²æŸ“</li></ol></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
      <tag>react</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>require.context()</title>
    <link href="/2022/02/24/require.context%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/02/24/require.context%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<ul><li><p>è‡ªåŠ¨åŒ–æ³¨å†Œç»„ä»¶</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// global.js</span><span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">import</span> upperFirst <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash/upperFirst&#x27;</span><span class="hljs-keyword">import</span> camelCase <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash/camelCase&#x27;</span><span class="hljs-keyword">const</span> requireComponent = <span class="hljs-built_in">require</span>.context(  <span class="hljs-comment">// å…¶ç»„ä»¶ç›®å½•çš„ç›¸å¯¹è·¯å¾„</span>  <span class="hljs-comment">// å…¨å±€æ³¨å†Œçš„ç›®å½•</span>  .,  <span class="hljs-comment">// æ˜¯å¦æŸ¥è¯¢å…¶å­ç›®å½•</span>  <span class="hljs-literal">false</span>,  <span class="hljs-comment">// åŒ¹é…åŸºç¡€ç»„ä»¶æ–‡ä»¶åçš„æ­£åˆ™è¡¨è¾¾å¼</span>  <span class="hljs-comment">// /Base[A-Z]\w+\.(vue|js)$/</span>  /\.vue$/)requireComponent.keys().forEach(<span class="hljs-function"><span class="hljs-params">fileName</span> =&gt;</span> &#123;  <span class="hljs-comment">// è·å–ç»„ä»¶é…ç½®</span>  <span class="hljs-keyword">const</span> componentConfig = requireComponent(fileName)  <span class="hljs-comment">// è·å–ç»„ä»¶çš„ PascalCase å‘½å</span>  <span class="hljs-keyword">const</span> componentName = upperFirst(    camelCase(      <span class="hljs-comment">// è·å–å’Œç›®å½•æ·±åº¦æ— å…³çš„æ–‡ä»¶å</span>      fileName        <span class="hljs-comment">// .split(&#x27;/&#x27;)</span>        <span class="hljs-comment">// .pop()</span>        .replace(<span class="hljs-regexp">/^\.\//</span>,<span class="hljs-string">&#x27;&#x27;</span>)        <span class="hljs-comment">// â€˜./ComA.vueâ€™ =&gt; &#x27;ComA.vue&#x27;</span>        .replace(<span class="hljs-regexp">/\.\w+$/</span>, <span class="hljs-string">&#x27;&#x27;</span>)        <span class="hljs-comment">// =&gt; &#x27;ComA&#x27;</span>    )  )  <span class="hljs-comment">// å…¨å±€æ³¨å†Œç»„ä»¶</span>  Vue.component(    componentName,    <span class="hljs-comment">// å¦‚æœè¿™ä¸ªç»„ä»¶é€‰é¡¹æ˜¯é€šè¿‡ `export default` å¯¼å‡ºçš„ï¼Œ</span>    <span class="hljs-comment">// é‚£ä¹ˆå°±ä¼šä¼˜å…ˆä½¿ç”¨ `.default`ï¼Œ</span>    <span class="hljs-comment">// å¦åˆ™å›é€€åˆ°ä½¿ç”¨æ¨¡å—çš„æ ¹ã€‚</span>    componentConfig.default || componentConfig  )&#125;)</code></pre></div></li><li><p>è‡ªåŠ¨åŒ–æ³¨å†Œè·¯ç”±</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// router.js</span><span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">import</span> Router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span>Vue.use(Router)<span class="hljs-keyword">const</span> routerList = []<span class="hljs-keyword">const</span> importAllRouter = <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> &#123;  r.keys().forEach(<span class="hljs-function"><span class="hljs-params">key</span>=&gt;</span>&#123;    routerList.push(r[key].default  <span class="hljs-comment">/*export default*/</span>)  &#125;)&#125;importAllRouter(<span class="hljs-built_in">require</span>.context(.<span class="hljs-comment">/* æŸ¥è¯¢ç›®å½•*/</span>,<span class="hljs-literal">true</span><span class="hljs-comment">/*æ˜¯å¦åŒ…å«å­ç›®å½•*/</span>,<span class="hljs-regexp">/\.router\.js/</span><span class="hljs-regexp">/*åŒ¹é…æ­£åˆ™*/</span>))<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> Router(&#123;  ...routerList&#125;)</code></pre></div></li><li><p>ç®¡ç† graph æ–‡ä»¶ï¼ˆåŒç†ï¼‰</p><p>  <img src="https://s2.loli.net/2022/01/04/YoxB7hS6sZDEapr.png"></p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> context = <span class="hljs-built_in">require</span>.context(<span class="hljs-string">&quot;./&quot;</span>, <span class="hljs-literal">true</span>, <span class="hljs-regexp">/\.gql$|\.graphql$/</span>);<span class="hljs-keyword">const</span> map = &#123;&#125;;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> context.keys()) &#123;  <span class="hljs-keyword">const</span> keyArr = key.split(<span class="hljs-string">&quot;/&quot;</span>);  keyArr.shift();  <span class="hljs-keyword">const</span> _key = keyArr[<span class="hljs-number">1</span>]; <span class="hljs-comment">// åˆ æ‰æ–‡ä»¶å¤¹å</span>  map[_key.replace(<span class="hljs-regexp">/\.gql$|\.graphql$/g</span>, <span class="hljs-string">&quot;&quot;</span>)] = context(key);&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> map;</code></pre></div></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>topKé—®é¢˜</title>
    <link href="/2022/02/24/topK/"/>
    <url>/2022/02/24/topK/</url>
    
    <content type="html"><![CDATA[<h2 id="æœ€å¤§-å°çš„-K-ä¸ªæ•°ï¼Œç¬¬-K-ä¸ªæœ€å¤§-æœ€å°å€¼"><a href="#æœ€å¤§-å°çš„-K-ä¸ªæ•°ï¼Œç¬¬-K-ä¸ªæœ€å¤§-æœ€å°å€¼" class="headerlink" title="æœ€å¤§/å°çš„ K ä¸ªæ•°ï¼Œç¬¬ K ä¸ªæœ€å¤§/æœ€å°å€¼"></a>æœ€å¤§/å°çš„ K ä¸ªæ•°ï¼Œç¬¬ K ä¸ªæœ€å¤§/æœ€å°å€¼</h2><ul><li><p>å±€éƒ¨å†’æ³¡<br>ï¼ï¼è¾“å‡ºç»“æœæ— åº</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bubbleSort</span>(<span class="hljs-params">arr, k</span>) </span>&#123;  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; k; i++) &#123;    <span class="hljs-comment">// å†’æ³¡æ‰§è¡Œkæ¬¡</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = arr.length - <span class="hljs-number">1</span>; j &gt; i; j--) &#123;      <span class="hljs-keyword">if</span> (arr[j] &lt; arr[j - <span class="hljs-number">1</span>]) &#123;        [arr[j], arr[j - <span class="hljs-number">1</span>]] = [arr[j - <span class="hljs-number">1</span>], arr[j]];      &#125;    &#125;  &#125;&#125;<span class="hljs-comment">// Kç›¸å½“äºå†’æ³¡æ¬¡æ•°</span><span class="hljs-comment">//å‰kä¸ªå°å€¼</span>data.slice(<span class="hljs-number">0</span>, k);<span class="hljs-comment">//ç¬¬kå°çš„å€¼</span>data[k - <span class="hljs-number">1</span>];</code></pre></div></li><li><p>å †æ’åº</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// topk</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heapObj</span>(<span class="hljs-params">items,k</span>)</span>&#123;  <span class="hljs-keyword">const</span> heap = [,...items.slice(<span class="hljs-number">0</span>,k)]  <span class="hljs-keyword">const</span> heapSize = k  buildHeap(heap,heapSize)  <span class="hljs-comment">// æ±‚å¤§å€¼ï¼Œå»ºç«‹æœ€å°å †</span>  <span class="hljs-comment">// åç»­ä¸æœ€å°å †å †é¡¶æ¯”è¾ƒ</span>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j = k ; j &lt; items.length ; j++)&#123;    <span class="hljs-keyword">if</span>(heap[<span class="hljs-number">1</span>] &lt; items[j])&#123;      <span class="hljs-comment">// å¦‚æœå¤§äºæœ€å°</span>      <span class="hljs-comment">// ä½œä¸ºå †é¡¶çš„æ–°å€¼ï¼Œè°ƒæ•´å †</span>      heap[<span class="hljs-number">1</span>] = items[j]      heapify(heap,heapSize,<span class="hljs-number">1</span>)    &#125;  &#125;  <span class="hljs-keyword">return</span> heap.slice(<span class="hljs-number">1</span>)  <span class="hljs-comment">// å‰kä¸ªå¤§å€¼</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildHeap</span>(<span class="hljs-params">items,heapSize</span>)</span>&#123;  <span class="hljs-keyword">if</span>(heapSize === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-built_in">Math</span>.floor(heapSize/<span class="hljs-number">2</span>) ; i &gt; <span class="hljs-number">0</span> ; i --)&#123;    heapify(items,heapSize,i)  &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heapify</span>(<span class="hljs-params">items,heapSize,i</span>)</span>&#123;  <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;    <span class="hljs-keyword">let</span> minIndex = i    <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i &lt;= heapSize &amp;&amp; items[<span class="hljs-number">2</span>*i] &lt; items[i]) minIndex = <span class="hljs-number">2</span>*i    <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span> &lt;= heapSize &amp;&amp; items[<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>] &lt; items[minIndex]) minIndex = <span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>    <span class="hljs-keyword">if</span>(minIndex===i) <span class="hljs-keyword">break</span>    [items[i],items[minIndex]] = [items[minIndex],items[i]]    i = minIndex  &#125;&#125;</code></pre></div><ul><li>å¿«é€Ÿé€‰æ‹©<blockquote><p>å¿«æ’çš„æ”¹è£…</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ç¬¬kå¤§çš„å…ƒç´ </span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">quickSort</span>(<span class="hljs-params">arr,k</span>)</span>&#123;  <span class="hljs-keyword">return</span> quick(arr,<span class="hljs-number">0</span>,arr.length-<span class="hljs-number">1</span>,k)  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">quick</span>(<span class="hljs-params">arr,l,r,k</span>)</span>&#123;    <span class="hljs-keyword">const</span> index = partition(arr,l,r)    <span class="hljs-comment">// è¿™é‡Œå¼€å§‹å’Œä¸€èˆ¬å¿«æ’ä¸åŒ</span>    <span class="hljs-comment">// ç¬¬kå¤§çš„å€¼ï¼Œç´¢å¼•ä¸ºk-1</span>    <span class="hljs-comment">// partitioné€‰å‡ºçš„ä½ç½®ä¸è¿™ä¸ªkæ¯”è¾ƒ</span>    <span class="hljs-comment">// æ ¹æ®pivotä¸k-1çš„ç›¸å¯¹ä½ç½®ï¼Œæ¯æ¬¡åªç”¨ç»§ç»­partitionä¸€åŠ</span>    <span class="hljs-keyword">if</span>(index === k-<span class="hljs-number">1</span>)&#123;      <span class="hljs-keyword">return</span> arr[index]    &#125;    <span class="hljs-keyword">if</span>(index &gt; k-<span class="hljs-number">1</span>)&#123;      <span class="hljs-keyword">return</span> quick(arr,l,index-<span class="hljs-number">1</span>,k)    &#125;    <span class="hljs-keyword">if</span>(index &lt; k-<span class="hljs-number">1</span>)&#123;      <span class="hljs-keyword">return</span> quick(arr,index+<span class="hljs-number">1</span>,r,k)    &#125;  &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">partition</span>(<span class="hljs-params">arr,l,r</span>)</span>&#123;  <span class="hljs-keyword">const</span> pivot = arr[r]  <span class="hljs-keyword">let</span> i = l  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j = l;j&lt;r;j++)&#123;    <span class="hljs-keyword">if</span>(arr[j]&lt;pivot)&#123;      [arr[j],arr[i]] = [arr[i],arr[j]]      i++    &#125;  &#125;  [arr[i],arr[r]] = [arr[r],arr[i]]  <span class="hljs-keyword">return</span> i &#125;</code></pre></div></li></ul><h2 id="å‡ºç°æœ€å¤š-æœ€å°‘çš„-K-ä¸ªå…ƒç´ "><a href="#å‡ºç°æœ€å¤š-æœ€å°‘çš„-K-ä¸ªå…ƒç´ " class="headerlink" title="å‡ºç°æœ€å¤š/æœ€å°‘çš„ K ä¸ªå…ƒç´ "></a>å‡ºç°æœ€å¤š/æœ€å°‘çš„ K ä¸ªå…ƒç´ </h2><ul><li>å‚»ç“œ map æ˜ å°„ä¸€ä¸ª arr è¿›è¡Œæ’åº</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showMost</span>(<span class="hljs-params">arr, k</span>) </span>&#123;  <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();  <span class="hljs-keyword">const</span> ret = [...new <span class="hljs-built_in">Set</span>(arr)];  arr.map(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (map.has(num)) &#123;      map.set(num, map.get(num) + <span class="hljs-number">1</span>);    &#125; <span class="hljs-keyword">else</span> &#123;      map.set(num, <span class="hljs-number">1</span>);    &#125;  &#125;);  ret.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> map.get(b) - map.get(a));  <span class="hljs-keyword">return</span> ret.slice(<span class="hljs-number">0</span>, k);&#125;</code></pre></div><ul><li>map æ˜ å°„å †æ’åº</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showMost</span>(<span class="hljs-params">arr, k</span>) </span>&#123;  <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();  <span class="hljs-keyword">const</span> heap = [,];  arr.map(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (map.has(num)) &#123;      map.set(num, map.get(num) + <span class="hljs-number">1</span>);    &#125; <span class="hljs-keyword">else</span> &#123;      map.set(num, <span class="hljs-number">1</span>);    &#125;  &#125;);  <span class="hljs-keyword">if</span> (map.size &lt;= k) <span class="hljs-keyword">return</span> [...map.keys()];  <span class="hljs-comment">//kå¤§äºå…ƒç´ æ•°ï¼Œç›´æ¥è¾“å‡º</span>  <span class="hljs-keyword">let</span> times = <span class="hljs-number">1</span>;  <span class="hljs-comment">//è®°æ•°å™¨</span>  <span class="hljs-comment">//å°äºkçš„éƒ¨åˆ†ç›´æ¥å»ºç«‹å †ï¼Œå¤§äºçš„éƒ¨åˆ†å¼€å§‹ä¸å †topæ¯”è¾ƒ</span>  map.forEach(<span class="hljs-function">(<span class="hljs-params">value, key</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (times &lt;= k) &#123;      heap.push(key);      <span class="hljs-keyword">if</span> (times === k) &#123;        <span class="hljs-comment">//å †åŒ–</span>        buildHeap(heap, map, k);      &#125;    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (map.get(heap[<span class="hljs-number">1</span>]) &lt; value) &#123;      <span class="hljs-comment">// ä¸å°é¡¶å †é¡¶äº¤æ¢</span>      heap[<span class="hljs-number">1</span>] = key;      heapify(heap, map, k, <span class="hljs-number">1</span>);    &#125;    times++;  &#125;);  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildHeap</span>(<span class="hljs-params">heap, map, heapSize</span>) </span>&#123;    <span class="hljs-keyword">if</span> (k === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-built_in">Math</span>.floor(heapSize / <span class="hljs-number">2</span>); i &gt;= <span class="hljs-number">1</span>; i--) &#123;      heapify(heap, map, heapSize, i);    &#125;  &#125;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heapify</span>(<span class="hljs-params">heap, map, heapSize, i</span>) </span>&#123;    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;      <span class="hljs-keyword">let</span> minIndex = i;      <span class="hljs-keyword">if</span> (<span class="hljs-number">2</span> * i &lt;= heapSize &amp;&amp; map.get(heap[<span class="hljs-number">2</span> * i]) &lt; map.get(heap[minIndex]))        minIndex = <span class="hljs-number">2</span> * i;      <span class="hljs-keyword">if</span> (        <span class="hljs-number">2</span> * i + <span class="hljs-number">1</span> &lt;= heapSize &amp;&amp;        map.get(heap[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>]) &lt; map.get(heap[minIndex])      )        minIndex = <span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>;      <span class="hljs-keyword">if</span> (minIndex === i) <span class="hljs-keyword">break</span>;      swap(heap, minIndex, i);      i = minIndex;    &#125;  &#125;  heap.shift();  <span class="hljs-keyword">return</span> heap;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">swap</span>(<span class="hljs-params">data, l, r</span>) </span>&#123;  <span class="hljs-keyword">let</span> temp = data[l];  data[l] = data[r];  data[r] = temp;&#125;</code></pre></div><ul><li>æ¡¶æ’åº</li></ul><p>å‡ºç°æ¬¡æ•°æœ€å¤šçš„å‰kä¸ªæ•°</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showMost</span>(<span class="hljs-params">arr,k</span>)</span>&#123;  <span class="hljs-comment">// è®°å½•å„æ•°å­—å‡ºç°æ¬¡æ•°</span>  <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()  arr.map(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (map.has(num)) &#123;      map.set(num, map.get(num) + <span class="hljs-number">1</span>);    &#125; <span class="hljs-keyword">else</span> &#123;      map.set(num, <span class="hljs-number">1</span>);    &#125;  &#125;);  <span class="hljs-keyword">if</span>(map.size&lt;=k) <span class="hljs-keyword">return</span> [...map.keys()]  <span class="hljs-keyword">return</span> buckerSort(map,k)&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buckerSort</span>(<span class="hljs-params">map,k</span>)</span>&#123;  <span class="hljs-comment">// æŒ‰ç…§å‡ºç°æ¬¡æ•°ä½œä¸ºarræ•°ç»„ä¸‹æ ‡åˆ’åˆ†æ¡¶</span>  <span class="hljs-comment">// å°†æ•°å­—æ”¾å…¥æ¡¶ä¸­</span>  <span class="hljs-keyword">let</span> arr = []  <span class="hljs-keyword">let</span> res = []  map.forEach(<span class="hljs-function">(<span class="hljs-params">value,key</span>)=&gt;</span>&#123;    <span class="hljs-keyword">if</span>(!arr[value])&#123;      arr[value] = [key]    &#125;<span class="hljs-keyword">else</span>&#123;      arr[value].push(key)    &#125;    <span class="hljs-comment">// å‡ºç°äº†valueæ¬¡çš„æ•°å­—æœ‰...</span>  &#125;)  <span class="hljs-comment">// é€†å‘éå†æ¡¶æ•°ç»„</span>  <span class="hljs-comment">// </span>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = arr.length - <span class="hljs-number">1</span> ; i&gt;=<span class="hljs-number">0</span> &amp;&amp; res.length &lt; k ; i--)&#123;    <span class="hljs-comment">// ä»å‡ºç°æœ€å¤šçš„æ•°å­—å¼€å§‹æ”¶é›†ç›´åˆ°æ”¶é›†åˆ°kä¸ª</span>    <span class="hljs-keyword">if</span>(arr[i])&#123;      res.push(...arr[i])    &#125;  &#125;  <span class="hljs-keyword">return</span> res&#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>svgå›¾æ ‡å°è£…ç»„ä»¶</title>
    <link href="/2022/02/24/svg%E5%9B%BE%E6%A0%87%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6/"/>
    <url>/2022/02/24/svg%E5%9B%BE%E6%A0%87%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<blockquote><p>VUEé¡¹ç›®ä¸­å°†svgå›¾æ ‡å°è£…ä¸ºç»„ä»¶,åç»­æ‹·è´è¿›svgæ–‡ä»¶ç›´æ¥ä½¿ç”¨</p></blockquote><h3 id="iconç»„ä»¶"><a href="#iconç»„ä»¶" class="headerlink" title="iconç»„ä»¶"></a>iconç»„ä»¶</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;template&gt;  &lt;svg :<span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;svgClass&quot;</span> aria-hidden=<span class="hljs-string">&quot;true&quot;</span>   <span class="hljs-comment">// /* aria-hidden=&quot;true&quot;å°†å…ƒç´ ä»å¯è®¿é—®æ ‘ä¸Šç§»é™¤ */</span>  v-on=<span class="hljs-string">&quot;$listeners&quot;</span>&gt;    &lt;use :xlink:href=<span class="hljs-string">&quot;iconName&quot;</span> /&gt;  &lt;/svg&gt;&lt;/template&gt;&lt;script&gt;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  name: <span class="hljs-string">&#x27;SvgIcon&#x27;</span>,  props: &#123;    iconClass: &#123;      type: <span class="hljs-built_in">String</span>,      required: <span class="hljs-literal">true</span>    &#125;,    className: &#123;      type: <span class="hljs-built_in">String</span>,      <span class="hljs-keyword">default</span>: <span class="hljs-string">&#x27;&#x27;</span>    &#125;  &#125;,  computed: &#123;    <span class="hljs-function"><span class="hljs-title">iconName</span>(<span class="hljs-params"></span>)</span> &#123;      <span class="hljs-keyword">return</span> <span class="hljs-string">`#icon-<span class="hljs-subst">$&#123;<span class="hljs-built_in">this</span>.iconClass&#125;</span>`</span>    &#125;,    <span class="hljs-function"><span class="hljs-title">svgClass</span>(<span class="hljs-params"></span>)</span> &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.className) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;svg-icon &#x27;</span> + <span class="hljs-built_in">this</span>.className      &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;svg-icon&#x27;</span>      &#125;    &#125;  &#125;&#125;&lt;/script&gt;&lt;style scoped&gt;.svg-icon &#123;  width: 1em;  height: 1em;  vertical-align: -<span class="hljs-number">0.</span>15em;  fill: currentColor;  overflow: hidden;&#125;&lt;/style&gt;</code></pre></div><h3 id="é…ç½®è‡ªåŠ¨å¼•å…¥svgæ–‡ä»¶"><a href="#é…ç½®è‡ªåŠ¨å¼•å…¥svgæ–‡ä»¶" class="headerlink" title="é…ç½®è‡ªåŠ¨å¼•å…¥svgæ–‡ä»¶"></a>é…ç½®è‡ªåŠ¨å¼•å…¥svgæ–‡ä»¶</h3><p>ä½¿ç”¨<code>webpack</code>çš„<code>require.context</code>APIï¼Œä¸¤ç§æ–¹æ³•</p><blockquote><p><code>assets/icon</code>æ˜¯å­˜æ”¾<code>svg</code>å›¾æ ‡æ–‡ä»¶çš„è·¯å¾„</p></blockquote><ol><li>åœ¨<code>assets/icon</code>æ–°å»º<code>index.js</code></li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">import</span> SvgIcon <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/components/SvgIcon&#x27;</span>Vue.component(<span class="hljs-string">&#x27;svg-icon&#x27;</span>, SvgIcon)<span class="hljs-keyword">const</span> importAll = <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.keys().forEach(r)<span class="hljs-keyword">const</span> svgContext = <span class="hljs-built_in">require</span>.context(<span class="hljs-string">&#x27;@/assets/icon&#x27;</span>, <span class="hljs-literal">false</span>, <span class="hljs-regexp">/\.svg$/</span>);<span class="hljs-comment">// è·å–è¯¥ç›®å½•ä¸‹æ‰€æœ‰.svgçš„context</span>importAll(svgContext)<span class="hljs-comment">//åœ¨main.jsä¸­å¯¼å…¥</span><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;@/assets/icon/index&#x27;</span></code></pre></div><ol start="2"><li>æˆ–è€…ç›´æ¥åœ¨<code>main.js</code>ä¸­</li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> SvgIcon <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/components/SvgIcon&#x27;</span><span class="hljs-keyword">const</span> importAll = <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.keys().forEach(r)<span class="hljs-keyword">const</span> svgContext = <span class="hljs-built_in">require</span>.context(<span class="hljs-string">&#x27;@/assets/icon&#x27;</span>, <span class="hljs-literal">false</span>, <span class="hljs-regexp">/\.svg$/</span>);<span class="hljs-comment">// è·å–è¯¥ç›®å½•ä¸‹æ‰€æœ‰.svgçš„context</span>importAll(svgContext)Vue.component(<span class="hljs-string">&#x27;svg-icon&#x27;</span>,SvgIcon) <span class="hljs-comment">// å…¨å±€æ³¨å†Œ</span></code></pre></div><h3 id="devDependencies"><a href="#devDependencies" class="headerlink" title="devDependencies"></a>devDependencies</h3><ul><li><code>svg-baker-runtime</code></li><li><code>svg-sprite-loader</code></li><li>é…ç½®<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// vue.config.js</span>chainWebpack: <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> svgRule = config.module.rule(<span class="hljs-string">&quot;svg&quot;</span>);  svgRule.uses.clear();  svgRule    .rule(<span class="hljs-string">&quot;icons&quot;</span>)    .test(<span class="hljs-regexp">/\.svg$/</span>)    .include.add(resolve(<span class="hljs-string">&quot;src/assets/icon&quot;</span>))    .end()    .use(<span class="hljs-string">&quot;svg-sprite-loader&quot;</span>)    .loader(<span class="hljs-string">&quot;svg-sprite-loader&quot;</span>)    .options(&#123;      symbolId: <span class="hljs-string">&quot;[name]&quot;</span>,    &#125;);&#125;,</code></pre></div></li></ul><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>å°ºå¯¸å¯ä»¥è‡ªå·±è¦†ç›–æ ·å¼</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;svg-icon  :icon-<span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;cardData.platform&quot;</span>  style=<span class="hljs-string">&quot;width: 2em; height: 2em;vertical-align:middle&quot;</span>&gt;&lt;/svg-icon&gt;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢å‘å¯¹è±¡</title>
    <link href="/2022/02/24/js%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    <url>/2022/02/24/js%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
    
    <content type="html"><![CDATA[<p>ref:<a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E6%80%9D%E6%83%B3.md">https://github.com/CyC2018</a></p><h2 id="é¢å‘å¯¹è±¡çš„è®¾è®¡æ€æƒ³"><a href="#é¢å‘å¯¹è±¡çš„è®¾è®¡æ€æƒ³" class="headerlink" title="é¢å‘å¯¹è±¡çš„è®¾è®¡æ€æƒ³"></a>é¢å‘å¯¹è±¡çš„è®¾è®¡æ€æƒ³</h2><p>é¢å‘å¯¹è±¡çš„è®¾è®¡æ€æƒ³æ˜¯ä»è‡ªç„¶ç•Œä¸­æ¥çš„ï¼Œå› ä¸ºåœ¨è‡ªç„¶ç•Œä¸­å°±å­˜åœ¨ç±»ï¼ˆClassï¼‰å’Œå®ä¾‹ï¼ˆInstanceï¼‰çš„æ¦‚å¿µã€‚</p><ul><li><p>  Class æ˜¯ä¸€ç§æŠ½è±¡æ¦‚å¿µï¼Œæ¯”å¦‚æˆ‘ä»¬å®šä¹‰çš„ Classâ€”â€”Student ï¼Œæ˜¯æŒ‡å­¦ç”Ÿè¿™ä¸ªæ¦‚å¿µï¼Œ</p></li><li><p>  è€Œå®ä¾‹ï¼ˆInstanceï¼‰åˆ™æ˜¯ä¸€ä¸ªä¸ªå…·ä½“çš„ Student ï¼Œæ¯”å¦‚ï¼Œ Michael å’Œ Bob æ˜¯ä¸¤ä¸ªå…·ä½“çš„ Student ã€‚</p></li><li><p>  é¢å‘è¿‡ç¨‹å°±æ˜¯åˆ†æå‡ºè§£å†³é—®é¢˜æ‰€éœ€è¦çš„æ­¥éª¤ï¼Œç„¶åç”¨å‡½æ•°æŠŠè¿™äº›æ­¥éª¤ä¸€æ­¥ä¸€æ­¥å®ç°ã€‚</p></li><li><p>  é¢å‘å¯¹è±¡æ˜¯æŠŠæ„æˆé—®é¢˜äº‹åŠ¡åˆ†è§£æˆå„ä¸ªå¯¹è±¡ï¼Œå»ºç«‹å¯¹è±¡çš„ç›®çš„ä¸æ˜¯ä¸ºäº†å®Œæˆä¸€ä¸ªæ­¥éª¤ï¼Œè€Œæ˜¯ä¸ºäº†æå™æŸä¸ªäº‹ç‰©åœ¨æ•´ä¸ªè§£å†³é—®é¢˜çš„æ­¥éª¤ä¸­çš„è¡Œä¸ºã€‚</p></li></ul><h2 id="é¢å‘å¯¹è±¡ä¸‰è¦ç´ "><a href="#é¢å‘å¯¹è±¡ä¸‰è¦ç´ " class="headerlink" title="é¢å‘å¯¹è±¡ä¸‰è¦ç´ "></a>é¢å‘å¯¹è±¡ä¸‰è¦ç´ </h2><h3 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h3><p>åˆ©ç”¨æŠ½è±¡æ•°æ®ç±»å‹å°†æ•°æ®å’ŒåŸºäºæ•°æ®çš„æ“ä½œå°è£…åœ¨ä¸€èµ·ï¼Œä½¿å…¶æ„æˆä¸€ä¸ªä¸å¯åˆ†å‰²çš„ç‹¬ç«‹å®ä½“ã€‚æ•°æ®è¢«ä¿æŠ¤åœ¨æŠ½è±¡æ•°æ®ç±»å‹çš„å†…éƒ¨ï¼Œå°½å¯èƒ½åœ°éšè—å†…éƒ¨çš„ç»†èŠ‚ï¼Œåªä¿ç•™ä¸€äº›å¯¹å¤–æ¥å£ä½¿ä¹‹ä¸å¤–éƒ¨å‘ç”Ÿè”ç³»ã€‚ç”¨æˆ·æ— éœ€çŸ¥é“å¯¹è±¡å†…éƒ¨çš„ç»†èŠ‚ï¼Œä½†å¯ä»¥é€šè¿‡å¯¹è±¡å¯¹å¤–æä¾›çš„æ¥å£æ¥è®¿é—®è¯¥å¯¹è±¡ã€‚</p><ul><li>  å‡å°‘è€¦åˆï¼šå¯ä»¥ç‹¬ç«‹åœ°å¼€å‘å’Œæµ‹è¯•</li><li>  å‡è½»ç»´æŠ¤çš„è´Ÿæ‹…ï¼šå¯ä»¥æ›´å®¹æ˜“è¢«ç¨‹åºå‘˜ç†è§£ï¼Œå¹¶ä¸”åœ¨è°ƒè¯•çš„æ—¶å€™å¯ä»¥ä¸å½±å“å…¶ä»–æ¨¡å—</li><li>æœ‰æ•ˆåœ°è°ƒèŠ‚æ€§èƒ½ï¼šå¯ä»¥é€šè¿‡å‰–æç¡®å®šå“ªäº›æ¨¡å—å½±å“äº†ç³»ç»Ÿçš„æ€§èƒ½<br>  æé«˜è½¯ä»¶çš„å¯é‡ç”¨æ€§</li><li>  é™ä½äº†æ„å»ºå¤§å‹ç³»ç»Ÿçš„é£é™©ï¼šå³ä½¿æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ï¼Œä½†æ˜¯è¿™äº›ç‹¬ç«‹çš„æ¨¡å—å´æœ‰å¯èƒ½æ˜¯å¯ç”¨çš„</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ä»¥ä¸‹ Person ç±»å°è£… nameã€genderã€age ç­‰å±æ€§ï¼Œå¤–ç•Œåªèƒ½é€šè¿‡ get() æ–¹æ³•è·å–ä¸€ä¸ª Person å¯¹è±¡çš„ name å±æ€§å’Œ gender å±æ€§ï¼Œè€Œæ— æ³•è·å– age å±æ€§ï¼Œä½†æ˜¯ age å±æ€§å¯ä»¥ä¾› work() æ–¹æ³•ä½¿ç”¨ã€‚</span><span class="hljs-comment">// æ³¨æ„åˆ° gender å±æ€§ä½¿ç”¨ int æ•°æ®ç±»å‹è¿›è¡Œå­˜å‚¨ï¼Œå°è£…ä½¿å¾—ç”¨æˆ·æ³¨æ„ä¸åˆ°è¿™ç§å®ç°ç»†èŠ‚ã€‚å¹¶ä¸”åœ¨éœ€è¦ä¿®æ”¹ gender å±æ€§ä½¿ç”¨çš„æ•°æ®ç±»å‹æ—¶ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸å½±å“å®¢æˆ·ç«¯ä»£ç çš„æƒ…å†µä¸‹è¿›è¡Œã€‚</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;    private <span class="hljs-built_in">String</span> name;    private int gender;    private int age;    <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">getName</span>(<span class="hljs-params"></span>)</span> &#123;        <span class="hljs-keyword">return</span> name;    &#125;    <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">getGender</span>(<span class="hljs-params"></span>)</span> &#123;        <span class="hljs-keyword">return</span> gender == <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;man&quot;</span> : <span class="hljs-string">&quot;woman&quot;</span>;    &#125;    <span class="hljs-keyword">void</span> <span class="hljs-function"><span class="hljs-title">work</span>(<span class="hljs-params"></span>)</span> &#123;        <span class="hljs-keyword">if</span> (<span class="hljs-number">18</span> &lt;= age &amp;&amp; age &lt;= <span class="hljs-number">50</span>) &#123;            System.out.println(name + <span class="hljs-string">&quot; is working very hard!&quot;</span>);        &#125; <span class="hljs-keyword">else</span> &#123;            System.out.println(name + <span class="hljs-string">&quot; can&#x27;t work any more!&quot;</span>);        &#125;    &#125;&#125;</code></pre></div><h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3><ul><li><p>  å­ç±»å¯ä»¥è®¿é—®çˆ¶ç±»é private å±æ€§</p></li><li><p>  é‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œå­ç±»å¯¹è±¡å¿…é¡»èƒ½å¤Ÿæ›¿æ¢æ‰çˆ¶ç±»å¯¹è±¡ã€‚</p></li><li><p>  æé«˜ä»£ç çš„å¤ç”¨æ€§ï¼Œç»§æ‰¿æ˜¯å¤šæ€çš„å‰æã€‚</p></li></ul><h4 id="ES5ä¸­çš„ç»§æ‰¿æ–¹å¼"><a href="#ES5ä¸­çš„ç»§æ‰¿æ–¹å¼" class="headerlink" title="ES5ä¸­çš„ç»§æ‰¿æ–¹å¼"></a>ES5ä¸­çš„ç»§æ‰¿æ–¹å¼</h4><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Human</span>(<span class="hljs-params">name</span>)</span>&#123;    <span class="hljs-built_in">this</span>.name = name&#125;Human.prototype.introduce = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name&#125;</code></pre></div><ol><li><p>æ„é€ å‡½æ•°ç»§æ‰¿</p><ul><li>åªèƒ½ç»§æ‰¿æ„é€ å‡½æ•°ä¸­çš„å±æ€§<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Asian</span>(<span class="hljs-params">name</span>)</span>&#123;    Human.call(<span class="hljs-built_in">this</span>,name)&#125;</code></pre></div></li></ul></li><li><p>åŸå‹é“¾ç»§æ‰¿</p><ul><li>ä¸èƒ½å‘çˆ¶ç±»æ„é€ å‡½æ•°ä¼ å‚</li><li>å…±äº«å¼•ç”¨ç±»å‹çš„å±æ€§<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Asian</span>(<span class="hljs-params">name</span>)</span>&#123;    <span class="hljs-built_in">this</span>.name = name&#125;Asian.prototype  = <span class="hljs-keyword">new</span> Human()</code></pre></div></li></ul></li><li><p>1+2ç»„åˆç»§æ‰¿</p><ul><li>çˆ¶ç±»æ„é€ å‡½æ•°è¢«è°ƒç”¨å¤ªå¤šæ¬¡</li><li>å…±äº«å¼•ç”¨ç±»å‹å±æ€§<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Asian</span>(<span class="hljs-params">name</span>)</span>&#123;    Human.call(<span class="hljs-built_in">this</span>,name)&#125;Asian.prototype  = <span class="hljs-keyword">new</span> Human()</code></pre></div></li></ul></li><li><p>åŸå‹å¼ç»§æ‰¿</p><ul><li>é€‚ç”¨äºä¸æƒ³ä½¿ç”¨æ„é€ å‡½æ•°åˆæƒ³å…±äº«æ•°æ®çš„æƒ…å†µ</li><li>ä¸åŸå‹é“¾æ¨¡å¼ä¸€æ ·å…±äº«å¼•ç”¨ç±»å‹çš„å±æ€§<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å…¶å®å°±æ˜¯Object.createçš„å®ç°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Asian</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">F</span>(<span class="hljs-params"></span>)</span>&#123;&#125;    F.prototype = Human    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> F()&#125;</code></pre></div></li></ul></li><li><p>å¯„ç”Ÿç»§æ‰¿</p><ul><li>å·¥å‚å‡½æ•°æ¨¡å¼</li><li>éš¾ä»¥å¤ç”¨<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createAsian</span>(<span class="hljs-params">source</span>)</span>&#123;    <span class="hljs-keyword">const</span> o = <span class="hljs-built_in">Object</span>.create(source)    o.xxx = xxx <span class="hljs-comment">//æ·»åŠ è‡ªå·±çš„å±æ€§</span>    <span class="hljs-keyword">return</span> o&#125;<span class="hljs-keyword">const</span> s1 = createAsian(Human)</code></pre></div></li></ul></li><li><p>å¯„ç”Ÿç»„åˆç»§æ‰¿</p><ul><li>åªè°ƒç”¨ä¸€æ¬¡çˆ¶æ„é€ å‡½æ•°</li><li>ä¿æŒåŸåŸå‹é“¾<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Asian</span>(<span class="hljs-params">name</span>)</span>&#123;    Human.call(<span class="hljs-built_in">this</span>,name)&#125;Asian.prototype  = <span class="hljs-built_in">Object</span>.create(Human.prototype)Asian.prototype.constructor = Asian</code></pre></div><h3 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h3></li></ul></li></ol><ul><li><p>  çˆ¶ç±»æˆ–æ¥å£å®šä¹‰çš„å¼•ç”¨å˜é‡å¯ä»¥æŒ‡å‘å­ç±»æˆ–å®ä¾‹å¯¹è±¡ï¼Œå³å¤šç§ä¸åŒçŠ¶æ€</p></li><li><p>  æé«˜äº†ç¨‹åºçš„æ‰©å±•æ€§</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//  ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä¹å™¨ç±»ï¼ˆInstrumentï¼‰æœ‰ä¸¤ä¸ªå­ç±»ï¼šWind å’Œ Percussionï¼Œå®ƒä»¬éƒ½è¦†ç›–äº†çˆ¶ç±»çš„ play() æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ main() æ–¹æ³•ä¸­ä½¿ç”¨çˆ¶ç±» Instrument æ¥å¼•ç”¨ Wind å’Œ Percussion å¯¹è±¡ã€‚åœ¨Instrument å¼•ç”¨è°ƒç”¨ play() æ–¹æ³•æ—¶ï¼Œä¼šæ‰§è¡Œå®é™…å¼•ç”¨å¯¹è±¡æ‰€åœ¨ç±»çš„ play() æ–¹æ³•ï¼Œè€Œä¸æ˜¯ Instrument çš„æ–¹æ³•ã€‚</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Instrument</span> </span>&#123;    <span class="hljs-keyword">void</span> <span class="hljs-function"><span class="hljs-title">play</span>(<span class="hljs-params"></span>)</span> &#123;        System.out.println(<span class="hljs-string">&quot;Instument is playing...&quot;</span>);    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Wind</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Instrument</span> </span>&#123;    <span class="hljs-keyword">void</span> <span class="hljs-function"><span class="hljs-title">play</span>(<span class="hljs-params"></span>)</span> &#123;        System.out.println(<span class="hljs-string">&quot;Wind is playing...&quot;</span>);    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Percussion</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Instrument</span> </span>&#123;    <span class="hljs-keyword">void</span> <span class="hljs-function"><span class="hljs-title">play</span>(<span class="hljs-params"></span>)</span> &#123;        System.out.println(<span class="hljs-string">&quot;Percussion is playing...&quot;</span>);    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Music</span> </span>&#123;    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-function"><span class="hljs-title">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>)</span> &#123;        List&lt;Instrument&gt; instruments = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        instruments.add(<span class="hljs-keyword">new</span> Wind());        instruments.add(<span class="hljs-keyword">new</span> Percussion());        <span class="hljs-keyword">for</span>(Instrument instrument : instruments) &#123;            instrument.play();        &#125;    &#125;&#125;</code></pre></div><h2 id="å…­å¤§åŸºæœ¬åŸåˆ™ï¼š"><a href="#å…­å¤§åŸºæœ¬åŸåˆ™ï¼š" class="headerlink" title="å…­å¤§åŸºæœ¬åŸåˆ™ï¼š"></a>å…­å¤§åŸºæœ¬åŸåˆ™ï¼š</h2><ul><li><p><code>Single Responsibility Principleï¼šå•ä¸€èŒè´£åŸåˆ™</code></p><p>  ä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå‘ç”Ÿå˜åŒ–çš„åŸå› ï¼Œåªè´Ÿè´£ä¸€é¡¹èŒè´£</p></li><li><p><code>Open Closed Principleï¼šå¼€é—­åŸåˆ™</code></p><p>  å¯¹ä¿®æ”¹å°é—­ï¼Œå¯¹æ‹“å±•å¼€æ”¾</p></li><li><p><code>Liskov Substitution Principleï¼šé‡Œæ°æ›¿æ¢åŸåˆ™</code></p><p>  å­ç±»èƒ½å®Œå…¨æ›¿ä»£çˆ¶ç±»</p></li><li><p><code>Law of Demeterï¼šè¿ªç±³ç‰¹æ³•åˆ™</code></p><p>  åŠŸèƒ½æ¨¡å—ä¹‹é—´å°½é‡å‡å°‘ç›¸äº’ä½œç”¨ï¼Œä¿æŒç›¸äº’ç‹¬ç«‹</p></li><li><p><code>Interface Segregation Principleï¼šæ¥å£éš”ç¦»åŸåˆ™</code></p><p>  ç”¨å¤šä¸ªå€Ÿå£å°†åŠŸèƒ½è§£è€¦</p></li><li><p><code>Dependence Inversion Principleï¼šä¾èµ–å€’ç½®åŸåˆ™</code></p><p>  é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼Œå¯¹æŠ½è±¡æ¥å£è¿›è¡Œç¼–ç¨‹</p></li></ul><h2 id="åŸå‹"><a href="#åŸå‹" class="headerlink" title="åŸå‹"></a>åŸå‹</h2><p><code>JavaScript</code> æ˜¯ä¸€ç§åŸºäºåŸå‹çš„è¯­è¨€ (prototype-based language)</p><p>åŒºåˆ«äºå…¶ä»–é¢å‘å¯¹è±¡çš„è¯­è¨€å®ä¾‹ä¸­å¤åˆ¶çˆ¶ç±»çš„å…¨éƒ¨å±æ€§ï¼Œjs åˆ™ä½¿ç”¨åŸå‹å»è®¿é—®çˆ¶ç±»çš„å…¬å¼€å±æ€§ã€‚</p><h2 id="åŸå‹é“¾"><a href="#åŸå‹é“¾" class="headerlink" title="åŸå‹é“¾"></a>åŸå‹é“¾</h2><ul><li>JSä¸­ä¸‡ç‰©éƒ½ä¸ºå¯¹è±¡ï¼Œä½†åªæœ‰å‡½æ•°æ‹¥æœ‰åŸå‹ï¼›</li><li>æ„é€ å‡½æ•°ç”Ÿæˆçš„å®ä¾‹å¯¹è±¡éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘å…¶åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆ<code>O.__proto__/O.constructor.prototype</code>;</li><li>å¦‚æœè¿™ä¸ªåŸå‹åˆæ˜¯å¦ä¸€ä¸ªæ„é€ å‡½æ•°ç”Ÿæˆçš„å®ä¾‹ï¼Œåˆ™è¿™ä¸ªåŸå‹å¯¹è±¡ä¹Ÿå¯ä»¥è®¿é—®è‡ªå·±çš„åŸå‹å¯¹è±¡ï¼Œè¿™æ ·å±‚å±‚é€’è¿›é“¾å¼è®¿é—®çš„å…³ç³»å°±å«åš<code>åŸå‹é“¾</code>ï¼›</li><li>js ä¸­æŸ¥æ‰¾å±æ€§æ—¶ï¼Œå…ˆæŸ¥æ‰¾å®ä¾‹è‡ªèº«ï¼ŒåæŸ¥æ‰¾åŸå‹å¯¹è±¡ï¼Œå†æ²¿ç€åŸå‹é“¾ä¸æ–­ä¸Šæº¯ï¼Œç›´åˆ°åŸå‹é“¾çš„å°½å¤´nullï¼›</li></ul><h3 id="ç‰¹æ®Šçš„Objectå’ŒFunction"><a href="#ç‰¹æ®Šçš„Objectå’ŒFunction" class="headerlink" title="ç‰¹æ®Šçš„Objectå’ŒFunction"></a>ç‰¹æ®Šçš„<code>Object</code>å’Œ<code>Function</code></h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Function</span>.prototype = <span class="hljs-string">&quot;function&quot;</span><span class="hljs-built_in">Function</span>.prototype = <span class="hljs-built_in">Function</span>.__proto__<span class="hljs-comment">//f()&#123;[native code]&#125;</span><span class="hljs-comment">// æ‰€æœ‰å¼•ç”¨ç±»å‹éƒ½ç»§æ‰¿è‡ªObject</span><span class="hljs-built_in">Function</span>.prototype.__proto__ === <span class="hljs-built_in">Object</span>.prototype <span class="hljs-comment">// true</span></code></pre></div><h3 id="åªæœ‰å‡½æ•°æ‰æœ‰prototype"><a href="#åªæœ‰å‡½æ•°æ‰æœ‰prototype" class="headerlink" title="åªæœ‰å‡½æ•°æ‰æœ‰prototype"></a>åªæœ‰å‡½æ•°æ‰æœ‰<code>prototype</code></h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f1</span>(<span class="hljs-params"></span>) </span>&#123;&#125;f1.__proto__ === <span class="hljs-built_in">Function</span>.prototype; <span class="hljs-comment">// f1ç›´æ¥ç”±Functionæ„é€ è€Œæ¥</span><span class="hljs-keyword">const</span> obj1 = &#123;&#125;;obj1.prototype; <span class="hljs-comment">// undefined</span></code></pre></div><h3 id="åŸå½¢é“¾çš„ç»ˆç‚¹"><a href="#åŸå½¢é“¾çš„ç»ˆç‚¹" class="headerlink" title="åŸå½¢é“¾çš„ç»ˆç‚¹"></a>åŸå½¢é“¾çš„ç»ˆç‚¹</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Object</span>.prototype === <span class="hljs-string">&#x27;object&#x27;</span><span class="hljs-comment">// æ„å‘³ç€Objectçš„åŸå‹æ˜¯ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡</span><span class="hljs-comment">// è€Œå¯¹è±¡çš„æ„é€ å™¨ä¹Ÿæ˜¯Objectï¼Œåˆ™ä¼šå‡ºç°æ­»å¾ªç¯</span>ï¼ã€<span class="hljs-built_in">Object</span>.prototype.__proto__ === <span class="hljs-built_in">Object</span>.prototypeã€‘ï¼<span class="hljs-comment">// ä¸ºäº†è®©åŸå‹é“¾æœ‰ç»ˆç‚¹ã€‚Javascriptè§„å®šï¼Œ</span><span class="hljs-built_in">Object</span>.prototype.__proto__ === <span class="hljs-literal">null</span></code></pre></div><p><img src="../images/proto.png" alt="proto"></p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f1</span>(<span class="hljs-params"></span>)</span>&#123;&#125;f1.__proto__ = <span class="hljs-built_in">Function</span>.prototype = <span class="hljs-function"><span class="hljs-title">f</span>(<span class="hljs-params"></span>)</span>&#123; [native code] &#125;f1.__proto__.__proto__ = <span class="hljs-built_in">Object</span>.prototype = &#123;<span class="hljs-attr">constructor</span>: Æ’, <span class="hljs-attr">__defineGetter__</span>: Æ’, <span class="hljs-attr">__defineSetter__</span>: Æ’, <span class="hljs-attr">hasOwnProperty</span>: Æ’, <span class="hljs-attr">__lookupGetter__</span>: Æ’,Â â€¦&#125;f1.__proto__.__proto__.__proto__ = <span class="hljs-literal">null</span><span class="hljs-keyword">const</span> obj = &#123;&#125;obj.__proto__ = <span class="hljs-built_in">Object</span>.prototypeobj.__proto__.__proto__ = <span class="hljs-literal">null</span></code></pre></div><h3 id="ç›¸å…³æ–¹æ³•"><a href="#ç›¸å…³æ–¹æ³•" class="headerlink" title="ç›¸å…³æ–¹æ³•"></a>ç›¸å…³æ–¹æ³•</h3><ul><li><p><code>Object.getPrototype()</code>/<code>__proto__</code></p><p>  è¿”å›æŒ‡å®šå¯¹è±¡çš„åŸå‹ï¼ˆéšå¼åŸå‹ï¼‰</p><p>  <code>__proto__</code>è™½ç„¶åœ¨ç»å¤§æ•°æµè§ˆå™¨éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œä½†å®˜æ–¹ä¸æ¨èä¸”å·²æ ‡ä¸ºåºŸå¼ƒï¼Œä½¿ç”¨<code>Object.getPrototypeOf()</code>æ›¿ä»£</p></li><li><p><code>Object.prototype.isPrototypeOf()</code></p><p>  åˆ¤æ–­å¯¹è±¡æ˜¯å¦åœ¨å¦ä¸€ä¸ªå¯¹è±¡åŸå‹é“¾ä¸Š</p></li></ul><h2 id="thisçš„æŒ‡å‘"><a href="#thisçš„æŒ‡å‘" class="headerlink" title="thisçš„æŒ‡å‘"></a>thisçš„æŒ‡å‘</h2><ol><li>å‡½æ•°çš„ <code>this</code> æŒ‡å‘å‡½æ•°è¿è¡Œæ—¶çš„æ‰§è¡Œä¸Šä¸‹æ–‡</li><li>å½“å‡½æ•°æ‰§è¡Œæ—¶å€™æ²¡æœ‰åˆ¶å®š<code>this</code>ï¼Œåˆ™<code>this</code>æŒ‡å‘<code>Global</code>å¯¹è±¡</li><li>å½“å‡½æ•°è¢«å½“ä½œå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨æ—¶,<code>this</code> æŒ‡å‘è°ƒç”¨å¯¹è±¡</li><li><code>new</code>æ“ä½œç¬¦ç”Ÿæˆçš„å¯¹è±¡ <code>this</code> æŒ‡å‘è‡ªå·±</li><li>ç®­å¤´å‡½æ•°çš„<code>this</code>å–å†³äºä¹¦å†™æ—¶å¤–éƒ¨å‡½æ•°ä½“çš„<code>this</code></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒå‰æ ‘</title>
    <link href="/2022/02/24/%E4%BA%8C%E5%8F%89%E6%A0%91/"/>
    <url>/2022/02/24/%E4%BA%8C%E5%8F%89%E6%A0%91/</url>
    
    <content type="html"><![CDATA[<h2 id="æ ‘å‹ç»“æ„"><a href="#æ ‘å‹ç»“æ„" class="headerlink" title="æ ‘å‹ç»“æ„"></a>æ ‘å‹ç»“æ„</h2><ul><li><p>  èŠ‚ç‚¹ä¸èƒ½é—­ç¯</p></li><li><p>  åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹</p></li><li><p>  é™¤äº†æ ¹èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸”åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹</p></li><li><p>  æ·±åº¦ï¼šèŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ç»è¿‡èŠ‚ç‚¹ä¸ªæ•°</p></li><li><p>  é«˜åº¦ï¼šèŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹æœ€é•¿è·¯å¾„ç»è¿‡èŠ‚ç‚¹ä¸ªæ•°</p></li><li><p>  æ ‘çš„é«˜åº¦ï¼šæ ¹èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ç»è¿‡èŠ‚ç‚¹ä¸ªæ•°</p></li></ul><h2 id="äºŒå‰æ ‘"><a href="#äºŒå‰æ ‘" class="headerlink" title="äºŒå‰æ ‘"></a>äºŒå‰æ ‘</h2><p>æœ€å¤šåªæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹çš„æ ‘ç»“æ„</p><p>äºŒå‰æ ‘æ˜¯ n ä¸ªæœ‰é™å…ƒç´ çš„é›†åˆï¼Œè¯¥é›†åˆæˆ–è€…ä¸ºç©ºã€æˆ–è€…ç”±ä¸€ä¸ªç§°ä¸ºæ ¹ï¼ˆrootï¼‰çš„å…ƒç´ åŠä¸¤ä¸ªä¸ç›¸äº¤çš„ã€è¢«åˆ†åˆ«ç§°ä¸ºå·¦å­æ ‘å’Œå³å­æ ‘çš„äºŒå‰æ ‘ç»„æˆ</p><h4 id="å¹³è¡¡äºŒå‰æ ‘"><a href="#å¹³è¡¡äºŒå‰æ ‘" class="headerlink" title="å¹³è¡¡äºŒå‰æ ‘"></a>å¹³è¡¡äºŒå‰æ ‘</h4><p>ä»»æ„èŠ‚ç‚¹çš„å·¦å³å­æ ‘é«˜åº¦å·®ä¸å¤§äº 1</p><h4 id="æ»¡äºŒå‰æ ‘ï¼šæ¯ä¸€å±‚èŠ‚ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼"><a href="#æ»¡äºŒå‰æ ‘ï¼šæ¯ä¸€å±‚èŠ‚ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼" class="headerlink" title="æ»¡äºŒå‰æ ‘ï¼šæ¯ä¸€å±‚èŠ‚ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼"></a>æ»¡äºŒå‰æ ‘ï¼šæ¯ä¸€å±‚èŠ‚ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼</h4><ul><li>  ä¸€ä¸ªå±‚æ•°ä¸º k çš„æ»¡äºŒå‰æ ‘æ€»ç»“ç‚¹æ•°ä¸ºï¼š2^k-1</li><li>  ç¬¬ i å±‚ä¸Šçš„ç»“ç‚¹æ•°ä¸ºï¼š2^(i-1)</li><li>  ä¸€ä¸ªå±‚æ•°ä¸º k çš„æ»¡äºŒå‰æ ‘çš„å¶å­ç»“ç‚¹ä¸ªæ•°ï¼ˆä¹Ÿå°±æ˜¯æœ€åä¸€å±‚ï¼‰ï¼š2^(k-1)</li></ul><h4 id="å®Œå…¨äºŒå‰æ ‘"><a href="#å®Œå…¨äºŒå‰æ ‘" class="headerlink" title="å®Œå…¨äºŒå‰æ ‘"></a>å®Œå…¨äºŒå‰æ ‘</h4><p>ä¸€æ£µæ·±åº¦ä¸ºkçš„æœ‰nä¸ªç»“ç‚¹çš„äºŒå‰æ ‘ï¼Œå¯¹æ ‘ä¸­çš„ç»“ç‚¹æŒ‰ä»ä¸Šè‡³ä¸‹ã€ä»å·¦åˆ°å³çš„é¡ºåºè¿›è¡Œç¼–å·ï¼Œå¦‚æœç¼–å·ä¸ºiï¼ˆ1â‰¤iâ‰¤nï¼‰çš„ç»“ç‚¹ä¸æ»¡äºŒå‰æ ‘ä¸­ç¼–å·ä¸ºiçš„ç»“ç‚¹åœ¨äºŒå‰æ ‘ä¸­çš„ä½ç½®ç›¸åŒï¼Œåˆ™è¿™æ£µäºŒå‰æ ‘ç§°ä¸ºå®Œå…¨äºŒå‰æ ‘ã€‚</p><h4 id="äºŒå‰æœç´¢æ ‘ã€BSTã€‘ï¼šå³å­å¤§äºçˆ¶å¤§äºå·¦å­"><a href="#äºŒå‰æœç´¢æ ‘ã€BSTã€‘ï¼šå³å­å¤§äºçˆ¶å¤§äºå·¦å­" class="headerlink" title="äºŒå‰æœç´¢æ ‘ã€BSTã€‘ï¼šå³å­å¤§äºçˆ¶å¤§äºå·¦å­"></a>äºŒå‰æœç´¢æ ‘ã€BSTã€‘ï¼šå³å­å¤§äºçˆ¶å¤§äºå·¦å­</h4><blockquote><p>äºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†å¾—åˆ°å‡åºæ’åˆ—</p></blockquote><h2 id="äºŒå‰æ ‘éå†"><a href="#äºŒå‰æ ‘éå†" class="headerlink" title="äºŒå‰æ ‘éå†"></a>äºŒå‰æ ‘éå†</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BinaryTree</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">const</span> Node = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>&#123;<span class="hljs-built_in">this</span>.val = val;<span class="hljs-built_in">this</span>.left = <span class="hljs-literal">null</span>;<span class="hljs-built_in">this</span>.right = <span class="hljs-literal">null</span>;&#125;;<span class="hljs-keyword">let</span> root = <span class="hljs-literal">null</span>;&#125;</code></pre></div><ul><li>å‰åºéå†<blockquote><p>root -&gt; left -&gt; right</p></blockquote></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">preOrderTraverse</span>(<span class="hljs-params">node</span>) </span>&#123;<span class="hljs-keyword">let</span> res = [];<span class="hljs-keyword">let</span> stack = [];<span class="hljs-keyword">if</span>(node) stack.push(node)<span class="hljs-keyword">while</span> (stack.length &gt; <span class="hljs-number">0</span>) &#123;<span class="hljs-keyword">let</span> curNode = stack.pop();res.push(curNode.val);curNode.right &amp;&amp; stack.push(curNode.right); <span class="hljs-comment">//  å…ˆå³å†å·¦å…¥æ ˆ</span>curNode.left &amp;&amp; stack.push(curNode.left); <span class="hljs-comment">//  åˆ™å·¦è¾¹å…ˆå‡ºæ ˆ</span>&#125;<span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">preOrderTraverse</span>(<span class="hljs-params">root</span>)</span>&#123;<span class="hljs-keyword">const</span> res = []<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">node</span>)</span>&#123;<span class="hljs-keyword">if</span>(!node) <span class="hljs-keyword">return</span> res.push(node.val)node.left &amp;&amp; traverse(node.left)node.right &amp;&amp; traverse(node.right)&#125;traverse(root)<span class="hljs-keyword">return</span> res&#125;</code></pre></div><ul><li>ä¸­åºéå†<blockquote><p>left -&gt; root -&gt; right</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inOrderTraverse</span>(<span class="hljs-params">root</span>)</span>&#123;<span class="hljs-keyword">const</span> res = []<span class="hljs-keyword">const</span> stack = []<span class="hljs-keyword">let</span> node = root<span class="hljs-keyword">while</span>(node || stack.length)&#123;<span class="hljs-keyword">while</span>(node)&#123;stack.push(node)node = node.left&#125;node = stack.pop()res.push(node.val)node = node.right&#125;<span class="hljs-keyword">return</span> res&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inOrderTraverse</span>(<span class="hljs-params">root</span>)</span>&#123;<span class="hljs-keyword">const</span> res = []<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">node</span>)</span>&#123;<span class="hljs-keyword">if</span>(!node) <span class="hljs-keyword">return</span> node.left &amp;&amp; traverse(node.left)res.push(node.val)node.right &amp;&amp; traverse(node.right)&#125;traverse(root)<span class="hljs-keyword">return</span> res&#125;</code></pre></div></li><li>ååºéå†<blockquote><p>left -&gt; right -&gt; root</p></blockquote></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">postOrderTraverse</span>(<span class="hljs-params">root</span>)</span>&#123;<span class="hljs-keyword">const</span> res = []<span class="hljs-keyword">const</span> stack = []<span class="hljs-keyword">if</span>(root) stack.push(root)<span class="hljs-keyword">while</span>(stack.length)&#123;<span class="hljs-keyword">const</span> node = stack.pop()res.unshift(node.val)node.left &amp;&amp; stack.push(node.left)node.right &amp;&amp; stack.push(node.right)&#125;<span class="hljs-keyword">return</span> res&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">postOrderTraverse</span>(<span class="hljs-params">root</span>)</span>&#123;<span class="hljs-keyword">const</span> res = []<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">node</span>)</span>&#123;<span class="hljs-keyword">if</span>(!node) <span class="hljs-keyword">return</span> node.left &amp;&amp; traverse(node.left)node.right &amp;&amp; traverse(node.right)res.push(node.val)&#125;&#125;</code></pre></div><h2 id="äºŒå‰æ ‘ç®—æ³•é¢˜"><a href="#äºŒå‰æ ‘ç®—æ³•é¢˜" class="headerlink" title="äºŒå‰æ ‘ç®—æ³•é¢˜"></a>äºŒå‰æ ‘ç®—æ³•é¢˜</h2><ul><li>  è®¡ç®—è·¯å¾„</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// è¾“å…¥ä¸€æ£µäºŒå‰æ ‘å’Œä¸€ä¸ªæ•´æ•°ï¼Œæ‰“å°å‡ºäºŒå‰æ ‘ä¸­èŠ‚ç‚¹å€¼çš„å’Œä¸ºè¾“å…¥æ•´æ•°çš„æ‰€æœ‰è·¯å¾„ã€‚ä»æ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹å¾€ä¸‹ä¸€ç›´åˆ°å¶èŠ‚ç‚¹æ‰€ç»è¿‡çš„èŠ‚ç‚¹å½¢æˆä¸€æ¡è·¯å¾„ã€‚</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pathSum</span>(<span class="hljs-params">root, sum</span>) </span>&#123;<span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> [];<span class="hljs-keyword">if</span> (root.value === sum) <span class="hljs-keyword">return</span> [root.value];<span class="hljs-keyword">const</span> paths = [];<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">searchPath</span>(<span class="hljs-params">node, target, prePath</span>) </span>&#123;<span class="hljs-keyword">const</span> target = sum - node.val;<span class="hljs-keyword">const</span> curPath = [...prePath, node.val];<span class="hljs-keyword">if</span> (!node.left &amp;&amp; !node.right &amp;&amp; target === <span class="hljs-number">0</span>) &#123;<span class="hljs-comment">// ä¸€ç›´è¦åˆ°å¶å­ç»“ç‚¹</span>paths.push(curPath);<span class="hljs-keyword">return</span>;&#125;node.left &amp;&amp; searchPath(node.left, target, curPath);node.right &amp;&amp; searchPath(node.right, target, curPath);&#125;searchPath(root, sum, []);<span class="hljs-keyword">return</span> paths;&#125;</code></pre></div><ul><li>  äºŒå‰æ ‘é•œåƒ / ç¿»è½¬äºŒå‰æ ‘</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// é€’å½’</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mirrorTree</span>(<span class="hljs-params">root</span>)</span>&#123;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mirror</span>(<span class="hljs-params">node</span>)</span>&#123;    <span class="hljs-keyword">if</span>(!node) <span class="hljs-keyword">return</span>    [node.left,node.right] = [node.right,node.left]    mirror(node.left)    mirror(node.right)  &#125;  mirror(root)  <span class="hljs-keyword">return</span> root&#125;<span class="hljs-comment">// stack</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mirrorTree</span>(<span class="hljs-params">root</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!root) <span class="hljs-keyword">return</span> root  <span class="hljs-keyword">const</span> swap = <span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> [node.left,node.right] = [node.right,node.left]  <span class="hljs-keyword">const</span> stack = [root]  <span class="hljs-keyword">while</span>(stack.length&gt;<span class="hljs-number">0</span>)&#123;    <span class="hljs-keyword">const</span> node = stack.pop()    swap(node)    node.left &amp;&amp; stack.push(node.left)    node.right &amp;&amp; stack.push(node.right)  &#125;  <span class="hljs-keyword">return</span> root&#125;</code></pre></div><ul><li>  è®¡ç®—äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TreeNode</span>(<span class="hljs-params">val</span>) </span>&#123;<span class="hljs-built_in">this</span>.val = val;<span class="hljs-built_in">this</span>.left = <span class="hljs-built_in">this</span>.right = <span class="hljs-literal">null</span>;&#125;<span class="hljs-comment">// ååºéå†</span><span class="hljs-comment">// DFS</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maxDepth</span>(<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-keyword">return</span> root ? <span class="hljs-built_in">Math</span>.max(maxDepth(root.left), maxDepth(root.right)) + <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;<span class="hljs-comment">// é€’å½’æ·±åº¦åŠ 1</span><span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-keyword">const</span> left = maxDepth(root.left);<span class="hljs-keyword">const</span> right = maxDepth(root.right);<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(left, right) + <span class="hljs-number">1</span>;&#125;<span class="hljs-comment">// BFS</span><span class="hljs-comment">//é€’å½’å®ç°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maxDepth</span>(<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-keyword">let</span> max = <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> max;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BFS</span>(<span class="hljs-params">node, dep</span>) </span>&#123;<span class="hljs-keyword">if</span> (!node) <span class="hljs-keyword">return</span>;max = <span class="hljs-built_in">Math</span>.max(max, ++dep);BFS(node.left, dep);BFS(node.right, dep);&#125;BFS(root, <span class="hljs-number">0</span>);<span class="hljs-keyword">return</span> max;&#125;<span class="hljs-comment">// æ ˆå®ç°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maxDepth</span>(<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-keyword">const</span> stack = [[root, <span class="hljs-number">0</span>]];<span class="hljs-keyword">let</span> max = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> (stack.length &gt; <span class="hljs-number">0</span>) &#123;<span class="hljs-keyword">const</span> [node, dep] = stack.pop();max = <span class="hljs-built_in">Math</span>.max(max, dep + <span class="hljs-number">1</span>);node.left &amp;&amp; stack.push(node.left, dep + <span class="hljs-number">1</span>);node.right &amp;&amp; stack.push(node.right, dep + <span class="hljs-number">1</span>);&#125;<span class="hljs-keyword">return</span> max;&#125;</code></pre></div><ul><li>äºŒå‰æœç´ æ ‘ä¸­ç¬¬ k å¤§çš„å€¼<blockquote><p>äºŒå‰æœç´¢æ ‘ + é€†å‘ä¸­åºéå† =&gt; é™åºæ’åˆ— val</p></blockquote></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">kthLargest</span>(<span class="hljs-params">root, k</span>) </span>&#123;<span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span>;<span class="hljs-keyword">let</span> res = root.val;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DFS</span>(<span class="hljs-params">node</span>) </span>&#123;<span class="hljs-keyword">if</span> (!node) <span class="hljs-keyword">return</span>;DFS(node.right);<span class="hljs-keyword">if</span> (--k === <span class="hljs-number">0</span>) &#123;res = node.val;<span class="hljs-keyword">return</span>;&#125;DFS(node.right);&#125;DFS(root);<span class="hljs-keyword">return</span> res;&#125;</code></pre></div><ul><li>äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ<br>  å¯¹äºæœ‰æ ¹æ ‘ T çš„ä¸¤ä¸ªç»“ç‚¹ pã€qï¼Œæœ€è¿‘å…¬å…±ç¥–å…ˆè¡¨ç¤ºä¸ºä¸€ä¸ªç»“ç‚¹ xï¼Œæ»¡è¶³ x æ˜¯ pã€q çš„ç¥–å…ˆä¸” x çš„æ·±åº¦å°½å¯èƒ½å¤§ï¼ˆä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆï¼‰</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lowestCommonAncestor</span>(<span class="hljs-params">root, p, q</span>) </span>&#123;<span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<span class="hljs-keyword">if</span> (root === p || root === q) <span class="hljs-keyword">return</span> root;<span class="hljs-keyword">const</span> l = lowerCommonAncestor(root.left, p, q);<span class="hljs-keyword">const</span> r = lowerCommonAncestor(root.right, p, q);l &amp;&amp; r ? root : l || r;&#125;</code></pre></div><ul><li>äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ<br>  äºŒå‰æœç´¢æ ‘ä¸­ rightTree &gt; root &gt; leftTree</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// é€’å½’</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lowestCommonAncestor</span>(<span class="hljs-params">root, p, q</span>) </span>&#123;<span class="hljs-keyword">if</span> (root.val &lt; p.val &amp;&amp; root.val &lt; q.val) &#123;<span class="hljs-keyword">return</span> lowestCommonAncestor(root.right, p, q);&#125;<span class="hljs-keyword">if</span> (root.val &gt; p.val &amp;&amp; root.val &gt; q.val) &#123;<span class="hljs-keyword">return</span> lowestCommonAncestor(root.left, p, q);&#125;<span class="hljs-keyword">return</span> root;&#125;</code></pre></div><ul><li>  äºŒå‰æœç´¢æ ‘èŠ‚ç‚¹é—´æœ€å°å·®</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ä¸­åºæ’åˆ—åï¼Œæœ€å°å·®å°±æ˜¯è¯¥æ•°ç»„ä¸­ç›¸é‚»å…ƒç´ æœ€å°å·®</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">minDiffInBST</span>(<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-keyword">let</span> pre = <span class="hljs-literal">null</span>;<span class="hljs-keyword">let</span> min = <span class="hljs-built_in">Number</span>.MAX_SAFE_INTEGER;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DFS</span>(<span class="hljs-params">node</span>) </span>&#123;<span class="hljs-keyword">if</span> (!node) <span class="hljs-keyword">return</span>;DFS(node.left);<span class="hljs-keyword">if</span> (pre === <span class="hljs-literal">null</span>) &#123;<span class="hljs-comment">// inité˜¶æ®µ</span>pre = node.val;&#125; <span class="hljs-keyword">else</span> &#123;min = <span class="hljs-built_in">Math</span>.min(min, node.val - pre);pre = node.val;&#125;<span class="hljs-comment">// ä¸­åºåˆ—éå†ï¼Œpreå­˜å‚¨ä¸Šä¸€ä¸ªå€¼ï¼Œç”±äºBSTç‰¹æ€§ï¼Œcur.valæ°¸è¿œå¤§äºpre</span>DFS(node.right);&#125;&#125;<span class="hljs-comment">// ä½¿ç”¨è¾…åŠ©æ ˆ</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">minDiffInBST</span>(<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-keyword">let</span> pre = <span class="hljs-literal">null</span>;<span class="hljs-keyword">let</span> min = <span class="hljs-built_in">Number</span>.MAX_SAFE_INTEGER;<span class="hljs-keyword">const</span> stack = [];<span class="hljs-keyword">while</span> (root || stack.length &gt; <span class="hljs-number">0</span>) &#123;<span class="hljs-keyword">while</span> (root) &#123;stack.push(root);root = root.left;&#125;<span class="hljs-keyword">const</span> node = stack.pop();<span class="hljs-keyword">if</span> (pre === <span class="hljs-literal">null</span>) &#123;pre = node.val;&#125; <span class="hljs-keyword">else</span> &#123;min = <span class="hljs-built_in">Math</span>.min(min, node.val - pre);pre = node.val;&#125;root = node.right;&#125;<span class="hljs-keyword">return</span> min;&#125;</code></pre></div><ul><li>å±‚åºéå†ï¼Œæ‰“å°äºŒå‰æ ‘<br>  [[ç¬¬ä¸€å±‚],[ç¬¬äºŒå±‚],[ç¬¬ä¸‰å±‚]]</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span>  <span class="hljs-title">levelOrder</span> (<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-keyword">const</span> stack = [[root, <span class="hljs-number">0</span>]];<span class="hljs-keyword">const</span> res = [];<span class="hljs-keyword">while</span> (stack.length &gt; <span class="hljs-number">0</span>) &#123;<span class="hljs-keyword">const</span> [node, level] = stack.shift();<span class="hljs-keyword">if</span> (!node) <span class="hljs-keyword">break</span>;<span class="hljs-keyword">if</span> (!res[level]) res[level] = [];res[level].push(node.val);node.left &amp;&amp; stack.push([node.left, level + <span class="hljs-number">1</span>]);node.right &amp;&amp; stack.push(node.right, level + <span class="hljs-number">1</span>);&#125;<span class="hljs-keyword">return</span> res;&#125;<span class="hljs-keyword">const</span> levelOrder = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-keyword">const</span> stack = [root];<span class="hljs-keyword">const</span> res = [];<span class="hljs-keyword">if</span> (root) &#123;<span class="hljs-keyword">while</span> (stack.length &gt; <span class="hljs-number">0</span>) &#123;<span class="hljs-keyword">const</span> preLevelSize = stack.length;<span class="hljs-keyword">const</span> curLevel = [];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; preLevelSize; i++) &#123;<span class="hljs-keyword">const</span> n = stack.shift();<span class="hljs-keyword">if</span> (!n) <span class="hljs-keyword">break</span>;curLevel.push(n.val);n.left &amp;&amp; stack.push(n.left);n.right &amp;&amp; stack.push(n.right);&#125;res.push(curLevel);&#125;&#125;<span class="hljs-keyword">return</span> res;&#125;;</code></pre></div><ul><li>åˆ¤æ–­å¹³è¡¡äºŒå‰æ ‘<br>  å¹³è¡¡äºŒå‰æ ‘ï¼Œå·¦å³å­æ ‘æ·±åº¦å·®ä¸å¤§äº 1</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBalanced</span>(<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-keyword">let</span> res = <span class="hljs-literal">true</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dfs</span>(<span class="hljs-params">node</span>) </span>&#123;<span class="hljs-keyword">if</span> (!node) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> left = dfs(node.left);<span class="hljs-keyword">let</span> right = dfs(node.right);<span class="hljs-keyword">if</span> (<span class="hljs-built_in">Math</span>.abs(left - right) &gt; <span class="hljs-number">1</span>) res = <span class="hljs-literal">false</span>;<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(left, right) + <span class="hljs-number">1</span>;&#125;dfs(root);<span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBalanced</span>(<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dfs</span>(<span class="hljs-params">node</span>) </span>&#123;<span class="hljs-keyword">if</span> (!node) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-keyword">const</span> left = dfs(node.left);<span class="hljs-keyword">const</span> right = dfs(node.right);<span class="hljs-keyword">if</span> (<span class="hljs-built_in">Math</span>.abs(left - right) &gt; <span class="hljs-number">1</span> || left === -<span class="hljs-number">1</span> || right === -<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(left, right) + <span class="hljs-number">1</span>;&#125;<span class="hljs-keyword">return</span> dfs(root) !== -<span class="hljs-number">1</span>;&#125;</code></pre></div><ul><li>  åˆ¤æ–­å¯¹ç§°äºŒå‰æ ‘</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å¯¹ç§°çš„äºŒå‰æ ‘</span><span class="hljs-comment">// l = r</span><span class="hljs-comment">// l.right = r.left &amp;&amp; l.left = r.right</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isMirrorTree</span>(<span class="hljs-params">root</span>) </span>&#123;<span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">recur</span>(<span class="hljs-params">l, r</span>) </span>&#123;<span class="hljs-keyword">if</span> (l == <span class="hljs-literal">null</span> &amp;&amp; r == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<span class="hljs-keyword">if</span> (l == <span class="hljs-literal">null</span> || r == <span class="hljs-literal">null</span> || l !== r) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-keyword">return</span> recur(l.left, r.right) &amp;&amp; recur(l.right, l, left);&#125;<span class="hljs-keyword">return</span> recur(root.left, root.right);&#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vueç»„ä»¶ä¹‹é—´é€šä¿¡æ–¹å¼</title>
    <link href="/2022/02/24/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/"/>
    <url>/2022/02/24/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/</url>
    
    <content type="html"><![CDATA[<h3 id="refå’Œ-refs"><a href="#refå’Œ-refs" class="headerlink" title="refå’Œ$refs"></a><code>refå’Œ$refs</code></h3><ul><li><p>  <code>ref</code>æŒ‚è½½åœ¨æ™®é€š HTML ç»„ä»¶ä¸Šè®¿é—®å®ƒå¾—åˆ° DOM</p></li><li><p>  <code>ref</code>æŒ‚è½½åœ¨ VUE ç»„ä»¶ä¸Šè®¿é—®å®ƒå¾—åˆ°ç»„ä»¶å®ä¾‹</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">base-input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;usernameInput&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">base-input</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">base-input</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">base-input</span>&gt;</span></code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">this</span>.$refs.usernameInput<span class="hljs-comment">// composition API</span><span class="hljs-keyword">const</span> usernameInput = ref(<span class="hljs-literal">null</span>)<span class="hljs-function"><span class="hljs-title">onMounted</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-comment">// ref</span>    usernameInput.value&#125;<span class="hljs-comment">// setupä¸­æ²¡æœ‰this</span>defineExpose(&#123;    a,    b&#125;)<span class="hljs-comment">// å®šä¹‰æš´éœ²åˆ°ç»„ä»¶å®ä¾‹ä¸Šçš„å±æ€§</span></code></pre></div><h3 id="emitå’Œprop"><a href="#emitå’Œprop" class="headerlink" title="$emitå’Œprop"></a><code>$emit</code>å’Œ<code>prop</code></h3><ul><li>  å­ç»„ä»¶<code>props</code>æ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’çš„æ•°æ®</li><li>  åŠ¨æ€æ•°æ®åŠ å†’å·<code>:</code></li><li>  å­ç»„ä»¶å¯å¯¹æ”¶åˆ°çš„<code>props</code>è®¾ç½®æ ¡éªŒ</li><li>å­ç»„ä»¶å®šä¹‰<code>$emit</code>è‡ªå®šä¹‰æ–¹æ³•<br>  <code>this.$emit(&#39;childToParentMsg&#39;,this.childInfo,this.type)</code></li><li>  çˆ¶ç»„ä»¶å°±å¯ä»¥<code>v-on</code>ç›‘å¬è¯¥æ–¹æ³•</li><li>  è¯¥æ–¹æ³•ç»‘å®šçˆ¶ç»„ä»¶çš„<code>methods</code></li><li>  è·å¾—æ–¹æ³•ä¸­ä¼ é€’çš„å‚æ•°</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript">defineEmits([<span class="hljs-string">&quot;emit1&quot;</span>, <span class="hljs-string">&quot;emit2&quot;</span>]);defineProps(&#123;foo: <span class="hljs-string">&quot;bar&quot;</span>,&#125;);</code></pre></div><h3 id="parentå’Œ-children"><a href="#parentå’Œ-children" class="headerlink" title="$parentå’Œ$children"></a><code>$parent</code>å’Œ<code>$children</code></h3><ul><li>  $parent å¾—åˆ° <strong>å¯¹è±¡</strong></li><li>  $children å¾—åˆ°å­ç»„ä»¶å®ä¾‹å¯¹è±¡ <strong>æ•°ç»„</strong></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Composition API</span>getCurrentInstance();</code></pre></div><h3 id="provideå’Œinject"><a href="#provideå’Œinject" class="headerlink" title="provideå’Œinject"></a><code>provide</code>å’Œ<code>inject</code></h3><ul><li><p>  çˆ¶ç»„ä»¶å‘<code>ä»»æ„æ·±åº¦</code>å­ç»„ä»¶ä¼ å€¼</p></li><li><p>  çˆ¶ç»„ä»¶ä¸­é€šè¿‡<code>provide</code>æ¥æä¾›å˜é‡</p></li><li><p>  å­ç»„ä»¶ä¸­é€šè¿‡<code>inject</code>æ¥æ³¨å…¥å˜é‡</p></li><li><p>ä¸è®ºå­ç»„ä»¶æœ‰å¤šæ·±ï¼Œåªè¦è°ƒç”¨äº†<code>inject</code>é‚£ä¹ˆå°±å¯ä»¥æ³¨å…¥<code>provider</code>ä¸­çš„æ•°æ®ã€‚åªè¦åœ¨çˆ¶ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå­ç»„ä»¶éƒ½å¯ä»¥è°ƒç”¨ã€‚</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">Vue.component(<span class="hljs-string">&quot;parent&quot;</span>, &#123;provide: &#123;<span class="hljs-comment">// æä¾›äº†forå˜é‡</span><span class="hljs-keyword">for</span>: <span class="hljs-string">&quot;test&quot;</span>,&#125;,&#125;);Vue.component(<span class="hljs-string">&quot;child&quot;</span>, &#123;<span class="hljs-comment">//</span>inject: [<span class="hljs-string">&quot;foo&quot;</span>],<span class="hljs-comment">// å°†forå˜é‡æ’å…¥æœ¬å®ä¾‹</span><span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-keyword">return</span> &#123;mymessage: <span class="hljs-built_in">this</span>.foo,&#125;;&#125;,&#125;);<span class="hljs-comment">// Composition API</span><span class="hljs-keyword">import</span> &#123;inject,provide&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>inject(_name)provide(_name,_reactive_value)</code></pre></div></li></ul><h3 id="attrs-amp-amp-listeners"><a href="#attrs-amp-amp-listeners" class="headerlink" title="$attrs &amp;&amp; $listeners"></a><code>$attrs</code> &amp;&amp; <code>$listeners</code></h3><ul><li><p>  <code>$attrs</code>åŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­ä¸ä½œä¸º prop è¢«è¯†åˆ« (ä¸”è·å–) çš„ attribute ç»‘å®š (class å’Œ style é™¤å¤–),é€šè¿‡<code>v-bind=&quot;$attrs&quot;</code> ä¼ å…¥å†…éƒ¨ç»„ä»¶</p></li><li><p><code>$listeners</code>åŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­çš„ (ä¸å« .native ä¿®é¥°å™¨çš„) v-on äº‹ä»¶ç›‘å¬å™¨ã€‚å®ƒå¯ä»¥é€šè¿‡ v-on=â€$listenersâ€ ä¼ å…¥å†…éƒ¨ç»„ä»¶</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// A-&gt;B-&gt;C</span><span class="hljs-comment">// äºŒçº§å­ç»„ä»¶C</span>Vue.component(<span class="hljs-string">&quot;C&quot;</span>, &#123;template: <span class="hljs-string">`</span><span class="hljs-string">              &lt;div&gt;</span><span class="hljs-string">                  &lt;input type=&quot;text&quot; v-model=&quot;$attrs.messagec&quot; @input=&quot;passCData($attrs.messagec)&quot;&gt; &lt;/div&gt;</span><span class="hljs-string">          `</span>,methods: &#123;<span class="hljs-function"><span class="hljs-title">passCData</span>(<span class="hljs-params">val</span>)</span> &#123;<span class="hljs-comment">//è§¦å‘çˆ¶ç»„ä»¶Aä¸­çš„äº‹ä»¶</span><span class="hljs-built_in">this</span>.$emit(<span class="hljs-string">&quot;getCData&quot;</span>, val);&#125;,&#125;,&#125;);<span class="hljs-comment">// ä¸€çº§å­ç»„ä»¶B</span>Vue.component(<span class="hljs-string">&quot;B&quot;</span>, &#123;<span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-keyword">return</span> &#123;mymessage: <span class="hljs-built_in">this</span>.message,&#125;;&#125;,template: <span class="hljs-string">`</span><span class="hljs-string">          &lt;div&gt;</span><span class="hljs-string">              &lt;input type=&quot;text&quot; v-model=&quot;mymessage&quot; @input=&quot;passData(mymessage)&quot;&gt; </span><span class="hljs-string">              &lt;C v-bind=&quot;$attrs&quot; v-on=&quot;$listeners&quot;&gt;&lt;/C&gt;</span><span class="hljs-string">          &lt;/div&gt;</span><span class="hljs-string">      `</span>,props: [<span class="hljs-string">&quot;message&quot;</span>], <span class="hljs-comment">//propsä¸­å–èµ°äº†Aä¼ ä¸‹æ¥çš„ä¸€ä¸ªattr</span><span class="hljs-comment">// å¦å¤–ä¸€ä¸ªä½¿ç”¨:bind=&quot;$attrs&quot;ç»§ç»­å‘ä¸‹ä¼ é€’ç»™C</span>methods: &#123;<span class="hljs-function"><span class="hljs-title">passData</span>(<span class="hljs-params">val</span>)</span> &#123;<span class="hljs-comment">//è§¦å‘çˆ¶ç»„ä»¶ä¸­çš„äº‹ä»¶</span><span class="hljs-built_in">this</span>.$emit(<span class="hljs-string">&quot;getChildData&quot;</span>, val);&#125;,&#125;,&#125;);<span class="hljs-comment">// çˆ¶ç»„ä»¶A</span>Vue.component(<span class="hljs-string">&quot;A&quot;</span>, &#123;template: <span class="hljs-string">`</span><span class="hljs-string">          &lt;div&gt;</span><span class="hljs-string">              &lt;p&gt;this is parent compoent!&lt;/p&gt;</span><span class="hljs-string">              &lt;B :messagec=&quot;messagec&quot; :message=&quot;message&quot; v-on:getCData=&quot;getCData&quot; v-on:getChildData=&quot;getChildData(message)&quot;&gt;&lt;/B&gt;</span><span class="hljs-string">          &lt;/div&gt;</span><span class="hljs-string">      `</span>,<span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-keyword">return</span> &#123;message: <span class="hljs-string">&quot;hello&quot;</span>,messagec: <span class="hljs-string">&quot;hello c&quot;</span>, <span class="hljs-comment">//ä¼ é€’ç»™cç»„ä»¶çš„æ•°æ®</span>&#125;;&#125;,methods: &#123;<span class="hljs-function"><span class="hljs-title">getChildData</span>(<span class="hljs-params">val</span>)</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;è¿™æ˜¯æ¥è‡ªBç»„ä»¶çš„æ•°æ®&quot;</span>);&#125;,<span class="hljs-comment">//æ‰§è¡ŒCå­ç»„ä»¶è§¦å‘çš„äº‹ä»¶</span><span class="hljs-function"><span class="hljs-title">getCData</span>(<span class="hljs-params">val</span>)</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;è¿™æ˜¯æ¥è‡ªCç»„ä»¶çš„æ•°æ®ï¼š&quot;</span> + val);&#125;,&#125;,&#125;);</code></pre></div></li><li><p>Vue3ä¸­</p><ul><li><code>listener</code>åˆå¹¶åˆ° <code>attrs</code>ä¸­</li><li><code>attrs</code>ä¸­è¿˜åŒ…å«<code>class</code>å’Œ<code>style</code></li></ul></li></ul><h3 id="EventBus"><a href="#EventBus" class="headerlink" title="EventBus"></a>EventBus</h3><p>ä¸€ä¸ªç©ºVueå®ä¾‹</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// eventBus.js</span><span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">const</span> EventBus  = <span class="hljs-keyword">new</span> Vue()<span class="hljs-comment">// componentA</span><span class="hljs-keyword">import</span> EventBus <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;eventBus.js&#x27;</span>methods:&#123;    <span class="hljs-function"><span class="hljs-title">someFunc</span>(<span class="hljs-params"></span>)</span>&#123;        EventBus.$emit(<span class="hljs-string">&#x27;funcName&#x27;</span>,&#123;            <span class="hljs-comment">//props</span>        &#125;)    &#125;&#125;<span class="hljs-comment">// componentsB</span><span class="hljs-function"><span class="hljs-title">mounted</span>(<span class="hljs-params"></span>)</span>&#123;    EventBus.$on(<span class="hljs-string">&#x27;funcName&#x27;</span>,<span class="hljs-function"><span class="hljs-params">param</span> =&gt;</span> &#123;        <span class="hljs-comment">//paramså–å¾—ä¼ è¿‡æ¥çš„å‚æ•°</span>    &#125;)&#125;</code></pre></div><h3 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h3><ul><li><a href="https://github.com/vuejs/pinia">pinia</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>vue</tag>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½œç”¨åŸŸé“¾ä¸é—­åŒ…</title>
    <link href="/2022/02/24/%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE%E4%B8%8E%E9%97%AD%E5%8C%85/"/>
    <url>/2022/02/24/%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE%E4%B8%8E%E9%97%AD%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h1 id="ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾</h1><h2 id="ä½œç”¨åŸŸï¼šå˜é‡å¯ä»¥èµ·ä½œç”¨çš„èŒƒå›´"><a href="#ä½œç”¨åŸŸï¼šå˜é‡å¯ä»¥èµ·ä½œç”¨çš„èŒƒå›´" class="headerlink" title="ä½œç”¨åŸŸï¼šå˜é‡å¯ä»¥èµ·ä½œç”¨çš„èŒƒå›´"></a>ä½œç”¨åŸŸï¼šå˜é‡å¯ä»¥èµ·ä½œç”¨çš„èŒƒå›´</h2><ul><li><p>å…¨å±€ä½œç”¨åŸŸ</p><p>å˜é‡åœ¨å‡½æ•°å¤–çš„å½“å‰globalé¡¶å±‚å£°æ˜</p><p> <code>å…¨å±€å˜é‡</code>ï¼šåœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è®¿é—®åˆ°çš„å˜é‡ï¼Œå…³é—­ç½‘é¡µæˆ–æµè§ˆå™¨æ‰ä¼šé”€æ¯ã€‚é¡¶å±‚</p><blockquote><p>å¬è¿‡varå£°æ˜çš„å…¨å±€å˜é‡ä¼šç›´æ¥æŒ‚è½½åœ¨Globalå¯¹è±¡ä¸Šï¼Œletå’Œconståˆ™ä¸ä¼šï¼Œä½†ä»–ä»¬æ•ˆæœæ˜¯ç›¸åŒçš„ã€‚</p></blockquote></li></ul><ul><li><p>å‡½æ•°ä½œç”¨åŸŸï¼ˆå±€éƒ¨ä½œç”¨åŸŸï¼‰</p><p>å˜é‡åœ¨å‡½æ•°å†…å£°æ˜</p><p> <code>å±€éƒ¨å˜é‡</code>ï¼šåªåœ¨å›ºå®šçš„ä»£ç ç‰‡æ®µå†…å¯è®¿é—®åˆ°çš„å˜é‡,åœ¨å‡½æ•°å¼€å§‹æ‰§è¡Œæ—¶åˆ›å»ºï¼Œå‡½æ•°æ‰§è¡Œå®Œå<code>å±€éƒ¨å˜é‡</code>ä¼šè‡ªåŠ¨é”€æ¯ã€‚</p></li><li><p>å—çº§ä½œç”¨åŸŸï¼ˆes5ï¼‰</p><p>ä»»ä½•ä¸€å¯¹èŠ±æ‹¬å·<code>&#123;&#125;</code>ä¹Ÿä¼šç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„ä½œç”¨åŸŸã€‚</p></li><li><p>è¯æ³•ä½œç”¨åŸŸ</p><p>jsçš„ä½œç”¨åŸŸèŒƒå›´åœ¨ä¹¦å†™æ—¶å°±å·²ç»ç¡®å®šï¼Œä¸å—ä»£ç æ‰§è¡Œçš„åŠ¨æ€å½±å“ã€‚ï¼ˆé™æ€ä½œç”¨åŸŸï¼‰</p></li><li><p>è‡ªç”±å˜é‡</p><p>å½“å‰ä½œç”¨åŸŸæ²¡æœ‰å®šä¹‰çš„å˜é‡ï¼Œè¿™æˆä¸º<code>è‡ªç”±å˜é‡</code>ï¼ˆæ—¢ä¸æ˜¯å±€éƒ¨å˜é‡ä¹Ÿä¸æ˜¯å‡½æ•°å‚æ•°ï¼‰</p><ul><li>è‡ªç”±å˜é‡ä¼šå‘çˆ¶çº§ä½œç”¨åŸŸä¸­å¯»æ‰¾</li><li><strong>è‡ªç”±å˜é‡ä»ä½œç”¨åŸŸé“¾ä¸­å»å¯»æ‰¾ï¼Œä¾æ®çš„æ˜¯å‡½æ•°å®šä¹‰æ—¶çš„ä½œç”¨åŸŸé“¾ï¼Œè€Œä¸æ˜¯å‡½æ•°æ‰§è¡Œæ—¶çš„ä½œç”¨åŸŸ</strong></li></ul></li></ul><h2 id="ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸé“¾</h2><ul><li><p>jsä¸­çš„å‡½æ•°åœ¨åˆ›å»ºæ—¶ä¼šåˆ›å»ºä¸€ä¸ª<code>å˜é‡å¯¹è±¡</code>ä¿å­˜å½“å‰ä½œç”¨åŸŸä¸­çš„æ‰€æœ‰å‡½æ•°ä¸å˜é‡ï¼›</p></li><li><p>jsä¸­çš„ä»£ç åœ¨æ‰§è¡Œæ—¶ä¼šåˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œè€Œæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„<code>[scope chain] </code>ä¿å­˜äº†æ‰€æœ‰çˆ¶çº§ä½œç”¨åŸŸçš„ä¸­<code>å˜é‡å¯¹è±¡</code>çš„å¼•ç”¨ï¼Œéšç€å‡½æ•°çš„æ‰§è¡Œï¼Œä¼šå°†å½“å‰çš„æ´»åŠ¨å¯¹è±¡é“¾æ¥åˆ°<code>[scope chain]</code>çš„æœ€å‰ç«¯ã€‚</p></li><li><p>å‡½æ•°çš„æ´»åŠ¨å¯¹è±¡åˆå§‹åªæœ‰<code>arguments</code>ï¼Œå˜é‡çš„æŸ¥æ‰¾ä¼šä»<code>arguments</code>å¼€å§‹å¾ªç€<code>scope chain</code>çš„é¡ºåºä¾æ¬¡å¾€å¤–éƒ¨æŸ¥æ‰¾å˜é‡æ ‡è¯†ç¬¦å·ï¼Œç›´åˆ°å…¨å±€ä½œç”¨åŸŸã€‚</p></li></ul><h1 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h1><ul><li><p>å‡½æ•°ä¸å…¶è¯æ³•ç¯å¢ƒå…±åŒæ„æˆ <em>é—­åŒ…ï¼ˆclosureï¼‰</em> ã€‚</p></li><li><p>è¯æ³•ç¯å¢ƒ = ä»£ç å†…å˜é‡æ ‡è¯†ç¬¦ä¸å€¼ä¹‹é—´çš„å…³è”å…³ç³»ï¼ˆç¯å¢ƒè®°å½•ï¼‰+ å¯¹å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å¼•ç”¨</p></li><li><p>æ‰€æœ‰å‡½æ•°ä¼šè‡ªåŠ¨é€šè¿‡éšè—çš„ [[Environment]] å±æ€§è®°ä½åˆ›å»ºå®ƒä»¬çš„ä½ç½®,ä¿å­˜å¯¹å…¶åˆ›å»ºä½ç½®çš„æ­¤æ³•ç¯å¢ƒçš„å¼•ç”¨.</p></li><li><p>å‡½æ•°åœ¨ä¹¦å†™çš„ä½ç½®ä¹‹å¤–çš„ä½œç”¨åŸŸè¢«è°ƒç”¨æ—¶ï¼Œå¯ä»¥è®¿é—®å…¶æ‰€åœ¨å‡½æ•°ä½“å†…çš„å˜é‡</p></li></ul><h2 id="é—­åŒ…çš„ç”¨é€”"><a href="#é—­åŒ…çš„ç”¨é€”" class="headerlink" title="é—­åŒ…çš„ç”¨é€”"></a>é—­åŒ…çš„ç”¨é€”</h2><ul><li><p>å®ç°æ•°æ®(å˜é‡å’Œæ–¹æ³•)ç§æœ‰åŒ–</p></li><li><p>å‡½æ•°æŸ¯é‡ŒåŒ–</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">curry</span>(<span class="hljs-params">func,...args1</span>)</span>&#123;  <span class="hljs-keyword">const</span> fnLen = func.length  <span class="hljs-keyword">const</span> argsArr = [...args1]  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_curry</span>(<span class="hljs-params">...args2</span>)</span>&#123;    argsArr = [...argsArr,...args2]    <span class="hljs-keyword">return</span> argsArr.length &gt;= fnLen ? func.apply(func,argsArr) : _curry  &#125;  <span class="hljs-keyword">return</span> _curry&#125;<span class="hljs-comment">// ä¼ ä¸–ç»å…¸ç´¯åŠ å‡½æ•°add</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">...args1</span>)</span>&#123;  <span class="hljs-keyword">let</span> res = [...args1].reduce(<span class="hljs-function">(<span class="hljs-params">a,b</span>)=&gt;</span>a+b)  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">innerAdd</span>(<span class="hljs-params">...args2</span>)</span>&#123;    res = [...res,...args2].reduce(<span class="hljs-function">(<span class="hljs-params">a,b</span>)=&gt;</span>a+b)    <span class="hljs-keyword">return</span> innerAdd  &#125;  innerAdd.toString = <span class="hljs-function">() =&gt;</span> res  <span class="hljs-comment">// æ‰“å°æ–¹æ³•ä¼šè°ƒç”¨toString</span>  <span class="hljs-keyword">return</span> innerAdd&#125;</code></pre></div></li></ul><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addCounter</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-keyword">let</span> counter = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ‰§è¡Œç»“æŸåä¸ä¼šè¢«æ¸…é™¤</span>  <span class="hljs-keyword">const</span> myFunction = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    counter = counter + <span class="hljs-number">1</span>; <span class="hljs-comment">// myFunctionå‡½æ•°å¯ä»¥è¯»å–addå‡½æ•°å†…éƒ¨çš„å˜é‡</span>    <span class="hljs-keyword">return</span> counter;  &#125;;  <span class="hljs-keyword">return</span> myFunction;&#125;<span class="hljs-keyword">const</span> increment = addCounter();<span class="hljs-keyword">const</span> c1 = increment();<span class="hljs-keyword">const</span> c2 = increment();<span class="hljs-keyword">const</span> c3 = increment();<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;increment:&quot;</span>, c1, c2, c3);<span class="hljs-comment">// increment: 1 2 3</span></code></pre></div><h2 id="é¢è¯•é¢˜"><a href="#é¢è¯•é¢˜" class="headerlink" title="é¢è¯•é¢˜"></a>é¢è¯•é¢˜</h2><ul><li>è€ç”Ÿå¸¸è°ˆçš„forå¾ªç¯setTimeoutæ‰“å°é—®é¢˜<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">7</span>; i++) &#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-built_in">console</span>.log(i)  &#125;, <span class="hljs-number">1000</span> * i)&#125;<span class="hljs-comment">// 6 6 6 6 6 6</span><span class="hljs-comment">// åˆ›å»ºçš„6ä¸ªsetTimeouté—­åŒ…å…±äº«ä¸€ä¸ªè¯æ³•ä½œç”¨åŸŸ</span>**é—­åŒ…åªèƒ½å–å¾—åŒ…å«å‡½æ•°ä¸­ä»»ä½•å˜é‡èµ‹å€¼æœ€åä¸€ä¸ªå€¼** <span class="hljs-comment">// 6</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">7</span>; i++) &#123;  (<span class="hljs-function">(<span class="hljs-params">j</span>) =&gt;</span> &#123;    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;      <span class="hljs-built_in">console</span>.log(j)    &#125;, <span class="hljs-number">1000</span> * j)  &#125;)(i)&#125;<span class="hljs-comment">// 1 2 3 4 5 6</span><span class="hljs-comment">// 6ä¸ªsetTimeouté—­åŒ…æœ‰è‡ªå·±ç‹¬ç«‹çš„è¯æ³•ç¯å¢ƒ</span><span class="hljs-comment">// é—­åŒ…è¯»å–åˆ°ä¸åŒçš„iå€¼</span><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span> ;i&lt;<span class="hljs-number">7</span>;i++)&#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">j</span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(j);  &#125;,<span class="hljs-number">1000</span>*i,i)&#125;<span class="hljs-comment">// setTimeout å¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°å½“å‡½æ•°è°ƒç”¨æ—¶ä¼ å…¥</span><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span> ;i&lt;<span class="hljs-number">7</span>;i++)&#123;  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(i);  &#125;,<span class="hljs-number">1000</span>*i)&#125;</code></pre></div></li><li><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span>(<span class="hljs-params">num2</span>) </span>&#123;  <span class="hljs-keyword">var</span> num = <span class="hljs-number">15</span>;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">abc</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">// å‡½æ•°ä½œä¸ºè¿”å›å€¼</span>    num++;    <span class="hljs-keyword">return</span>(num + num2);  &#125;  <span class="hljs-keyword">return</span> abc;&#125;<span class="hljs-keyword">var</span> aa = fn(<span class="hljs-number">20</span>); <span class="hljs-comment">//  æ²¡æœ‰å¼•ç”¨ï¼Ÿï¼Ÿ</span>aa(); <span class="hljs-comment">//16+20</span>aa(); <span class="hljs-comment">//17+20</span>fn(<span class="hljs-number">20</span>)(); <span class="hljs-comment">//36</span>fn(<span class="hljs-number">20</span>)(); <span class="hljs-comment">//36</span></code></pre></div></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯æ¶‰åŠåˆ°çš„æ•°æ®å­˜å‚¨</title>
    <link href="/2022/02/24/%E5%89%8D%E7%AB%AF%E5%AD%98%E5%82%A8/"/>
    <url>/2022/02/24/%E5%89%8D%E7%AB%AF%E5%AD%98%E5%82%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="LocalStorage-h5-web-storage"><a href="#LocalStorage-h5-web-storage" class="headerlink" title="LocalStorage[h5 web storage]"></a><code>LocalStorage</code>[h5 web storage]</h3><ul><li><p>ä¸ä¼šè¿‡æœŸ</p></li><li><p>æ•°æ®å¤§å°5MB</p></li><li><p>åŒæºå…±äº«åŒä¸€ä»½<code>localStorage</code></p></li><li><p>åªèƒ½ä¸º<code>string</code>ç±»å‹,æ³¨æ„éœ€è¦<code>JSON</code>è½¬æ¢</p></li></ul><h3 id="SessionStorage-h5-web-storage"><a href="#SessionStorage-h5-web-storage" class="headerlink" title="SessionStorage[h5 web storage]"></a><code>SessionStorage</code>[h5 web storage]</h3><ul><li><p>ä¼šè¯æœŸé—´å¯ç”¨ï¼ˆå³åªè¦æµè§ˆå™¨å¤„äºæ‰“å¼€çŠ¶æ€ï¼ŒåŒ…æ‹¬é¡µé¢é‡æ–°åŠ è½½å’Œæ¢å¤ï¼‰</p></li><li><p>æ•°æ®å¤§å°5MB</p></li><li><p>ä¸è·¨çª—å£å…±äº«,å°±ç®—åŒä¸€<code>url</code>çš„å¤šä¸ª<code>tab</code>å„è‡ªç‹¬ç«‹</p></li></ul><h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a><code>Cookie</code></h3><ul><li><p>æ‰‹åŠ¨è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå¦åˆ™æµè§ˆå™¨å…³é—­å¤±æ•ˆ</p></li><li><p>æ•°æ®å¤§å° 4KB</p></li><li><p>å‚ä¸æ¯æ¬¡<code>http</code>è¯·æ±‚</p></li><li><p>æœ‰<code>path</code>å’Œ<code>domain</code>æ¦‚å¿µï¼Œ</p></li><li><p>æŸäº›æµè§ˆå™¨å¯¹å•ç½‘ç«™cookieæ•°ç›®æœ‰é™åˆ¶(ä¸è¶…è¿‡20ä¸ª)</p></li><li><p>cookieå­—æ®µ</p><ul><li><p><code>name</code></p></li><li><p><code>value</code></p></li><li><p><code>domain</code>ã€€        å¯ä»¥è®¿é—®æ­¤cookieçš„åŸŸï¼Œé»˜è®¤ä¸ºè¯¥è¯·æ±‚æºçš„åŸŸ<code>origin</code></p></li><li><p><code>path</code>ã€€        ã€€ å¯ä»¥è®¿é—®æ­¤cookieçš„é¡µé¢è·¯å¾„</p></li><li><p><code>expires / max-age</code> è¿‡æœŸæ—¶é—´ï¼Œå¦‚æ²¡è®¾ç½®åˆ™ä¸ä¼šè¯æ—¶æ•ˆç›¸åŒï¼ˆå…³é—­æµè§ˆå™¨çª—å£å¤±æ•ˆï¼‰</p></li><li><p><code>HttpOnly</code>ã€€      ç¦æ­¢jsè¯»å–<code>Document.cookie</code></p></li><li><p><code>Secure</code>          åªä½¿ç”¨HTTPSä¼ è¾“</p></li><li><p><code>sameSite = </code> é˜²æ­¢ã€XSRFã€‘æ”»å‡»</p><ul><li><code>Strict</code>  è·¨åŸŸæ—¶ä¸å…è®¸å¸¦ä¸Šä»»ä½•cookie</li><li><code>Lax</code>  åªæœ‰ä¸‰ç§æƒ…å†µå¯ä»¥å¸¦ä¸Šcookie[aè¿æ¥,getæäº¤çš„è¡¨å•,é¢„åŠ è½½link]<blockquote><p>ç°ä»£æµè§ˆå™¨ä¼šå°†æ²¡æœ‰å£°æ˜ SameSite å€¼çš„ cookie é»˜è®¤è®¾ç½®ä¸ºLax</p></blockquote></li><li><code>None</code> ä¸å¯¹å‘é€è¿›è¡Œé™åˆ¶ï¼Œéœ€é…åˆ<code>secure</code>ä½¿ç”¨ç”¨ <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Set</span>-Cookie: widget_session=xxxxx; SameSite=None; Secure</code></pre></div></li></ul></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;<span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Expires=&lt;date&gt;<span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Max-Age=&lt;non-zero-digit&gt;<span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;<span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Path=&lt;path-value&gt;<span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Secure<span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; HttpOnly<span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=Strict<span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=Lax<span class="hljs-built_in">Set</span>-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=None; Secure</code></pre></div><h3 id="IndexedDB"><a href="#IndexedDB" class="headerlink" title="IndexedDB"></a><code>IndexedDB</code></h3></li><li><p>é™¤éè¢«æ¸…ç†å¦åˆ™ä¸€ç›´å­˜åœ¨</p></li><li><p>æ•°æ®å¤§å°æ— é™åˆ¶</p></li><li><p>IndexedDB æ˜¯ä¸€ä¸ªåŸºäº JavaScript çš„é¢å‘å¯¹è±¡æ•°æ®åº“ï¼Œç›¸æ¯”webStorageæä¾›å­˜å‚¨å¤§é‡ç»“æ„åŒ–æ•°æ®çš„èƒ½åŠ›</p></li></ul><h2 id="manifest"><a href="#manifest" class="headerlink" title="manifest"></a><code>manifest</code></h2><p><code>manifest.json</code>åœ¨ä¸€ä¸ªJSONæ–‡æœ¬æ–‡ä»¶ä¸­æä¾›æœ‰å…³åº”ç”¨ç¨‹åºçš„ä¿¡æ¯ï¼ˆå¦‚åç§°ï¼Œä½œè€…ï¼Œå›¾æ ‡å’Œæè¿°ï¼‰ã€‚manifest çš„ç›®çš„æ˜¯å°†Webåº”ç”¨ç¨‹åºå®‰è£…åˆ°è®¾å¤‡çš„ä¸»å±å¹•ï¼Œä¸ºç”¨æˆ·æä¾›æ›´å¿«çš„è®¿é—®å’Œæ›´ä¸°å¯Œçš„ä½“éªŒã€‚</p><p>Webåº”ç”¨ç¨‹åºæ¸…å•æ˜¯è¢«ç§°ä¸º<code>æ¸è¿›å¼Webåº”ç”¨ç¨‹åº(PWA)</code>çš„WebæŠ€æœ¯é›†åˆçš„ä¸€éƒ¨åˆ†, å®ƒä»¬æ˜¯å¯ä»¥å®‰è£…åˆ°è®¾å¤‡çš„ä¸»å±å¹•çš„ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œè€Œä¸éœ€è¦ç”¨æˆ·é€šè¿‡åº”ç”¨å•†åº—ï¼Œä¼´éšç€å…¶ä»–åŠŸèƒ½, æ¯”å¦‚ç¦»çº¿å¯ç”¨å’Œæ¥æ”¶æ¨é€é€šçŸ¥ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</title>
    <link href="/2022/02/24/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    <url>/2022/02/24/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="ã€æ‰“åŒ…æ—¶é—´ã€‘"><a href="#ã€æ‰“åŒ…æ—¶é—´ã€‘" class="headerlink" title="ã€æ‰“åŒ…æ—¶é—´ã€‘"></a>ã€æ‰“åŒ…æ—¶é—´ã€‘</h1><ul><li>ç¼©å°loaderçš„ä½œç”¨èŒƒå›´<code>include</code>,<code>exclude</code></li><li>ç¼©å°æ¨¡å—æœç´¢èŒƒå›´<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">module</span>.exports = &#123;  <span class="hljs-comment">//...</span>  resolve: &#123;    modules: [path.resolve(__dirname, <span class="hljs-string">&#x27;src&#x27;</span>), <span class="hljs-string">&#x27;node_modules&#x27;</span>], <span class="hljs-comment">// æœç´¢ä½ç½®</span>    extensions:[<span class="hljs-string">&quot;.js&quot;</span>,<span class="hljs-string">&quot;.jsx&quot;</span>] <span class="hljs-comment">// æœç´¢çš„åç¼€å,è™½ç„¶å†™çš„æ—¶å€™å¯ä»¥çœç•¥,ä½†ä¼šå¢åŠ æœç´¢çš„æ€§èƒ½æŸè€—</span>  &#125;&#125;;</code></pre></div></li></ul><h1 id="ã€æ‰“åŒ…å¤§å°ã€‘"><a href="#ã€æ‰“åŒ…å¤§å°ã€‘" class="headerlink" title="ã€æ‰“åŒ…å¤§å°ã€‘"></a>ã€æ‰“åŒ…å¤§å°ã€‘</h1><ul><li><p>èµ„æºå‹ç¼©<br>  css/js/å›¾ç‰‡å‹ç¼©</p></li><li><p>ä»£ç åˆ†å‰²<br>  åˆ†ç¦»ç¬¬ä¸‰æ–¹åº“å»è®¾ç½®é•¿ç¼“å­˜æˆ–è€…CDN</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">module</span>.exports = &#123;  chainWebpack: <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> &#123;      config.optimizationsplitChunks(&#123;        chunks: <span class="hljs-string">&#x27;all&#x27;</span>,        cacheGroups: &#123;          vendors: &#123;            name: <span class="hljs-string">&#x27;chunk-vendors&#x27;</span>,            test: <span class="hljs-regexp">/[\\/]node_module[\\/]/</span>,            priority: <span class="hljs-number">10</span>,            chunks: <span class="hljs-string">&#x27;initial&#x27;</span>          &#125;,          echarts: &#123;            name: <span class="hljs-string">&#x27;chunk-echarts&#x27;</span>,            priority: <span class="hljs-number">20</span>,            test: <span class="hljs-regexp">/[\\/]node_module[\\/]_?echarts(.*)/</span>          &#125;        &#125;      &#125;)    &#125;&#125;</code></pre></div></li><li><p>babelè½¬è¯‘ä¼˜åŒ–<br>babelä¼šåœ¨åœ¨æ¯ä¸ªéœ€è¦ç¼–è¯‘çš„åœ°æ–¹éƒ½åŠ ä¸Šhelperå‡½æ•°ï¼Œé€ æˆå†—ä½™</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// .babelrc</span><span class="hljs-string">&quot;plugins&quot;</span>: [        <span class="hljs-string">&quot;@babel/plugin-transform-runtime&quot;</span>]<span class="hljs-comment">// è‡ªåŠ¨ç§»é™¤è¯­æ³•è½¬æ¢åå†…è”çš„è¾…åŠ©å‡½æ•°ï¼ˆinline Babel helpersï¼‰ï¼Œä½¿ç”¨@babel/runtime/helpersé‡Œçš„è¾…åŠ©å‡½æ•°æ¥æ›¿ä»£ï¼›</span></code></pre></div></li><li><p>æŒ‰éœ€æ‰“åŒ…ç»„ä»¶ï¼ˆå¦‚element-uiï¼‰å’Œ<code>tree shaking</code></p></li><li><p><code>gzip</code>å‹ç¼©</p><h1 id="ã€åŠ è½½é˜¶æ®µã€‘"><a href="#ã€åŠ è½½é˜¶æ®µã€‘" class="headerlink" title="ã€åŠ è½½é˜¶æ®µã€‘"></a>ã€åŠ è½½é˜¶æ®µã€‘</h1><h2 id="ç™½å±loadingæç¤ºæˆ–è€…éª¨æ¶å±"><a href="#ç™½å±loadingæç¤ºæˆ–è€…éª¨æ¶å±" class="headerlink" title="ç™½å±loadingæç¤ºæˆ–è€…éª¨æ¶å±"></a>ç™½å±loadingæç¤ºæˆ–è€…éª¨æ¶å±</h2><h2 id="è·¯ç”±æ‡’åŠ è½½-å¼‚æ­¥ç»„ä»¶"><a href="#è·¯ç”±æ‡’åŠ è½½-å¼‚æ­¥ç»„ä»¶" class="headerlink" title="è·¯ç”±æ‡’åŠ è½½/å¼‚æ­¥ç»„ä»¶"></a>è·¯ç”±æ‡’åŠ è½½/å¼‚æ­¥ç»„ä»¶</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// router</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> Router(&#123;  routes: [    &#123;      path: <span class="hljs-string">&#x27;/home&#x27;</span>,      component: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/components/home&#x27;</span>),    &#125;,    &#123;      path: <span class="hljs-string">&#x27;/about&#x27;</span>,      component: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/components/home&#x27;</span>),    &#125;,  ],&#125;)<span class="hljs-comment">// async component</span><span class="hljs-keyword">import</span> &#123;defineAsyncComponent&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span></code></pre></div></li></ul><h2 id="å›¾ç‰‡æ‡’åŠ è½½"><a href="#å›¾ç‰‡æ‡’åŠ è½½" class="headerlink" title="å›¾ç‰‡æ‡’åŠ è½½"></a>å›¾ç‰‡æ‡’åŠ è½½</h2>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ä¸»è¦é€»è¾‘</span><span class="hljs-keyword">const</span> imgList = [...document.querySelectAll(<span class="hljs-string">&#x27;img&#x27;</span>)]<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lazyLoad</span>(<span class="hljs-params">imgList</span>)</span>&#123;  <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>  <span class="hljs-keyword">const</span> len = imgList.length  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">let</span> doneList = []    imgList.forEach(<span class="hljs-function">(<span class="hljs-params">img,index</span>)=&gt;</span>&#123;      <span class="hljs-keyword">const</span> react = img.getBoundingClientRect()      <span class="hljs-comment">// Element.getBoundingClientRect() æ–¹æ³•è¿”å›å…ƒç´ çš„å¤§å°åŠå…¶ç›¸å¯¹äºè§†å£çš„ä½ç½®</span>      <span class="hljs-keyword">if</span>(react.top&lt;<span class="hljs-built_in">window</span>.innerHeight)&#123;        img.src = img.dataset.src  <span class="hljs-comment">// åœ¨è¿™é‡Œèµ‹å€¼å›¾ç‰‡src</span>        doneList.push(index)        count++        <span class="hljs-keyword">if</span>(count === len)&#123;          <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">&#x27;scroll&#x27;</span>,lazyLoad)        &#125;      &#125;    &#125;)    imgList = imgList.filter(<span class="hljs-function">(<span class="hljs-params">img,index</span>)=&gt;</span>!doneList.includes(i))  &#125;&#125;<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">&#x27;scroll&#x27;</span>,_.debounce(lazyLoad))<span class="hljs-comment">//</span></code></pre></div><h2 id="è™šæ‹Ÿåˆ—è¡¨"><a href="#è™šæ‹Ÿåˆ—è¡¨" class="headerlink" title="è™šæ‹Ÿåˆ—è¡¨"></a>è™šæ‹Ÿåˆ—è¡¨</h2><p>  åŠ¨æ€æ¸²æŸ“é•¿åˆ—è¡¨</p><h2 id="å›¾ç‰‡å ä½ç¬¦"><a href="#å›¾ç‰‡å ä½ç¬¦" class="headerlink" title="å›¾ç‰‡å ä½ç¬¦"></a>å›¾ç‰‡å ä½ç¬¦</h2><p><a href="https://www.npmjs.com/package/sqip">sqip</a></p><h2 id="ä¼˜åŒ–æ–‡æ¡£ç»“æ„"><a href="#ä¼˜åŒ–æ–‡æ¡£ç»“æ„" class="headerlink" title="ä¼˜åŒ–æ–‡æ¡£ç»“æ„"></a>ä¼˜åŒ–æ–‡æ¡£ç»“æ„</h2><ul><li><p>cssèµ„æºè¯·æ±‚æ”¾åœ¨æ–‡æ¡£æœ€å‰</p></li><li><p>è„šæœ¬æ”¾åœ¨æœ€åä¸”éæ ¸å¿ƒä»£ç å¼‚æ­¥åŠ è½½</p><blockquote><p>jsè„šæœ¬ç»„ç»‡DOMè§£æï¼Œè€Œcssèµ„æºåˆå›é˜»å¡jsæ‰§è¡Œ</p></blockquote><p>å¼‚æ­¥åŠ è½½çš„æ–¹å¼</p><ol><li>åŠ¨æ€åˆ›å»ºscriptæ ‡ç­¾</li><li>script<code>defer</code></li><li>script<code>async</code><br><img src="../images/script.png" alt="script"></li></ol><ul><li>æ™®é€šçš„<code>script</code>ï¼Œhtmlè§£ææš‚åœï¼Œç«‹å³ä¸‹è½½å’Œæ‰§è¡Œè¿™ä¸ªè„šæœ¬</li><li><code>&lt;script async&gt;</code>ï¼Œhtmlè§£æå’Œè¯¥è„šæœ¬çš„åŠ è½½åŒæ—¶è¿›è¡Œï¼Œä¸‹è½½å®Œåæ‰§è¡Œè„šæœ¬æ—¶æš‚åœhtmlè§£æ</li><li><code>&lt;script defer&gt;</code>ï¼Œhtmlè§£æå’Œè¯¥è„šæœ¬çš„åŠ è½½åŒæ—¶è¿›è¡Œï¼Œè„šæœ¬åœ¨é¡µé¢è§£æå®Œæˆåæ‰æ‰§è¡Œâ€”&gt;<code>DOMContentLoaded</code> ä¹‹å‰æ‰§è¡Œ</li></ul></li></ul><h2 id="ä½¿ç”¨CDN"><a href="#ä½¿ç”¨CDN" class="headerlink" title="ä½¿ç”¨CDN"></a>ä½¿ç”¨CDN</h2><ol><li><p>å®‰è£…<code>html-webpack-plugin</code></p></li><li><p>ä¿®æ”¹<code>public/index.html</code></p>   <div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    &lt;meta      name=&quot;viewport&quot;      content=&quot;width=device-width,initial-scale=1.0,user-scalable=no&quot;    /&gt;    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;icon&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;</span> /&gt;</span>    <span class="hljs-comment">&lt;!-- ä½¿ç”¨CDNçš„CSSæ–‡ä»¶ --&gt;</span>    &lt;% for (var i in htmlWebpackPlugin.options.cdn &amp;&amp;    htmlWebpackPlugin.options.cdn.css) &#123; %&gt;    &lt;link      href=&quot;&lt;%= htmlWebpackPlugin.options.cdn.css[i] %&gt;&quot;      rel=&quot;preload&quot;      as=&quot;style&quot;    /&gt;    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&lt;%= htmlWebpackPlugin.options.cdn.css[i] %&gt;&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;</span>    &lt;% &#125; %&gt;    <span class="hljs-comment">&lt;!-- ä½¿ç”¨CDNçš„CSSæ–‡ä»¶ --&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span>      <span class="hljs-comment">&lt;!--  --&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-comment">&lt;!-- built files will be auto injected --&gt;</span>    <span class="hljs-comment">&lt;!-- ä½¿ç”¨CDNçš„JSæ–‡ä»¶ --&gt;</span>    &lt;% for (var i in htmlWebpackPlugin.options.cdn &amp;&amp;    htmlWebpackPlugin.options.cdn.js) &#123; %&gt;    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&lt;%= htmlWebpackPlugin.options.cdn.js[i] %&gt;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    &lt;% &#125; %&gt;    <span class="hljs-comment">&lt;!-- ä½¿ç”¨CDNçš„JSæ–‡ä»¶ --&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div></li><li><p>é…ç½®<code>vue.config.js</code></p>   <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// åˆ¤æ–­ç”Ÿäº§ç¯å¢ƒ</span><span class="hljs-keyword">const</span> isProduction = process.env.NODE_ENV === <span class="hljs-string">&quot;production&quot;</span>;<span class="hljs-keyword">const</span> cdn = &#123;  <span class="hljs-comment">// éšä¾¿æŠ“å‡ ä¸ª</span>  js: [    <span class="hljs-string">&quot;https://cdn.bootcdn.net/ajax/libs/vue/2.6.0/vue.runtime.esm.js&quot;</span>,    <span class="hljs-string">&quot;https://cdn.bootcdn.net/ajax/libs/vue-router/3.1.3/vue-router.esm.js&quot;</span>  ],&#125;;<span class="hljs-built_in">module</span>.exports = &#123;  configureWebpack: <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (isProduction) &#123;      config.externals = &#123;        <span class="hljs-comment">// æ’é™¤çš„ä¾èµ–ï¼Œä¸ä»bundleä¸­å¼•å…¥çš„ä¾èµ–</span>        <span class="hljs-string">&quot;vue&quot;</span>: <span class="hljs-string">&quot;Vue&quot;</span>,        <span class="hljs-string">&quot;vue-router&quot;</span>: <span class="hljs-string">&quot;VueRouter&quot;</span>      &#125;;    &#125;  &#125;,  chainWebpack: <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (isProduction) &#123;      config.plugin(<span class="hljs-string">&quot;html&quot;</span>).tap(<span class="hljs-function">(<span class="hljs-params">args</span>) =&gt;</span> &#123;        <span class="hljs-comment">// ä¼ é€’ç»™ html-webpack-plugin&#x27;s æ„é€ å‡½æ•°çš„æ–°å‚æ•°</span>        args[<span class="hljs-number">0</span>].cdn = cdn;        <span class="hljs-keyword">return</span> args;      &#125;);    &#125;  &#125;,&#125;;</code></pre></div></li></ol><h2 id="é¢„è§£æDNS"><a href="#é¢„è§£æDNS" class="headerlink" title="é¢„è§£æDNS"></a>é¢„è§£æDNS</h2><p><code>DNS Prefetch</code> æ˜¯ä¸€ç§DNS é¢„è§£ææŠ€æœ¯ï¼Œå½“æµè§ˆç½‘é¡µæ—¶ï¼Œæµè§ˆå™¨ä¼šåœ¨åŠ è½½ç½‘é¡µæ—¶å¯¹ç½‘é¡µä¸­çš„åŸŸåè¿›è¡Œè§£æç¼“å­˜ï¼Œè¿™æ ·åœ¨å•å‡»å½“å‰ç½‘é¡µä¸­çš„è¿æ¥æ—¶å°±æ— éœ€è¿›è¡ŒDNSçš„è§£æï¼Œå‡å°‘ç”¨æˆ·ç­‰å¾…æ—¶é—´ï¼Œæé«˜ç”¨æˆ·ä½“éªŒã€‚</p><ol><li><p><code>HTTP</code>ä¸­æµè§ˆå™¨ä¼šå¯¹<code>&lt;a&gt;æ ‡ç­¾</code>è‡ªåŠ¨å¼€å¯dnsé¢„è§£æ</p><blockquote><p>å¯¹äºhttpsé¡µé¢ï¼Œå¤§éƒ¨åˆ†æµè§ˆå™¨æ˜¯å…³é—­aæ ‡ç­¾çš„dnsé¢„è§£æçš„</p></blockquote></li><li><p><code>HTTPS</code>ç”¨metaä¿¡æ¯æ¥å‘ŠçŸ¥æµè§ˆå™¨, å½“å‰é¡µé¢è¦åšDNSé¢„è§£æ:<br><code>&lt;meta http-equiv=&quot;x-dns-prefetch-control&quot; content=&quot;on&quot; /&gt;</code></p></li><li><p>åœ¨é¡µé¢<code>&lt;head&gt;</code>ä¸­ä½¿ç”¨<code>&lt;link&gt;æ ‡ç­¾</code>æ¥å¼ºåˆ¶å¯¹DNSé¢„è§£æ:</p></li></ol><p><code> &lt;link rel=&quot;dns-prefetch&quot; href=&quot;http://bdimg.share.baidu.com&quot; /&gt;</code></p><h2 id="é¢„æ¸²æŸ“å’ŒæœåŠ¡ç«¯æ¸²æŸ“"><a href="#é¢„æ¸²æŸ“å’ŒæœåŠ¡ç«¯æ¸²æŸ“" class="headerlink" title="é¢„æ¸²æŸ“å’ŒæœåŠ¡ç«¯æ¸²æŸ“"></a>é¢„æ¸²æŸ“å’ŒæœåŠ¡ç«¯æ¸²æŸ“</h2><ul><li><code>SSR:server side render</code></li><li><code>prerender-spa-plugin</code>ä¸é€‚ç”¨äºä¸ªæ€§åŒ–çš„ï¼Œå†…å®¹å˜åŒ–å¤§ï¼Œå¤šè·¯ç”±çš„é¡µé¢ï¼Œå¯ä»¥ç”¨æ¥ä¼˜åŒ–å•é¡µåº”ç”¨ã€‚</li></ul><h1 id="ã€è¿è¡Œé˜¶æ®µã€‘"><a href="#ã€è¿è¡Œé˜¶æ®µã€‘" class="headerlink" title="ã€è¿è¡Œé˜¶æ®µã€‘"></a>ã€è¿è¡Œé˜¶æ®µã€‘</h1><h2 id="JS"><a href="#JS" class="headerlink" title="JS"></a>JS</h2><ul><li>åˆç†ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜ç­–ç•¥</li><li>ä¸é¢‘ç¹æ“ä½œDOMï¼Œä½¿ç”¨è™šæ‹ŸDOMæˆ–<code>fragment</code>æ‰¹é‡æ“ä½œ</li><li>è¯»å–å…ƒç´ çš„ä½ç½®å¤§å°å±æ€§ï¼ˆå¦‚<code>scrollTop</code>,<code>offsetHeight</code>â€¦ï¼‰æµè§ˆå™¨ä¼šç«‹å³é‡æ’ï¼Œæ›´ä¸èƒ½å°†è¿™äº›å±æ€§æ”¾å…¥å¾ªç¯ä¸­</li><li>ä½¿ç”¨äº‹ä»¶å§”æ‰˜</li><li>ä½¿ç”¨<code>Web Worker</code></li><li>ä½¿ç”¨<code>requestAnimationFrame</code>ä»£æ›¿æœ‰é«˜æ€§èƒ½éœ€æ±‚çš„è®¡æ—¶å™¨<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2></li><li>é¿å…<code>css</code>é€‰æ‹©å™¨åµŒå¥—è¿‡æ·±</li><li>é¿å…å¤§é‡ä½¿ç”¨<code>id</code>é€‰æ‹©å™¨ï¼Œæ¯ä¸ª<code>id</code>éƒ½ä¼šå˜ä¸ºä¸€ä¸ªå•ç‹¬çš„å…¨å±€å˜é‡</li><li>é¿å…ä½¿ç”¨<code>table</code>ï¼Œ<code>table</code>ä¼šé¢‘ç¹è§¦å‘é‡æ’</li><li>æ›´æ¢<code>class</code>ä»£æ›¿ç›´æ¥ä¿®æ”¹<code>style</code></li><li>åˆç†ä½¿ç”¨GPUåŠ é€Ÿ<ul><li> <code>css3</code>åŠ¨ç”»<code>transform</code>ä»£æ›¿ä¿®æ”¹å‡ ä½•ä¿¡æ¯<code>left,top...</code></li><li> <code>opacity</code>ä»£æ›¿<code>visibility</code></li><li> å¤æ‚åŠ¨ç”»å…ƒç´ è„±ç¦»æ–‡æ¡£æµ<code>position:absolute/fixed</code></li><li> åŠ ä¸Š<code>will-change</code>å±æ€§çš„å…ƒç´ ä¼šäº¤ç»™åˆæˆå±‚æ¸²æŸ“ï¼ˆGPU</li></ul></li></ul><h1 id="ã€èµ„æºä¼˜åŒ–ã€‘"><a href="#ã€èµ„æºä¼˜åŒ–ã€‘" class="headerlink" title="ã€èµ„æºä¼˜åŒ–ã€‘"></a>ã€èµ„æºä¼˜åŒ–ã€‘</h1><h2 id="å›¾ç‰‡èµ„æº"><a href="#å›¾ç‰‡èµ„æº" class="headerlink" title="å›¾ç‰‡èµ„æº"></a>å›¾ç‰‡èµ„æº</h2><h3 id="é«˜æ•ˆå›¾ç‰‡æ ¼å¼"><a href="#é«˜æ•ˆå›¾ç‰‡æ ¼å¼" class="headerlink" title="é«˜æ•ˆå›¾ç‰‡æ ¼å¼"></a>é«˜æ•ˆå›¾ç‰‡æ ¼å¼</h3><ul><li><a href="https://en.wikipedia.org/wiki/WebP">WebP</a></li><li>çŸ¢é‡å›¾<a href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG</a></li><li>Base64ä½å›¾ <a href="https://en.wikipedia.org/wiki/Base64">base64</a><h3 id="å“åº”å¼å›¾ç‰‡"><a href="#å“åº”å¼å›¾ç‰‡" class="headerlink" title="å“åº”å¼å›¾ç‰‡"></a>å“åº”å¼å›¾ç‰‡</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;picture&gt;&lt;source srcset=<span class="hljs-string">&quot;banner_w1000.jpg&quot;</span> media=<span class="hljs-string">&quot;(min-width: 801px)&quot;</span>&gt;&lt;source srcset=<span class="hljs-string">&quot;banner_w800.jpg&quot;</span> media=<span class="hljs-string">&quot;(max-width: 800px)&quot;</span>&gt;&lt;img src=<span class="hljs-string">&quot;banner_w800.jpg&quot;</span> alt=<span class="hljs-string">&quot;&quot;</span>&gt;&lt;/picture&gt;</code></pre></div><h3 id="å›¾ç‰‡å‹ç¼©"><a href="#å›¾ç‰‡å‹ç¼©" class="headerlink" title="å›¾ç‰‡å‹ç¼©"></a>å›¾ç‰‡å‹ç¼©</h3></li><li><a href="https://tinypng.com/">tinypng</a></li><li><a href="https://webpack.docschina.org/plugins/image-minimizer-webpack-plugin/#root">webpackæ’ä»¶</a></li></ul><h3 id="å°å›¾åˆå¹¶"><a href="#å°å›¾åˆå¹¶" class="headerlink" title="å°å›¾åˆå¹¶"></a>å°å›¾åˆå¹¶</h3><ul><li>åˆå¹¶é›ªç¢§å›¾</li><li>ä½¿ç”¨<code>icon-font</code>å­—ä½“å›¾æ ‡<div class="hljs code-wrapper"><pre><code class="hljs javascript">svg-sprite-loader</code></pre></div></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸç”Ÿjs</title>
    <link href="/2022/02/24/%E5%8E%9F%E7%94%9Fjs/"/>
    <url>/2022/02/24/%E5%8E%9F%E7%94%9Fjs/</url>
    
    <content type="html"><![CDATA[<h2 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h2><blockquote><p>js æ˜¯ä¸€é—¨å‡½æ•°ä¼˜å…ˆçš„è½»é‡çº§è§£é‡Šå‹è¯­è¨€ï¼ŒåŸºäºåŸå‹ç¼–ç¨‹çš„åŠ¨æ€è„šæœ¬è¯­è¨€</p></blockquote><ol><li>å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼ˆå˜é‡æå‡ï¼Œå‡½æ•°å¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œè¿”å›å€¼ï¼Œå¯ä»¥èµ‹å€¼ç»™å˜é‡ï¼Œã€å‡½æ•°å¼ç¼–ç¨‹çš„æ¡ä»¶ã€‘</li><li>é¢å‘å¯¹è±¡ç¼–ç¨‹</li><li>å¼±ç±»å‹è¯­è¨€ï¼ˆå˜é‡çš„ç±»å‹åœ¨è¿è¡Œæ—¶ä¼šå˜åŒ–ï¼Œå¼ºç±»å‹è¯­è¨€çš„å˜é‡ç±»å‹ç¼–è¯‘æ—¶å°±ç¡®å®šä¸”ä¸ä¼šæ”¹å˜</li><li>åŸºäºåŸå‹ï¼ˆåŒºåˆ«äºåŸºäºç±»[ç±»å’Œå®ä¾‹]ï¼Œjs ä¸­ä¸‡ç‰©çš†ä¸º[å¯¹è±¡]<blockquote><p>åŸºäºåŸå‹çš„è¯­è¨€å…·æœ‰æ‰€è°“åŸå‹å¯¹è±¡ï¼ˆprototypical objectï¼‰çš„æ¦‚å¿µã€‚åŸå‹å¯¹è±¡å¯ä»¥ä½œä¸ºä¸€ä¸ªæ¨¡æ¿ï¼Œæ–°å¯¹è±¡å¯ä»¥ä»ä¸­è·å¾—åŸå§‹çš„å±æ€§ã€‚ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥æŒ‡å®šå…¶è‡ªèº«çš„å±æ€§ï¼Œä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼ˆprototypeï¼‰ï¼Œä»è€Œå…è®¸åè€…å…±äº«å‰è€…çš„å±æ€§ã€‚</p></blockquote></li></ol><h2 id="BOMï¼ˆBrowser-Object-Modelï¼‰-æµè§ˆå™¨å¯¹è±¡æ¨¡å‹"><a href="#BOMï¼ˆBrowser-Object-Modelï¼‰-æµè§ˆå™¨å¯¹è±¡æ¨¡å‹" class="headerlink" title="BOMï¼ˆBrowser Object Modelï¼‰ æµè§ˆå™¨å¯¹è±¡æ¨¡å‹"></a>BOMï¼ˆBrowser Object Modelï¼‰ æµè§ˆå™¨å¯¹è±¡æ¨¡å‹</h2><ul><li><p><code>navigator</code>    ç”¨æˆ·ä¿¡æ¯</p><ul><li><code>Navigator.geolocation</code>åœ°ç†ä½ç½®</li><li><code>NavigatorID.userAgent</code>ç”¨æˆ·ä»£ç†ä¿¡æ¯</li></ul></li><li><p><code>location</code>    æ–‡æ¡£ä½ç½®</p><ul><li><code>location.href/hash/search/domain/path/port/protcol</code></li><li><code>location.reload()</code></li><li><code>location.replace()</code></li></ul></li><li><p><code>history</code>    çª—å£æµè§ˆå™¨å†å²</p><ul><li><code>history.go()</code></li><li><code>history.back()</code></li><li><code>history.forward()</code></li><li><blockquote><p>window.go(-1) = window.back() + f5 // ä¸¢å¤±è¡¨å•</p></blockquote></li></ul></li><li><p><code>screen</code> å±å¹•ä¿¡æ¯</p></li></ul><h2 id="DOM-ï¼ˆDocument-Object-Modelï¼‰-æ–‡æ¡£å¯¹è±¡æ¨¡å‹"><a href="#DOM-ï¼ˆDocument-Object-Modelï¼‰-æ–‡æ¡£å¯¹è±¡æ¨¡å‹" class="headerlink" title="DOM ï¼ˆDocument Object Modelï¼‰ æ–‡æ¡£å¯¹è±¡æ¨¡å‹"></a>DOM ï¼ˆDocument Object Modelï¼‰ æ–‡æ¡£å¯¹è±¡æ¨¡å‹</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">document</span>.getElementById(id);<span class="hljs-built_in">document</span>.getElementsByTagName(name);<span class="hljs-built_in">document</span>.createElement(name);parentNode.appendChild(node);element.innerHTML;<span class="hljs-comment">//innerHTML ä»å¯¹è±¡èµ·å§‹ä½ç½®åˆ°ç»ˆæ­¢ä½ç½®çš„å…¨éƒ¨å†…å®¹ï¼ˆåŒ…æ‹¬htmlæ ‡ç­¾</span><span class="hljs-comment">//outerHTML åŒ…æ‹¬å¯¹è±¡è‡ªèº«æ ‡ç­¾</span><span class="hljs-comment">//innerText innerHTMLä½†ä¸åŒ…æ‹¬htmlæ ‡ç­¾ï¼Œ</span><span class="hljs-comment">//textContent æ‰€æœ‰æ–‡æœ¬å†…å®¹ï¼ŒåŒ…æ‹¬scriptå’Œstyleæ ‡ç­¾å†…</span>element.style.left;element.setAttribute();element.getAttribute();element.addEventListener();<span class="hljs-built_in">window</span>.content;<span class="hljs-built_in">window</span>.onload;<span class="hljs-built_in">window</span>.dump();<span class="hljs-built_in">window</span>.scrollTo();</code></pre></div><h2 id="jsä¸¥æ ¼æ¨¡å¼use-strict"><a href="#jsä¸¥æ ¼æ¨¡å¼use-strict" class="headerlink" title="jsä¸¥æ ¼æ¨¡å¼use strict"></a>jsä¸¥æ ¼æ¨¡å¼<code>use strict</code></h2><ol><li>æ— æ³•æ„å¤–åˆ›å»ºå…¨å±€å˜é‡</li><li>é™é»˜å¤±è´¥å°†ä¼šè¢«æŠ›å‡ºå¼‚å¸¸(ç»™ä¸å¯å†™å±æ€§èµ‹å€¼, ç»™åªè¯»å±æ€§èµ‹å€¼, ç»™ä¸å¯æ‰©å±•å¯¹è±¡çš„æ–°å±æ€§èµ‹å€¼,åˆ é™¤å¿…å¯åˆ é™¤çš„å±æ€§â€¦etc)</li><li>å‡½æ•°å‚æ•°åå”¯ä¸€</li><li>ç¦æ­¢ä½¿ç”¨<code>with</code></li><li><code>eval()</code>ä¼šæœ‰è‡ªå·±çš„ä½œç”¨åŸŸ</li><li>ç¦æ­¢åˆ é™¤å£°æ˜å˜é‡</li><li>ç¦æ­¢ä½¿ç”¨<code>.callee</code>å’Œ<code>.arguments</code></li><li>ä¿ç•™å…³é”®å­—</li><li>ç¦æ­¢äº†ä¸åœ¨è„šæœ¬æˆ–è€…å‡½æ•°å±‚é¢çš„å‡½æ•°å£°æ˜ <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) &#123;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params"></span>) </span>&#123; &#125; <span class="hljs-comment">// !!! è¯­æ³•é”™è¯¯</span>  f();&#125;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f2</span>(<span class="hljs-params"></span>) </span>&#123; &#125; <span class="hljs-comment">// !!! è¯­æ³•é”™è¯¯</span>  f2();&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">baz</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">// åˆæ³•</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">eit</span>(<span class="hljs-params"></span>) </span>&#123; &#125; <span class="hljs-comment">// åŒæ ·åˆæ³•</span>&#125;</code></pre></div></li></ol><h2 id="æ“ä½œå­—ç¬¦ä¸²"><a href="#æ“ä½œå­—ç¬¦ä¸²" class="headerlink" title="æ“ä½œå­—ç¬¦ä¸²"></a>æ“ä½œå­—ç¬¦ä¸²</h2><ul><li><code>charAt()</code> è¿”å›ç´¢å¼•ä½ç½®å­—ç¬¦</li><li><code>charCodeAt()</code>è¿”å›ç´¢å¼•ä½ç½®å­—ç¬¦UTF16ä»£ç </li><li></li><li><code>concat()</code> æ‹¼æ¥</li><li><code>indexOf()</code>, <code>lastIndexOf()</code> è¿”å›ç´¢å¼•</li><li><code>includes()</code> è¿”å›Boolean</li><li><code>match()</code> åŒ¹é…æ­£åˆ™</li><li><code>replace()</code> æ›¿æ¢</li><li><code>split()</code> åˆ†å‰²å­—ç¬¦ä¸²</li><li><code>slice()</code> æˆªå–è¿”å›æ–°å­—ç¬¦ä¸²ï¼Œä»¥ç´¢å¼•</li><li><code>substring()</code> //æˆªå–è¿”å›æ–°å­—ç¬¦ä¸²ï¼Œä»¥é•¿åº¦</li><li><code>trim()</code> //åˆ é™¤ç©ºæ ¼</li><li><code>toLowerCase(), toUpperCase()</code></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
      <tag>js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>webå®‰å…¨</title>
    <link href="/2022/02/24/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/"/>
    <url>/2022/02/24/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/</url>
    
    <content type="html"><![CDATA[<h2 id="åŒæºç­–ç•¥"><a href="#åŒæºç­–ç•¥" class="headerlink" title="åŒæºç­–ç•¥"></a>åŒæºç­–ç•¥</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><ul><li>ä¸¤ä¸ªURl <strong>!åŒåè®® !åŒåŸŸå !åŒç«¯å£</strong></li><li>åŒæºç­–ç•¥é™åˆ¶äº†åŒä¸€ä¸ªæºåŠ è½½çš„è„šæœ¬å’Œæ–‡æ¡£å¦‚ä½•ä¸å…¶ä»–æºçš„èµ„æºè¿›è¡Œäº¤äº’ï¼ŒåŒ…æ‹¬jsè„šæœ¬ï¼Œç¼“å­˜çš„è¯»å–ï¼Œcookieï¼Œajaxç­‰</li><li>ä¸‰ç§æ ‡ç­¾ä¸å—åŒæºé™åˆ¶<code>script</code> <code>link</code> <code>img</code></li></ul><h3 id="è·¨åŸŸçš„æ–¹æ³•"><a href="#è·¨åŸŸçš„æ–¹æ³•" class="headerlink" title="è·¨åŸŸçš„æ–¹æ³•"></a>è·¨åŸŸçš„æ–¹æ³•</h3><ul><li><p>ä»£ç†æœåŠ¡å™¨<code>nginx,å„ç§devServer</code></p></li><li><p><code>document.domain</code></p><p>å‰ææ˜¯ä¸¤ä¸ªé¡µé¢ä¸»è¦åŸŸç›¸åŒ</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-string">&#x27;someWebSite.com/dir1/pageA.html&#x27;</span><span class="hljs-string">&#x27;someWebSite.com/dir2/pageB.html&#x27;</span>éƒ½è®¾ç½®<span class="hljs-built_in">document</span>.domain = <span class="hljs-string">&#x27;someWebSite.com&#x27;</span>åˆ™ä»–ä»¬ä¹‹é—´é€šä¿¡å°†é€šè¿‡åŒæºæ£€æµ‹ï¼Œå¹¶éƒ½è®¿é—®çˆ¶æºçš„cookie</code></pre></div></li><li><p><code>window.name</code>  </p></li><li><p><code>postMessage</code></p><p>å¯¹æ–°æ‰“å¼€çš„çª—å£æˆ–è€…iframeçš„contentWindowå±æ€§ã€æ‰§è¡Œwindow.openè¿”å›çš„çª—å£å¯¹è±¡</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// pageAé€šè¿‡iframeåµŒå…¥äº†pageB</span><span class="hljs-comment">// pageAä¸­ä»£ç </span><span class="hljs-built_in">window</span>.iframe[i].postMessage(<span class="hljs-string">&#x27;data&#x27;</span>,<span class="hljs-string">&#x27;pageBçš„URL&#x27;</span>)<span class="hljs-comment">// pageBä¸­çš„ä»£ç </span><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&#x27;message&#x27;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(e.data)     <span class="hljs-comment">// data</span>    <span class="hljs-built_in">console</span>.log(e.source)   <span class="hljs-comment">// aä¸­windowçš„å¼•ç”¨</span>    <span class="hljs-built_in">console</span>.log(e.origin)  <span class="hljs-comment">// pageAçš„URL</span>&#125;,<span class="hljs-literal">false</span>)<span class="hljs-comment">// åè¿‡æ¥pageBå‘pageAå‘é€æ•°æ®</span><span class="hljs-comment">// åœ¨pageAä¸­åŠ å…¥window.addEventListener</span><span class="hljs-comment">// åœ¨pageBä¸­e.source.postMessage</span></code></pre></div></li><li><p><code>iframe</code>+<code>hash</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// pageAé€šè¿‡iframeåµŒå…¥äº†pageB</span><span class="hljs-keyword">var</span> B = <span class="hljs-built_in">document</span>.getElementByTagName(<span class="hljs-string">&quot;iframe&quot;</span>);B.src = B.src + <span class="hljs-string">&quot;#&quot;</span> + <span class="hljs-string">&quot;data&quot;</span>;<span class="hljs-comment">// pageBä¸­çš„ä»£ç </span><span class="hljs-built_in">window</span>.onhashchange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>&#123;data = <span class="hljs-built_in">window</span>.location.hash; <span class="hljs-comment">//  &lt;-  pageBå°±è·å–åˆ°äº†hashå€¼</span>&#125;;</code></pre></div></li><li><p><code>jsonp</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jsonp</span>(<span class="hljs-params">&#123; url, params, callback &#125;</span>) </span>&#123;  <span class="hljs-keyword">const</span> attrs = []  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> [key,value] <span class="hljs-keyword">of</span> <span class="hljs-built_in">Object</span>.entries(params))&#123;    attrs.push(<span class="hljs-string">`<span class="hljs-subst">$&#123;key&#125;</span>=<span class="hljs-subst">$&#123;value&#125;</span>`</span>)  &#125;  attrs.push(<span class="hljs-string">`callback=<span class="hljs-subst">$&#123;callback&#125;</span>`</span>)  url+= attrs.join(<span class="hljs-string">&#x27;&amp;&#x27;</span>)  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;    <span class="hljs-keyword">const</span> script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;script&#x27;</span>)    script.src = url    <span class="hljs-built_in">document</span>.body.appendChild(script);    <span class="hljs-keyword">try</span>&#123;      <span class="hljs-built_in">window</span>[callback] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>&#123;        resolve(data)        <span class="hljs-built_in">document</span>.removeChild(script)      &#125;    &#125;<span class="hljs-keyword">catch</span>(err)&#123;      reject(err)    &#125;  &#125;)&#125;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å‘é€</span>jsonp(&#123;url: <span class="hljs-string">&quot;http://localhost:3000/jsptest&quot;</span>,params: &#123; <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;jsptestmessage&quot;</span> &#125;,callback: <span class="hljs-string">&quot;jsonpCallback&quot;</span>&#125;).then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<span class="hljs-comment">//å¤„ç†data</span>    &#125;);</code></pre></div></li><li><p><code>imgPing</code><strong>æ·»åŠ imgæ ‡ç­¾srcä¸­æ”¾å…¥getè¯·æ±‚</strong></p><p>åªèƒ½å‘é€GETè¯·æ±‚ï¼Œæ— æ³•æ¥å—è¿”å›</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> img = <span class="hljs-keyword">new</span> Image();img.onload = img.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;å·²å‘é€&quot;</span>);&#125;;img.src = <span class="hljs-string">&quot;http://xxx.xxx.com/query?key=value&quot;</span>;<span class="hljs-comment">// è®¾ç½®å®Œsrcå±æ€§é‚£ä¸€åˆ»å¼€å§‹è¯·æ±‚å°±å‘é€äº†</span></code></pre></div></li><li><p><code>CORS</code>è·¨åŸŸèµ„æºå…±äº«ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰</p></li><li><p><code>websocket</code>åè®®</p></li><li><p><code>Fetch</code>API</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">postData</span>(<span class="hljs-params">url, data</span>) </span>&#123;<span class="hljs-comment">// Default options are marked with *</span>  <span class="hljs-keyword">return</span> fetch(url, &#123;      body: <span class="hljs-built_in">JSON</span>.stringify(data), <span class="hljs-comment">// must match &#x27;Content-Type&#x27; header</span>      <span class="hljs-comment">// ...</span>      mode: <span class="hljs-string">&quot;cors&quot;</span>, <span class="hljs-comment">// no-cors, cors, *same-origin</span>      <span class="hljs-comment">// ... </span>      &#125;).then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.json()); <span class="hljs-comment">// parses response to JSON</span>  &#125;</code></pre></div></li></ul><h3 id="CORSè·¨åŸŸ"><a href="#CORSè·¨åŸŸ" class="headerlink" title="CORSè·¨åŸŸ"></a><code>CORS</code>è·¨åŸŸ</h3><h4 id="ç®€å•è¯·æ±‚"><a href="#ç®€å•è¯·æ±‚" class="headerlink" title="ç®€å•è¯·æ±‚"></a>ç®€å•è¯·æ±‚</h4><ul><li>æ–¹æ³•<code>POST</code> <code>GET</code> <code>HEAD</code>,</li><li><code>Content-Type</code>ï¼šåªé™äºä¸‰ä¸ªå€¼<code>application/x-www-form-urlencoded</code>ã€<code>multipart/form-data</code>ã€<code>text/plain</code></li></ul><h5 id="è¯·æ±‚"><a href="#è¯·æ±‚" class="headerlink" title="è¯·æ±‚"></a>è¯·æ±‚</h5><ul><li><code>request header</code>ä¸­æ·»åŠ <code>Origin</code>å­—æ®µ</li></ul><h5 id="å“åº”"><a href="#å“åº”" class="headerlink" title="å“åº”"></a>å“åº”</h5><ul><li><p><code>Access-Control-Allow-Origin</code>:å…è®¸è·¨åŸŸè®¿é—®çš„åŸŸï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªåŸŸçš„åˆ—è¡¨ï¼Œä¹Ÿå¯ä»¥æ˜¯é€šé…ç¬¦â€*â€œ</p></li><li><p><code>Access-Control-Allow-Credentials</code>:æ˜¯å¦å…è®¸è¯·æ±‚å¸¦æœ‰ cookie</p><p>å¦‚æœè¦å‘é€<code>Cookie</code>ï¼Œ<code>Access-Control-Allow-Origin</code>å°±ä¸èƒ½è®¾ä¸ºæ˜Ÿå·ï¼Œå¿…é¡»æŒ‡å®šæ˜ç¡®çš„ã€ä¸è¯·æ±‚ç½‘é¡µä¸€è‡´çš„åŸŸå</p><p>å¹¶ä¸” ajax ä¸­è¦æ‰“å¼€</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();xhr.withCredentials = <span class="hljs-literal">true</span>;  <span class="xml">&lt;-------</span></code></pre></div></li><li><p><code>Access-Control-Expose-Headers</code>: è‡ªå®šä¹‰å­—æ®µ</p></li></ul><h4 id="éç®€å•è¯·æ±‚"><a href="#éç®€å•è¯·æ±‚" class="headerlink" title="éç®€å•è¯·æ±‚"></a>éç®€å•è¯·æ±‚</h4><ul><li>éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯<code>PUT</code>æˆ–<code>DELETE</code>ï¼Œæˆ–è€…<code>Content-Type</code>å­—æ®µçš„ç±»å‹æ˜¯<code>application/json</code></li><li>æ­£å¼é€šä¿¡å‰ä¼šå…ˆå‘èµ·â€é¢„æ£€â€è¯·æ±‚</li><li>ä¸€æ—¦æœåŠ¡å™¨é€šè¿‡äº†â€é¢„æ£€â€è¯·æ±‚ï¼Œä»¥åæ¯æ¬¡æµè§ˆå™¨æ­£å¸¸çš„ CORS è¯·æ±‚ï¼Œå°±éƒ½è·Ÿç®€å•è¯·æ±‚ä¸€æ ·</li></ul><h5 id="è¯·æ±‚-1"><a href="#è¯·æ±‚-1" class="headerlink" title="è¯·æ±‚"></a>è¯·æ±‚</h5><ul><li><code>OPTIONS</code>è¯·æ±‚å‘é€é¢„æ£€è¯·æ±‚</li><li><code>Origin</code>æ¥æºåŸŸ</li><li><code>Access-Control-Request-Method</code>æ¥ä¸‹æ¥è¯·æ±‚çš„æ–¹æ³•</li><li><code>Access-Control-Request-Headers</code>è‡ªå®šä¹‰é¦–éƒ¨</li></ul><h5 id="å“åº”-1"><a href="#å“åº”-1" class="headerlink" title="å“åº”"></a>å“åº”</h5><ul><li><code>Access-Control-Allow-Origin</code>å…è®¸è·¨åŸŸè®¿é—®çš„åŸŸ</li><li><code>Access-Control-Allow-Methods</code>æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰è·¨åŸŸè¯·æ±‚çš„æ–¹æ³•</li><li><code>Access-Control-Max-Age</code>é¢„æ£€è¯·æ±‚æœ‰æ•ˆæœŸ</li><li><code>Access-Control-Allow-Credentials</code>ä¸ç®€å•è¯·æ±‚ç›¸åŒ</li></ul><h2 id="è·¨é¡µé¢é€šä¿¡"><a href="#è·¨é¡µé¢é€šä¿¡" class="headerlink" title="è·¨é¡µé¢é€šä¿¡"></a>è·¨é¡µé¢é€šä¿¡</h2><ul><li>é€æ˜<code>iframe</code>+<code>postMessage</code></li><li><code>service worker</code>+<code>postMessage</code></li><li>ä½¿ç”¨<code>localStorage</code>çš„å›è°ƒç›‘å¬å˜åŒ–<code>window.addEventListener(&#39;storage&#39;, e=&gt;e.key)</code></li></ul><h2 id="XSSè·¨åŸŸè„šæœ¬æ”»å‡»"><a href="#XSSè·¨åŸŸè„šæœ¬æ”»å‡»" class="headerlink" title="XSSè·¨åŸŸè„šæœ¬æ”»å‡»"></a>XSSè·¨åŸŸè„šæœ¬æ”»å‡»</h2><p><code>Cross-site scripting</code></p><blockquote><p>æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹ä¸­æ‰§è¡Œäº†é¢„æœŸå¤–çš„æ¶æ„ä»£ç </p></blockquote><blockquote><p>XSSåˆ©ç”¨webå¼€å‘è¿‡ç¨‹ä¸­çš„æ¼æ´æ‰§è¡Œæ”»å‡»</p></blockquote><ul><li><p>å­˜å‚¨å‹XSS</p><p>  input, textareaç­‰ï¼‰ä¸­å†™å…¥æ¶æ„è„šæœ¬ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå…¶ä»–äººä¸‹è½½å¸¦æœ‰è¯¥è„šæœ¬çš„htmlé¡µé¢è‡³æµè§ˆå™¨æ—¶è„šæœ¬è¿è¡Œ</p></li><li><p>åå°„å‹XSS</p><p>  å°†æ¶æ„ä»£ç åŠ å…¥<code>URL</code>ä¸­æäº¤ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è¿”å›å†…å®¹å°±å¸¦ä¸Šäº†æ¶æ„ä»£ç ï¼Œæµè§ˆå™¨ä¸‹è½½é¡µé¢åˆ™æ‰§è¡Œäº†æ¶æ„ä»£ç ï¼ŒæœåŠ¡å™¨ä¸å­˜å‚¨æ¶æ„ä»£ç </p></li><li><p>DOM XSS</p><ul><li>JavaScript çš„ <code>eval()</code>ã€<code>setTimeout()</code>ã€<code>setInterval()</code> ç­‰å‡½æ•°</li><li><code>&lt;a&gt;</code>æ ‡ç­¾çš„<code>href</code>å±æ€§</li><li>DOMä¸­çš„å†…è”äº‹ä»¶ç›‘è§†å™¨,<code>location</code>,<code>onclick</code>,<code>onerror</code>,<code>onload</code>ç­‰</li><li>éƒ½å¯ä»¥å°†å­—ç¬¦ä¸²ä½œä¸ºä»£ç æ‰§è¡Œ</li></ul></li></ul><h3 id="é˜²èŒƒXSS"><a href="#é˜²èŒƒXSS" class="headerlink" title="é˜²èŒƒXSS"></a>é˜²èŒƒXSS</h3><ul><li><p>ä½¿ç”¨å†…å®¹å®‰å…¨ç­–ç•¥CSP<code>Content Security Policy</code>,é™åˆ¶è¯¥é¡µé¢å¯ä»¥è·å–çš„èµ„æºå’Œæ¥æº</p></li><li><p>å¯¹æ‰€æœ‰ç”¨æˆ·æäº¤å†…å®¹è¿›è¡Œå¯é çš„è¾“å…¥éªŒè¯ï¼ŒåŒ…æ‹¬URLã€æŸ¥è¯¢å…³é”®å­—ã€HTTPå¤´ã€REFERã€POSTæ•°æ®ç­‰</p></li><li><p>ä»»ä½•å†…å®¹è¾“å‡ºåˆ°é¡µé¢ä¹‹å‰éƒ½å¿…é¡»åŠ ä»¥<code>en-code</code>ç¼–ç ï¼Œé¿å…ç”Ÿæˆæ„å¤–çš„htmlæ ‡ç­¾ï¼›</p></li><li><p><code>cookie</code> å†…ä¸å­˜å‚¨æ•æ„Ÿä¿¡æ¯å¦‚è´¦å·å¯†ç ç­‰ï¼Œå¹¶è®¾æ–½<code>http only</code></p></li></ul><h2 id="CSRFè·¨åŸŸè¯·æ±‚ä¼ªé€ "><a href="#CSRFè·¨åŸŸè¯·æ±‚ä¼ªé€ " class="headerlink" title="CSRFè·¨åŸŸè¯·æ±‚ä¼ªé€ "></a>CSRFè·¨åŸŸè¯·æ±‚ä¼ªé€ </h2><p><code>Cross-site request forgery</code></p><blockquote><p>åˆ©ç”¨ç”¨æˆ·ç™»å½•æ€</p></blockquote><h3 id="é˜²å¾¡CSRF"><a href="#é˜²å¾¡CSRF" class="headerlink" title="é˜²å¾¡CSRF"></a>é˜²å¾¡CSRF</h3><ul><li>éªŒè¯<code>http</code>è¯·æ±‚çš„æ¥æº<code>origin</code>å’Œ<code>referrer</code></li><li>è®¾ç½®<code>cookie</code>çš„<code>SameSite</code>å±æ€§ï¼Œä½¿<code>cookie</code>åªå¯è¢«ç¬¬ä¸€æ–¹ä½¿ç”¨</li><li>è®¾ç½®å®¢æˆ·ç«¯è¯·æ±‚æºå¸¦<code>session token</code>ï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯éªŒè¯<code>token</code></li><li>éªŒè¯ç  </li></ul><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h4 id="SQlæ³¨å…¥"><a href="#SQlæ³¨å…¥" class="headerlink" title="SQlæ³¨å…¥"></a>SQlæ³¨å…¥</h4><ol><li><p>é»‘å®¢æäº¤ç•¸å½¢æ•°æ®æ”¹å˜è¯­ä¹‰æäº¤sqlæŸ¥è¯¢å¾—åˆ°éæ³•æ•°æ®</p></li><li><p>é˜²å¾¡</p><ol><li>è¿‡æ»¤sqlä¿ç•™å­—</li><li>å‡å°‘æŠ›å‡ºä¸å¿…è¦çš„æ•°æ®åº“é”™è¯¯ä¿¡æ¯</li><li>ç¦æ­¢åŠ¨æ€æ‹¼æ¥sqlè¯­å¥è®¿é—®æ•°æ®åº“</li></ol></li></ol><h4 id="ç‚¹å‡»åŠ«æŒ"><a href="#ç‚¹å‡»åŠ«æŒ" class="headerlink" title="ç‚¹å‡»åŠ«æŒ"></a>ç‚¹å‡»åŠ«æŒ</h4><ol><li>ç‚¹å‡»é€æ˜iframe</li><li>ç›‘å¬é¼ æ ‡ç§»åŠ¨ä½ç½®</li><li>H5æ‹–æ‹½</li><li>é˜²å¾¡ï¼š<ol><li>æœåŠ¡ç«¯æ·»åŠ  <code>X-Frame-Options</code> å“åº”å¤´</li><li>jsåˆ¤æ–­é¡¶å±‚è§†å£æ˜¯å¦åŒæº</li><li>æ•æ„Ÿæ“ä½œå¤æ‚æ“ä½œï¼ˆéªŒè¯ç ï¼ŒäºŒæ¬¡ç¡®è®¤</li></ol></li></ol><h4 id="window-opener"><a href="#window-opener" class="headerlink" title="window.opener"></a><code>window.opener</code></h4><ol><li>ä¿®æ”¹<code>window.opener.location</code>å¯ä»¥æ”¹å†™æ¥æºç«™ç‚¹çš„åœ°å€</li><li>é˜²å¾¡ï¼š<ol><li>è®¾ç½®aæ ‡ç­¾çš„relå±æ€§<code>rel=noopener</code>,ç¦æ­¢æ–°é¡µé¢ä¼ é€’æºé¡µé¢åœ°å€</li><li>å¤–éƒ¨é“¾æ¥æ”¹ä¸ºç»ç”±æœåŠ¡å™¨è·³è½¬</li><li>ä½¿ç”¨window.openæ‰“å¼€å¤–é“¾</li></ol></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å †åŠç›¸å…³ç®—æ³•</title>
    <link href="/2022/02/24/%E5%A0%86/"/>
    <url>/2022/02/24/%E5%A0%86/</url>
    
    <content type="html"><![CDATA[<h2 id="å †"><a href="#å †" class="headerlink" title="å †"></a>å †</h2><ul><li><p>å †å°±æ˜¯å®Œå…¨äºŒå‰æ ‘</p><div class="hljs code-wrapper"><pre><code class="hljs">å®Œå…¨äºŒå‰æ ‘ï¼šé™¤äº†æ·±åº¦æœ€æ·±çš„ä¸€å±‚å¤–æ‰€æœ‰å±‚èŠ‚ç‚¹æ•°éƒ½æ»¡å‘˜æ·±åº¦ï¼šä»æ ¹èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹ç»å†çš„èŠ‚ç‚¹ä¸ªæ•°</code></pre></div></li><li><p>æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ¯”å·¦å³å­èŠ‚ç‚¹å¤§â€“&gt;æœ€å¤§å †ï¼Œæœ€å¤§å€¼åœ¨æ ¹èŠ‚ç‚¹</p></li><li><p>æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ¯”å·¦å³å­èŠ‚ç‚¹å°â€“&gt;æœ€å°å †ï¼Œæœ€å°å€¼åœ¨æ ¹èŠ‚ç‚¹</p></li><li><p>å®Œå…¨äºŒå‰æ ‘å¯ä»¥ä½¿ç”¨æ•°ç»„æ¥å­˜å‚¨</p></li></ul><h3 id="å»ºç«‹å †"><a href="#å»ºç«‹å †" class="headerlink" title="å»ºç«‹å †"></a>å»ºç«‹å †</h3><ul><li>å°†èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹æ¯”è¾ƒ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//å°é¡¶å †</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildHeap</span>(<span class="hljs-params">items,heapSize</span>)</span>&#123;  <span class="hljs-keyword">while</span>(heapSize&lt;items.length - <span class="hljs-number">1</span>)&#123;  <span class="hljs-comment">// items ç¬¬ä¸€ä¸ªæ˜¯&lt;empty item&gt;</span>    heapSize++    heapify(items,heapSize)  &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heapify</span>(<span class="hljs-params">items,i</span>)</span>&#123;  <span class="hljs-keyword">while</span>(<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>) &gt; <span class="hljs-number">0</span> &amp;&amp; items[i] &lt; items[<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)])&#123;    [items[i],items[<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)]] =  [items[<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)],items[i]]    <span class="hljs-comment">// äº¤æ¢ä½ç½®</span>    i = <span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)  &#125; &#125;</code></pre></div><ul><li>å°†èŠ‚ç‚¹ä¸å­èŠ‚ç‚¹æ¯”è¾ƒ</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//å¤§é¡¶å †</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildHeap</span>(<span class="hljs-params">items</span>)</span>&#123;  <span class="hljs-keyword">const</span> heapSize = items.length - <span class="hljs-number">1</span>  <span class="hljs-comment">// &lt;-- items.length - 1 !</span>  <span class="hljs-comment">// æœ€åå¶å­èŠ‚ç‚¹çš„ç´¢å¼•å€¼</span>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-built_in">Math</span>.floor(heapSize/<span class="hljs-number">2</span>) ; i &gt;= <span class="hljs-number">1</span> ; i--)&#123; <span class="hljs-comment">// &lt;-i&gt;=1 !</span>    <span class="hljs-comment">// i ä¸ºæœ€åä¸€ä¸ªé å¶å­ èŠ‚ç‚¹çš„ç´¢å¼•ï¼Œiè¿˜æœ‰å­èŠ‚ç‚¹</span>    heapify(items,heapSize,i)  &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heapify</span>(<span class="hljs-params">items, heapSize, i</span>) </span>&#123;  <span class="hljs-comment">// è‡ªä¸Šè€Œä¸‹å¼å †åŒ–</span>  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;      <span class="hljs-keyword">var</span> maxIndex = i;      <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i &lt;= heapSize &amp;&amp; items[maxIndex] &lt; items[i*<span class="hljs-number">2</span>] ) &#123;        <span class="hljs-comment">// è¿™é‡Œçš„ç­‰å·æ„å‘³ç€ä¸‡ä¸€è¿™ä¸ªèŠ‚ç‚¹æ˜¯æœ€åçš„èŠ‚ç‚¹å‘¢</span>          maxIndex = i*<span class="hljs-number">2</span>;      &#125;      <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span> &lt;= heapSize &amp;&amp; items[maxIndex] &lt; items[i*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>] ) &#123;          maxIndex = i*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>;      &#125;      <span class="hljs-keyword">if</span> (maxIndex === i) <span class="hljs-keyword">break</span>;      [items[i],items[maxIndex]] = [items[maxIndex],items[i]]      i = maxIndex;   &#125;&#125;</code></pre></div><h3 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h3><ol><li>å»ºç«‹å¤§é¡¶å †/å°é¡¶å †</li><li>åˆ™ç´¢å¼•1ä½ç½®ä¸ºå½“å‰å †çš„ æœ€å¤§å€¼/æœ€å°å€¼</li><li>å¾ªç¯å°†[1]ä¸[æœ«å°¾]äº¤æ¢ä½ç½®ï¼Œå¹¶ä¸”ç¼©å°å †çš„å¤§å°ï¼ˆç›¸å½“äºå°†ä¸Šä¸€æ¬¡çš„æœ€å€¼ç§»å‡ºå †ï¼‰</li><li>ä¸€ç›´å †åŒ–</li><li>å¤§é¡¶å †å¾—åˆ°å‡åº / å°é¡¶å †å¾—åˆ°é™åºæ’åˆ—</li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heapSort</span>(<span class="hljs-params">arr</span>)</span>&#123;  <span class="hljs-comment">// è¾“å…¥éœ€è¦ä¸º[,]</span>  <span class="hljs-comment">// const heap = [,]</span>  <span class="hljs-comment">// let i = 0</span>  <span class="hljs-comment">// while(i&lt;arr.length)&#123;</span>  <span class="hljs-comment">//   heap.push(arr[i++])</span>  <span class="hljs-comment">// &#125;</span>  <span class="hljs-keyword">const</span> heapSize  =  arr.length - <span class="hljs-number">1</span>  buildHeap(arr,heapSize)    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = heapSize ; i&gt;<span class="hljs-number">1</span> ;i--)&#123;    [arr[i],arr[<span class="hljs-number">1</span>]]=[arr[<span class="hljs-number">1</span>],arr[i]]    heapSize --    heapify(arr,heapSize,<span class="hljs-number">1</span>)  &#125;  <span class="hljs-keyword">return</span> arr&#125;</code></pre></div><h3 id="topKé—®é¢˜"><a href="#topKé—®é¢˜" class="headerlink" title="topKé—®é¢˜"></a>topKé—®é¢˜</h3><p>æ±‚å‡ºå‰kä¸ªæœ€å¤§/æœ€å°å€¼ï¼Œæˆ–è€…å‡ºç°æ¬¡æ•°æœ€å¤š/æœ€å°‘çš„kä¸ªå€¼</p><ul><li>æ±‚å¤§å€¼ï¼Œå»ºç«‹æœ€å°å †</li><li>æ±‚å°å€¼ï¼Œå»ºç«‹æœ€å¤§å †<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// æ¯”å¦‚æ±‚å‰kä¸ªæœ€å¤§å€¼</span><span class="hljs-comment">// å…ˆç”¨å‰kä¸ªæ•°æ®å»ºç«‹å°é¡¶å †</span><span class="hljs-comment">// ä¸ºä»€ä¹ˆæ±‚å‰kå¤§å»ºç«‹å°é¡¶å †ï¼Ÿï¼Ÿï¼Ÿ</span><span class="hljs-comment">// å¦‚æœå»ºç«‹å¤§é¡¶å †ï¼Œäº¤æ¢å †é¡¶åï¼Œå †é¡¶ä¾ç„¶æ˜¯æœ€å¤§çš„ï¼Œä¾æ¬¡æ¯”è¾ƒä¹‹åçš„æ•°æ®åªä¼šæ”¹å˜å †é¡¶è€Œå·²ï¼Œæ”¶é›†ä¸äº†åˆ«çš„å€¼</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">topK</span>(<span class="hljs-params">data,k</span>)</span>&#123;  <span class="hljs-keyword">let</span> heap = [,...data]  <span class="hljs-keyword">const</span> heapSize = k  buildHeap(heap,heapSize)  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j = k ; j &lt;data.length ;j++)&#123;    <span class="hljs-comment">// å°†ä½™ä¸‹çš„æ•°æ®ä¾æ¬¡ä¸å †é¡¶æ¯”è¾ƒ</span>    <span class="hljs-comment">// æ¯”å°é¡¶å †çš„å †é¡¶å¤§åˆ™äº¤æ¢</span>    <span class="hljs-keyword">if</span>(heap[<span class="hljs-number">1</span>] &lt; data[j])&#123;      heap[<span class="hljs-number">1</span>] = data[j]      heapify(heap,k,<span class="hljs-number">1</span>)    &#125;  &#125;  heap.shift()  <span class="hljs-keyword">return</span> heap&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildHeap</span>(<span class="hljs-params">items ,heapSize</span>)</span>&#123;  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-built_in">Math</span>.floor(heapSize/<span class="hljs-number">2</span>) ; i &gt;= <span class="hljs-number">1</span> ; i--)&#123;    heapify(items,heapSize,i)  &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heapify</span>(<span class="hljs-params">items,heapSize,i</span>)</span>&#123;  <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;    <span class="hljs-keyword">let</span> minIndex = i    <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i &lt;= heapSize &amp;&amp; items[minIndex] &gt; items[i*<span class="hljs-number">2</span>] ) &#123;        <span class="hljs-comment">// è¿™é‡Œçš„ç­‰å·æ„å‘³ç€ä¸‡ä¸€è¿™ä¸ªèŠ‚ç‚¹æ˜¯æœ€åçš„èŠ‚ç‚¹å‘¢</span>        minIndex = i*<span class="hljs-number">2</span>;      &#125;      <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span> &lt;= heapSize &amp;&amp; items[minIndex] &gt; items[i*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>] ) &#123;        minIndex = i*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>;      &#125;      <span class="hljs-keyword">if</span> (minIndex === i) <span class="hljs-keyword">break</span>;      [items[i],items[minIndex]] = [items[minIndex],items[i]]      i = minIndex;   &#125;&#125;</code></pre></div></li></ul><h3 id="ä¸­ä½æ•°é—®é¢˜"><a href="#ä¸­ä½æ•°é—®é¢˜" class="headerlink" title="ä¸­ä½æ•°é—®é¢˜"></a>ä¸­ä½æ•°é—®é¢˜</h3><p><code>n</code>ä¸ªæ•°æ®ä¸­çš„ä¸­ä½æ•°</p><div class="hljs code-wrapper"><pre><code class="hljs">  [1,2,3] =&gt; 2  [1,2,3,4] =&gt; 2,3  å½“ n % 2 !== 0 æ—¶ï¼Œä¸­ä½æ•°ä¸ºï¼šarr[(n-1)/2]  å½“ n % 2 === 0 æ—¶ï¼Œä¸­ä½æ•°ä¸ºï¼šarr[n/2], arr[n/2 + 1]</code></pre></div><ul><li><p>å°†å‰<code>n/2//å¶æ•°</code>||<code>ï¼ˆMath.floor(n/2)ï¼‰+ 1//å¥‡æ•°</code>å †åŒ–ä¸ºå¤§é¡¶å †ï¼Œå<code>Math.floor(n/2)</code>å †åŒ–ä¸ºå°é¡¶å †ã€‚</p></li><li><p>ç»“æœåˆ†åˆ«ä¸ºä¸¤ä¸ªå †é¡¶<code>å¶æ•°</code>/å‰é¢çš„å †é¡¶<code>å¥‡æ•°</code></p></li><li><p>åŠ¨æ€æ•°ç»„ï¼Œåˆ™æŠŠæ’å…¥çš„æ•°æ®ä¸å †é¡¶æ¯”è¾ƒ</p><ul><li>ã€å‡åºã€‘å¤§äºå¤§é¡¶å †çš„é¡¶åˆ™åŠ å…¥å°é¡¶å †</li><li>ã€é™åºã€‘å°äºå°é¡¶å †åˆ™åŠ å…¥å¤§é¡¶å †</li><li> åŠ å…¥åå†æ¬¡å †åŒ–ï¼Œå¦‚æœå †å¤§å°ä¸æ»¡è¶³åˆ†å‰²ä¸­ä½æ•°è¦æ±‚åˆ™ç»§ç»­è°ƒæ•´</li></ul></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Median</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-built_in">this</span>.maxHeap = <span class="hljs-keyword">new</span> MaxHeap()  <span class="hljs-built_in">this</span>.minHeap = <span class="hljs-keyword">new</span> MinHeap()&#125;Median.prototype.addNum = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">num</span>)</span>&#123;  <span class="hljs-keyword">if</span>(num &lt; <span class="hljs-built_in">this</span>.maxHeap.getTop() || !<span class="hljs-built_in">this</span>.maxHeap.getSize())&#123;    <span class="hljs-built_in">this</span>.maxHeap.insert(num)  &#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-built_in">this</span>.minHeap.insert(num)  &#125;  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.maxHeap.getSize() - <span class="hljs-built_in">this</span>.minHeap.getSize() &gt; <span class="hljs-number">1</span>)&#123;    <span class="hljs-comment">//å¥‡æ•°åˆ†å¸ƒ</span>    <span class="hljs-comment">//å¤§é¡¶å †sizeæ¯”å°é¡¶å †å¤§1</span>    <span class="hljs-built_in">this</span>.minHeap.insert(<span class="hljs-built_in">this</span>.maxHeap.rmTop())    <span class="hljs-comment">//ä¸ç¬¦åˆåˆ™å¤§é¡¶å †é¡¶æ’å…¥å°é¡¶å †</span>  &#125;  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.minHeap.getSize() &gt; <span class="hljs-built_in">this</span>.maxHeap.getSize())&#123;    <span class="hljs-built_in">this</span>.maxHeap.insert(<span class="hljs-built_in">this</span>.minHeap.rmTop())    <span class="hljs-comment">// </span>  &#125;&#125;Median.prototype.getMedianNum = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-comment">// return console.log(this.maxHeap.getSize());</span>  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.maxHeap.getSize() &amp;&amp; <span class="hljs-built_in">this</span>.maxHeap.getSize() === <span class="hljs-built_in">this</span>.minHeap.getSize())&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">this</span>.maxHeap.getTop() + <span class="hljs-built_in">this</span>.minHeap.getTop())/<span class="hljs-number">2</span>  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.maxHeap.getTop()&#125;<span class="hljs-comment">// å¤§é¡¶å †</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MaxHeap</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">const</span> heap = [,]  <span class="hljs-built_in">this</span>.getSize = <span class="hljs-function">() =&gt;</span> heap.length - <span class="hljs-number">1</span>  <span class="hljs-built_in">this</span>.getTop = <span class="hljs-function">() =&gt;</span> heap.length &gt; <span class="hljs-number">1</span> ? heap[<span class="hljs-number">1</span>] : <span class="hljs-literal">null</span>  <span class="hljs-built_in">this</span>.insert = <span class="hljs-function"><span class="hljs-params">num</span> =&gt;</span> &#123;    <span class="hljs-comment">//æ’å…¥å¼å»ºå †</span>    heap.push(num)    <span class="hljs-keyword">let</span> i = heap.length - <span class="hljs-number">1</span>    <span class="hljs-comment">// push è¿›å»çš„ç´¢å¼•</span>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)&gt;<span class="hljs-number">0</span> &amp;&amp; heap[i] &gt; heap[<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)])&#123;      <span class="hljs-comment">// å¤§é¡¶å †ï¼Œä¸çˆ¶èŠ‚ç‚¹æ¯”è¾ƒï¼Œå¤§äºåˆ™äº¤æ¢</span>      [heap[i],heap[<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)]] = [heap[<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)],heap[i]]      i = <span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)    &#125;  &#125;  <span class="hljs-built_in">this</span>.rmTop = <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">if</span>(!heap.length &gt; <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>    <span class="hljs-keyword">if</span>(heap.length === <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> heap.pop()    <span class="hljs-keyword">const</span> num = heap[<span class="hljs-number">1</span>]    heap[<span class="hljs-number">1</span>] = heap.pop()<span class="hljs-comment">// æ‹¿èµ°äº†topå€¼ï¼Œå¹¶ç”¨æœ«å°¾èŠ‚ç‚¹å¡«å……</span>    heapify(<span class="hljs-number">1</span>)    <span class="hljs-keyword">return</span> num  &#125;  <span class="hljs-keyword">const</span> heapify = <span class="hljs-function"><span class="hljs-params">i</span> =&gt;</span> &#123;    <span class="hljs-comment">// å †åŒ–</span>    <span class="hljs-keyword">const</span> heapSize = heap.length - <span class="hljs-number">1</span>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;      <span class="hljs-keyword">let</span> maxIndex = i      <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*<span class="hljs-number">1</span> &lt;= heapSize &amp;&amp; heap[<span class="hljs-number">2</span>*i] &gt; heap[i]) maxIndex = <span class="hljs-number">2</span>*i      <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span> &lt;= heapSize &amp;&amp; heap[<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>] &gt; heap[maxIndex]) maxIndex = <span class="hljs-number">2</span>*i+<span class="hljs-number">1</span> <span class="hljs-comment">// !!!!!!</span>      <span class="hljs-keyword">if</span>(maxIndex === i) <span class="hljs-keyword">break</span>      [heap[i],heap[maxIndex]] = [heap[maxIndex],heap[i]]      <span class="hljs-comment">// é‡æ–°èµ‹å€¼iå¼€å§‹ä¸‹çº§å¾ªç¯</span>      i = maxIndex    &#125;  &#125;&#125;<span class="hljs-comment">// å°é¡¶å †</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MinHeap</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">const</span> heap = [,]  <span class="hljs-built_in">this</span>.getSize = <span class="hljs-function">() =&gt;</span> heap.length - <span class="hljs-number">1</span>  <span class="hljs-built_in">this</span>.getTop = <span class="hljs-function">() =&gt;</span> heap.length &gt; <span class="hljs-number">1</span> ? heap[<span class="hljs-number">1</span>] : <span class="hljs-literal">null</span>  <span class="hljs-built_in">this</span>.insert = <span class="hljs-function"><span class="hljs-params">num</span> =&gt;</span> &#123;    heap.push(num)    <span class="hljs-keyword">let</span> i = heap.length - <span class="hljs-number">1</span>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)&gt;<span class="hljs-number">0</span> &amp;&amp; heap[i] &lt; heap[<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)])&#123;      <span class="hljs-comment">// å°é¡¶å †ï¼Œä¸çˆ¶èŠ‚ç‚¹æ¯”è¾ƒï¼Œå°äºåˆ™äº¤æ¢</span>      [heap[i],heap[<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)]] = [heap[<span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)],heap[i]]      i = <span class="hljs-built_in">Math</span>.floor(i/<span class="hljs-number">2</span>)    &#125;  &#125;  <span class="hljs-built_in">this</span>.rmTop = <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-keyword">if</span>(!heap.length&gt;<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>    <span class="hljs-keyword">if</span>(heap.length === <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> heap.pop()    <span class="hljs-keyword">const</span> num = heap[<span class="hljs-number">1</span>]    heap[<span class="hljs-number">1</span>] = heap.pop()    heapify(<span class="hljs-number">1</span>)    <span class="hljs-keyword">return</span> num  &#125;  <span class="hljs-keyword">const</span> heapify = <span class="hljs-function"><span class="hljs-params">i</span> =&gt;</span> &#123;    <span class="hljs-keyword">const</span> heapSize = heap.length - <span class="hljs-number">1</span>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;      <span class="hljs-keyword">let</span> minIndex = i      <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*<span class="hljs-number">1</span> &lt;= heapSize &amp;&amp; heap[<span class="hljs-number">2</span>*i] &lt; heap[i]) minIndex = <span class="hljs-number">2</span>*i      <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span> &lt;= heapSize &amp;&amp; heap[<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>] &lt; heap[minIndex]) minIndex = <span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>      <span class="hljs-keyword">if</span>(minIndex === i) <span class="hljs-keyword">break</span>      [heap[i],heap[minIndex]] = [heap[minIndex],heap[i]]      <span class="hljs-comment">// é‡æ–°èµ‹å€¼iå¼€å§‹ä¸‹çº§å¾ªç¯</span>      i = minIndex    &#125;  &#125;&#125;<span class="hljs-comment">// äºŒåˆ†æŸ¥æ‰¾æ³•</span><span class="hljs-keyword">const</span> MedianFinder = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-built_in">this</span>.data = []&#125;MedianFinder.prototype.addMun = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">num</span>)</span>&#123;  <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">this</span>.data  <span class="hljs-keyword">if</span>(data.length&lt;<span class="hljs-number">1</span>)&#123;    data.push(num)    <span class="hljs-keyword">return</span>   &#125;  <span class="hljs-keyword">let</span> L = <span class="hljs-number">0</span>  <span class="hljs-keyword">let</span> R = data.length - <span class="hljs-number">1</span>  <span class="hljs-keyword">while</span>(L&lt;=R)&#123;    <span class="hljs-keyword">let</span> M = <span class="hljs-built_in">Math</span>.floor((L+R)/<span class="hljs-number">2</span>)    <span class="hljs-keyword">if</span>(data[M]===num)&#123;      data.splice(M,<span class="hljs-number">0</span>,num)      <span class="hljs-keyword">return</span>     &#125;    <span class="hljs-keyword">if</span>(data[M]&lt;num)&#123;      L ++    &#125;<span class="hljs-keyword">else</span>&#123;      R --    &#125;  &#125;  data.splice(R+<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,num)&#125;MedianFinder.prototype.findMedian = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-keyword">const</span> len = <span class="hljs-built_in">this</span>.data.length  <span class="hljs-keyword">if</span>(!len) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>  <span class="hljs-keyword">const</span> mid = <span class="hljs-built_in">Math</span>.floor((len-<span class="hljs-number">1</span>)/<span class="hljs-number">2</span>)  <span class="hljs-keyword">if</span>(len%<span class="hljs-number">2</span>===<span class="hljs-number">0</span>)&#123;    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">this</span>.data[mid]+ <span class="hljs-built_in">this</span>.data[mid+<span class="hljs-number">1</span>])/<span class="hljs-number">2</span>  &#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.data[mid]  &#125;&#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œå­—ç¬¦ä¸²ç®—æ³•é¢˜</title>
    <link href="/2022/02/24/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E5%85%B3%E7%AE%97%E6%B3%95%E9%A2%98/"/>
    <url>/2022/02/24/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E5%85%B3%E7%AE%97%E6%B3%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<ul><li>  å¯»æ‰¾æœ€é•¿å…¬å…¬å‰ç¼€</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// è¾“å…¥: [&quot;flower&quot;,&quot;flow&quot;,&quot;flight&quot;]</span><span class="hljs-comment">// è¾“å‡º: &quot;fl&quot;</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">commonPrefix</span>(<span class="hljs-params">...str</span>) </span>&#123;<span class="hljs-keyword">if</span> (!str.length || str.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<span class="hljs-keyword">let</span> ref = str[<span class="hljs-number">0</span>];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; str.length; i++) &#123;<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (; j &lt; ref.length &amp;&amp; j &lt; str[i].length; j++) &#123;<span class="hljs-keyword">if</span> (ref.chartAt(j) !== str[i].chartAt(j)) <span class="hljs-keyword">break</span>;&#125;ref = ref.subString(<span class="hljs-number">0</span>, j);&#125;<span class="hljs-keyword">return</span> ref;&#125;</code></pre></div><ul><li>  è¿å­—ç¬¦è½¬ä¸ºé©¼å³°</li></ul><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> toCamelCase = <span class="hljs-function">(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>) =&gt;</span> str.replace(<span class="hljs-regexp">/-\w/g</span>, <span class="hljs-function">(<span class="hljs-params">$</span>) =&gt;</span> $.slice(<span class="hljs-number">1</span>).toUpperCase());</code></pre></div><ul><li>  å°†å­—ç¬¦ä¸²æ”¹ä¸ºé¦–å­—æ¯å¤§å†™</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// -i-hate -_you_</span><span class="hljs-comment">// \båŒ¹é…å•è¯è¾¹ç•Œ</span><span class="hljs-comment">// åŠ ä¸Šåˆ¤æ–­æ˜¯å¦ä¼šæœ‰ä¸‹åˆ’çº¿</span><span class="hljs-comment">// \w å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿</span><span class="hljs-keyword">const</span> firstUpper = <span class="hljs-function">(<span class="hljs-params">str: string</span>) =&gt;</span> str.replace(<span class="hljs-regexp">/\b_?\w/g</span>, <span class="hljs-function">(<span class="hljs-params">$</span>) =&gt;</span> $.toUpperCase());</code></pre></div><ul><li>  åè½¬å¥å­</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//  æ­£åˆ™</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reverseWords</span>(<span class="hljs-params">str</span>) </span>&#123;<span class="hljs-keyword">return</span> str.trim().replace(<span class="hljs-regexp">/\s+/g</span>, <span class="hljs-string">&quot; &quot;</span>).split(<span class="hljs-string">&quot; &quot;</span>).reverse().join(<span class="hljs-string">&quot; &quot;</span>);<span class="hljs-comment">// \s \sæ˜¯æŒ‡ç©ºç™½,åŒ…æ‹¬ç©ºæ ¼ã€æ¢è¡Œã€tabç¼©è¿›ç­‰æ‰€æœ‰çš„ç©ºç™½</span><span class="hljs-comment">// å»é™¤å•è¯ä¹‹é—´å¤šä½™çš„ç©ºç™½</span>&#125;<span class="hljs-comment">//</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reverseWords</span>(<span class="hljs-params">str</span>) </span>&#123;<span class="hljs-comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨string+ &#x27; &#x27;</span><span class="hljs-comment">// è¿™é‡Œä½¿ç”¨æ•°ç»„</span><span class="hljs-keyword">let</span> arr = [];str = srt.trim();<span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> right = str.length - <span class="hljs-number">1</span>;<span class="hljs-keyword">let</span> word = <span class="hljs-string">&quot;&quot;</span>;<span class="hljs-comment">// å»é™¤å¤´å°¾å¤šä½™ç©ºæ ¼</span><span class="hljs-keyword">while</span> (left &lt;= right) &#123;<span class="hljs-keyword">let</span> char = str.charAt(left);<span class="hljs-keyword">if</span> (char === <span class="hljs-string">&quot; &quot;</span> &amp;&amp; word) &#123;arr.unshift(word);word = <span class="hljs-string">&quot;&quot;</span>;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (char !== <span class="hljs-string">&quot; &quot;</span>) &#123;word += char;&#125;left++;&#125;arr.unshift(word);<span class="hljs-comment">// ä¸Šé¢å•è¯çš„æ·»åŠ æ˜¯åŸºäºè¯¥ä½ç½®å­—ç¬¦æ˜¯å¦ä¸ºç©º</span><span class="hljs-comment">// åˆ™æœ€åä¸€ä¸ªå•è¯çš„æœ«å°¾éç©ºå°†ä¸ä¼šè¢«æ·»åŠ </span><span class="hljs-comment">// æ‰€ä»¥æœ€ååŠ ä¸Šarr.unshift(word)</span><span class="hljs-keyword">return</span> arr.join(<span class="hljs-string">&quot; &quot;</span>);&#125;</code></pre></div><ul><li>  æ£€æŸ¥å›æ–‡</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reverseCheck</span>(<span class="hljs-params">str</span>) </span>&#123;<span class="hljs-keyword">let</span> s = str.toLowerCase().replace(<span class="hljs-regexp">/[\W_]/g</span>, <span class="hljs-string">&quot;&quot;</span>);<span class="hljs-comment">// æ ¼å¼æ‰ä¸æ˜¯å­—æ¯çš„åˆ«çš„ç©æ„</span><span class="hljs-comment">// | `\W`   | åŒ¹é…ä»»æ„ä¸æ˜¯å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ |</span><span class="hljs-comment">// `[]` å­—ç¬¦ä¸²ç”¨ä¸­æ‹¬å·æ‹¬èµ·æ¥ï¼Œè¡¨ç¤ºåŒ¹é…å…¶ä¸­çš„ä»»ä¸€å­—ç¬¦</span><span class="hljs-keyword">return</span> s === s.split(<span class="hljs-string">&quot;&quot;</span>).reverse().join(<span class="hljs-string">&quot;&quot;</span>);<span class="hljs-comment">// æŒ‡é’ˆ</span><span class="hljs-keyword">let</span> l = <span class="hljs-number">0</span><span class="hljs-keyword">let</span> r = str.length - <span class="hljs-number">1</span> <span class="hljs-keyword">while</span>(l&lt;r)&#123;<span class="hljs-keyword">if</span>(str[l++]===str[r--])&#123;<span class="hljs-keyword">continue</span>&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;&#125;<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;</code></pre></div><ul><li>  æœ€é•¿ä¸é‡å¤å­ä¸²é•¿åº¦</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// æ»‘åŠ¨çª—å£</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">longest1</span>(<span class="hljs-params">str</span>) </span>&#123;<span class="hljs-keyword">const</span> <span class="hljs-built_in">window</span> = [];<span class="hljs-comment">// æ»‘åŠ¨çª—å£</span><span class="hljs-keyword">let</span> maxLen = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; str.length; i++) &#123;<span class="hljs-keyword">const</span> index = <span class="hljs-built_in">window</span>.indexOf(str[i]);<span class="hljs-keyword">if</span> (index !== -<span class="hljs-number">1</span>) &#123;<span class="hljs-built_in">window</span>.splice(<span class="hljs-number">0</span>, index + <span class="hljs-number">1</span>);<span class="hljs-comment">// æœ‰é‡å¤å€¼æ—¶ç¼©å°çª—å£</span>&#125;<span class="hljs-built_in">window</span>.push(str[i]);<span class="hljs-comment">// æ— é‡å¤æ‰©å¤§çª—å£</span>maxLen = <span class="hljs-built_in">Math</span>.max(maxLen, <span class="hljs-built_in">window</span>.length);&#125;<span class="hljs-keyword">return</span> maxLen;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">longest2</span>(<span class="hljs-params">str</span>) </span>&#123;<span class="hljs-keyword">let</span> _index = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> maxLen = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; j &lt; str.length; j++) &#123;_index = str.substring(i, j).indexOf(str[j]);<span class="hljs-keyword">if</span> (_index !== -<span class="hljs-number">1</span>) &#123;<span class="hljs-comment">// _indexä¸ºé‡å¤é¡¹ä½ç½®</span>i += _index + <span class="hljs-number">1</span>;&#125;maxLen = <span class="hljs-built_in">Math</span>.max(maxLen, j - i + <span class="hljs-number">1</span>);&#125;<span class="hljs-keyword">return</span> maxLen;&#125;<span class="hljs-comment">// mapåŒæŒ‡é’ˆ</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">longest3</span>(<span class="hljs-params">str</span>) </span>&#123;<span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();<span class="hljs-keyword">let</span> maxLen = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<span class="hljs-comment">// è®¾ i ä½ç½®å³ä¾§å­—ç¬¦æ— é‡å¤</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; str.length; j++) &#123;<span class="hljs-keyword">if</span> (map.has(str[j])) &#123;i = <span class="hljs-built_in">Math</span>.max(map.get(str[j]) + <span class="hljs-number">1</span>, i);<span class="hljs-comment">// æ£€æµ‹åˆ°é‡å¤ï¼Œæ›´æ–°içš„ä½ç½®ï¼Œæ³¨æ„ä¸ä¸€å®šæ˜¯str[j]+1ï¼Œstr[j]+1ä¸ä¸€å®šæ¯”ä¸Šä¸€ä¸ªé‡å¤å…ƒç´ çš„æŸ¥é‡ä½ç½®æ›´é å</span><span class="hljs-comment">// [3,2,1,1,3,2] 3æŸ¥é‡çš„ä½ç½®æ˜æ˜¾å°äº1æŸ¥é‡</span>&#125;map.set(str[j], j);maxLen = <span class="hljs-built_in">Math</span>.max(j - i + <span class="hljs-number">1</span>, maxLen);&#125;&#125;</code></pre></div><ul><li>  è®¡ç®—äºŒè¿›åˆ¶æ•°ä¸­ 1 çš„ä¸ªæ•°</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// n ä¸º32ä½äºŒè¿›åˆ¶æ•°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hammingWeight1</span>(<span class="hljs-params">n</span>) </span>&#123;<span class="hljs-keyword">const</span> numStr = n.toString(<span class="hljs-number">2</span>);<span class="hljs-comment">// è½¬ä¸ºäºŒè¿›åˆ¶åè®°æ•°</span><span class="hljs-keyword">let</span> showTimes = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numStr.length; i++) &#123;<span class="hljs-keyword">if</span> (numStr[i] === <span class="hljs-string">&quot;1&quot;</span>) &#123;showTimes++;&#125;&#125;<span class="hljs-keyword">return</span> showTimes;&#125;<span class="hljs-comment">// ä½è¿ç®—</span><span class="hljs-comment">// &gt;&gt;&gt; æ— ç¬¦å·å‘å³ç§»</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hammingWeight2</span>(<span class="hljs-params">n</span>) </span>&#123;<span class="hljs-keyword">let</span> showTimes = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> (n != <span class="hljs-number">0</span>) &#123;showTimes += n &amp; <span class="hljs-number">1</span>;<span class="hljs-comment">// &amp;è¿ç®—ï¼Œ1çš„äºŒè¿›åˆ¶ä¸º1</span><span class="hljs-comment">// åˆ™å·¦å³éƒ½ä¸º1æ—¶è¾“å‡º1</span>n &gt;&gt;&gt;= <span class="hljs-number">1</span>;&#125;<span class="hljs-keyword">return</span> showTimes;&#125;<span class="hljs-comment">// æ•´ä½“n &amp;</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hammingWeight3</span>(<span class="hljs-params">n</span>) </span>&#123;<span class="hljs-keyword">let</span> showTimes = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> (n != <span class="hljs-number">0</span>) &#123;showTimes++;n &amp;= n - <span class="hljs-number">1</span>;<span class="hljs-comment">// äºŒè¿›åˆ¶ - ä¸­</span><span class="hljs-comment">// n-1 ç›¸å½“ äºnæŠŠæœ€å³è¾¹çš„1å˜ä¸º0,å…¶åé¢çš„0å˜ä¸º1</span><span class="hljs-comment">// nä¸n-1è¿›è¡Œä¸è¿ç®—,1&amp;1=1,å³åªæ”¹å˜äº†æœ€å³è¾¹ç¬¬ä¸€ä¸ª1</span><span class="hljs-comment">// n       =&gt; 0001100</span><span class="hljs-comment">// n-1     =&gt; 0001011</span><span class="hljs-comment">// n&amp;(n-1) =&gt; 0001000</span><span class="hljs-comment">// n-1     =&gt; 0000111</span><span class="hljs-comment">// n&amp;(n-1) =&gt; 0000000</span><span class="hljs-comment">// è·³å‡ºå¾ªç¯</span>&#125;<span class="hljs-keyword">return</span> showTimes;&#125;</code></pre></div><ul><li>  è¯·å®ç°ä¸€ä¸ªå‡½æ•°ç”¨æ¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦è¡¨ç¤ºæ•°å€¼ï¼ˆåŒ…æ‹¬æ•´æ•°å’Œå°æ•°ï¼‰</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">numberCheck</span>(<span class="hljs-params">s</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^\s$/</span>.test(s)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-keyword">return</span> <span class="hljs-built_in">Number</span>(s).toString() !== <span class="hljs-string">&quot;NaN&quot;</span>;&#125;</code></pre></div><ul><li>  åƒåˆ†ä½åŠ é€—å·</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">numFormat</span>(<span class="hljs-params">num</span>)</span>&#123;  <span class="hljs-keyword">var</span> res=num.toString().replace(<span class="hljs-regexp">/\d+/</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">n</span>)</span>&#123; <span class="hljs-comment">// æ•´æ•°éƒ¨åˆ†</span>       <span class="hljs-keyword">return</span> n.replace(<span class="hljs-regexp">/(\d)(?=(\d&#123;3&#125;)+$)/g</span>,$<span class="hljs-number">1</span>=&gt;$<span class="hljs-number">1</span>+<span class="hljs-string">&#x27;,&#x27;</span>);  &#125;)  <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-comment">// or</span><span class="hljs-built_in">Number</span>[].toLocaleString();</code></pre></div><ul><li>  è§£æ URL å‚æ•°</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseQueryString</span>(<span class="hljs-params">url</span>) </span>&#123;<span class="hljs-keyword">const</span> rule = <span class="hljs-regexp">/([^?=&amp;]+)=([^&amp;#]*)/g</span>;<span class="hljs-keyword">return</span> url.match.reduce(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> [key, value] = b.split(<span class="hljs-string">&quot;=&quot;</span>);k = <span class="hljs-built_in">decodeURIComponent</span>(key);v = <span class="hljs-built_in">decodeURIComponent</span>(value);a[k] = a[k] ? [...a[k], value] : value;<span class="hljs-keyword">return</span> a;&#125;, &#123;&#125;);&#125;</code></pre></div><ul><li>  å­—ç¬¦ä¸²ç›¸åŠ /å¤§æ•°ç›¸åŠ </li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stringAdd</span>(<span class="hljs-params">num1, num2</span>) </span>&#123;<span class="hljs-keyword">let</span> l1 = num1.length;<span class="hljs-keyword">let</span> l2 = num2.length;<span class="hljs-keyword">let</span> res = <span class="hljs-string">&quot;&quot;</span>;<span class="hljs-comment">// è¿›ä½</span><span class="hljs-keyword">let</span> carry = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> (l1 || l2) &#123;<span class="hljs-keyword">if</span> (l1) carry += +num1[--l1];<span class="hljs-keyword">if</span> (l2) carry += +num2[--l2];<span class="hljs-comment">// å½“å‰ä½</span>res = (carry % <span class="hljs-number">10</span>) + res;<span class="hljs-comment">// è®¡ç®—å‡ºè¶…è¿‡åçš„è¿›ä½</span>carry = carry &gt;= <span class="hljs-number">10</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;&#125;<span class="hljs-keyword">if</span> (carry) res = carry + res;<span class="hljs-keyword">return</span> res;&#125;</code></pre></div><ul><li>  å­—ç¬¦ä¸²ç›¸ä¹˜/å¤§æ•°ç›¸ä¹˜</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stringMulti</span>(<span class="hljs-params">x, y</span>) </span>&#123;<span class="hljs-keyword">if</span> (x === <span class="hljs-string">&quot;0&quot;</span> || y === <span class="hljs-string">&quot;0&quot;</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0&quot;</span>;<span class="hljs-keyword">if</span> (x === <span class="hljs-string">&quot;1&quot;</span>) <span class="hljs-keyword">return</span> y;<span class="hljs-keyword">if</span> (y === <span class="hljs-string">&quot;1&quot;</span>) <span class="hljs-keyword">return</span> x;<span class="hljs-keyword">const</span> len1 = x.length;<span class="hljs-keyword">const</span> len2 = y.length;<span class="hljs-keyword">const</span> pos = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(len1 + len2).fill(<span class="hljs-number">0</span>);<span class="hljs-keyword">let</span> num1, num2, multi, cur;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = len1 - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;num1 = x[i];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = len2 - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">0</span>; j--) &#123;num2 = y[j];multi = num1 * num2;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;multi&quot;</span> + multi);<span class="hljs-comment">// å‚è€ƒä¹˜æ³•è‰ç¨¿</span>cur = multi + pos[i + j + <span class="hljs-number">1</span>];<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;cur&quot;</span> + cur);<span class="hljs-comment">// è¿›ä½</span>pos[i + j] += (cur / <span class="hljs-number">10</span>) | <span class="hljs-number">0</span>;<span class="hljs-comment">// ä½™æ•°</span>pos[i + j + <span class="hljs-number">1</span>] = cur % <span class="hljs-number">10</span>;&#125;&#125;<span class="hljs-keyword">let</span> res = pos.join(<span class="hljs-string">&quot;&quot;</span>);<span class="hljs-keyword">while</span> (res[<span class="hljs-number">0</span>] === <span class="hljs-string">&quot;0&quot;</span>) &#123;res = res.substring(<span class="hljs-number">1</span>);&#125;<span class="hljs-keyword">return</span> res;&#125;</code></pre></div><ul><li>  å®ç°ä¸€ä¸ª<code>trim</code>å‡½æ•°</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// trim è¿”å›å»é™¤äº†é¦–å°¾ç©ºç™½çš„å­—ç¬¦ä¸²</span><span class="hljs-built_in">String</span>.prototype._trim = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-comment">//1.regexp</span><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.replace(<span class="hljs-regexp">/^\s+/</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-regexp">/\s+$/</span>, <span class="hljs-string">&quot;&quot;</span>);&#125;;<span class="hljs-built_in">String</span>.prototype._trim = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">const</span> str = <span class="hljs-built_in">this</span>;<span class="hljs-keyword">let</span> res = <span class="hljs-string">&quot;&quot;</span>;<span class="hljs-keyword">let</span> trimFlag = <span class="hljs-literal">true</span>;<span class="hljs-keyword">let</span> tailIndex; <span class="hljs-comment">// æ‰¾å‡ºæœ€åä¸€ä¸ªä¸æ˜¯ç©ºæ ¼çš„ç´¢å¼•</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = str.length - <span class="hljs-number">1</span>; j &gt; <span class="hljs-number">0</span>; j--) &#123;<span class="hljs-keyword">if</span> (str[j] !== <span class="hljs-string">&quot; &quot;</span>) &#123;tailIndex = j;<span class="hljs-keyword">break</span>;&#125;&#125;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; str.length; i++) &#123;<span class="hljs-comment">// è¶Šè¿‡æœ«ä½ååˆå¼€å§‹å¿½ç•¥ç©ºæ ¼</span><span class="hljs-keyword">if</span> (i &gt;= tailIndex) &#123;trimFlag = <span class="hljs-literal">true</span>;&#125;<span class="hljs-keyword">if</span> (str[i] === <span class="hljs-string">&quot; &quot;</span> &amp;&amp; trimFlag) &#123;<span class="hljs-keyword">continue</span>;&#125; <span class="hljs-keyword">else</span> &#123;trimFlag = <span class="hljs-literal">false</span>;res += str[i];&#125;&#125;<span class="hljs-keyword">return</span> res;&#125;;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ–‡ä»¶å¤¹å†…æ‰¹é‡æ˜ å°„ä¸ºæ¨¡å—</title>
    <link href="/2022/02/24/%E6%89%B9%E9%87%8F%E6%98%A0%E5%B0%84%E6%A8%A1%E5%9D%97/"/>
    <url>/2022/02/24/%E6%89%B9%E9%87%8F%E6%98%A0%E5%B0%84%E6%A8%A1%E5%9D%97/</url>
    
    <content type="html"><![CDATA[<h2 id="1-æ‰¹é‡æ³¨å†Œä¸­é—´ä»¶"><a href="#1-æ‰¹é‡æ³¨å†Œä¸­é—´ä»¶" class="headerlink" title="1. æ‰¹é‡æ³¨å†Œä¸­é—´ä»¶"></a>1. æ‰¹é‡æ³¨å†Œä¸­é—´ä»¶</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript">./controllersä¸­controllerA.jscontrollerB.jscontrollerC.js</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript">./controllers/index.js<span class="hljs-keyword">const</span> _ = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;lodash&#x27;</span>)<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<span class="hljs-comment">/**</span><span class="hljs-comment"> * æ˜ å°„æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ä¸ºæ¨¡å—</span><span class="hljs-comment"> */</span><span class="hljs-keyword">const</span> mapDir = <span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> &#123;    <span class="hljs-keyword">const</span> tree = &#123;&#125;    <span class="hljs-comment">// è·å¾—å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰çš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶</span>    <span class="hljs-keyword">const</span> [dirs, files] = _(fs.readdirSync(d))        .partition(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> fs.statSync(path.join(d, p)).isDirectory())    <span class="hljs-comment">// _(value)</span>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç» lodash åŒ…è£…åçš„å¯¹è±¡ä¼šå¯ç”¨éšå¼é“¾ã€‚è¿”å›çš„æ•°ç»„ã€é›†åˆã€æ–¹æ³•ç›¸äº’ä¹‹é—´èƒ½å¤Ÿé“¾å¼è°ƒç”¨</span>    <span class="hljs-comment">// é€’å½’æ˜ å°„æ–‡ä»¶å¤¹</span>    dirs.forEach(<span class="hljs-function"><span class="hljs-params">dir</span> =&gt;</span> &#123;        tree[dir] = mapDir(path.join(d, dir))    &#125;)    <span class="hljs-comment">// æ˜ å°„æ–‡ä»¶</span>    files.forEach(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (path.extname(file) === <span class="hljs-string">&#x27;.js&#x27;</span>) &#123;            tree[path.basename(file, <span class="hljs-string">&#x27;.js&#x27;</span>)] = <span class="hljs-built_in">require</span>(path.join(d, file))        &#125;    &#125;)    <span class="hljs-keyword">return</span> tree&#125;<span class="hljs-comment">// é»˜è®¤å¯¼å‡ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ˜ å°„</span><span class="hljs-built_in">module</span>.exports = mapDir(path.join(__dirname))</code></pre></div><ul><li>  ä½¿ç”¨</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> controllers = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../controllers&quot;</span>);router.get(<span class="hljs-string">&quot;/A&quot;</span>, controllers.controllerA);router.post(<span class="hljs-string">&quot;/B&quot;</span>, controllers.controllerB);router.post(<span class="hljs-string">&quot;/C&quot;</span>, controllers.controllerC);</code></pre></div><h2 id="2-æ‰¹é‡æ³¨å†Œè·¯ç”±"><a href="#2-æ‰¹é‡æ³¨å†Œè·¯ç”±" class="headerlink" title="2. æ‰¹é‡æ³¨å†Œè·¯ç”±"></a>2. æ‰¹é‡æ³¨å†Œè·¯ç”±</h2><ul><li>  <code>/routes/...</code></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript">/a.js&#123;    <span class="hljs-keyword">const</span> router = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;koa-router&#x27;</span>)()    router.get(<span class="hljs-string">&#x27;/xxx&#x27;</span>,<span class="hljs-function">()=&gt;</span>&#123;        ctx.....    &#125;)    <span class="hljs-keyword">return</span> router&#125;...b.jsc.jsd.js</code></pre></div><ul><li>  <code>/router/index.js</code></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> router = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;koa-router&quot;</span>)();<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs&quot;</span>);<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<span class="hljs-keyword">const</span> mapRoutes = <span class="hljs-function">(<span class="hljs-params">filePath</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> files = fs.readdirSync(filePath); <span class="hljs-comment">//å°†å½“å‰ç›®å½•ä¸‹ éƒ½è¯»å‡ºæ¥</span>files.filter(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> &#123;<span class="hljs-comment">// è¿‡æ»¤</span><span class="hljs-keyword">if</span> (filePath !== __dirname &amp;&amp; file === <span class="hljs-string">&quot;index.js&quot;</span>) &#123;<span class="hljs-comment">//è¯»å–çš„æ—¶å€™ä¼šå°†å½“å‰ç›®å½•çš„ index.js ä¹Ÿè¯»å–å‡ºæ¥ï¼Œè¿™ä¸ªä¸éœ€è¦ï¼Œå¦‚æœæ‹¿åˆ°åˆ«çš„åœ°æ–¹å¯ä»¥ä¸åŠ è¿™ä¸ªåˆ¤æ–­</span><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;routes module must not be &#x27;index.js&#x27; &quot;</span>);&#125;<span class="hljs-keyword">return</span> file !== <span class="hljs-string">&quot;index.js&quot;</span>;&#125;) <span class="hljs-comment">// å°† index.js è¿‡æ»¤æ‰ï¼Œè·¯ç”±åå­—ä¸€å¾‹ä¸èƒ½ç”¨ index.js å‘½åï¼Œå¦åˆ™ä¸ç”Ÿæ•ˆï¼Œæˆ‘è¿™é‡Œè¾¹çš„ index.js å¦‚æœæ‹¿åˆ°å¤–é¢å°±ä¸ç”¨æ·»åŠ è¿™ä¸ªåˆ¤æ–­äº† ...</span>.forEach(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> &#123;<span class="hljs-keyword">let</span> newFilePath = path.join(filePath, file);<span class="hljs-keyword">if</span> (fs.statSync(newFilePath).isDirectory()) &#123;<span class="hljs-comment">// æ˜¯ç›®å½•</span>loadRoutes(newFilePath); <span class="hljs-comment">// é€’å½’</span>&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-comment">// æ˜¯æ–‡ä»¶</span><span class="hljs-keyword">let</span> route = <span class="hljs-built_in">require</span>(newFilePath);<span class="hljs-comment">//æ³¨å†Œè·¯ç”±</span>router.use(route.routes());router.use(route.allowedMethods());&#125;&#125;);&#125;;mapRoutes(path.join(__dirname));<span class="hljs-built_in">module</span>.exports = router;</code></pre></div><ul><li>  <code>app.js</code></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> routes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./routes/index&quot;</span>);app.use(routes.routes(), routes.allowedMethods());</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>node</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ§åˆ¶å°ä¸€ç›´æ‰“å°http://xxx/sockjs-node/info?t=xxx</title>
    <link href="/2022/02/24/%E6%8E%A7%E5%88%B6%E5%8F%B0%E4%B8%80%E7%9B%B4%E6%8A%A5%E9%94%99sockjs-node/"/>
    <url>/2022/02/24/%E6%8E%A7%E5%88%B6%E5%8F%B0%E4%B8%80%E7%9B%B4%E6%8A%A5%E9%94%99sockjs-node/</url>
    
    <content type="html"><![CDATA[<h3 id="sockjs-nodeæ˜¯ä¸€ä¸ªJavaScriptåº“ï¼Œæä¾›è·¨æµè§ˆå™¨JavaScriptçš„APIï¼Œåˆ›å»ºäº†ä¸€ä¸ªä½å»¶è¿Ÿï¼Œå…¨åŒå·¥çš„æµè§ˆå™¨å’ŒwebæœåŠ¡å™¨ä¹‹é—´é€šä¿¡é€šé“ã€‚"><a href="#sockjs-nodeæ˜¯ä¸€ä¸ªJavaScriptåº“ï¼Œæä¾›è·¨æµè§ˆå™¨JavaScriptçš„APIï¼Œåˆ›å»ºäº†ä¸€ä¸ªä½å»¶è¿Ÿï¼Œå…¨åŒå·¥çš„æµè§ˆå™¨å’ŒwebæœåŠ¡å™¨ä¹‹é—´é€šä¿¡é€šé“ã€‚" class="headerlink" title="sockjs-nodeæ˜¯ä¸€ä¸ªJavaScriptåº“ï¼Œæä¾›è·¨æµè§ˆå™¨JavaScriptçš„APIï¼Œåˆ›å»ºäº†ä¸€ä¸ªä½å»¶è¿Ÿï¼Œå…¨åŒå·¥çš„æµè§ˆå™¨å’ŒwebæœåŠ¡å™¨ä¹‹é—´é€šä¿¡é€šé“ã€‚"></a>sockjs-nodeæ˜¯ä¸€ä¸ªJavaScriptåº“ï¼Œæä¾›è·¨æµè§ˆå™¨JavaScriptçš„APIï¼Œåˆ›å»ºäº†ä¸€ä¸ªä½å»¶è¿Ÿï¼Œå…¨åŒå·¥çš„æµè§ˆå™¨å’ŒwebæœåŠ¡å™¨ä¹‹é—´é€šä¿¡é€šé“ã€‚</h3><h3 id="å¦‚æœä½ çš„é¡¹ç›®æ²¡æœ‰ç”¨åˆ°sockjs-vuecli3-è¿è¡Œnpm-run-serve-ä¹‹ånetworké‡Œé¢ä¸€ç›´è°ƒç”¨ä¸€ä¸ªæ¥å£"><a href="#å¦‚æœä½ çš„é¡¹ç›®æ²¡æœ‰ç”¨åˆ°sockjs-vuecli3-è¿è¡Œnpm-run-serve-ä¹‹ånetworké‡Œé¢ä¸€ç›´è°ƒç”¨ä¸€ä¸ªæ¥å£" class="headerlink" title="å¦‚æœä½ çš„é¡¹ç›®æ²¡æœ‰ç”¨åˆ°sockjs,vuecli3 è¿è¡Œnpm run serve ä¹‹ånetworké‡Œé¢ä¸€ç›´è°ƒç”¨ä¸€ä¸ªæ¥å£:"></a>å¦‚æœä½ çš„é¡¹ç›®æ²¡æœ‰ç”¨åˆ°sockjs,vuecli3 è¿è¡Œnpm run serve ä¹‹ånetworké‡Œé¢ä¸€ç›´è°ƒç”¨ä¸€ä¸ªæ¥å£:</h3><p><code>http://localhost:8080/sockjs-node/info?t=1556418283950</code></p><h2 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a>è§£å†³æ–¹æ¡ˆï¼š</h2><ol><li>å¼€å‘ç¯å¢ƒä¸­å…³é—­æ­¤æœåŠ¡</li></ol><p>  <code>node_modules/sockjs-client/dist/sockjs.js</code>ä¸­æ³¨é‡Š<br><code>self.xhr.send(payload)</code></p><ol start="2"><li>webpacké…ç½®ä¸­</li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript">sockHost: <span class="hljs-string">&quot; http://192.168.1.6:8080&quot;</span>,disableHostCheck: <span class="hljs-literal">true</span></code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°ç»„</title>
    <link href="/2022/02/24/%E6%95%B0%E7%BB%84/"/>
    <url>/2022/02/24/%E6%95%B0%E7%BB%84/</url>
    
    <content type="html"><![CDATA[<h2 id="åˆ›å»ºæ•°ç»„"><a href="#åˆ›å»ºæ•°ç»„" class="headerlink" title="åˆ›å»ºæ•°ç»„"></a>åˆ›å»ºæ•°ç»„</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å­—é¢é‡</span><span class="hljs-keyword">let</span> arr = []<span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]<span class="hljs-comment">// æ„é€ å‡½æ•°</span><span class="hljs-keyword">let</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>()<span class="hljs-keyword">let</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-regexp">/ä¼ å…¥æ•°ç»„ä»£è¡¨æ•°ç»„é•¿åº¦/</span>)<span class="hljs-keyword">let</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">&#x27;item1&#x27;</span>,<span class="hljs-string">&#x27;item2&#x27;</span>/ä¼ å…¥å…ƒç´ /)<span class="hljs-keyword">let</span> arr = <span class="hljs-built_in">Array</span>(<span class="hljs-number">10</span>)/çœç•¥<span class="hljs-keyword">new</span>æ“ä½œç¬¦/<span class="hljs-comment">// Array.of</span><span class="hljs-built_in">Array</span>.of(<span class="hljs-number">7</span>) åˆ›å»ºä¸€ä¸ªå…·æœ‰å•ä¸ªå…ƒç´  <span class="hljs-number">7</span> çš„æ•°ç»„ï¼Œè€Œ<span class="hljs-built_in">Array</span>(<span class="hljs-number">7</span>) åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º<span class="hljs-number">7</span>çš„ç©ºæ•°ç»„<span class="hljs-comment">// Array.from</span><span class="hljs-built_in">Array</span>.from(arrayLike[, mapFn[, thisArg]]ç±»æ•°ç»„å¯¹è±¡)</code></pre></div><h2 id="å˜å¼‚æ–¹æ³•ï¼ˆæ”¹å˜åŸæ•°ç»„ï¼‰"><a href="#å˜å¼‚æ–¹æ³•ï¼ˆæ”¹å˜åŸæ•°ç»„ï¼‰" class="headerlink" title="å˜å¼‚æ–¹æ³•ï¼ˆæ”¹å˜åŸæ•°ç»„ï¼‰"></a>å˜å¼‚æ–¹æ³•ï¼ˆæ”¹å˜åŸæ•°ç»„ï¼‰</h2><ul><li>  <code>pop()</code>åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ </li><li>  <code>shift()</code>åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>  <code>push()</code>æ·»åŠ å…ƒç´ è‡³æœ«å°¾</li><li>  <code>unshift()</code>æ·»åŠ å…ƒç´ è‡³é¦–ä½</li><li>  <code>splice(start,delCount,new1,new2...)</code>å¾€æ•°ç»„ç´¢å¼•ä¸º start ä½ç½®åˆ é™¤ delCont ä¸ªå…ƒç´ ï¼Œå¹¶ä»è¯¥ä½ç½®åŠ å…¥ new æ–°å…ƒç´ </li><li>  <code>sort()</code>æ’åº</li><li><code>reverse()</code>å€’åº,è¿”å›æ–°æ•°ç»„<br>  es6</li><li>  <code>copyWithin(target,start,end)</code>æ‹·è´æ•°ç»„ä¸­ç´¢å¼•ä» start åˆ° endï¼ˆendï¼‰çš„å…ƒç´ æ·»åŠ è‡³ target</li><li>  <code>fill(value,start,end)</code>å°†æ•°ç»„ä¸­ç´¢å¼• start åˆ° endï¼ˆä¸å«ï¼‰çš„ä½ç½®å¡«å……ä¸º value å…ƒç´ </li></ul><h2 id="éå˜å¼‚æ–¹æ³•"><a href="#éå˜å¼‚æ–¹æ³•" class="headerlink" title="éå˜å¼‚æ–¹æ³•"></a>éå˜å¼‚æ–¹æ³•</h2><ul><li>  <code>slice(start,end)</code>æ½œæ‹·è´ï¼Œè¿”å›ç´¢å¼•ä» start åˆ° endï¼ˆä¸å«ï¼‰çš„å…ƒç´ ç»„æˆæ–°æ•°ç»„</li><li>  <code>join()</code>æŒ‡å®šåˆ†éš”ç¬¦å°†æ•°å­—å…ƒç´ è¿æˆå­—ç¬¦ä¸²</li><li>  <code>concat()</code>åˆå¹¶æ•°ç»„</li><li>  <code>indexOf()/lastIndexOf()</code>æŸ¥æ‰¾å…ƒç´ ç´¢å¼•,å¯ä¼ å…¥èµ·å§‹ä½ç½®</li><li>  <code>includes()</code>æŸ¥æ‰¾æ˜¯å¦åŒ…å«å…ƒç´ è¿”å› Boolean,å¯ä¼ å…¥èµ·å§‹ä½ç½®</li><li>  <code>...</code>å±•å¼€è¿ç®—ç¬¦</li></ul><h3 id="éå†æ•°ç»„"><a href="#éå†æ•°ç»„" class="headerlink" title="éå†æ•°ç»„"></a>éå†æ•°ç»„</h3><p>éå†æ•°ç»„çš„å›è°ƒ<code>mapFn</code>åŒ…å«è‡ªåŠ¨ä¼ å…¥çš„å‚æ•°(currentValue,currentIndex,thisArr)</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// parseInt(string, radix)   è§£æä¸€ä¸ªå­—ç¬¦ä¸²å¹¶è¿”å›æŒ‡å®šåŸºæ•°çš„åè¿›åˆ¶æ•´æ•°</span><span class="hljs-comment">// è§£é‡Šäº†</span>[<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>].map(<span class="hljs-built_in">parseInt</span>)=&gt;  <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-number">0</span>),<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-number">1</span>),<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-number">2</span>)=&gt;  <span class="hljs-number">1</span>,<span class="hljs-literal">NaN</span>,<span class="hljs-literal">NaN</span></code></pre></div><ul><li><p>  <code>map()</code>ä½¿ç”¨æŒ‡å®šå‡½æ•°æ˜ å°„æ¯ä¸€ä¸ªå…ƒç´ åçš„è¿”å›å€¼ç»„æˆçš„æ–°æ•°ç»„</p></li><li><p>  <code>flatmap()</code>ä½¿ç”¨æŒ‡å®šå‡½æ•°æ˜ å°„æ¯ä¸€ä¸ªå…ƒç´ åçš„è¿”å›å€¼ç»„æˆæ–°æ•°ç»„å¹¶æ‰§è¡Œä¸€æ¬¡æ‰å¹³åŒ–</p></li><li><p>  <code>some()</code>æµ‹è¯•æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ å¯ä»¥é€šè¿‡æä¾›çš„å‡½æ•°,è¿”å›å¸ƒå°”å€¼ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå°±ä¼šåœæ­¢éå†</p></li><li><p>  <code>every()</code>æ£€æµ‹æ•°ç»„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½ç¬¦åˆåˆ¤æ–­æ¡ä»¶,è¿”å›å¸ƒå°”å€¼ï¼Œé‡åˆ°falseå°±ä¼šåœæ­¢éå†</p></li><li><p>  <code>forEach()</code>å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¸€æ¬¡æä¾›çš„å‡½æ•°,ä¸ä¼šæ”¹å˜åŸæ•°ç»„</p></li><li><p>  <code>filter()</code>è¿”å›é€šè¿‡åˆ¶å®šå‡½æ•°è¿‡æ»¤åã€Œè¿”å›trueã€çš„æ•°ç»„</p></li><li><p>  <code>find()</code>è¿”å›æ•°ç»„ä¸­æ»¡è¶³æä¾›çš„æµ‹è¯•å‡½æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ã€‚å¦åˆ™è¿”å› undefined</p></li><li><p>  <code>findIndex()</code>è¿”å›æ•°ç»„ä¸­æ»¡è¶³æä¾›çš„æµ‹è¯•å‡½æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ã€‚å¦åˆ™è¿”å›-1</p></li><li><p>  <code>reduce()å’ŒreduceRight()</code>ç´¯åŠ å™¨,ç´¯åŠ å‡½æ•°çš„ return ä½œä¸ºä¸‹ä¸€æ¬¡ç´¯åŠ çš„ pre å€¼ï¼Œå¹¶å¯æŒ‡å®šåˆå§‹å€¼</p></li><li><p>  <code>flat(depth)</code>æŒ‰ç…§ä¸€ä¸ªå¯æŒ‡å®šçš„æ·±åº¦é€’å½’éå†æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ ä¸éå†åˆ°çš„å­æ•°ç»„ä¸­çš„å…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªæ–°æ•°ç»„è¿”å›ï¼ˆ_ä¼šç§»é™¤æ•°ç»„ä¸­çš„ç©ºé¡¹_ï¼‰</p></li><li><p>è°ƒç”¨éå†å™¨[Symbol.Iterator]</p><ul><li>  <code>of Object.keys()</code></li><li>  <code>of Object.values()</code></li><li>  <code>of Object.entries()</code></li></ul>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index <span class="hljs-keyword">of</span> [<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>].keys()) &#123;<span class="hljs-built_in">console</span>.log(index);&#125;<span class="hljs-comment">// 0</span><span class="hljs-comment">// 1</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> elem <span class="hljs-keyword">of</span> [<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>].values()) &#123;<span class="hljs-built_in">console</span>.log(elem);&#125;<span class="hljs-comment">// &#x27;a&#x27;</span><span class="hljs-comment">// &#x27;b&#x27;</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> [index, elem] <span class="hljs-keyword">of</span> [<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>].entries()) &#123;<span class="hljs-built_in">console</span>.log(index, elem);&#125;<span class="hljs-comment">// 0 &quot;a&quot;</span><span class="hljs-comment">// 1 &quot;b&quot;</span></code></pre></div></li></ul><h2 id="åˆ¤æ–­æ•°ç»„"><a href="#åˆ¤æ–­æ•°ç»„" class="headerlink" title="åˆ¤æ–­æ•°ç»„"></a>åˆ¤æ–­æ•°ç»„</h2><ol><li><p><code>arr.constructor===Array</code></p></li><li><p><code>arr instanceof Array</code></p></li><li><p><code>Array.prototype.isPrototypeOf(arr)</code></p><blockquote><p>è¿™ä¸‰ç§æŸ¥æ‰¾åŸå‹çš„æ–¹æ³•ï¼Œå¦‚æœæ‰‹åŠ¨æ›´æ”¹å¯¹è±¡çš„åŸå‹ä¹Ÿå¯æ¬ºéª—è¿‡æ£€æµ‹</p></blockquote></li><li><p><code>Object.prototype.toString.call(arr)===&#39;[object Array]&#39;</code></p></li><li><p><code>Array.isArray()</code></p></li></ol><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> notArr = &#123;__proto__: <span class="hljs-built_in">Array</span>.prototype,&#125;;notArr.constructor = <span class="hljs-built_in">Array</span>;<span class="hljs-comment">// true</span><span class="hljs-built_in">Array</span>.prototype.isPrototypeOf(notArr);<span class="hljs-comment">// true</span>notArr <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>;<span class="hljs-comment">// true</span><span class="hljs-built_in">Object</span>.prototype.toString.call(notArr);<span class="hljs-comment">// &quot;[object Object]&quot;</span><span class="hljs-built_in">Array</span>.isArray(notArr);<span class="hljs-comment">// false</span></code></pre></div><h2 id="æ•°ç»„å»é‡"><a href="#æ•°ç»„å»é‡" class="headerlink" title="æ•°ç»„å»é‡"></a>æ•°ç»„å»é‡</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>];<span class="hljs-comment">// 1</span><span class="hljs-keyword">let</span> uni1 = <span class="hljs-built_in">Array</span>.from(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(arr));<span class="hljs-comment">// 2</span><span class="hljs-keyword">let</span> uni2 = [...new <span class="hljs-built_in">Set</span>(arr)];<span class="hljs-comment">// 3</span><span class="hljs-keyword">let</span> uni3 = arr.sort().reduce(<span class="hljs-function">(<span class="hljs-params">pre, cur</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (pre.length === <span class="hljs-number">0</span> || pre[pre.length - <span class="hljs-number">1</span>] !== cur) pre.push(cur);<span class="hljs-keyword">return</span> pre;&#125;, []);<span class="hljs-comment">// 4</span><span class="hljs-keyword">let</span> uni4 = arr.reduce(<span class="hljs-function">(<span class="hljs-params">pre,cur</span>)=&gt;</span>&#123;<span class="hljs-keyword">if</span>(!pre.includes(cur))&#123;pre.push(cur)&#125;<span class="hljs-keyword">return</span> pre&#125;,[])<span class="hljs-comment">// 5</span><span class="hljs-keyword">let</span> uni4 = arr.filter(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> &#123;<span class="hljs-keyword">return</span> arr.indexOf(item) === index;&#125;);</code></pre></div><h2 id="è®¡ç®—æ•°ç»„ä¸­å…ƒç´ å‡ºç°çš„æ¬¡æ•°"><a href="#è®¡ç®—æ•°ç»„ä¸­å…ƒç´ å‡ºç°çš„æ¬¡æ•°" class="headerlink" title="è®¡ç®—æ•°ç»„ä¸­å…ƒç´ å‡ºç°çš„æ¬¡æ•°"></a>è®¡ç®—æ•°ç»„ä¸­å…ƒç´ å‡ºç°çš„æ¬¡æ•°</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>];<span class="hljs-comment">//reduce</span><span class="hljs-keyword">let</span> countArr = arr.reduce(<span class="hljs-function">(<span class="hljs-params">obj, i</span>) =&gt;</span> &#123;<span class="hljs-keyword">if</span> (obj[i]) &#123;obj[i]++;&#125; <span class="hljs-keyword">else</span> &#123;obj[i] = <span class="hljs-number">1</span>;&#125;<span class="hljs-keyword">return</span> obj;&#125;, &#123;&#125;);<span class="hljs-comment">// &#123; &#x27;1&#x27;: 2, &#x27;2&#x27;: 2, &#x27;3&#x27;: 2, &#x27;4&#x27;: 4 &#125;</span><span class="hljs-comment">// å¾ªç¯</span><span class="hljs-keyword">let</span> obj = &#123;&#125;;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i <span class="hljs-keyword">of</span> arr) &#123;<span class="hljs-keyword">if</span> (i <span class="hljs-keyword">in</span> obj) &#123;obj[i]++;&#125; <span class="hljs-keyword">else</span> &#123;obj[i] = <span class="hljs-number">1</span>;&#125;&#125;</code></pre></div><h2 id="å¯¹äº-obj-æŒ‰ç…§å±æ€§åˆ†ç±»"><a href="#å¯¹äº-obj-æŒ‰ç…§å±æ€§åˆ†ç±»" class="headerlink" title="å¯¹äº obj æŒ‰ç…§å±æ€§åˆ†ç±»"></a>å¯¹äº obj æŒ‰ç…§å±æ€§åˆ†ç±»</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// é¢è¯•é¢˜æ•™ä½ å½’ç±»json</span><span class="hljs-comment">// JSON.parse(jsonStr)</span><span class="hljs-keyword">let</span> person = [&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Alice&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">21</span> &#125;,&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Bob&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">21</span> &#125;,&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Hank&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;,&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Jery&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">19</span> &#125;,];<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">groupBy</span>(<span class="hljs-params">objArr, prop</span>) </span>&#123;<span class="hljs-keyword">return</span> objArr.reduce(<span class="hljs-function">(<span class="hljs-params">acc, obj</span>) =&gt;</span> &#123;<span class="hljs-keyword">let</span> key = obj[prop];<span class="hljs-keyword">if</span> (!acc[key]) acc[key] = [];acc[key].push(obj);<span class="hljs-keyword">return</span> acc;&#125;, &#123;&#125;);&#125;<span class="hljs-keyword">let</span> res = groupBy(person, <span class="hljs-string">&quot;age&quot;</span>);</code></pre></div><h2 id="æ‰å¹³åŒ–æ•°ç»„"><a href="#æ‰å¹³åŒ–æ•°ç»„" class="headerlink" title="æ‰å¹³åŒ–æ•°ç»„"></a>æ‰å¹³åŒ–æ•°ç»„</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 1 reduce</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flat1</span>(<span class="hljs-params">arr</span>) </span>&#123;  <span class="hljs-keyword">return</span> arr.reduce(<span class="hljs-function">(<span class="hljs-params">res, item</span>) =&gt;</span>  &#123;    <span class="hljs-keyword">return</span> res.concat(<span class="hljs-built_in">Array</span>.isArray(item) ? flat1(item) : item);  &#125;, []);&#125;<span class="hljs-comment">//2 é€’å½’</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flat2</span>(<span class="hljs-params">arr</span>) </span>&#123;  <span class="hljs-keyword">let</span> res = [];  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> arr) &#123;    res.push(<span class="hljs-built_in">Array</span>.isArray(item) ? (...flat2(item)) : item)  &#125;  <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-comment">// 3 å±•å¼€è¿ç®—ç¬¦</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flat3</span>(<span class="hljs-params">arr</span>) </span>&#123;  <span class="hljs-keyword">while</span> (arr.some(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>  <span class="hljs-built_in">Array</span>.isArray(item))) &#123;    arr = [].concat(...arr);  &#125;  <span class="hljs-keyword">return</span> arr;&#125;<span class="hljs-comment">// 4 toString</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flat4</span>(<span class="hljs-params">arr</span>) </span>&#123;  <span class="hljs-keyword">return</span> arr    .toString()    .split(<span class="hljs-string">&quot;,&quot;</span>)    .map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>  <span class="hljs-built_in">Number</span>(item));&#125;<span class="hljs-comment">// 5 join</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flat5</span>(<span class="hljs-params">arr</span>) </span>&#123;  <span class="hljs-keyword">return</span> arr    .join(<span class="hljs-string">&quot;,&quot;</span>)    .split(<span class="hljs-string">&quot;,&quot;</span>)    .map((item) =  <span class="hljs-built_in">Number</span>(item));&#125;<span class="hljs-comment">// 6 flat()</span>flat(<span class="hljs-literal">Infinity</span>);</code></pre></div><h2 id="æ•°ç»„æ’åº"><a href="#æ•°ç»„æ’åº" class="headerlink" title="æ•°ç»„æ’åº"></a>æ•°ç»„æ’åº</h2><h3 id="V8-ä¸­çš„-sort"><a href="#V8-ä¸­çš„-sort" class="headerlink" title="V8 ä¸­çš„ sort()"></a>V8 ä¸­çš„ sort()</h3><ul><li>  7.0 ä¹‹å‰ arr.length =10ã€æ’å…¥æ’åºã€‘ï¼Œ 10ã€å¿«é€Ÿæ’åºã€‘</li><li>  7.0 ä¹‹å ã€timesortã€‘</li></ul><h3 id="å¸¸è§æ’åºæ–¹æ³•"><a href="#å¸¸è§æ’åºæ–¹æ³•" class="headerlink" title="å¸¸è§æ’åºæ–¹æ³•"></a>å¸¸è§æ’åºæ–¹æ³•</h3><h4 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h4><blockquote><p>O(n^2) ç¬¬ä¸€ä¸ªå¾ªç¯è®¾å®šå†’æ³¡èŒƒå›´ï¼Œç¬¬äºŒä¸ªå¾ªç¯å†’æ³¡å…ƒç´ </p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bubbleSort</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Array</span>.isArray(arr) || arr.length &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> arr;<span class="hljs-keyword">const</span> len = arr.length;<span class="hljs-comment">// å¤–å±‚å¾ªç¯æ˜¯å†’æ³¡èŒƒå›´</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<span class="hljs-keyword">let</span> flag = <span class="hljs-literal">false</span>; <span class="hljs-comment">// æå‰é€€å‡ºflag</span><span class="hljs-comment">// å†…å±‚å¾ªç¯æ˜¯å†’æ³¡æ¯”è¾ƒ</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt; len - i; j++) &#123;<span class="hljs-keyword">if</span> (arr[j - <span class="hljs-number">1</span>] &gt; arr[j]) &#123;[arr[j - <span class="hljs-number">1</span>], arr[j]] = [arr[j], arr[j - <span class="hljs-number">1</span>]];flag = <span class="hljs-literal">true</span>;&#125;&#125;<span class="hljs-keyword">if</span> (flag === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span>;&#125;<span class="hljs-keyword">return</span> arr;&#125;</code></pre></div><h4 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h4><blockquote><p>O(n^2)</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insertSort</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Array</span>.isArray(arr) || arr.length &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> arr;<span class="hljs-keyword">const</span> len = arr.length;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;<span class="hljs-keyword">const</span> pivot = arr[i]; <span class="hljs-comment">// ä»indexå¼€å§‹é€‰å‡ºåŸºå‡†å€¼</span><span class="hljs-keyword">let</span> j = i;<span class="hljs-keyword">while</span> (arr[j - <span class="hljs-number">1</span>] &gt; pivot &amp;&amp; j &gt; <span class="hljs-number">0</span>) &#123;<span class="hljs-comment">// ä¸åŸºå‡†å€¼æ¯”è¾ƒ,å°†åŸºå‡†å€¼æ’å…¥æ­£ç¡®ä½ç½®</span>arr[j] = arr[j - <span class="hljs-number">1</span>]; <span class="hljs-comment">// æŠŠæ¯”åŸºå‡†å¤§çš„å…ƒç´ å‘å³è¾¹æ¬ç§»</span>j--;&#125;arr[j] = pivot;&#125;<span class="hljs-keyword">return</span> arr;&#125;<span class="hljs-comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨äº¤æ¢,æ€§èƒ½ä½</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insertSort2</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">const</span> len = arr.length;<span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> arr;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = i; j &gt; <span class="hljs-number">0</span> &amp;&amp; arr[j] &gt; arr[j - <span class="hljs-number">1</span>]; j--) &#123;[arr[j], arr[j - <span class="hljs-number">1</span>]] = [arr[j - <span class="hljs-number">1</span>], arr[j]];&#125;&#125;<span class="hljs-keyword">return</span> arr;&#125;</code></pre></div><h4 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h4><blockquote><p>O(n^2) ä¸ç¨³å®š</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">selectSort</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(arr) !== <span class="hljs-literal">true</span> || arr.length &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> arr;<span class="hljs-keyword">const</span> len = arr.length;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len - <span class="hljs-number">1</span>; i++) &#123;<span class="hljs-keyword">let</span> minIndex = i;<span class="hljs-comment">// å‡è®¾iä¸ºä»iåˆ°lençš„æœ€å°å€¼</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = i + <span class="hljs-number">1</span>; j &lt; len; j++) &#123;<span class="hljs-comment">// ä»i+1å¼€å§‹å¯»æ‰¾æœ€å°å€¼</span><span class="hljs-keyword">if</span> (arr[j] &lt; arr[minIndex]) &#123;minIndex = j;&#125;&#125;<span class="hljs-comment">// æ›¿æ¢iä½ç½®çš„å€¼å¾—</span>[arr[minIndex], arr[i]] = [arr[i], arr[minIndex]];&#125;<span class="hljs-keyword">return</span> arr;&#125;</code></pre></div><blockquote><p>å¯¹äºå¤§é‡æ•°æ®,ä¸Šè¿°ä¸‰ç§ O(n^2)çš„æ—¶é—´å¤æ‚åº¦éš¾ä»¥æ¥å—</p></blockquote><h4 id="å¹¶å½’æ’åº"><a href="#å¹¶å½’æ’åº" class="headerlink" title="å¹¶å½’æ’åº"></a>å¹¶å½’æ’åº</h4><blockquote><p>O(n log n)</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeSort</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">if</span> (arr.length === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> arr;<span class="hljs-comment">// once function &#x27;mergeSort&#x27; run ,split arr to two group length equally</span><span class="hljs-keyword">const</span> mid = <span class="hljs-built_in">Math</span>.floor(arr.length / <span class="hljs-number">2</span>);<span class="hljs-keyword">const</span> left = arr.slice(<span class="hljs-number">0</span>, mid);<span class="hljs-keyword">const</span> right = arr.slice(mid);<span class="hljs-keyword">return</span> merge(mergeSort(left), mergeSort(right));&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">merge</span>(<span class="hljs-params">l, r</span>) </span>&#123;<span class="hljs-keyword">const</span> res = [];<span class="hljs-keyword">while</span> (l.length &gt; <span class="hljs-number">0</span> &amp;&amp; r.length &gt; <span class="hljs-number">0</span>) &#123;<span class="hljs-comment">//notice: â€˜&amp;&amp;â€™ not â€˜||â€˜</span><span class="hljs-keyword">if</span> (l[<span class="hljs-number">0</span>] &gt; r[<span class="hljs-number">0</span>]) &#123;res.push(r.shift());&#125; <span class="hljs-keyword">else</span> &#123;res.push(l.shift());&#125;&#125;<span class="hljs-comment">// one of l and r is empty,concat it to Array &#x27;res&#x27;</span><span class="hljs-keyword">return</span> res.concat(l).concat(r);&#125;</code></pre></div><h4 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h4><blockquote><p>å¹³å‡ O(n log n)</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">quickSort</span>(<span class="hljs-params">arr</span>)</span>&#123;  <span class="hljs-keyword">if</span> (arr.length &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> arr; <span class="hljs-comment">//ä¸€ç›´æ’åºåˆ°åŒºé—´å†…åªæœ‰ä¸€ä¸ªæ•°</span>  <span class="hljs-keyword">var</span> pivotIndex = <span class="hljs-built_in">Math</span>.floor(arr.length / <span class="hljs-number">2</span>); <span class="hljs-comment">//åŸºå‡†ä½ç½®ï¼ˆå¯ä»»æ„é€‰å–ï¼‰</span>  <span class="hljs-keyword">var</span> pivot = arr.splice(pivotIndex, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]; <span class="hljs-comment">//æ‰¾å‡ºåŸºå‡†æ•°å¹¶æŠŠå®ƒä»åŸæ•°ç»„åˆ é™¤</span>  <span class="hljs-keyword">var</span> left = [];  <span class="hljs-comment">// ç©ºé—´å¤æ‚åº¦O(n)</span>  <span class="hljs-keyword">var</span> right = [];  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;    <span class="hljs-keyword">if</span> (arr[i] &lt; pivot) &#123;<span class="hljs-comment">// å°äºåœ¨å·¦è¾¹å¤§äºåœ¨å³</span>      left.push(arr[i]);    &#125; <span class="hljs-keyword">else</span> &#123;      right.push(arr[i]);    &#125;  &#125;  <span class="hljs-keyword">return</span> [...quickSort(left), pivot, ...quickSort(right)]&#125;<span class="hljs-comment">// ä¸ä½¿ç”¨é¢å¤–ç©ºé—´,åœ¨åŸæ•°ç»„äº¤æ¢å…ƒç´ ä½ç½®</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">quickSort</span>(<span class="hljs-params">arr</span>) </span>&#123;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">quick</span>(<span class="hljs-params">arr,l,r</span>)</span>&#123;    <span class="hljs-keyword">const</span> index = partition(arr,l,r)    <span class="hljs-comment">// partitionå‡½æ•°å–å‡ºä¸€ä¸ªåŸºå‡†ç´¢å¼•ï¼Œå¹¶ä¼šä¾æ®åŸºå‡†åˆ†ä¸ºå¤§äºå°äºåŸºå‡†çš„ä¸¤éƒ¨åˆ†</span>    <span class="hljs-keyword">if</span>(l&lt;index)&#123;      quick(arr,l,index-<span class="hljs-number">1</span>)    &#125;    <span class="hljs-keyword">if</span>(r&gt;index)&#123;      quick(arr,index+<span class="hljs-number">1</span>,r)    &#125;  &#125;  quick(arr,<span class="hljs-number">0</span>,arr.length-<span class="hljs-number">1</span>)  <span class="hljs-keyword">return</span> arr&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">partition</span>(<span class="hljs-params">arr,l,r</span>)</span>&#123;  <span class="hljs-comment">// è¿™é‡Œç›´æ¥ä½¿ç”¨rä½œä¸ºåŸºå‡†ï¼Œä¸ç”¨éšæœºå€¼</span>  <span class="hljs-comment">// i æ˜¯æ’åºåpivotçš„æ­£ç¡®ä½ç½®ï¼Œåˆå§‹è®¾ç½®ä¸ºæœ€å·¦</span>  <span class="hljs-keyword">let</span> i = l  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j = l ; j&lt;r ; j++)&#123;    <span class="hljs-comment">// åˆ¤æ–­ç›¸å¯¹äºåŸºå‡†çš„å¤§å°å¹¶æ›´æ–°içš„ä½ç½®</span>    <span class="hljs-comment">// iå·¦è¾¹æ˜¯å·²ç»æ¯”è¾ƒå®Œçš„åŒºé—´,éƒ½æ¯”arr[r]å°</span>    <span class="hljs-keyword">if</span>(arr[j]&lt;arr[r])&#123;      [arr[j],arr[i]] = [arr[i],arr[j]]<span class="hljs-comment">// jå‘å³æ‰«çš„è¿‡ç¨‹ä¸­é‡åˆ°æ¯”åŸºå‡†å°çš„å€¼æ—¶,iåœç•™åœ¨ä¸Šä¸€ä¸ªæ¯”åŸºå‡†å¤§çš„ä½ç½®,åˆ™å¯¹ä»–ä¸¤è¿›è¡Œäº¤æ¢</span>      i++    &#125;  &#125;  <span class="hljs-comment">// pivotå½’ä½,æœ€åä»¥iä½ç½®å®Œæˆåˆ†ç•Œ</span>  [arr[i],arr[r]] = [arr[r],arr[i]]  <span class="hljs-keyword">return</span> i&#125;</code></pre></div><h4 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h4><blockquote><p>å¹³å‡ O(n log 2n) æœ€å O(n^2)<br>ç›¸å½“äºè®¾ç½®åŠ¨æ€é—´éš”çš„æ’å…¥æ’åº</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ç§»åŠ¨</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shellSort1</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">const</span> len = arr.length;<span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> arr;<span class="hljs-keyword">let</span> gap = len &gt;&gt; <span class="hljs-number">1</span>;<span class="hljs-comment">// è¿™é‡Œåˆå§‹è®¾ä¸ºé•¿åº¦ä¸€åŠ</span><span class="hljs-keyword">for</span> (; gap &gt; <span class="hljs-number">0</span>; gap = gap &gt;&gt; <span class="hljs-number">1</span>) &#123;<span class="hljs-comment">// ä¸æ–­ç¼©å°é—´éš”çš„é•¿åº¦</span><span class="hljs-comment">// æœ€ç»ˆä¼šä¸º1</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = gap; i &lt; len; i++) &#123;<span class="hljs-keyword">const</span> pivot = arr[i];<span class="hljs-keyword">let</span> j = i;<span class="hljs-keyword">while</span> (arr[j - gap] &gt; pivot &amp;&amp; j - gap &gt;= <span class="hljs-number">0</span>) &#123;arr[j] = arr[j - gap];j -= gap;&#125;arr[j] = pivot;&#125;&#125;<span class="hljs-keyword">return</span> arr;&#125;</code></pre></div><h4 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h4><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å»ºç«‹å¤§é¡¶å †</span><span class="hljs-comment">// ä¾æ¬¡å°†æœ«å°¾å…ƒç´ ä¸heap[1]äº¤æ¢ä½ç½®å¹¶è°ƒæ•´å †ï¼ŒåŒæ—¶ç¼©å°å †çš„å¤§å°ï¼ˆæ’é™¤æœ€åçš„å¤§æ•°ï¼‰</span><span class="hljs-comment">// heap[2]å’Œheap[1]äº¤æ¢å®Œæˆåå°±æ˜¯å‡åºæ’åº</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heapSort</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">const</span> heap = [, ...arr];<span class="hljs-keyword">let</span> heapSize = arr.length;buildHeap(heap, heapSize);<span class="hljs-comment">// å¼€å§‹äº¤æ¢å¤´å°¾</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = heapSize; k &gt; <span class="hljs-number">1</span>; k--) &#123;[heap[k], heap[<span class="hljs-number">1</span>]] = [heap[<span class="hljs-number">1</span>], heap[k]];heapify(heap, --heapSize, <span class="hljs-number">1</span>);&#125;heap.shift();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildHeap</span>(<span class="hljs-params">heap, size</span>) </span>&#123;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-built_in">Math</span>.floor(size / <span class="hljs-number">2</span>); i &gt;= <span class="hljs-number">1</span>; i--) &#123;heapify(heap, size, i);&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heapify</span>(<span class="hljs-params">heap, heapSize, i</span>) </span>&#123;<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<span class="hljs-keyword">let</span> maxIndex = i;<span class="hljs-keyword">if</span> (<span class="hljs-number">2</span> * i &lt;= heapSize &amp;&amp; heap[<span class="hljs-number">2</span> * i] &gt; heap[i]) maxIndex = <span class="hljs-number">2</span> * i;<span class="hljs-keyword">if</span> (<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span> &lt;= heapSize &amp;&amp; heap[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>] &gt; heap[maxIndex]) maxIndex = <span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>;<span class="hljs-keyword">if</span> (maxIndex === i) <span class="hljs-keyword">break</span>;[heap[maxIndex], heap[i]] = [heap[i], heap[maxIndex]];i = maxIndex;&#125;&#125;&#125;</code></pre></div><h4 id="è®°æ•°æ’åºğŸ¤¯"><a href="#è®°æ•°æ’åºğŸ¤¯" class="headerlink" title="è®°æ•°æ’åºğŸ¤¯"></a>è®°æ•°æ’åºğŸ¤¯</h4><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">countSort</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">let</span> maxValue = arr[<span class="hljs-number">0</span>];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> n <span class="hljs-keyword">of</span> arr) &#123;<span class="hljs-keyword">if</span> (n &gt; maxValue) maxValue = n;&#125;<span class="hljs-comment">// æ‰¾å‡ºæ•°æ®ä¸­çš„æœ€å¤§å€¼</span><span class="hljs-keyword">const</span> countArr = <span class="hljs-built_in">Array</span>(maxValue + <span class="hljs-number">1</span>).fill(<span class="hljs-number">0</span>);<span class="hljs-comment">// å»ºç«‹è®¡æ•°æ•°ç»„ï¼Œä¸‹æ ‡ä¸ºæ•°æ®å€¼ï¼Œå…ƒç´ ä¸ºç›¸åŒå…ƒç´ ä¸ªæ•°</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> n <span class="hljs-keyword">of</span> arr) &#123;countArr[n]++;&#125;<span class="hljs-comment">// ç»Ÿè®¡æ•°æ®å‡ºç°æ¬¡æ•°åŠ å…¥è®¡æ•°æ•°ç»„</span><span class="hljs-comment">// å¯¹è®¡æ•°æ•°ç»„æ‰§è¡Œç´¯åŠ æ“ä½œ</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; countArr.length; i++) &#123;countArr[i] += countArr[i - <span class="hljs-number">1</span>];&#125;<span class="hljs-comment">// countArrä¸­å…ƒç´ å³ä»£è¡¨arrä¸­å…ƒç´ å°äºç­‰äºè¯¥ä¸‹æ ‡çš„æ•°é‡</span><span class="hljs-keyword">const</span> temp = <span class="hljs-built_in">Array</span>(arr.length);<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = arr.length - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">0</span>; j--) &#123;<span class="hljs-keyword">let</span> num = arr[j];<span class="hljs-keyword">let</span> pos = countArr[num] - <span class="hljs-number">1</span>;<span class="hljs-comment">// å¾—å‡ºé¡ºåºæ­£ç¡®çš„ç´¢å¼•</span>temp[pos] = num;<span class="hljs-comment">// arræŒ‡é’ˆå‘å·¦æ‰«ï¼Œå½’ä½å…ƒç´ åå°†ç´¯åŠ è®¡æ•°æ•°ç»„ä¸­è®¡æ•°-1</span>countArr[num]--;&#125;<span class="hljs-keyword">return</span> temp; <span class="hljs-comment">// or copy temp to origin arr</span>&#125;</code></pre></div><h4 id="æ´—ç‰Œç®—æ³•"><a href="#æ´—ç‰Œç®—æ³•" class="headerlink" title="æ´—ç‰Œç®—æ³•"></a>æ´—ç‰Œç®—æ³•</h4><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shuffle</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">return</span> arr.sort(<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">Math</span>.random() - <span class="hljs-number">0.5</span>);<span class="hljs-comment">//ç”±äºjsä¸­sortæ–¹æ³•çš„ç‰¹æ®Šæ€§ï¼Œå¯¹äºæ•°æ®é‡å°äº10å’Œå¤§äº10çš„æ’åºæ–¹æ³•ä¸ä¸€æ ·</span><span class="hljs-comment">// Math.random()-0.5ä¸èƒ½åšåˆ°çœŸæ­£æ„ä¹‰ä¸Šçš„å®Œå…¨éšæœº</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shuffle</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">let</span> len = arr.length;<span class="hljs-keyword">while</span> (len) &#123;<span class="hljs-keyword">const</span> i = (<span class="hljs-built_in">Math</span>.random() * len) &gt;&gt; <span class="hljs-number">0</span><span class="hljs-comment">// éšæœºä½ç½®å’Œæœ«å°¾äº¤æ¢</span>[arr[i], arr[len-<span class="hljs-number">1</span>]] = [arr[len-<span class="hljs-number">1</span>], arr[i]];len -- <span class="hljs-comment">// const i = (Math.random() * len--) &gt;&gt; 0;</span><span class="hljs-comment">// [arr[i], arr[len]] = [arr[len], arr[i]];</span>&#125;<span class="hljs-keyword">return</span> arr;&#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ˆç®—æ³•é¢˜</title>
    <link href="/2022/02/24/%E6%A0%88%E7%BB%93%E6%9E%84%E7%AE%97%E6%B3%95%E9%A2%98/"/>
    <url>/2022/02/24/%E6%A0%88%E7%BB%93%E6%9E%84%E7%AE%97%E6%B3%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="æ ˆç»“æ„ï¼Œå…ˆè¿›åå‡º"><a href="#æ ˆç»“æ„ï¼Œå…ˆè¿›åå‡º" class="headerlink" title="æ ˆç»“æ„ï¼Œå…ˆè¿›åå‡º"></a>æ ˆç»“æ„ï¼Œå…ˆè¿›åå‡º</h2><ul><li><p>æœ€å°æ ˆ</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MinStack</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-built_in">this</span>.stack = []  <span class="hljs-built_in">this</span>.min = [<span class="hljs-literal">Infinity</span>]&#125;MinStack.prototype.push = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>)</span>&#123;  <span class="hljs-built_in">this</span>.stack.push(item)  <span class="hljs-built_in">this</span>.min.push(<span class="hljs-built_in">Math</span>.min(<span class="hljs-built_in">this</span>.min[<span class="hljs-built_in">this</span>.min.length-<span class="hljs-number">1</span>],item))&#125;MinStack.prototype.pop = <span class="hljs-function"><span class="hljs-keyword">function</span></span>&#123;  <span class="hljs-built_in">this</span>.stack.pop()  <span class="hljs-built_in">this</span>.min.pop()&#125;MinStack.prototype.top = <span class="hljs-function"><span class="hljs-keyword">function</span></span>&#123;  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.stack[<span class="hljs-built_in">this</span>.stack.length-<span class="hljs-number">1</span>]&#125;MinStack.prototype.min = <span class="hljs-function"><span class="hljs-keyword">function</span></span>&#123;  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.min[<span class="hljs-built_in">this</span>.min.length-<span class="hljs-number">1</span>]&#125;</code></pre></div></li><li><p>åˆ¤æ–­æ‹¬å·æ˜¯å¦åˆæ³•</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ()</span><span class="hljs-comment">// []</span><span class="hljs-comment">// &#123;&#125;</span><span class="hljs-comment">// (&#123;[)]&#125;</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bracketCheck</span>(<span class="hljs-params">str</span>)</span>&#123;  <span class="hljs-keyword">const</span> brackets = &#123;    <span class="hljs-string">&#x27;(&#x27;</span>:<span class="hljs-string">&#x27;)&#x27;</span>,    <span class="hljs-string">&#x27;&#123;&#x27;</span>:<span class="hljs-string">&#x27;&#125;&#x27;</span>,    <span class="hljs-string">&#x27;[&#x27;</span>:<span class="hljs-string">&#x27;]&#x27;</span>  &#125;  <span class="hljs-keyword">let</span> stack = []  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ;i&lt;str.length;i++)&#123;    <span class="hljs-keyword">if</span>(brackets[str[i]])&#123;      stack.push([str[i]])    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(str[i] !== brackets[stack.pop()])&#123;      <span class="hljs-comment">// è¿™ä¸ªå†™æ³•6âƒ£ï¸å•Š</span>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>    &#125;  &#125;  <span class="hljs-keyword">return</span> stack.length === <span class="hljs-number">0</span>&#125;</code></pre></div><ul><li>ç”Ÿæˆnå¯¹æ‹¬å·<br>æ•°å­— nÂ ä»£è¡¨ç”Ÿæˆæ‹¬å·çš„å¯¹æ•°ï¼Œè¯·ä½ è®¾è®¡ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºèƒ½å¤Ÿç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„å¹¶ä¸” æœ‰æ•ˆçš„ æ‹¬å·ç»„åˆã€‚</li></ul><p>è¾“å…¥ï¼šn = 3<br>è¾“å‡ºï¼š[â€œ((()))â€,â€(()())â€,â€(())()â€,â€()(())â€,â€()()()â€]</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateParenthesis</span>(<span class="hljs-params">n</span>)</span>&#123;  <span class="hljs-comment">//nå¯¹æ‹¬å·</span>  <span class="hljs-comment">//å¯ç”¨çš„å·¦æ‹¬å·æ•°é‡l=n</span>  <span class="hljs-comment">//å¯ç”¨çš„å³æ‹¬å·æ•°é‡r=n</span>  <span class="hljs-keyword">const</span> res = []  DFS(n,n,<span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-keyword">return</span> res  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DFS</span>(<span class="hljs-params">l,r,str</span>)</span>&#123;    <span class="hljs-comment">// è€ƒè™‘åˆç†é—­åˆçš„æ‹¬å·ç»„åˆ</span>    <span class="hljs-comment">// ç”Ÿæˆè¿‡ç¨‹ä¸­å·¦å³æ‹¬å·å¯ä½¿ç”¨çš„æ•°é‡</span>    <span class="hljs-keyword">if</span>(str.length===<span class="hljs-number">2</span>*n)&#123;      <span class="hljs-comment">// 2nä¸ªå­—ç¬¦è¯´æ˜å‡‘å¤Ÿä¸€ç§</span>      <span class="hljs-keyword">return</span> res.push(str)    &#125;    <span class="hljs-keyword">if</span>(l&gt;<span class="hljs-number">0</span>)&#123;      <span class="hljs-comment">// å·¦æ‹¬å·æœ‰å°±èƒ½ç”¨</span>      DFS(l-<span class="hljs-number">1</span>,r,str+<span class="hljs-string">&#x27;(&#x27;</span>)    &#125;    <span class="hljs-keyword">if</span>(l&lt;r)&#123;      DFS(l,r-<span class="hljs-number">1</span>,str+<span class="hljs-string">&#x27;)&#x27;</span>)    &#125;  &#125;&#125;</code></pre></div><ul><li>åˆ é™¤å­—ç¬¦ä¸²å†…ç›¸é‚»é‡å¤é¡¹<br>ç»™å‡ºç”±å°å†™å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² S ï¼Œåˆ é™¤æ‰€æœ‰ç›¸é‚»é‡å¤é¡¹<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// &#x27;ababccca&#x27;</span><span class="hljs-comment">// pre = &#x27;&#x27;</span><span class="hljs-comment">// c = a</span><span class="hljs-comment">// stack = [&#x27;&#x27;,a]</span><span class="hljs-comment">// pre = a</span><span class="hljs-comment">// c = c</span><span class="hljs-comment">// stack = [&#x27;&#x27;,a,c]</span><span class="hljs-comment">// pre = c</span><span class="hljs-comment">// c = c</span><span class="hljs-comment">// stack = [&#x27;&#x27;,a]</span><span class="hljs-comment">// pre = a</span><span class="hljs-comment">// c = c</span><span class="hljs-comment">// stack = [&#x27;&#x27;,a,c]</span><span class="hljs-comment">//</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delDup</span>(<span class="hljs-params">s</span>)</span>&#123;  <span class="hljs-keyword">const</span> stack = [s[<span class="hljs-number">0</span>]]  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span> ;i &lt; s.length ;i++)&#123;    <span class="hljs-keyword">const</span> pre = stack.pop()    <span class="hljs-comment">// æ¯æ¬¡å–å‡ºä¸Šä¸€ä¸ªæœ«å°¾å­—ç¬¦</span>    <span class="hljs-keyword">const</span> cur = s[i]    <span class="hljs-keyword">if</span>(cur !== pre)&#123;      <span class="hljs-comment">// ä¸æ˜¯ç›¸åŒå­—ç¬¦åˆ™å­˜å‚¨èµ·æ¥</span>      <span class="hljs-comment">// æ˜¯ç›¸åŒå­—ç¬¦åˆ™ç”±äºpopæ–¹æ³•å·²ç»ä»ç»“æœä¸­åˆ é™¤</span>      stack.push(pre,cur)    &#125;  &#125;  <span class="hljs-keyword">return</span> stack.join(<span class="hljs-string">&#x27;&#x27;</span>)&#125;</code></pre></div></li></ul><ul><li>æ»‘åŠ¨çª—å£æœ€å¤§å€¼<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// k ä¸ºçª—å£å¤§å°</span><span class="hljs-comment">// windowå­˜å‚¨æ•°ç»„ç´¢å¼•</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maxInSlideWin</span>(<span class="hljs-params">arr,k</span>)</span>&#123;  <span class="hljs-keyword">let</span> res = []  <span class="hljs-keyword">let</span> <span class="hljs-built_in">window</span> = []  <span class="hljs-comment">// windowå­˜å‚¨ç´¢å¼•</span>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ; i &lt; arr.length ; i++)&#123;    <span class="hljs-keyword">if</span>(i-<span class="hljs-built_in">window</span>[<span class="hljs-number">0</span>]&gt;=k)&#123;      <span class="hljs-comment">// çª—å£å¤§å°è¶…è¿‡é™åˆ¶</span>      <span class="hljs-built_in">window</span>.shift()      <span class="hljs-comment">// æŠ›å¼ƒå‰é¢çš„å€¼</span>    &#125;    <span class="hljs-keyword">while</span>(arr[<span class="hljs-built_in">window</span>[<span class="hljs-built_in">window</span>.length-<span class="hljs-number">1</span>]]&lt;=arr[i])&#123;      <span class="hljs-comment">// ç”¨æŒ‡é’ˆä½ç½®çš„å€¼ä¸çª—å£å°¾éƒ¨ç´¢å¼•å€¼æ¯”è¾ƒ</span>      <span class="hljs-comment">// å¾ªç¯åˆ é™¤æ¯”æŒ‡é’ˆå°çš„å€¼ç´¢å¼•</span>      <span class="hljs-built_in">window</span>.pop()    &#125;    <span class="hljs-built_in">window</span>.push(i)    <span class="hljs-comment">// iä¹‹å‰éƒ½æ¯”iå¤§</span>    <span class="hljs-keyword">if</span>(i&gt;=k-<span class="hljs-number">1</span>)&#123;      <span class="hljs-comment">// ç´¢å¼•k-1å¼€å§‹æ”¶é›†çª—å£æœ€å¤§å€¼ï¼Œ</span>      <span class="hljs-comment">// k-1ä¹‹å‰çª—å£éƒ½è¿˜æ²¡åˆ°å°ºå¯¸</span>      res.push(arr[<span class="hljs-built_in">window</span>[<span class="hljs-number">0</span>]])      <span class="hljs-comment">// ä¿è¯çª—å£å†…æœ€å·¦å€¼=è¾¹ç´¢å¼•ä¸ºæœ€å¤§å€¼</span>    &#125;  &#125;  <span class="hljs-keyword">return</span> res&#125;</code></pre></div></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµè§ˆå™¨ç¼“å­˜ç­–ç•¥</title>
    <link href="/2022/02/24/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5/"/>
    <url>/2022/02/24/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼ºç¼“å­˜"><a href="#å¼ºç¼“å­˜" class="headerlink" title="å¼ºç¼“å­˜"></a>å¼ºç¼“å­˜</h1><p>æµè§ˆå™¨åœ¨æœ¬åœ°éªŒè¯èµ„æºæ˜¯å¦è¿‡æœŸï¼Œå¦‚æœæ²¡è¿‡æœŸç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œå¹¶è¿”å›<code>200</code>å’Œæ˜¾ç¤º(<code>from memory cache / from disk cache)</code>(æ ¹æ®å†…å­˜ç©ºé—²æƒ…å†µå’Œèµ„æºç±»å‹ï¼Œå¹¶ä¸”memory cacheé¡µé¢å…³é—­åä¼šæ¸…ç†ï¼Œä¸‹æ¬¡åŠ è½½æ˜¯ä»disk cache)</p><h2 id="å¼ºç¼“å­˜å­—æ®µ"><a href="#å¼ºç¼“å­˜å­—æ®µ" class="headerlink" title="å¼ºç¼“å­˜å­—æ®µ"></a>å¼ºç¼“å­˜å­—æ®µ</h2><h3 id="Expires"><a href="#Expires" class="headerlink" title="Expires"></a><code>Expires</code></h3><ul><li> http 1.0</li><li> æ—¶é—´æˆ³æ ¼å¼<code>Expires: Wed, 22 Oct 2018 08:41:00 GMT</code></li><li> âš ï¸ä½¿ç”¨æœ¬åœ°æ—¶é—´éªŒè¯ï¼Œä¸æœåŠ¡å™¨æ—¶é—´ä¹‹é—´çš„è¯¯å·®æˆ–è€…æœ¬åœ°æ—¶é—´çš„ä¿®æ”¹éƒ½åä¼šé€ æˆç¼“å­˜å¤±æ•ˆ</li></ul><h3 id="Cache-control"><a href="#Cache-control" class="headerlink" title="Cache-control"></a><code>Cache-control</code></h3><ul><li> http 1.1</li><li>å¯é€‰å‚æ•°ï¼š<ul><li><code>public</code>,<code>private</code><ul><li><code>public</code> è¡¨ç¤ºè¯¥èµ„æºå¯ä»¥è¢«æ‰€æœ‰å®¢æˆ·ç«¯å’Œä»£ç†æœåŠ¡å™¨ç¼“å­˜</li><li><code>private</code> è¡¨ç¤ºè¯¥èµ„æºä»…èƒ½å®¢æˆ·ç«¯ç¼“å­˜[<em>é»˜è®¤å€¼</em>]</li></ul></li><li><code>max-age</code><em>ç›¸å¯¹èµ„æºé¦–æ¬¡è¢«è¯·æ±‚çš„æ—¶é—´</em><ul><li>å•ä½ä¸ºæ¯«ç§’ï¼Œè¡¨ç¤ºå¤šé•¿æ—¶é—´åè¿‡æœŸ</li><li>å¯è®¾ç½®ä¸º <strong>0</strong> ç«‹å³è¯·æ±‚æ–°èµ„æº</li></ul></li><li><code>s-maxage</code> ä¼šåœ¨<code>public</code>å­—æ®µç”Ÿæ•ˆæ—¶è¦†ç›–<code>Expires</code>å’Œ<code>max-age</code> </li><li><code>no-cache</code>,<code>no-store</code><ul><li><code>no-cache</code> ä¼šç¼“å­˜èµ„æºï¼Œä½†è¦åå•†ç¼“å­˜éªŒè¯</li><li><code>no-store</code> ä¸ç¼“å­˜</li></ul></li><li><code>max-age=0 || no-cache</code>ä¼šè¿›å…¥åå•†ç¼“å­˜</li></ul></li></ul><h3 id="Pragma"><a href="#Pragma" class="headerlink" title="Pragma"></a><code>Pragma</code></h3><ul><li> åªä¸ºäº†å…¼å®¹http1.0</li><li> <code>Pragma = no-cache</code>ä¸<code>Cache-Control: no-cache</code>æ•ˆæœä¸€è‡´</li></ul><h3 id="ä¼˜å…ˆçº§"><a href="#ä¼˜å…ˆçº§" class="headerlink" title="ä¼˜å…ˆçº§"></a>ä¼˜å…ˆçº§</h3><p><code>Cache-Control -&gt; Expires</code></p><h1 id="åå•†ç¼“å­˜"><a href="#åå•†ç¼“å­˜" class="headerlink" title="åå•†ç¼“å­˜"></a>åå•†ç¼“å­˜</h1><p>æµè§ˆå™¨æºå¸¦ç¼“å­˜æ ‡è¯†å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œè¯¢é—®æœåŠ¡å™¨ç¼“å­˜æœ‰æ•ˆæ€§ï¼Œåå•†ç¼“å­˜ç”Ÿæ•ˆï¼Œè¿”å›<code>304</code>å’Œ<code>Not Modified</code>ï¼Œåå•†ç¼“å­˜å¤±æ•ˆï¼Œè¿”å›<code>200</code>å’Œè¯·æ±‚ç»“æœ</p><h2 id="åå•†ç¼“å­˜å­—æ®µ"><a href="#åå•†ç¼“å­˜å­—æ®µ" class="headerlink" title="åå•†ç¼“å­˜å­—æ®µ"></a>åå•†ç¼“å­˜å­—æ®µ</h2><h3 id="Last-modified-If-Modified-Since"><a href="#Last-modified-If-Modified-Since" class="headerlink" title="Last-modified + If-Modified-Since"></a><code>Last-modified + If-Modified-Since</code></h3><ul><li><p>æœåŠ¡å™¨è¿”å›èµ„æºçš„åŒæ—¶åœ¨<code>response header</code>ä¸­æ·»åŠ  <code>Last-Modified</code>å­—æ®µï¼Œå€¼æ˜¯è¯¥èµ„æºåœ¨æœåŠ¡å™¨ä¸Šçš„æœ€åä¿®æ”¹æ—¶é—´<br>  <code>Last-Modified: Fri, 22 Jul 2016 01:47:00 GMT</code></p></li><li><p> å†æ¬¡è¯·æ±‚è¯¥èµ„æºæ—¶ï¼Œæµè§ˆå™¨æ£€æµ‹åˆ°èµ„æºä¸­å­˜åœ¨ <code>Last-Modified</code>å­—æ®µï¼Œåˆ™ä¼šå°†è¿™ä¸ªæ—¶é—´æˆ³ä½œä¸º<code>If-Modified-Since</code>çš„å€¼åŠ å…¥è¯·æ±‚å¤´ä¸­å‘é€ç»™æœåŠ¡å™¨</p></li><li><p> æœåŠ¡å™¨æ ¹æ®è‡ªèº«èµ„æºçš„ä¿®æ”¹æ—¶é—´å’Œæ¥è‡ªè¯·æ±‚çš„æ—¶é—´æˆ³åˆ¤æ–­èµ„æºæ˜¯å¦æ›´æ–°ï¼Œè¿”å›ç›¸å¯¹åº”çš„ç»“æœ</p></li></ul><blockquote><p>ç¼ºç‚¹</p></blockquote><ul><li>æœ¬åœ°æ‰“å¼€ç¼“å­˜æ–‡ä»¶ï¼Œå³ä½¿æ²¡æœ‰å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œä½†è¿˜æ˜¯ä¼šé€ æˆ <code>Last-Modified</code> è¢«ä¿®æ”¹</li><li><code>Last-Modified</code> åªèƒ½ä»¥ç§’è®¡æ—¶ï¼Œå¦‚æœåœ¨ä¸å¯æ„ŸçŸ¥çš„æ—¶é—´å†…ä¿®æ”¹å®Œæˆæ–‡ä»¶ï¼Œåˆ™ä¸èƒ½ä½“ç°è¢«ä¿®æ”¹è¿‡</li></ul><h3 id="ETag-If-Not-Match"><a href="#ETag-If-Not-Match" class="headerlink" title="ETag + If-Not-Match"></a><code>ETag + If-Not-Match</code></h3><ul><li><p> æœåŠ¡å™¨ä¸ºèµ„æºè¿›è¡Œhashè®¡ç®—ç”Ÿæˆå”¯ä¸€çš„æ ‡è¯†ç¬¦<code>Etag</code>åŠ å…¥è¿”å›å¤´ï¼Œèµ„æºçš„ä¿®æ”¹ä¼šå¯¼è‡´æ ‡è¯†æ”¹å˜</p></li><li><p> æµè§ˆå™¨è¯·æ±‚æ—¶å°†èµ„æºè‡ªå¸¦çš„æ ‡è¯†ä½œä¸º<code>If-None-Match</code>çš„å€¼åŠ å…¥è¯·æ±‚å¤´ä¸­å‘é€ç»™æœåŠ¡å™¨</p></li><li><p> æœåŠ¡å™¨æ ¹æ®åŒä¸€èµ„æºæ ‡è¯†æ˜¯å¦ä¸€è‡´è¿”å›ç›¸åº”ç»“æœ</p></li><li><p><code>ETag:\W å¼±éªŒè¯</code>: æ–°æ—§èµ„æºä¸éœ€è¦é€å­—èŠ‚ä¸€ä¸€å¯¹åº”æ–°æ—§èµ„æºçš„æ¯”è¾ƒä¼šä½¿ç”¨è¾ƒä¸ºå®½æ¾çš„ç®—æ³•</p></li><li><p><code>If-Matchæ¡ä»¶è¯·æ±‚</code>: åœ¨è¯·æ±‚æ–¹æ³•ä¸º GET å’Œ HEAD çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä»…åœ¨è¯·æ±‚çš„èµ„æºåŒ¹é…è¯¥ETagå€¼æ—¶æ‰ä¼šè¿”å›èµ„æºã€‚è€Œå¯¹äº PUT æˆ–å…¶ä»–éå®‰å…¨æ–¹æ³•æ¥è¯´ï¼Œåªæœ‰åœ¨æ»¡è¶³æ¡ä»¶çš„æƒ…å†µä¸‹æ‰å¯ä»¥å°†æ•°æ®ä¸Šä¼ ã€‚ä¾‹å¦‚:Rangeè¯·æ±‚ or é¿å…æ›´æ–°ä¸¢å¤±ï¼ˆç”¨æˆ·ä¸Šä¼ è¦†ç›–å…¶ä»–ç”¨æˆ·æäº¤çš„æ›´æ–°ï¼‰</p><h1 id="ç¼“å­˜ç­–ç•¥"><a href="#ç¼“å­˜ç­–ç•¥" class="headerlink" title="ç¼“å­˜ç­–ç•¥"></a>ç¼“å­˜ç­–ç•¥</h1></li></ul><ol><li><p>å…ˆåˆ¤æ–­<code>Cache-Control</code>ï¼Œåœ¨<code>Cache-Control</code>çš„<code>max-age</code>ä¹‹å†…ï¼Œç›´æ¥è¿”å›<code>200 from cache</code>ï¼›</p></li><li><p>æ²¡æœ‰<code>Cache-Control</code>å†åˆ¤æ–­<code>Expires</code>ï¼Œåœ¨<code>Expires</code>ä¹‹å†…ï¼Œç›´æ¥è¿”å›<code>200 from cache</code></p></li><li><p><code>Cache-Control=no-cache/no-store</code>æˆ–è€…ä¸ç¬¦åˆ<code>Expires</code>ï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚</p></li><li><p> æœåŠ¡å™¨åˆ¤æ–­<code>If-Modified-Since</code>å’Œ<code>If-None-Match</code>ï¼Œä¸¤è€…åŒæ—¶å‡ºç°æ—¶ä¼šå¿½ç•¥<code>If-Modified-Since</code>ï¼Œæœ‰æ•ˆåˆ™è¿”å›<code>304</code>ï¼Œå¤±æ•ˆåˆ™è¿”å›æ–°èµ„æºã€‚</p></li></ol><h2 id="ç”¨æˆ·è¡Œä¸ºçš„å½±å“"><a href="#ç”¨æˆ·è¡Œä¸ºçš„å½±å“" class="headerlink" title="ç”¨æˆ·è¡Œä¸ºçš„å½±å“"></a>ç”¨æˆ·è¡Œä¸ºçš„å½±å“</h2><ol><li><em>åœ°å€æ </em>è®¿é—®ï¼Œé“¾æ¥è·³è½¬æ˜¯æ­£å¸¸ç”¨æˆ·è¡Œä¸ºï¼Œå°†ä¼šè§¦å‘æµè§ˆå™¨ç¼“å­˜æœºåˆ¶ï¼›</li><li><em>F5</em>åˆ·æ–°ï¼Œè¿›è¡Œåå•†ç¼“å­˜åˆ¤æ–­ï¼›</li><li><em>ctrl+F5</em>åˆ·æ–°ï¼ŒæŒ‡å®šå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜éƒ½å¤±æ•ˆã€‚</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®—æ³•é¢˜</title>
    <link href="/2022/02/24/%E7%AE%97%E6%B3%95%E9%A2%98/"/>
    <url>/2022/02/24/%E7%AE%97%E6%B3%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<ul><li><p>ä¸¤æ•°ä¹‹åˆ</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">twoSum</span>(<span class="hljs-params">arr, target</span>) </span>&#123;<span class="hljs-keyword">let</span> res = [];<span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();<span class="hljs-comment">// ä½¿ç”¨æ•°å€¼-&gt;ç´¢å¼•å»ºç«‹map</span><span class="hljs-comment">// æ¯æ¬¡å¾ªç¯è®¡ç®—å¾—å‡ºå½“å‰å·®å€¼</span><span class="hljs-comment">// åœ¨mapä¸­æŸ¥æ‰¾è¿™ä¸ªå·®å€¼æ—¢èƒ½å¾—å‡ºç´¢å¼•</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<span class="hljs-keyword">let</span> k = target - arr[i];<span class="hljs-keyword">if</span> (map.has(k)) &#123;res.push([map.get(k), i]);&#125;map.set(arr[i], i);&#125;<span class="hljs-keyword">return</span> res.length === <span class="hljs-number">1</span> ? res[<span class="hljs-number">0</span>] : res;&#125;</code></pre></div></li><li><p>æ’åºæ•°ç»„çš„ä¸¤æ•°ä¹‹å’Œ</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">twoSum</span>(<span class="hljs-params">nums, target</span>) </span>&#123;<span class="hljs-keyword">let</span> l = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> r = nums.length - <span class="hljs-number">1</span>;<span class="hljs-keyword">while</span> (l &lt; r) &#123;<span class="hljs-keyword">const</span> curSum = nums[l] + nums[r];<span class="hljs-keyword">if</span> (curNum === target) <span class="hljs-keyword">return</span> [nums[l], nums[r]];<span class="hljs-keyword">if</span> (curNum &gt; target) &#123;r--;&#125; <span class="hljs-keyword">else</span> &#123;l++;&#125;&#125;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#125;</code></pre></div></li><li><p>ä¸‰æ•°ä¹‹åˆ</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">threeSum</span>(<span class="hljs-params">arr, target</span>) </span>&#123;<span class="hljs-keyword">let</span> res = [];<span class="hljs-keyword">let</span> len = arr.length;<span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">3</span>) <span class="hljs-keyword">return</span> res;arr = arr.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b);<span class="hljs-comment">// æŒ‰å¤§å°æ’åº</span><span class="hljs-comment">// å¼€å§‹å¾ªç¯</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<span class="hljs-keyword">if</span> (arr[i] &gt;= target) <span class="hljs-keyword">break</span>;<span class="hljs-comment">// ç¬¬ä¸€ä¸ªå€¼å°±å¤§äºtargetåé¢ä¸ç”¨æƒ³äº†</span><span class="hljs-keyword">if</span> (arr[i] === arr[i - <span class="hljs-number">1</span>]) <span class="hljs-keyword">continue</span>;<span class="hljs-comment">// è·³è¿‡é‡å¤çš„å€¼</span><span class="hljs-keyword">let</span> first = i,second = i + <span class="hljs-number">1</span>,third = len - <span class="hljs-number">1</span>;<span class="hljs-keyword">while</span> (second &lt; third) &#123;<span class="hljs-keyword">const</span> sum = arr[first] + arr[second] + arr[third];<span class="hljs-keyword">if</span> (sum === target) &#123;res.push([arr[first], arr[second], arr[third]]);second++;third--;<span class="hljs-comment">// ç§»åŠ¨ä¸€æ¬¡æŒ‡é’ˆå†è·³è¿‡é‡å¤é¡¹</span><span class="hljs-keyword">while</span> (arr[second] === arr[second - <span class="hljs-number">1</span>]) &#123;second++;&#125;<span class="hljs-keyword">while</span> (arr[third] === arr[third + <span class="hljs-number">1</span>]) &#123;third--;&#125;&#125;<span class="hljs-comment">//ç§»åŠ¨æŒ‡é’ˆ</span><span class="hljs-keyword">if</span> (sum &gt; target) third--;<span class="hljs-keyword">if</span> (sum &lt; target) second++;&#125;&#125;<span class="hljs-keyword">return</span> res;&#125;</code></pre></div></li><li><p>æœ€å¤§é¢ç§¯</p><p>  ç»™å®šæ•°ç»„ï¼ŒæŒ‰æ•°ç»„ index ä¸º x è½´åæ ‡,value ä¸º y è½´åæ ‡åœ¨äºŒçº¬åæ ‡ç³»ç”»çº¿ï¼Œè¿æ¥å“ªä¸¤æ¡çº¿æ—¶å¾—åˆ°æœ€å¤§é¢ç§¯</p><blockquote><p>é¢ç§¯ = ä¸¤ç›´çº¿ä¸­è¾ƒçŸ­çš„é«˜åº¦ * ä¸¤çº¿é—´è·ç¦»</p></blockquote>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maxArea</span>(<span class="hljs-params">height</span>) </span>&#123;<span class="hljs-keyword">let</span> l = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> r = height.length - <span class="hljs-number">1</span>;<span class="hljs-keyword">let</span> res = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> (l &lt; r) &#123;res = <span class="hljs-built_in">Math</span>.max(res, (r - l) * <span class="hljs-built_in">Math</span>.min(height[l], height[r]));<span class="hljs-keyword">if</span> (height[l] &lt; height[r]) &#123;l++;&#125; <span class="hljs-keyword">else</span> &#123;r--;&#125;&#125;<span class="hljs-keyword">return</span> res;&#125;</code></pre></div></li><li><p>åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹ï¼Œä¸èƒ½ä½¿ç”¨é¢å¤–ç©ºé—´ï¼Œè¿”å›ä¸é‡å¤çš„é•¿åº¦</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeDuplicates</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> len = arr.length;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt; len; j++) &#123;<span class="hljs-keyword">if</span> (arr[j] !== arr[j - <span class="hljs-number">1</span>]) &#123;arr[++i] = arr[j];&#125;&#125;<span class="hljs-keyword">return</span> i + <span class="hljs-number">1</span>;&#125;</code></pre></div></li><li><p>è®¾è®¡ä¸€ä¸ªæ”¯æŒåœ¨å¹³å‡æ—¶é—´å¤æ‚åº¦ O(1) ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œçš„æ•°æ®ç»“æ„ã€‚</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">insert(val) ï¼šå½“å…ƒç´  val ä¸å­˜åœ¨æ—¶ï¼Œå‘é›†åˆä¸­æ’å…¥è¯¥é¡¹ã€‚remove(val) ï¼šå…ƒç´  val å­˜åœ¨æ—¶ï¼Œä»é›†åˆä¸­ç§»é™¤è¯¥é¡¹ã€‚getRandom ï¼šéšæœºè¿”å›ç°æœ‰é›†åˆä¸­çš„ä¸€é¡¹ã€‚æ¯ä¸ªå…ƒç´ åº”è¯¥æœ‰ ç›¸åŒçš„æ¦‚ç‡ è¢«è¿”å›ã€‚ç¤ºä¾‹ :<span class="hljs-comment">// åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„é›†åˆã€‚</span>RandomizedSet randomSet = <span class="hljs-keyword">new</span> RandomizedSet();<span class="hljs-comment">// å‘é›†åˆä¸­æ’å…¥ 1 ã€‚è¿”å› true è¡¨ç¤º 1 è¢«æˆåŠŸåœ°æ’å…¥ã€‚</span>randomSet.insert(<span class="hljs-number">1</span>);<span class="hljs-comment">// è¿”å› false ï¼Œè¡¨ç¤ºé›†åˆä¸­ä¸å­˜åœ¨ 2 ã€‚</span>randomSet.remove(<span class="hljs-number">2</span>);<span class="hljs-comment">// å‘é›†åˆä¸­æ’å…¥ 2 ã€‚è¿”å› true ã€‚é›†åˆç°åœ¨åŒ…å« [1,2] ã€‚</span>randomSet.insert(<span class="hljs-number">2</span>);<span class="hljs-comment">// getRandom åº”éšæœºè¿”å› 1 æˆ– 2 ã€‚</span>randomSet.getRandom();<span class="hljs-comment">// ä»é›†åˆä¸­ç§»é™¤ 1 ï¼Œè¿”å› true ã€‚é›†åˆç°åœ¨åŒ…å« [2] ã€‚</span>randomSet.remove(<span class="hljs-number">1</span>);<span class="hljs-comment">// 2 å·²åœ¨é›†åˆä¸­ï¼Œæ‰€ä»¥è¿”å› false ã€‚</span>randomSet.insert(<span class="hljs-number">2</span>);<span class="hljs-comment">// ç”±äº 2 æ˜¯é›†åˆä¸­å”¯ä¸€çš„æ•°å­—ï¼ŒgetRandom æ€»æ˜¯è¿”å› 2 ã€‚</span>randomSet.getRandom();<span class="hljs-comment">// mapæ–¹æ³•</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RandomSet</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-built_in">this</span>.map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()  <span class="hljs-built_in">this</span>.values = []&#125;RandomSet.prototype.insert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>)</span>&#123;  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.map.has(val)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>  <span class="hljs-built_in">this</span>.map.set(val,values.length)  <span class="hljs-comment">// æ’å…¥åçš„ç´¢å¼•ï¼ˆæ’å…¥å‰çš„æ•°ç»„é•¿åº¦ï¼‰</span>  <span class="hljs-built_in">this</span>.values.push(val)  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;RandomSet.prototype.remove = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">this</span>.map.has(val)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>  <span class="hljs-keyword">let</span> index = <span class="hljs-built_in">this</span>.map.get(val)  <span class="hljs-comment">// åˆ¤æ–­åœ¨å°¾éƒ¨</span>  <span class="hljs-comment">// ä¼¼ä¹ä¹Ÿå¯ä»¥ç”¨å¤´éƒ¨</span>  <span class="hljs-keyword">if</span>(index === <span class="hljs-built_in">this</span>.values.length - <span class="hljs-number">1</span>)&#123;    <span class="hljs-built_in">this</span>.map.delete(value)    <span class="hljs-built_in">this</span>.values.pop()  &#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-comment">// ä¸åœ¨å°¾éƒ¨</span>    <span class="hljs-comment">// valuesç”¨å°¾éƒ¨å…ƒç´ å¡«å……è¯¥ä½ç½®</span>    <span class="hljs-comment">// mapä¸­ä¿®æ”¹ç´¢å¼•</span>    <span class="hljs-keyword">let</span> last = <span class="hljs-built_in">this</span>.values.pop()    <span class="hljs-comment">// èµ‹å€¼</span>    <span class="hljs-built_in">this</span>.values[index] = last    <span class="hljs-built_in">this</span>.map.set(last,index)    <span class="hljs-built_in">this</span>.map.delete(val)  &#125;  <span class="hljs-keyword">return</span> val&#125;RandomSet.prototype.getRandom = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">let</span> len = <span class="hljs-built_in">this</span>.values.length  <span class="hljs-keyword">let</span> index = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random()*len)  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.values[index]&#125;<span class="hljs-comment">// setæ–¹æ³•</span><span class="hljs-comment">// setæ˜¯ä¸é‡å¤çš„å€¼çš„é›†åˆ</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RandomSet</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-built_in">this</span>.data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>()&#125;RandomizedSet.prototype.insert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>)</span>&#123;  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.data.has(val)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>  <span class="hljs-built_in">this</span>.set.add(val)  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;RandomizedSet.prototype.remove = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">this</span>.data.has(val)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>  <span class="hljs-built_in">this</span>.set.delete(val)  <span class="hljs-keyword">return</span> val&#125;RandomizedSet.prototype.getRandom = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">let</span> len = <span class="hljs-built_in">this</span>.values.length  <span class="hljs-keyword">let</span> index = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random()*len)  <span class="hljs-keyword">return</span> [...this.data][index]&#125;</code></pre></div></li><li><p>åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// arr1 = [1,2,5]  m=3</span><span class="hljs-comment">// arr2 = [2,3,4]  n=3</span><span class="hljs-comment">// å‡è®¾arr1èƒ½è£…ä¸‹arr2</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeArr</span>(<span class="hljs-params">arr1, m, arr2, n</span>) </span>&#123;<span class="hljs-keyword">let</span> index1 = m - <span class="hljs-number">1</span>;<span class="hljs-keyword">let</span> index2 = n - <span class="hljs-number">1</span>;<span class="hljs-keyword">let</span> index = m + n - <span class="hljs-number">1</span>;<span class="hljs-keyword">while</span> (index &gt;= <span class="hljs-number">0</span>) &#123;<span class="hljs-keyword">if</span> (index2 &lt; <span class="hljs-number">0</span>) &#123;<span class="hljs-comment">// arr2è€—å°½</span><span class="hljs-comment">// å‰©ä¸‹ä¿æŒarr1çš„å€¼</span>arr1[index--] = arr2[index2--];<span class="hljs-keyword">continue</span>;&#125;arr1[index--] = arr1[index1] &gt;= arr2[index2] ? arr1[index1--] : arr2[index2--];&#125;&#125;</code></pre></div></li><li><p>è®¡ç®—ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">intersection</span>(<span class="hljs-params">arr1, arr2</span>) </span>&#123;<span class="hljs-keyword">return</span> [...new <span class="hljs-built_in">Set</span>(arr1.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> arr2.includes(item)))];&#125;</code></pre></div></li><li><p>è®¡ç®—å¤šä¸ªæ•°ç»„çš„äº¤é›†</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">intersection</span>(<span class="hljs-params">...arrs</span>) </span>&#123;<span class="hljs-keyword">if</span> (arrs.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> [];<span class="hljs-keyword">if</span> (arrs.length === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> arrs[<span class="hljs-number">0</span>];<span class="hljs-keyword">return</span> [...new <span class="hljs-built_in">Set</span>(arrs.reduce(<span class="hljs-function">(<span class="hljs-params">pre, next</span>) =&gt;</span> &#123;<span class="hljs-comment">// reduceç´¯åŠ å™¨ï¼Œæ¯ä¸€æ¬¡çš„returnä½œä¸ºä¸‹ä¸€æ¬¡ç´¯åŠ çš„preï¼Œä½ å’‹è¿™ä¹Ÿèƒ½å¿˜</span><span class="hljs-comment">// åè¿˜èƒ½æ·»åŠ å‚æ•°æ‰‹åŠ¨åˆ¶å®šç¬¬ä¸€æ¬¡ç´¯åŠ çš„preå€¼</span><span class="hljs-keyword">return</span> pre.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> next.includes(item));&#125;)),];&#125;</code></pre></div></li><li><p>å¤§æ•°ç›¸ä¹˜(å¯ä»¥è¾“å‡ºå­—ç¬¦ä¸²)</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bigMulti</span>(<span class="hljs-params">x, y</span>) </span>&#123;<span class="hljs-keyword">if</span> (x === <span class="hljs-string">&quot;0&quot;</span> || y === <span class="hljs-string">&quot;0&quot;</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0&quot;</span>;<span class="hljs-keyword">if</span> (x === <span class="hljs-string">&quot;1&quot;</span>) <span class="hljs-keyword">return</span> y;<span class="hljs-keyword">if</span> (y === <span class="hljs-string">&quot;1&quot;</span>) <span class="hljs-keyword">return</span> x;<span class="hljs-keyword">const</span> len1 = x.length;<span class="hljs-keyword">const</span> len2 = y.length;<span class="hljs-keyword">const</span> pos = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(len1 + len2).fill(<span class="hljs-number">0</span>);<span class="hljs-keyword">let</span> num1, num2, mulit, cur;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = len1 - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;num1 = x[i];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = len2 - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">0</span>; j--) &#123;num2 = y[j];mulit = num1 * num2;cur = mulit + pos[i + j + <span class="hljs-number">1</span>];pos[i + j + <span class="hljs-number">1</span>] = cur % <span class="hljs-number">10</span>;pos[i + j] += (cur / <span class="hljs-number">10</span>) | <span class="hljs-number">0</span>; <span class="hljs-comment">// å–10ä½ä»¥ä¸Šéƒ¨åˆ†</span>&#125;&#125;<span class="hljs-keyword">let</span> res = pos.join(<span class="hljs-string">&quot;&quot;</span>);<span class="hljs-built_in">console</span>.log(res);<span class="hljs-keyword">while</span> (res[<span class="hljs-number">0</span>] === <span class="hljs-string">&quot;0&quot;</span>) &#123;res = res.substring(<span class="hljs-number">1</span>);&#125;<span class="hljs-keyword">return</span> res;&#125;</code></pre></div></li><li><p>ä¿ç•™ç²¾åº¦åŠ æ³•</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> fixAdd = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> &#123;<span class="hljs-keyword">const</span> len1 = x.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">1</span>].length;<span class="hljs-keyword">const</span> len2 = y.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">1</span>].length;<span class="hljs-keyword">const</span> maxLen = len1 &gt;= len2 ? len1 : len2;<span class="hljs-keyword">const</span> times = maxLen * <span class="hljs-number">10</span>;<span class="hljs-keyword">return</span> (x * times + y * times) / times;&#125;;</code></pre></div></li><li><p>æ»¡ 9 åŠ  1</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add1</span>(<span class="hljs-params">num</span>) </span>&#123;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> dig = num.length - <span class="hljs-number">1</span>; dig &gt;= <span class="hljs-number">0</span>; dig--) &#123;<span class="hljs-keyword">if</span> (num[dig] === <span class="hljs-number">9</span>) &#123;num[dig] = <span class="hljs-number">0</span>;&#125; <span class="hljs-keyword">else</span> &#123;num[dig]++;<span class="hljs-keyword">return</span> num;&#125;&#125;num.unshift(<span class="hljs-number">1</span>);<span class="hljs-keyword">return</span> num;&#125;</code></pre></div></li><li><p>å°†æ•°ç»„ä¸­çš„ 0 å…¨éƒ¨ç§»åŠ¨åˆ°æœ€åä¸”é 0 éƒ¨åˆ†ä¿æŒåŸé¡ºåº</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">move0</span>(<span class="hljs-params">num</span>) </span>&#123;<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> (i &lt; num.length) &#123;<span class="hljs-keyword">if</span> (num[i] !== <span class="hljs-number">0</span>) &#123;[mim[i], num[j]] = [num[j], num[i]];i++;j++;&#125; <span class="hljs-keyword">else</span> &#123;i++;&#125;&#125;&#125;</code></pre></div></li><li><p>  æ•°çš„æ¬¡æ–¹ï¼ˆä¸ä½¿ç”¨å†…ç½®åº“ pow</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å¦‚æœæŒ‡æ•°næ˜¯å¶æ•°ï¼Œx^n = x^(n/2) * x^(n/2)</span><span class="hljs-comment">// å¦‚æœæŒ‡æ•°næ˜¯å¥‡æ•°ï¼Œx^n = x * x^(n/2) * x^(n/2)</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myPow</span>(<span class="hljs-params">x, n</span>) </span>&#123;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_pow</span>(<span class="hljs-params">base, ex</span>) </span>&#123;<span class="hljs-keyword">if</span> (ex === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<span class="hljs-keyword">if</span> (ex === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> base;<span class="hljs-keyword">const</span> splitPow = _pow(base, <span class="hljs-built_in">Math</span>.floor(ex / <span class="hljs-number">2</span>));<span class="hljs-keyword">return</span> ex % <span class="hljs-number">2</span> ? base * splitPow * splitPow : splitPow * splitPow;&#125;<span class="hljs-keyword">const</span> res = _pow(x, <span class="hljs-built_in">Math</span>.abs(n));<span class="hljs-keyword">return</span> n &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> / res : res;&#125;</code></pre></div><ul><li>  æ•°å­—çš„å¼€æ–¹ ï¼ˆä¸ä½¿ç”¨å†…ç½®åº“ pow å’Œ X ** X</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//  è¿”å›å€¼åªä¿ç•™æ•´æ•°éƒ¨åˆ† ï¼Œ8 =&gt; 2</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mySqrt</span>(<span class="hljs-params">num</span>) </span>&#123;<span class="hljs-keyword">let</span> l = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> r = num;<span class="hljs-comment">// å·¦å³æŒ‡é’ˆé‡åˆåè·³å‡º</span><span class="hljs-keyword">while</span> (l &lt;= r) &#123;<span class="hljs-comment">// è®¡ç®—ä¸€æ¬¡å½“å‰çš„ä¸­é—´å€¼</span><span class="hljs-keyword">const</span> mid = <span class="hljs-built_in">Math</span>.floor((r - l) / <span class="hljs-number">2</span>) + l;<span class="hljs-comment">// const mid = (r-l) &gt;&gt; 1 + l</span><span class="hljs-keyword">const</span> curPow = mid * mid;<span class="hljs-keyword">if</span> (mid &lt;= num) &#123;l = mid + <span class="hljs-number">1</span>;&#125; <span class="hljs-keyword">else</span> &#123;r = mid - <span class="hljs-number">1</span>;&#125;&#125;<span class="hljs-keyword">return</span> r;&#125;</code></pre></div><ul><li>  è¾“å‡º 1 åˆ°æœ€å¤§çš„ n ä½æ•°</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><span class="hljs-comment">  / <span class="hljs-doctag">@params </span>n=1 ä¸€ä½æ•°ï¼Œæœ€å¤§9ï¼Œè¾“å‡º123456789</span><span class="hljs-comment">  / <span class="hljs-doctag">@params </span>n=2 ä¸¤ä½æ•°å‘€ æœ€å¤§99</span><span class="hljs-comment">  */</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printNumbers1</span>(<span class="hljs-params">n</span>) </span>&#123;<span class="hljs-comment">//ç»„åˆå­—ç¬¦ä¸²</span><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;&quot;</span>;<span class="hljs-keyword">while</span> (n &gt; <span class="hljs-number">0</span>) &#123;str += <span class="hljs-string">&quot;9&quot;</span>;n--;&#125;str = <span class="hljs-built_in">Number</span>(str);<span class="hljs-keyword">const</span> res = [];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= str; i++) &#123;res.push(i);&#125;<span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printNumbers1</span>(<span class="hljs-params">n</span>) </span>&#123;<span class="hljs-comment">//æœ€å¤§å€¼å°±æ˜¯ 10^n-1......</span><span class="hljs-keyword">const</span> max = <span class="hljs-number">10</span> ** n - <span class="hljs-number">1</span>;<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(max).fill(<span class="hljs-number">1</span>);<span class="hljs-keyword">return</span> res.map(<span class="hljs-function">(<span class="hljs-params">v, i</span>) =&gt;</span> v + i);&#125;</code></pre></div><ul><li>  å’Œä¸º s çš„æ‰€æœ‰æ­£æ•°åºåˆ—</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><span class="hljs-comment"> *  15</span><span class="hljs-comment"> * [1,2,3,4,5] [4,5,6] [7,8]</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findContinuousSequence</span>(<span class="hljs-params">target</span>) </span>&#123;<span class="hljs-comment">// ç›´æ¥ç”¨æ»‘åŠ¨çª—å£å¥—</span><span class="hljs-keyword">let</span> l = <span class="hljs-number">1</span>;<span class="hljs-keyword">let</span> r = <span class="hljs-number">2</span>;<span class="hljs-keyword">let</span> sum = <span class="hljs-number">3</span>;<span class="hljs-keyword">const</span> res = [];<span class="hljs-keyword">while</span> (l &lt; r) &#123;<span class="hljs-keyword">if</span> (sum === target) &#123;<span class="hljs-keyword">const</span> ret = [];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = j; i &lt;= r; i++) &#123;ret.push(i);&#125;sum -= l;l++;&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sum &gt; target) &#123;sum -= l;l++;&#125; <span class="hljs-keyword">else</span> &#123;r++;sum += r;&#125;&#125;<span class="hljs-keyword">return</span> res;&#125;<span class="hljs-comment">// æ»‘åŠ¨çª—å£çš„å¦å¤–ä¸€ç§å®ç°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findContinuousSequence</span>(<span class="hljs-params">target</span>) </span>&#123;<span class="hljs-keyword">const</span> max = target % <span class="hljs-number">2</span> === <span class="hljs-number">0</span> ? target / <span class="hljs-number">2</span> : <span class="hljs-built_in">Math</span>.round(target / <span class="hljs-number">2</span>);<span class="hljs-comment">// maxå³è¾¹éƒ½ä¸å¯èƒ½æ»¡è¶³</span><span class="hljs-comment">// t = 9</span><span class="hljs-comment">// max = 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6[x]ï¼Œ7[x]ï¼Œ8[x]</span><span class="hljs-keyword">const</span> <span class="hljs-built_in">window</span> = [];<span class="hljs-keyword">const</span> res = [];<span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= max; i++) &#123;<span class="hljs-built_in">window</span>.push(i);sum += i;<span class="hljs-keyword">while</span> (sum &gt; target) &#123;sum -= <span class="hljs-built_in">window</span>.shift();&#125;<span class="hljs-keyword">if</span> (sum === target) &#123;<span class="hljs-built_in">window</span>.length &gt; <span class="hljs-number">1</span> &amp;&amp; res.push([...window]);<span class="hljs-comment">//<span class="hljs-doctag">FIXME:</span></span><span class="hljs-comment">// æ³¨æ„ï¼ï¼</span><span class="hljs-comment">// push windowçš„æµ…æ‹·è´</span>&#125;&#125;<span class="hljs-keyword">return</span> res;&#125;</code></pre></div><ul><li>  æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡æ•°ç»„é•¿åº¦ä¸€åŠçš„å…ƒç´ </li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ä¸€å®šä¼šæ˜¯æ’åºåçš„æ•°ç»„ä¸­ç‚¹</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">majorityElement</span>(<span class="hljs-params">nums</span>) </span>&#123;nums = nums.sort();<span class="hljs-keyword">return</span> nums[<span class="hljs-built_in">Math</span>.floor(nums.length / <span class="hljs-number">2</span>)];&#125;<span class="hljs-comment">// æŠ•ç¥¨è®°æ•°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">majorityElement</span>(<span class="hljs-params">nums</span>) </span>&#123;<span class="hljs-keyword">let</span> vote = <span class="hljs-number">1</span>;<span class="hljs-comment">// å‰åå…ƒç´ ç›¸åŒæŠ•ç¥¨åŠ 1ï¼Œä¸åŒå‡1ï¼Œç¥¨æ•°æŠµæ¶ˆåˆ™è®¡ç®—åé¢çš„å…ƒç´ </span><span class="hljs-keyword">let</span> mid = nums[<span class="hljs-number">0</span>];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> num <span class="hljs-keyword">of</span> nums) &#123;<span class="hljs-keyword">if</span> (vote === <span class="hljs-number">1</span>) &#123;mid = num;&#125;vote += num === mid ? <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>;&#125;<span class="hljs-keyword">return</span> mid;&#125;</code></pre></div><ul><li>  åœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—</li></ul><p>0,1,Â·Â·Â·,n-1 è¿™ n ä¸ªæ•°å­—æ’æˆä¸€ä¸ªåœ†åœˆï¼Œä»æ•°å­— 0 å¼€å§‹ï¼Œæ¯æ¬¡ä»è¿™ä¸ªåœ†åœˆé‡Œåˆ é™¤ç¬¬ m ä¸ªæ•°å­—ï¼ˆåˆ é™¤åä»ä¸‹ä¸€ä¸ªæ•°å­—å¼€å§‹è®¡æ•°ï¼‰ã€‚æ±‚å‡ºè¿™ä¸ªåœ†åœˆé‡Œå‰©ä¸‹çš„æœ€åä¸€ä¸ªæ•°å­—ã€‚</p><p>ä¾‹å¦‚ï¼Œ0ã€1ã€2ã€3ã€4 è¿™ 5 ä¸ªæ•°å­—ç»„æˆä¸€ä¸ªåœ†åœˆï¼Œä»æ•°å­— 0 å¼€å§‹æ¯æ¬¡åˆ é™¤ç¬¬ 3 ä¸ªæ•°å­—ï¼Œåˆ™åˆ é™¤çš„å‰ 4 ä¸ªæ•°å­—ä¾æ¬¡æ˜¯ 2ã€0ã€4ã€1ï¼Œå› æ­¤æœ€åå‰©ä¸‹çš„æ•°å­—æ˜¯ 3ã€‚</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// æœ´æœ´ç´ ç´ è¶…æ—¶æ–¹æ³•</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lastRemaining</span>(<span class="hljs-params">n, m</span>) </span>&#123;<span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(n).fill(<span class="hljs-number">0</span>).map(<span class="hljs-function">(<span class="hljs-params">v, i</span>) =&gt;</span> (v += i));<span class="hljs-keyword">let</span> pos = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> (arr &gt; <span class="hljs-number">1</span>) &#123;pos = (pos + m - <span class="hljs-number">1</span>) % arr.length;arr.splice(pos, <span class="hljs-number">1</span>);&#125;<span class="hljs-keyword">return</span> arr[<span class="hljs-number">0</span>];&#125;<span class="hljs-comment">// æ‰¾è§„å¾‹</span><span class="hljs-comment">// çº¦ç‘Ÿå¤«ç¯</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lastRemaining</span>(<span class="hljs-params">n, m</span>) </span>&#123;<span class="hljs-comment">// 0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5...n-1,n</span><span class="hljs-comment">// n = 1 æ—¶è¾“å‡º 0</span><span class="hljs-comment">// åæ¨å¾—åˆ°å…¬å¼</span><span class="hljs-comment">// nä¸ªæ•°å­—,ç”±äºä»0å¼€å§‹æ’åˆ—ï¼Œåˆ™ç´¢å¼•===æ•°å€¼</span><span class="hljs-comment">// å½“å‰çŠ¶æ€ç”¨f(n,m)è¡¨ç¤ºï¼Œåˆ™ä¸Šä¸€è½®ä¸ºf(n-1,m)</span><span class="hljs-comment">// f(n,m) = (f(n-1,m)+m)%n</span><span class="hljs-keyword">if</span> (n === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> (lastRemaining(n - <span class="hljs-number">1</span>, m) + m) % n;&#125;<span class="hljs-comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨è¿­ä»£å®ç°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lastRemaining</span>(<span class="hljs-params">n, m</span>) </span>&#123;<span class="hljs-keyword">let</span> pos = <span class="hljs-number">0</span>; <span class="hljs-comment">// nä¸º1æ—¶çš„ å‰©ä¸‹0</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++) &#123;<span class="hljs-comment">// æ¯ä¸€è½®éƒ½æ ¹æ®è§„å¾‹ä¿®æ”¹</span>pos = (pos + m) % i;&#125;<span class="hljs-keyword">return</span> pos;&#125;</code></pre></div><ul><li>  å°†æ•°ç»„ä¸­çš„å¥‡æ•°ç§»åŠ¨åˆ°å‰ï¼Œå¶æ•°ç§»åŠ¨åˆ°å</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exchange</span>(<span class="hljs-params">nums</span>) </span>&#123;<span class="hljs-comment">// å¯¹æ’æŒ‡é’ˆ</span><span class="hljs-comment">// åˆ†åˆ«å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„æ•°</span><span class="hljs-keyword">let</span> l = <span class="hljs-number">0</span>,r = nums.length - <span class="hljs-number">1</span>;<span class="hljs-keyword">while</span> (l &lt; r) &#123;<span class="hljs-keyword">while</span> (l &lt; r &amp;&amp; nums[l] % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) l++;<span class="hljs-keyword">while</span> (l &lt; r &amp;&amp; nums[r] % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>) r--;[nums[l], nums[r]] = [nums[r], nums[l]];&#125;<span class="hljs-keyword">return</span> nums;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exchange</span>(<span class="hljs-params">nums</span>) </span>&#123;<span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆ</span><span class="hljs-keyword">let</span> slow = <span class="hljs-number">0</span>,fast = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> (fast &lt; nums.length) &#123;<span class="hljs-keyword">if</span> (nums[fast] % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) &#123;[nums[slow], nums[fast]] = [num[fast], nums[slow]];slow++;&#125;fast++;&#125;<span class="hljs-keyword">return</span> nums;&#125;</code></pre></div><ul><li>  å®ç°å‰ç¼€æ ‘ prefixTree</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PrefixTree</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-built_in">this</span>.tree = &#123;&#125;;&#125;PrefixTree.prototype.insert = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">word</span>) </span>&#123;<span class="hljs-comment">// ä¾æ¬¡å°†å•è¯çš„æ¯ä¸ªå­—æ¯å‘treeå¯¹è±¡ä¸­é€’å½’æ·»åŠ å±æ€§</span><span class="hljs-comment">// msy= &gt;</span><span class="hljs-comment">// &#123;m:&#123;s:&#123;y:&#123;isEnd:true&#125;&#125;&#125;&#125;</span><span class="hljs-keyword">let</span> node = <span class="hljs-built_in">this</span>.tree;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> n <span class="hljs-keyword">of</span> word) &#123;<span class="hljs-keyword">if</span> (!node[n]) node[n] = &#123;&#125;;node = node[n];&#125;node.isEnd = <span class="hljs-literal">true</span>;&#125;;PrefixTree.prototype.loop = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">word</span>) </span>&#123;<span class="hljs-keyword">let</span> node = <span class="hljs-built_in">this</span>.tree;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> n <span class="hljs-keyword">of</span> word) &#123;<span class="hljs-keyword">if</span> (!node[n]) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;node = node[n];&#125;<span class="hljs-keyword">return</span> node;&#125;;PrefixTree.prototype.search = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">word</span>) </span>&#123;<span class="hljs-keyword">const</span> ret = <span class="hljs-built_in">this</span>.loop(word);<span class="hljs-keyword">return</span> ret !== <span class="hljs-literal">undefined</span> &amp;&amp; ret.isEnd === <span class="hljs-literal">true</span>;&#125;;PrefixTree.prototype.startWith = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prefix</span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.loop(prefix);&#125;;</code></pre></div><ul><li>é’è›™è·³å°é˜¶/æ–æ³¢é‚£å¥‘æ•°åˆ—<blockquote><p>æ³¨æ„åˆ«ææ··äº†ï¼Œfibonacci æ•°åˆ—æ’åˆ—æ˜¯å›ºå®šçš„<br>fib æ•°åˆ— [0,1,1,2,3]<br>é’è›™è·³æ³• [1,1,2,3,5]</p></blockquote></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">numWays</span>(<span class="hljs-params">n</span>) </span>&#123;<span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> n;<span class="hljs-keyword">let</span> res = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> i = <span class="hljs-number">2</span>;<span class="hljs-keyword">let</span> cur = <span class="hljs-number">2</span>;<span class="hljs-keyword">let</span> pre = <span class="hljs-number">1</span>;<span class="hljs-keyword">while</span> (i++ &lt; n) &#123;<span class="hljs-comment">// ä»n=3æ—¶è¿­ä»£æ¨å¯¼</span>res = cur + pre;pre = cur;cur = res;&#125;<span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">numWays</span>(<span class="hljs-params">n</span>) </span>&#123;<span class="hljs-comment">// æ–æ³¢é‚£å¥‘æ•°åˆ—</span><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++) &#123;arr[i] = arr[i - <span class="hljs-number">1</span>] + arr[i - <span class="hljs-number">2</span>];&#125;<span class="hljs-keyword">return</span> arr[i];&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Fibonacci</span>(<span class="hljs-params">n</span>) </span>&#123;<span class="hljs-keyword">if</span> (n === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<span class="hljs-keyword">return</span> Fibonacci(n - <span class="hljs-number">1</span>) + Fibonacci(n - <span class="hljs-number">2</span>);&#125;<span class="hljs-comment">// å°¾é€’å½’ç‰ˆæœ¬</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Fibonacci</span>(<span class="hljs-params">n, b1 = <span class="hljs-number">1</span>, b2 = <span class="hljs-number">1</span>, c = <span class="hljs-number">3</span></span>) </span>&#123;<span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">3</span>) &#123;<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">if</span> (n === <span class="hljs-number">3</span>) &#123;<span class="hljs-keyword">return</span> c;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> Fibonacci(n, b2, b1 + b2, c + <span class="hljs-number">1</span>);&#125;&#125;&#125;</code></pre></div><ul><li>  è¿ç»­å­æ•°ç»„çš„å’Œçš„æœ€å¤§å€¼</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maxSubArray</span>(<span class="hljs-params">nums</span>) </span>&#123;<span class="hljs-comment">// ç”¨dpè®°å½•è¯¥ä½ç½®ä½œä¸ºå­æ•°ç»„æœ«å°¾çš„ç´¯åŠ å€¼</span><span class="hljs-comment">// [nums[0],nums[1]],dp[1] = num[0] + num[1]</span><span class="hljs-comment">// dp[2] = dp[1] + nums[2]</span><span class="hljs-comment">// åŒæ—¶åˆ¤æ–­å‰ä¸€dpçš„å€¼æ­£è´Ÿ</span><span class="hljs-comment">// å‰ä¸€ä¸ªdpä¸ºæ­£åˆ™ å½“å‰dp = å‰dp + å½“å‰nums</span><span class="hljs-comment">// å¦‚æœä¸ºè´Ÿç›´æ¥ä¸¢å¼ƒ</span><span class="hljs-keyword">if</span> (nums.length &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> nums[<span class="hljs-number">0</span>];<span class="hljs-keyword">let</span> max = nums[<span class="hljs-number">0</span>];<span class="hljs-keyword">let</span> dpi = nums[<span class="hljs-number">0</span>];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; nums.length; i++) &#123;dpi = dpi &gt; <span class="hljs-number">0</span> ? dpi + nums[i] : nums[i];max = <span class="hljs-built_in">Math</span>.max(max, dpi);&#125;<span class="hljs-keyword">return</span> max;&#125;</code></pre></div><ul><li>  åè½¬åµŒå¥—æ•°ç»„</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å·²çŸ¥æ•°ç»„ a=[1,[2,[3,[4,null]]]], å®ç°æ•°ç»„ b=[4,[3,[2,[1,null]]]] ï¼Œè€ƒè™‘nçº§åµŒå¥—çš„æƒ…å†µ</span><span class="hljs-keyword">const</span> a = [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, [<span class="hljs-number">4</span>, <span class="hljs-literal">null</span>]]]];<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reverseArray</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reverse</span>(<span class="hljs-params">arr, temp</span>) </span>&#123;<span class="hljs-comment">// arr = [1,[2,[3,[4,null]]]]</span><span class="hljs-comment">// arr = [1,[2,[3,[4,null]]]][1] = [2,[3,[4,null]]]</span><span class="hljs-comment">// arr = [1,[2,[3,[4,null]]]][1][1] = [3,[4,null]]</span><span class="hljs-comment">// arr = [1,[2,[3,[4,null]]]][1][1][1] = [4,null]</span><span class="hljs-keyword">if</span> (arr[<span class="hljs-number">1</span>] === <span class="hljs-literal">null</span>) &#123;<span class="hljs-keyword">return</span> [arr[<span class="hljs-number">0</span>], temp];<span class="hljs-comment">// return</span>&#125;temp = temp ? [arr[<span class="hljs-number">0</span>], temp] : [arr[<span class="hljs-number">0</span>], <span class="hljs-literal">null</span>];<span class="hljs-comment">// temp = [1,null]</span><span class="hljs-comment">// temp = [2,[1,null]]</span><span class="hljs-comment">// temp = [3,[2,[1,null]]]</span><span class="hljs-keyword">return</span> reverse(arr[<span class="hljs-number">1</span>], temp); <span class="hljs-comment">// é€’å½’è¿›åµŒå¥—</span>&#125;<span class="hljs-keyword">return</span> reverse(arr, <span class="hljs-literal">null</span>);&#125;<span class="hljs-built_in">console</span>.log(reverseArray(a));</code></pre></div><ul><li><p>çº¦ç‘Ÿå¤«ç¯</p><p>  0,1,Â·Â·Â·,n-1 è¿™ n ä¸ªæ•°å­—æ’æˆä¸€ä¸ªåœ†åœˆï¼Œä»æ•°å­— 0 å¼€å§‹ï¼Œæ¯æ¬¡ä»è¿™ä¸ªåœ†åœˆé‡Œåˆ é™¤ç¬¬ m ä¸ªæ•°å­—ï¼ˆåˆ é™¤åä»ä¸‹ä¸€ä¸ªæ•°å­—å¼€å§‹è®¡æ•°ï¼‰ã€‚æ±‚å‡ºè¿™ä¸ªåœ†åœˆé‡Œå‰©ä¸‹çš„æœ€åä¸€ä¸ªæ•°å­—ã€‚<br>  ä¾‹å¦‚ï¼Œ0ã€1ã€2ã€3ã€4 è¿™ 5 ä¸ªæ•°å­—ç»„æˆä¸€ä¸ªåœ†åœˆï¼Œä»æ•°å­— 0 å¼€å§‹æ¯æ¬¡åˆ é™¤ç¬¬ 3 ä¸ªæ•°å­—ï¼Œåˆ™åˆ é™¤çš„å‰ 4 ä¸ªæ•°å­—ä¾æ¬¡æ˜¯ 2ã€0ã€4ã€1ï¼Œå› æ­¤æœ€åå‰©ä¸‹çš„æ•°å­—æ˜¯ 3ã€‚</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// é€’å½’å…¬å¼</span><span class="hljs-comment">// f(n,m) = (f(n-1,m)+m)%n æœ¬è½®ç´¢å¼•=ä¸Šè½®ç´¢å¼•+m%n</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lastRemaining</span>(<span class="hljs-params">n, m</span>) </span>&#123;<span class="hljs-keyword">if</span> (n === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> (lastRemaining(n - <span class="hljs-number">1</span>, m) + m) % n;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lastRemaining</span>(<span class="hljs-params">n, m</span>) </span>&#123;<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">2</span>; j &lt;= m; j++) &#123;i = (i + m) % j;&#125;<span class="hljs-keyword">return</span> i;&#125;</code></pre></div><ul><li><p>è¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ</p><p>  è¾“å…¥ä¸€ä¸ªæ•´å‹æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„ä¸€ä¸ªæˆ–è¿ç»­å¤šä¸ªæ•´æ•°ç»„æˆä¸€ä¸ªå­æ•°ç»„ã€‚æ±‚æ‰€æœ‰å­æ•°ç»„çš„å’Œçš„æœ€å¤§å€¼ã€‚<br>  è¦æ±‚æ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚</p><div class="hljs code-wrapper"><pre><code class="hljs">  ç¤ºä¾‹1:  è¾“å…¥: nums = [-2,1,-3,4,-1,2,1,-5,4]  è¾“å‡º: 6  è§£é‡Š:Â è¿ç»­å­æ•°ç»„Â [4,-1,2,1] çš„å’Œæœ€å¤§ï¼Œä¸ºÂ 6ã€‚</code></pre></div></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// çŠ¶æ€è½¬ç§»</span><span class="hljs-comment">// ç”±è¿ç»­å…ƒç´ æ¥æ±‚å’Œ</span><span class="hljs-comment">// dp[i] ä½ç½®çš„ç´¯åŠ å€¼ç”±dp[i-1]å†³å®šï¼Œdp[i-1]ä¸ä¸ºè´Ÿåˆ™åŠ ä¸Šdp[i-1]</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maxSubArray</span>(<span class="hljs-params">nums</span>) </span>&#123;<span class="hljs-keyword">if</span> (nums.length &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> nums;<span class="hljs-keyword">let</span> max = nums[<span class="hljs-number">0</span>];<span class="hljs-keyword">const</span> dp = [nums[<span class="hljs-number">0</span>]];<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; nums.length; i++) &#123;dp[i] = dp[i - <span class="hljs-number">1</span>] &gt; <span class="hljs-number">0</span> ? nums[i] + dp[i - <span class="hljs-number">1</span>] : nums[i];<span class="hljs-keyword">if</span> (dp[i] &gt; max) max = dp[i];&#125;<span class="hljs-keyword">return</span> max;&#125;<span class="hljs-comment">// ä½¿ç”¨å˜é‡è®°å¿†dp[i-1]çš„å€¼</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maxSubArray</span>(<span class="hljs-params">nums</span>) </span>&#123;<span class="hljs-keyword">if</span> (nums.length &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> nums;<span class="hljs-keyword">let</span> max = nums[<span class="hljs-number">0</span>];<span class="hljs-keyword">let</span> preDp = <span class="hljs-number">0</span>; <span class="hljs-comment">// init 0</span><span class="hljs-keyword">let</span> curDp;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> n <span class="hljs-keyword">of</span> nums) &#123;curDp = n;curDp += preDp &gt; <span class="hljs-number">0</span> ? preDp : <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> (curDp &gt; max) max = curDp;preDp = curDp;&#125;<span class="hljs-keyword">return</span> max;&#125;</code></pre></div><ul><li>  [0 ~ n-1]ä¸­ç¼ºçœçš„å€¼</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// æ­£ç¡®çš„æ•°ç»„åº”è¯¥value===index</span><span class="hljs-comment">// [0,1,3] =&gt; 2</span><span class="hljs-comment">// [1,2] =&gt; 0</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">missingNumber</span>(<span class="hljs-params">nums</span>) </span>&#123;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nums.length; i++) &#123;<span class="hljs-keyword">if</span> (i !== nums[i]) <span class="hljs-keyword">return</span> i;&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">missingNumber</span>(<span class="hljs-params">nums</span>) </span>&#123;<span class="hljs-keyword">let</span> l = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> r = nums.length - <span class="hljs-number">1</span>;<span class="hljs-keyword">while</span> (l &gt;= r) &#123;<span class="hljs-keyword">let</span> mid = <span class="hljs-built_in">Math</span>.floor((r - l) / <span class="hljs-number">2</span>) + l;<span class="hljs-keyword">if</span> (mid === nums[mid]) &#123;<span class="hljs-comment">// ä¸­é—´ä½ç½®æ•°å€¼æ­£ç¡®ï¼Œè¯´æ˜ç¼ºçœæ•°å€¼åœ¨å³è¾¹</span>l = mid + <span class="hljs-number">1</span>;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-comment">// ä¸­é—´æ•°å€¼å·²ç»ä¸æ­£ç¡®ï¼Œè¯´æ˜ç¼ºçœæ•°å€¼åœ¨å·¦è¾¹</span>r = mid - <span class="hljs-number">1</span>;&#125;&#125;<span class="hljs-comment">// è·³å‡ºwhileåråœ¨lçš„å·¦è¾¹</span><span class="hljs-keyword">return</span> l;&#125;</code></pre></div><ul><li>  è¾“å…¥ä¸€ä¸ªçŸ©å½¢ï¼Œé¡ºæ—¶é’ˆæ‰“å°çŸ©å½¢å…¶ä¸­å…ƒç´ </li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> matrix = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],[<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>],[<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>],];<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">spiralOrder</span>(<span class="hljs-params">matrix</span>) </span>&#123;<span class="hljs-keyword">const</span> rowLen = matrix.length;<span class="hljs-keyword">const</span> columnLen = matrix[<span class="hljs-number">0</span>].length;<span class="hljs-keyword">let</span> top = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> bottom = rowLen - <span class="hljs-number">1</span>;<span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> right = columnLen - <span class="hljs-number">1</span>;<span class="hljs-keyword">const</span> res = [];<span class="hljs-keyword">while</span> (left &lt;= right &amp;&amp; top &lt;= bottom) &#123;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> a = left; a &lt;= right; a++) &#123;res.push(matrix[top][a]);&#125;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> b = top + <span class="hljs-number">1</span>; b &lt;= bottom; b++) &#123;res.push(matrix[b][right]);&#125;<span class="hljs-keyword">if</span> (top &gt;= bottom || left &gt;= right) <span class="hljs-keyword">break</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> c = right - <span class="hljs-number">1</span>; c &gt;= left; c--) &#123;res.push(matrix[bottom][c]);&#125;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> d = bottom; d &gt;= top; d--) &#123;res.push(matrix[left][d]);&#125;left++;right--;top++;bottom--;&#125;<span class="hljs-keyword">return</span> res;&#125;</code></pre></div><ul><li><p>ç”µå•† SKU å…¨æ’åˆ—/ç¬›å¡å°”ç§¯</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> attrs = &#123;names: [<span class="hljs-string">&quot;iPhone X&quot;</span>, <span class="hljs-string">&quot;iPhone XS&quot;</span>, <span class="hljs-string">&quot;iPhone 11&quot;</span>],colors: [<span class="hljs-string">&quot;é»‘è‰²&quot;</span>, <span class="hljs-string">&quot;ç™½è‰²&quot;</span>, <span class="hljs-string">&quot;çº¢è‰²&quot;</span>],storage: [<span class="hljs-string">&quot;64g&quot;</span>, <span class="hljs-string">&quot;128G&quot;</span>, <span class="hljs-string">&quot;256g&quot;</span>],&#125;;<span class="hljs-keyword">const</span> descartes = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">chunks</span>) </span>&#123;<span class="hljs-keyword">let</span> res = [];<span class="hljs-keyword">const</span> keysName = <span class="hljs-built_in">Object</span>.keys(chunks);<span class="hljs-comment">// ç”±äºæ˜¯æ“ä½œå¯¹è±¡,å¤šå¢åŠ ä¸€ä¸ªkeysæ•°ç»„</span><span class="hljs-keyword">const</span> helper = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">chunkIndex, prev</span>) </span>&#123;<span class="hljs-keyword">let</span> curKey = keysName[chunkIndex];<span class="hljs-keyword">let</span> curChunk = chunks[curKey];<span class="hljs-keyword">let</span> isLast = chunkIndex === keysName.length - <span class="hljs-number">1</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> val <span class="hljs-keyword">of</span> curChunk) &#123;<span class="hljs-keyword">const</span> cur = prev.concat(<span class="hljs-string">`<span class="hljs-subst">$&#123;curKey&#125;</span>:<span class="hljs-subst">$&#123;val&#125;</span>`</span>);<span class="hljs-keyword">if</span> (isLast) &#123;<span class="hljs-comment">// å¦‚æœå·²ç»å¤„ç†åˆ°æ•°ç»„çš„æœ€åä¸€é¡¹äº† åˆ™æŠŠæ‹¼æ¥çš„ç»“æœæ”¾å…¥è¿”å›å€¼ä¸­</span>res.push(cur);&#125; <span class="hljs-keyword">else</span> &#123;helper(chunkIndex + <span class="hljs-number">1</span>, cur);&#125;&#125;&#125;;<span class="hljs-comment">// ä»å±æ€§æ•°ç»„ä¸‹æ ‡ä¸º 0 å¼€å§‹å¤„ç†</span><span class="hljs-comment">// å¹¶ä¸”æ­¤æ—¶çš„ prev æ˜¯ä¸ªç©ºæ•°ç»„</span>helper(<span class="hljs-number">0</span>, []);<span class="hljs-keyword">return</span> res;&#125;;</code></pre></div></li><li><p>1 åˆ° n çš„æ•°å­—ç»„æˆ k é•¿åº¦çš„æ•°ç»„çš„æ‰€æœ‰ç»„åˆ</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// è¾“å…¥: n = 4, k = 2;</span><span class="hljs-comment">// è¾“å‡º: [[2,4],[3,4],[2,3],[1,2],[1,3],[1,4],]</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">combine</span>(<span class="hljs-params">n, k</span>) </span>&#123;<span class="hljs-keyword">const</span> res = [];<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">helper</span>(<span class="hljs-params">start, prev</span>) </span>&#123;<span class="hljs-keyword">const</span> len = prev.length;<span class="hljs-keyword">if</span> (len === k) &#123;res.push(prev);<span class="hljs-keyword">return</span>;&#125;<span class="hljs-comment">// å‰ªæ,è¿˜èƒ½å‰©ä¸‹å‡ ä¸ªç©ºä½</span><span class="hljs-keyword">const</span> rest = k - len;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt;= n; i++) &#123;<span class="hljs-keyword">if</span> (n - i + <span class="hljs-number">1</span> &lt; rest) &#123;<span class="hljs-comment">// é€’å¢å…³ç³»+1</span><span class="hljs-comment">// næ˜¯æœ€å¤§æ•°å­—,å‡å»å½“å‰æ•°å­—+1</span><span class="hljs-keyword">return</span>; <span class="hljs-comment">// å¾€åçš„iéƒ½ä¸ä¼šç¬¦åˆ,ç›´æ¥return</span>&#125;helper(i + <span class="hljs-number">1</span>, prev.concat(i));&#125;&#125;helper(<span class="hljs-number">1</span>, []);<span class="hljs-keyword">return</span> res;&#125;</code></pre></div></li><li><p>è¯·ä½ åˆ¤æ–­ä¸€ä¸ª Â 9 x 9 çš„æ•°ç‹¬æ˜¯å¦æœ‰æ•ˆã€‚æ ¹æ®ä»¥ä¸‹è§„åˆ™ ï¼ŒéªŒè¯å·²ç»å¡«å…¥çš„æ•°å­—æ˜¯å¦æœ‰æ•ˆ</p><ol><li>æ•°å­— Â 1-9Â  åœ¨æ¯ä¸€è¡Œåªèƒ½å‡ºç°ä¸€æ¬¡ã€‚</li><li>æ•°å­— Â 1-9Â  åœ¨æ¯ä¸€åˆ—åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚</li><li>æ•°å­— Â 1-9Â  åœ¨æ¯ä¸€ä¸ªä»¥ç²—å®çº¿åˆ†éš”çš„ Â 3x3Â  å®«å†…åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚ï¼ˆè¯·å‚è€ƒç¤ºä¾‹å›¾ï¼‰</li><li>ç©ºç™½ä¸ºâ€™.â€™</li></ol>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">board = [[<span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>],[<span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>],[<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>],[<span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>],[<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>],[<span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>],[<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>],[<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>],[<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;9&quot;</span>],];<span class="hljs-comment">//è¾“å‡ºï¼štrue</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidSudoku</span>(<span class="hljs-params">arr</span>) </span>&#123;<span class="hljs-comment">// ç”¨æœ€ç›´ç™½çš„å“ˆå¸Œè¡¨ï¼Œç”±äºè¦å¤„ç†é¡ºåºé€’å¢æ•°ç»„ï¼Œå¯ä»¥é»˜è®¤å…¨éƒ¨æ˜¯0</span><span class="hljs-comment">// è®°å½•index+1ä½ç½®çš„æ•°æœ‰æ²¡æœ‰å‡ºç°è¿‡</span><span class="hljs-keyword">const</span> rows = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">9</span>).fill(<span class="hljs-number">0</span>).map(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">9</span>).fill(<span class="hljs-number">0</span>));<span class="hljs-keyword">const</span> columns = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">9</span>).fill(<span class="hljs-number">0</span>).map(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">9</span>).fill(<span class="hljs-number">0</span>));<span class="hljs-comment">// 9*9çš„å°æ–¹å—</span><span class="hljs-keyword">const</span> blocks = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">3</span>).fill(<span class="hljs-number">0</span>).map(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">3</span>).fill(<span class="hljs-number">0</span>).map(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">9</span>).fill(<span class="hljs-number">0</span>)));<span class="hljs-comment">// å¼€å§‹å¾ªç¯</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; i++) &#123;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">9</span>; j++) &#123;<span class="hljs-keyword">const</span> cur = board[i][j];<span class="hljs-keyword">if</span> (cur === <span class="hljs-string">&quot;.&quot;</span>) countine; <span class="hljs-comment">//è·³è¿‡</span><span class="hljs-keyword">const</span> index = +cur - <span class="hljs-number">1</span>;rows[i][index]++;columns[j][index]++;blocks[~~(i / <span class="hljs-number">3</span>)][~~[j / <span class="hljs-number">3</span>]][index]++;<span class="hljs-keyword">if</span> (rows[i][index] &gt; <span class="hljs-number">1</span> || columns[j][index] &gt; <span class="hljs-number">1</span> || blocks[~~(i / <span class="hljs-number">3</span>)][~~[j / <span class="hljs-number">3</span>]][index] &gt; <span class="hljs-number">1</span>) &#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#125;&#125;&#125;<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#125;</code></pre></div></li><li><p>å®ç° LRU ç¼“å­˜ç»“æ„ ï¼ˆæœ€è¿‘æœ€å°‘è®¿é—®</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LRUCache</span>(<span class="hljs-params">capacity</span>)</span>&#123;<span class="hljs-built_in">this</span>.capacity = capacity<span class="hljs-built_in">this</span>.cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()&#125;LRUCache.prototype.get = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>)</span>&#123;<span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.cache.has(key))&#123;<span class="hljs-keyword">const</span> val = <span class="hljs-built_in">this</span>.cache.get(key)<span class="hljs-built_in">this</span>.cache.delete(key)<span class="hljs-built_in">this</span>.cache.set(key,val)<span class="hljs-keyword">return</span> val&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>&#125;&#125;LRUCache.prototype.put = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key,value</span>)</span>&#123;<span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.cache.has(key))&#123;<span class="hljs-built_in">this</span>.cache.delete(key)&#125;<span class="hljs-built_in">this</span>.cache.set(key,value)<span class="hljs-comment">// å¦‚æœå®¹é‡è¶…æ ‡</span><span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.cache.size &gt; <span class="hljs-built_in">this</span>.capacity)&#123;<span class="hljs-comment">// åˆ é™¤mapä¸­çš„ç¬¬ä¸€ä¸ª</span><span class="hljs-keyword">const</span> latestKey = <span class="hljs-built_in">this</span>.cache.keys().next().value<span class="hljs-built_in">this</span>.cache.delete(latestKey)&#125;&#125;</code></pre></div></li><li><p>   åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯è´¨æ•°/ç´ æ•°</p><blockquote><p>è´¨æ•°ï¼šå¤§äº1çš„è‡ªç„¶æ•°åªèƒ½è¢« 1 å’Œè‡ªèº«æ•´é™¤çš„æ•°</p></blockquote></li></ul><blockquote><p>sqrt å¹³æ–¹æ ¹</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isPrime</span>(<span class="hljs-params">num</span>) </span>&#123;<span class="hljs-keyword">if</span> (num === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">2</span>; i &lt; num - <span class="hljs-number">1</span>; i++) &#123;<span class="hljs-keyword">if</span> (num % i === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#125;<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#125;<span class="hljs-comment">// ä¸€ä¸ªæ•°è‹¥å¯ä»¥è¿›è¡Œå› æ•°åˆ†è§£ï¼Œé‚£ä¹ˆåˆ†è§£æ—¶å¾—åˆ°çš„ä¸¤ä¸ªæ•°ä¸€å®šæ˜¯ä¸€ä¸ªå°äºç­‰äºsqrt(n)ï¼Œä¸€ä¸ªå¤§äºç­‰äºsqrt(n)</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isPrime</span>(<span class="hljs-params">num</span>)</span>&#123;<span class="hljs-keyword">if</span>(num === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><span class="hljs-keyword">const</span> sqrt = <span class="hljs-built_in">Math</span>.sqrt(num)<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">2</span> ; i &lt; sqrt ;i++)&#123;<span class="hljs-keyword">if</span>(num % i === <span class="hljs-number">0</span> ) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;</code></pre></div><ul><li><p> è®¡ç®—nä»¥å†…çš„è´¨æ•°æ•°é‡</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> countPrimes = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) </span>&#123;<span class="hljs-comment">// nä¹‹å‰çš„æ•°ç»„ï¼Œå…ˆå…¨éƒ¨é»˜è®¤æ˜¯è´¨æ•°</span>  <span class="hljs-comment">// primeArray[i] = true</span><span class="hljs-keyword">const</span> primeArray = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(n).fill(<span class="hljs-literal">true</span>);<span class="hljs-keyword">let</span> primeCount = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">2</span>; i &lt; n; i++) &#123;    <span class="hljs-comment">// ä»2å¼€å§‹,ç”±äº2æ˜¯è´¨æ•°,å¼€å§‹æ¨å¯¼2æ´¾ç”Ÿå‡ºå»çš„è´¨æ•°</span>    <span class="hljs-comment">// å³2çš„næ¬¡+2åéƒ½ä¸ä¼šæ˜¯è´¨æ•°äº†</span><span class="hljs-keyword">if</span> (primeArray[i]) &#123;primeCount++;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = i * i; j &lt; n; j += i) &#123;primeArray[j] = <span class="hljs-literal">false</span>;&#125;&#125;&#125;<span class="hljs-keyword">return</span> primeCount;&#125;;</code></pre></div></li><li><p>æ±‚å‡ºä¸¤ä¸ªæ•°ç»„æœ€é•¿çš„å…¬å…±å­æ•°ç»„é•¿åº¦</p></li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// è¾“å…¥ï¼šnums1 = [1,2,3,2,1], nums2 = [3,2,1,4,7]</span><span class="hljs-comment">// è¾“å‡ºï¼š3</span><span class="hljs-comment">// è§£é‡Šï¼šé•¿åº¦æœ€é•¿çš„å…¬å…±å­æ•°ç»„æ˜¯ [3,2,1] </span><span class="hljs-comment">// åŠ¨æ€è§„åˆ’</span><span class="hljs-comment">// åˆ†åˆ«ç”¨iï¼Œjä»£è¡¨åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­çš„ç´¢å¼•</span><span class="hljs-comment">// å½“arr1[i] === arr[j]æ—¶</span><span class="hljs-comment">// è¯¥ä½ç½®çš„å…¬å…±é•¿åº¦ dp[i][j] = dp[i-1][j-1] + 1</span><span class="hljs-comment">// å»ºç«‹äºŒç»´æ•°ç»„dp</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">commonLongest</span> (<span class="hljs-params">A,B</span>)</span>&#123;<span class="hljs-keyword">const</span> m = A.length<span class="hljs-keyword">const</span> n = B.length<span class="hljs-keyword">let</span> res = <span class="hljs-number">0</span>;<span class="hljs-comment">// è€ƒè™‘0çš„æƒ…å†µï¼Œå¹¶ä¸”dp[x][0]æˆ–è€…dp[0][x]éƒ½ä¸º0</span><span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(m+<span class="hljs-number">1</span>).fill(<span class="hljs-number">0</span>).map(<span class="hljs-function">()=&gt;</span><span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(n+<span class="hljs-number">1</span>).fill(<span class="hljs-number">0</span>))<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span> ; i &lt;= m ;i++)&#123;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j  = <span class="hljs-number">1</span>; j &lt;= n ; j++)&#123;<span class="hljs-comment">// ä»é•¿åº¦ä¸º0å¼€å§‹ï¼Œåˆ™æœ‰ä¸€ä½é‡åˆ + 1</span><span class="hljs-keyword">if</span>(A[i-<span class="hljs-number">1</span>] === B[j-<span class="hljs-number">1</span>])&#123;dp[i][j] = dp[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>] + <span class="hljs-number">1</span>&#125;res = <span class="hljs-built_in">Math</span>.max(res,dp[i][j])&#125;&#125;<span class="hljs-keyword">return</span> res&#125;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘ç»œåˆ†å±‚æ¨¡å‹</title>
    <link href="/2022/02/24/%E7%BD%91%E7%BB%9C%E5%88%86%E5%B1%82%E6%A8%A1%E5%9E%8B/"/>
    <url>/2022/02/24/%E7%BD%91%E7%BB%9C%E5%88%86%E5%B1%82%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="OSI-å‚è€ƒæ¨¡å‹"><a href="#OSI-å‚è€ƒæ¨¡å‹" class="headerlink" title="OSI å‚è€ƒæ¨¡å‹"></a>OSI å‚è€ƒæ¨¡å‹</h1><p><code>OSIå‚è€ƒæ¨¡å‹ï¼ˆOSI/RMï¼‰</code>çš„å…¨ç§°æ˜¯å¼€æ”¾ç³»ç»Ÿäº’è¿å‚è€ƒæ¨¡å‹<code>ï¼ˆOpen System Interconnection Reference Modelï¼ŒOSI/RMï¼‰</code>ï¼Œå®ƒæ˜¯ç”±å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼ˆInternational Standard Organizationï¼ŒISOï¼‰æå‡ºçš„ä¸€ä¸ªç½‘ç»œç³»ç»Ÿäº’è¿æ¨¡å‹ã€‚</p><ul><li><p>åœ¨è¿™ä¸ª OSI ä¸ƒå±‚æ¨¡å‹ä¸­ï¼Œæ¯ä¸€å±‚éƒ½ä¸ºå…¶ä¸Šä¸€å±‚æä¾›æœåŠ¡å’Œè®¿é—®æ¥å£</p></li><li><p>ä¸åŒä¸»æœºä¹‹é—´çš„ç›¸åŒå±‚ç§°ä¸º<strong>å¯¹ç­‰å±‚</strong></p></li><li></li><li><p>å¯¹ç­‰å±‚ä¹‹é—´äº’ç›¸é€šä¿¡éœ€è¦éµå®ˆä¸€å®šçš„è§„åˆ™ï¼Œå¦‚é€šä¿¡çš„å†…å®¹ã€é€šä¿¡çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸º<strong>åè®®</strong>ï¼ˆProtocolï¼‰ã€‚</p></li><li><p>æˆ‘ä»¬å°†æŸä¸ªä¸»æœºä¸Šè¿è¡Œçš„æŸç§åè®®çš„é›†åˆç§°ä¸º<strong>åè®®æ ˆ</strong>ã€‚ä¸»æœºæ­£æ˜¯åˆ©ç”¨è¿™ä¸ªåè®®æ ˆæ¥æ¥æ”¶å’Œå‘é€æ•°æ®çš„ã€‚</p></li><li><p>OSI å‚è€ƒæ¨¡å‹é€šè¿‡å°†åè®®æ ˆåˆ’åˆ†ä¸ºä¸åŒçš„å±‚æ¬¡ï¼Œå¯ä»¥ç®€åŒ–é—®é¢˜çš„åˆ†æã€å¤„ç†è¿‡ç¨‹ä»¥åŠç½‘ç»œç³»ç»Ÿè®¾è®¡çš„å¤æ‚æ€§ã€‚</p></li></ul><h2 id="OSI-å‚è€ƒæ¨¡å‹ä¸­å„å±‚çš„ä½œç”¨"><a href="#OSI-å‚è€ƒæ¨¡å‹ä¸­å„å±‚çš„ä½œç”¨" class="headerlink" title="OSI å‚è€ƒæ¨¡å‹ä¸­å„å±‚çš„ä½œç”¨"></a>OSI å‚è€ƒæ¨¡å‹ä¸­å„å±‚çš„ä½œç”¨</h2><h3 id="ç‰©ç†å±‚Physical-Layer"><a href="#ç‰©ç†å±‚Physical-Layer" class="headerlink" title="ç‰©ç†å±‚Physical Layer"></a>ç‰©ç†å±‚<code>Physical Layer</code></h3><ul><li>åˆ©ç”¨ä¼ è¾“ä»‹è´¨ä¸ºæ•°æ®é“¾è·¯å±‚æä¾›ç‰©ç†ä¿¡é“ï¼Œä¼ è¾“äºŒè¿›åˆ¶æ•°æ®</li><li>æ•°æ®çš„å•ä½ç§°ä¸ºæ¯”ç‰¹<code>bit</code></li></ul><h3 id="æ•°æ®é“¾è·¯å±‚Data-Link-Layer"><a href="#æ•°æ®é“¾è·¯å±‚Data-Link-Layer" class="headerlink" title="æ•°æ®é“¾è·¯å±‚Data Link Layer"></a>æ•°æ®é“¾è·¯å±‚<code>Data Link Layer</code></h3><blockquote><p>ç›¸é‚»èŠ‚ç‚¹</p></blockquote><ul><li>ç‰©ç†åœ°å€å¯»å€ã€æ•°æ®çš„æˆå¸§ã€æµé‡æ§åˆ¶ã€æ£€é”™é‡å‘ç­‰ã€‚æ§åˆ¶å¸§åœ¨ç‰©ç†ä¿¡é“çš„ä¼ è¾“</li><li>æ•°æ®çš„å•ä½ç§°ä¸ºå¸§<code>frame</code></li><li>åè®®<ul><li><code>ARP</code>ï¼ˆAddress Resolution Protocolï¼Œåœ°å€è§£æåè®®ï¼‰IPåœ°å€æ˜ å°„åˆ°MACåœ°å€</li><li><code>RARP</code>ï¼ˆReverse Address Resolution Protocolï¼Œé€†åœ°å€è§£æåè®®ï¼‰</li></ul></li></ul><h3 id="ç½‘ç»œå±‚Network-Layer"><a href="#ç½‘ç»œå±‚Network-Layer" class="headerlink" title="ç½‘ç»œå±‚Network Layer"></a>ç½‘ç»œå±‚<code>Network Layer</code></h3><blockquote><p>ä¸ç›¸é‚»èŠ‚ç‚¹</p></blockquote><ul><li>å°†ä¼ è¾“å±‚æ•°æ®å°è£…æˆåŒ…ï¼Œå¹¶æ ¹æ®IPåœ°å€é€‰æ‹©è·¯ç”±è·¯å¾„å¹¶åœ¨ç½‘ç»œä¸­ä¼ è¾“</li><li>æ•°æ®çš„å•ä½ç§°ä¸ºåŒ…<code>packet</code></li><li>åè®®<ul><li><code>IP</code> åè®®ï¼ˆInternet Protocolï¼Œç½‘é™…åè®®ï¼‰<ol><li><code>IPåè®®</code>æ˜¯ä¸ºè®¡ç®—æœºç½‘ç»œç›¸äº’è¿æ¥è¿›è¡Œé€šä¿¡è€Œè®¾è®¡çš„åè®®ã€‚åœ¨å› ç‰¹ç½‘ä¸­ï¼Œå®ƒæ˜¯èƒ½ä½¿è¿æ¥åˆ°ç½‘ä¸Šçš„æ‰€æœ‰è®¡ç®—æœºç½‘ç»œå®ç°ç›¸äº’é€šä¿¡çš„ä¸€å¥—è§„åˆ™ï¼Œè§„å®šäº†è®¡ç®—æœºåœ¨å› ç‰¹ç½‘ä¸Šè¿›è¡Œé€šä¿¡æ—¶åº”å½“éµå®ˆçš„è§„åˆ™</li><li><code>IPåè®®</code>å±è”½äº†ä¸‹å±‚å„ç§ç‰©ç†å­ç½‘çš„å·®å¼‚ï¼Œå‘ä¸Šå±‚æä¾›ç»™ç»Ÿä¸€æ ¼å¼çš„<code>IPæ•°æ®æŠ¥</code></li><li><code>IPæ•°æ®æŠ¥</code>ä¼ é€ä½¿ç”¨<code>éè¿æ¥å¼</code>çš„ä¼ é€æ–¹å¼ã€‚éè¿æ¥å¼çš„ä¼ é€æ–¹å¼æ˜¯æŒ‡IPä¼ é€æ—¶ï¼Œæºè®¾å¤‡ä¸ç›®çš„è®¾å¤‡åŒæ–¹ä¸å¿…äº‹å…ˆè¿æ¥ï¼Œå³å¯å°†IPæ•°æ®æŠ¥é€è¾¾ã€‚å³æºè®¾å¤‡å®Œå…¨ä¸ç”¨ç†ä¼šç›®çš„è®¾å¤‡ï¼Œè€Œåªæ˜¯å•çº¯åœ°å°†IPæ•°æ®æŠ¥é€ä¸€é€å‡ºã€‚è‡³äºç›®çš„è®¾å¤‡æ˜¯å¦æ”¶åˆ°æ¯ä¸ªä¿¡æ¯åŒ…ã€æ˜¯å¦æ”¶åˆ°æ­£ç¡®çš„ä¿¡æ¯åŒ…ç­‰ï¼Œåˆ™ç”±ä¸Šå±‚çš„åè®®(ä¾‹å¦‚<code>TCP</code>)æ¥è´Ÿè´£æ£€æŸ¥</li></ol></li><li><code>ICMP</code> åè®®ï¼ˆInternet Control Message Protocolï¼Œç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ï¼‰</li><li><code>IGMP</code> åè®®ï¼ˆInternet Group Management Protocolï¼Œç½‘é™…ç»„ç®¡ç†åè®®ï¼‰</li></ul></li></ul><h3 id="ä¼ è¾“å±‚Transport-Layer"><a href="#ä¼ è¾“å±‚Transport-Layer" class="headerlink" title="ä¼ è¾“å±‚Transport Layer"></a>ä¼ è¾“å±‚<code>Transport Layer</code></h3><ul><li><p>æä¾›ç«¯å¯¹ç«¯çš„æ¥å£ï¼Œå‘ä¸¤ä¸ªä¸»æœºä¸­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æä¾›æœåŠ¡ï¼Œæ ¹æ®åè®®å¯å‘ä¼šè¯å±‚äº¤ä»˜å¯é çš„ç½‘ç»œè¿æ¥ï¼ŒåŒæ—¶å¯¹äºé«˜å±‚å±è”½äº†ä½å±‚çš„æŠ€æœ¯ç»†èŠ‚</p></li><li><p>æ•°æ®çš„å•ä½ç§°ä¸ºæ•°æ®æ®µ<code>Segment</code>æˆ–æŠ¥æ–‡</p></li><li><p>åè®®</p><ul><li><p><code>TCP</code>ï¼ˆTransmission Control Protocolï¼‰ä¼ è¾“æ§åˆ¶åè®®</p><ol><li>é¢å‘è¿æ¥ï¼ˆæ¡æ‰‹ç¹çï¼‰</li><li>å¯é äº¤ä»˜ï¼Œä¿è¯æ•°æ®çš„å®Œæ•´å’Œé¡ºåºæ— å·®é”™</li><li>å•æ’­ç‚¹å¯¹ç‚¹</li><li>å¤´éƒ¨è¾ƒå¤§â€”â€”20å­—èŠ‚</li><li>é˜Ÿå¤´é˜»å¡</li></ol></li><li><p><code>UDP</code>ï¼ˆUser Datagram Protocolï¼‰ç”¨æˆ·æ•°æ®åè®®</p><ol><li>é¢å‘æŠ¥æ–‡ï¼ˆæ— éœ€æ¡æ‰‹ï¼Œå¯¹åº”ç”¨å±‚äº¤ä¸‹æ¥çš„æŠ¥æ–‡ï¼Œæ·»åŠ é¦–éƒ¨åç›´æ¥ä¹¡ä¸‹äº¤ä»˜ä¸ºIPå±‚ï¼‰</li><li>ä¸å¯é äº¤ä»˜ï¼Œæ•°æ®å‘é€ä¸å—ä¸¢åŒ…å’Œç½‘ç»œæ³¢åŠ¨å½±å“</li><li>å•æ’­å’Œå¹¿æ’­ï¼Œ</li><li>å¤´éƒ¨è¾ƒå°â€”â€”8å­—èŠ‚</li><li>ç›´æ’­ï¼Œåœ¨çº¿ä¼šè®®ï¼Œè¯­éŸ³ï¼Œå³æ—¶é€šä¿¡</li><li>æ²¡æœ‰æ‹¥å¡æœºåˆ¶</li></ol></li></ul></li></ul><h3 id="ä¼šè¯å±‚Session-Layer"><a href="#ä¼šè¯å±‚Session-Layer" class="headerlink" title="ä¼šè¯å±‚Session Layer"></a>ä¼šè¯å±‚<code>Session Layer</code></h3><ul><li>ç®¡ç†è¡¨ç¤ºå±‚ä¹‹é—´çš„è¿æ¥ï¼ˆä¼šè¯ï¼‰</li><li>ç»„ç»‡å’Œåè°ƒä¸¤ä¸ªä¼šè¯è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡,å¹¶å¯¹æ•°æ®äº¤æ¢è¿›è¡Œç®¡ç†</li></ul><h3 id="è¡¨ç¤ºå±‚Presentation-Layer"><a href="#è¡¨ç¤ºå±‚Presentation-Layer" class="headerlink" title="è¡¨ç¤ºå±‚Presentation Layer"></a>è¡¨ç¤ºå±‚<code>Presentation Layer</code></h3><ul><li>å¤„ç†æ•°æ®ç¼–ç ã€æ•°æ®æ ¼å¼è½¬æ¢å’ŒåŠ å¯†è§£å¯†</li></ul><h3 id="åº”ç”¨å±‚Application-Layer"><a href="#åº”ç”¨å±‚Application-Layer" class="headerlink" title="åº”ç”¨å±‚Application Layer"></a>åº”ç”¨å±‚<code>Application Layer</code></h3><ul><li>åº”ç”¨ç¨‹åºè®¿é—®ç½‘ç»œæœåŠ¡çš„æ¥å£</li><li>åè®®<ul><li><code>HTTP</code>ï¼ˆHyper Text Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰</li><li><code>FTP</code>ï¼ˆFile Transfer Protocolï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰</li><li>é‚®ä»¶ç›¸å…³çš„<code>POP3</code>ï¼ˆPost Office Protocol - V3ï¼‰å’Œ<code>SMTP</code>ï¼ˆSimple Mail Transfer Protocolï¼Œç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰</li></ul></li></ul><hr><h1 id="TCP-IP-åˆ†å±‚æ¨¡å‹"><a href="#TCP-IP-åˆ†å±‚æ¨¡å‹" class="headerlink" title="TCP/IP åˆ†å±‚æ¨¡å‹"></a>TCP/IP åˆ†å±‚æ¨¡å‹</h1><ul><li>TCP/IP åˆ†å±‚æ¨¡å‹ï¼ˆTCP/IP Layering Modelï¼‰è¢«ç§°ä½œå› ç‰¹ç½‘åˆ†å±‚æ¨¡å‹(Internet Layering Model)ã€å› ç‰¹ç½‘å‚è€ƒæ¨¡å‹(Internet Reference Model)</li></ul><h2 id="TCP-IP-ä¸­å„å±‚çš„ä½œç”¨"><a href="#TCP-IP-ä¸­å„å±‚çš„ä½œç”¨" class="headerlink" title="TCP/IP ä¸­å„å±‚çš„ä½œç”¨"></a>TCP/IP ä¸­å„å±‚çš„ä½œç”¨</h2><h3 id="é“¾è·¯å±‚"><a href="#é“¾è·¯å±‚" class="headerlink" title="é“¾è·¯å±‚"></a>é“¾è·¯å±‚</h3><blockquote><p>å¯¹åº”ç€ OSI/RM çš„æ•°æ®é“¾è·¯å±‚+ç‰©ç†å±‚</p></blockquote><h3 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h3><h3 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h3><h3 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h3><blockquote><p>å¯¹åº”OSI/RM çš„è¡¨ç¤ºå±‚+ä¼šè¯å±‚+åº”ç”¨å±‚</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>http</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è™šæ‹Ÿåˆ—è¡¨çš„ç®€å•å®ç°</title>
    <link href="/2022/02/24/%E8%99%9A%E6%8B%9F%E5%88%97%E8%A1%A8%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/02/24/%E8%99%9A%E6%8B%9F%E5%88%97%E8%A1%A8%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>ref:[<a href="https://mp.weixin.qq.com/s/8uttkBw-dwYXsybKePQ3nA]">https://mp.weixin.qq.com/s/8uttkBw-dwYXsybKePQ3nA]</a></p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>è™šæ‹Ÿåˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">      <span class="hljs-selector-tag">html</span> &#123;</span><span class="css">        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;</span>      &#125;<span class="css">      <span class="hljs-selector-tag">body</span> &#123;</span><span class="css">        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;</span><span class="css">        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span>      &#125;      #app &#123;<span class="css">        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;</span>      &#125;      .visible-area&#123;<span class="css">        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;</span>      &#125;      .infinite-list-container &#123;<span class="css">        <span class="hljs-attribute">overflow</span>: auto;</span><span class="css">        <span class="hljs-attribute">position</span>: relative;</span><span class="css">        -webkit-<span class="hljs-attribute">overflow</span>-scrolling: touch;</span><span class="css">        <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid black;</span>      &#125;      .infinite-list-phantom &#123;<span class="css">        <span class="hljs-attribute">position</span>: absolute;</span><span class="css">        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;</span><span class="css">        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;</span><span class="css">        <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;</span><span class="css">        <span class="hljs-attribute">z-index</span>: -<span class="hljs-number">1</span>;</span>      &#125;      .infinite-list &#123;<span class="css">        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;</span><span class="css">        <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;</span><span class="css">        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;</span><span class="css">        <span class="hljs-attribute">position</span>: absolute;</span>      &#125;      .infinite-list-item &#123;<span class="css">        <span class="hljs-attribute">margin</span>: <span class="hljs-number">5px</span>;</span><span class="css">        <span class="hljs-attribute">color</span>: <span class="hljs-number">#555</span>;</span><span class="css">        <span class="hljs-comment">/* box-sizing: border-box; */</span></span><span class="css">        <span class="hljs-attribute">border</span>:<span class="hljs-number">6px</span> solid gray;</span><span class="css">        <span class="hljs-comment">/* height:200px; */</span></span>      &#125;    <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;visible-area&quot;</span>&gt;</span>        æˆ‘æ˜¯å¯è§†åŒºåŸŸ              <span class="hljs-tag">&lt;<span class="hljs-name">virtual-list</span> <span class="hljs-attr">:list-data</span>=<span class="hljs-string">&quot;list&quot;</span> <span class="hljs-attr">:estimated-item-size</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">:buffer-scale</span>=<span class="hljs-string">&quot;5&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">virtual-list</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">virtual-list</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.bootcdn.net/ajax/libs/Faker/3.1.0/faker.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;module&quot;</span>&gt;</span><span class="javascript">      <span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.esm.browser.js&quot;</span>;</span><span class="javascript">      Vue.component(<span class="hljs-string">&quot;virtual-list&quot;</span>, &#123;</span>        template: `<span class="javascript">        &lt;div ref=<span class="hljs-string">&quot;list&quot;</span> :style=<span class="hljs-string">&quot;&#123;height&#125;&quot;</span> <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;infinite-list-container&quot;</span> @scroll=<span class="hljs-string">&quot;scrollEvent($event)&quot;</span>&gt;</span><span class="handlebars"><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;phantom&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;infinite-list-phantom&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></span><span class="javascript">          &lt;div ref=<span class="hljs-string">&quot;content&quot;</span> <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;infinite-list&quot;</span>&gt;</span><span class="javascript">            &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;infinite-list-item&quot;</span> ref=<span class="hljs-string">&quot;items&quot;</span> :id=<span class="hljs-string">&quot;item.id&quot;</span> :key=<span class="hljs-string">&quot;item.id&quot;</span> v-<span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;item in visibleData&quot;</span>&gt;</span><span class="handlebars"><span class="xml">              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color:red&quot;</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">item.id</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">item.value</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span></span><span class="handlebars"><span class="xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></span><span class="handlebars"><span class="xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></span><span class="handlebars"><span class="xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></span>        `,        props: &#123;<span class="javascript">          <span class="hljs-comment">//åˆ—è¡¨æ•°æ®</span></span>          listData: &#123;<span class="javascript">            type: <span class="hljs-built_in">Array</span>,</span><span class="javascript">            <span class="hljs-keyword">default</span>: <span class="hljs-function">() =&gt;</span> [],</span>          &#125;,<span class="javascript">          <span class="hljs-comment">//é¢„ä¼°é«˜åº¦</span></span>          estimatedItemSize: &#123;<span class="javascript">            type: <span class="hljs-built_in">Number</span>,</span><span class="javascript">            required: <span class="hljs-literal">true</span>,</span>          &#125;,<span class="javascript">          <span class="hljs-comment">//ç¼“å†²åŒºæ¯”ä¾‹</span></span>          bufferScale: &#123;<span class="javascript">            type: <span class="hljs-built_in">Number</span>,</span><span class="javascript">            <span class="hljs-keyword">default</span>: <span class="hljs-number">1</span>,</span>          &#125;,<span class="javascript">          <span class="hljs-comment">//å®¹å™¨é«˜åº¦ 100px or 50vh</span></span>          height: &#123;<span class="javascript">            type: <span class="hljs-built_in">String</span>,</span><span class="javascript">            <span class="hljs-keyword">default</span>: <span class="hljs-string">&quot;100%&quot;</span>,</span>          &#125;,        &#125;,        computed: &#123;<span class="javascript">          <span class="hljs-comment">// å¯è§†åŒºåŸŸå†…èƒ½æ˜¾ç¤ºå‡ æ¡æ•°æ®</span></span><span class="javascript">          <span class="hljs-function"><span class="hljs-title">visibleCount</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">            <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.ceil(<span class="hljs-built_in">this</span>.screenHeight / <span class="hljs-built_in">this</span>.estimatedItemSize);</span>          &#125;,<span class="javascript">          <span class="hljs-comment">// å¯è§†åŒºåŸŸä¸Šæ–¹æ•°æ®æ¡æ•°</span></span><span class="javascript">          <span class="hljs-comment">// Math.minå–ç¼“å†²åŒºå€¼</span></span><span class="javascript">          <span class="hljs-function"><span class="hljs-title">aboveCount</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">            <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.min(<span class="hljs-built_in">this</span>.start, <span class="hljs-built_in">this</span>.bufferScale * <span class="hljs-built_in">this</span>.visibleCount);</span>          &#125;,<span class="javascript">          <span class="hljs-comment">// å¯è§†åŒºåŸŸä¸‹æ–¹æ•°æ®æ¡æ•°</span></span><span class="javascript">          <span class="hljs-function"><span class="hljs-title">belowCount</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">            <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.min(</span><span class="javascript">              <span class="hljs-built_in">this</span>.listData.length - <span class="hljs-built_in">this</span>.end,</span><span class="javascript">              <span class="hljs-built_in">this</span>.bufferScale * <span class="hljs-built_in">this</span>.visibleCount</span>            );          &#125;,<span class="javascript">          <span class="hljs-function"><span class="hljs-title">visibleData</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">            <span class="hljs-comment">// éœ€è¦æ¸²æŸ“çš„æ•°æ® = æ˜¾ç¤ºçš„æ•°æ®åŠ ä¸Šä¸Šä¸‹ç¼“å†²åŒº</span></span><span class="javascript">            <span class="hljs-keyword">let</span> start = <span class="hljs-built_in">this</span>.start - <span class="hljs-built_in">this</span>.aboveCount;</span><span class="javascript">            <span class="hljs-keyword">let</span> end = <span class="hljs-built_in">this</span>.end + <span class="hljs-built_in">this</span>.belowCount;</span><span class="javascript">            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.listData.slice(start, end);</span>          &#125;,        &#125;,<span class="javascript">        <span class="hljs-function"><span class="hljs-title">created</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">          <span class="hljs-built_in">this</span>.initPositions();</span>        &#125;,<span class="javascript">        <span class="hljs-function"><span class="hljs-title">mounted</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">          <span class="hljs-built_in">this</span>.screenHeight = <span class="hljs-built_in">this</span>.$el.clientHeight;</span><span class="javascript">          <span class="hljs-built_in">this</span>.start = <span class="hljs-number">0</span>;</span><span class="javascript">          <span class="hljs-built_in">this</span>.end = <span class="hljs-built_in">this</span>.start + <span class="hljs-built_in">this</span>.visibleCount;</span>        &#125;,<span class="javascript">        <span class="hljs-function"><span class="hljs-title">updated</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">          <span class="hljs-built_in">this</span>.$nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><span class="javascript">            <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.$refs.items || !<span class="hljs-built_in">this</span>.$refs.items.length) &#123;</span><span class="javascript">              <span class="hljs-keyword">return</span>;</span>            &#125;<span class="javascript">            <span class="hljs-comment">//è·å–çœŸå®å…ƒç´ å¤§å°ï¼Œä¿®æ”¹å¯¹åº”çš„å°ºå¯¸ç¼“å­˜</span></span><span class="javascript">            <span class="hljs-built_in">this</span>.updateItemsSize();</span><span class="javascript">            <span class="hljs-comment">//æ›´æ–°åˆ—è¡¨æ€»é«˜åº¦</span></span><span class="javascript">            <span class="hljs-keyword">let</span> height = <span class="hljs-built_in">this</span>.positions[<span class="hljs-built_in">this</span>.positions.length - <span class="hljs-number">1</span>].bottom;</span><span class="javascript">            <span class="hljs-built_in">this</span>.$refs.phantom.style.height = height + <span class="hljs-string">&quot;px&quot;</span>;</span><span class="javascript">            <span class="hljs-comment">//æ›´æ–°çœŸå®åç§»é‡</span></span><span class="javascript">            <span class="hljs-built_in">this</span>.setStartOffset();</span>          &#125;);        &#125;,<span class="javascript">        <span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">          <span class="hljs-keyword">return</span> &#123;</span><span class="javascript">            <span class="hljs-comment">//å¯è§†åŒºåŸŸé«˜åº¦</span></span>            screenHeight: 0,<span class="javascript">            <span class="hljs-comment">//èµ·å§‹ç´¢å¼•</span></span>            start: 0,<span class="javascript">            <span class="hljs-comment">//ç»“æŸç´¢å¼•</span></span>            end: 0,          &#125;;        &#125;,        methods: &#123;<span class="javascript">          <span class="hljs-function"><span class="hljs-title">initPositions</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">            <span class="hljs-built_in">this</span>.positions = <span class="hljs-built_in">this</span>.listData.map(<span class="hljs-function">(<span class="hljs-params">d, index</span>) =&gt;</span> (&#123;</span>              index,<span class="javascript">              height: <span class="hljs-built_in">this</span>.estimatedItemSize,</span><span class="javascript">              top: index * <span class="hljs-built_in">this</span>.estimatedItemSize,</span><span class="javascript">              bottom: (index + <span class="hljs-number">1</span>) * <span class="hljs-built_in">this</span>.estimatedItemSize,</span>            &#125;));          &#125;,<span class="javascript">          <span class="hljs-comment">//è·å–åˆ—è¡¨èµ·å§‹ç´¢å¼•</span></span><span class="javascript">          <span class="hljs-function"><span class="hljs-title">getStartIndex</span>(<span class="hljs-params">scrollTop = <span class="hljs-number">0</span></span>)</span> &#123;</span><span class="javascript">            <span class="hljs-comment">//äºŒåˆ†æ³•æŸ¥æ‰¾</span></span><span class="javascript">            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.binarySearch(<span class="hljs-built_in">this</span>.positions, scrollTop);</span>          &#125;,<span class="javascript">          <span class="hljs-function"><span class="hljs-title">binarySearch</span>(<span class="hljs-params">list, value</span>)</span> &#123;</span><span class="javascript">            <span class="hljs-keyword">let</span> start = <span class="hljs-number">0</span>;</span><span class="javascript">            <span class="hljs-keyword">let</span> end = list.length - <span class="hljs-number">1</span>;</span><span class="javascript">            <span class="hljs-keyword">let</span> tempIndex = <span class="hljs-literal">null</span>;</span><span class="javascript">            <span class="hljs-keyword">while</span> (start &lt;= end) &#123;</span><span class="javascript">              <span class="hljs-keyword">let</span> midIndex = <span class="hljs-built_in">parseInt</span>((start + end) / <span class="hljs-number">2</span>);</span><span class="javascript">              <span class="hljs-keyword">let</span> midValue = list[midIndex].bottom;</span>              if (midValue === value) &#123;<span class="javascript">                <span class="hljs-keyword">return</span> midIndex + <span class="hljs-number">1</span>;</span><span class="javascript">              &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (midValue &lt; value) &#123;</span>                start = midIndex + 1;<span class="javascript">              &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (midValue &gt; value) &#123;</span><span class="javascript">                <span class="hljs-keyword">if</span> (tempIndex === <span class="hljs-literal">null</span> || tempIndex &gt; midIndex) &#123;</span>                  tempIndex = midIndex;                &#125;                end = end - 1;              &#125;            &#125;<span class="javascript">            <span class="hljs-keyword">return</span> tempIndex;</span>          &#125;,<span class="javascript">          <span class="hljs-comment">//æ›´æ–°åˆ—è¡¨é¡¹çš„å½“å‰å°ºå¯¸</span></span><span class="javascript">          <span class="hljs-function"><span class="hljs-title">updateItemsSize</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">            <span class="hljs-keyword">let</span> nodes = <span class="hljs-built_in">this</span>.$refs.items;</span><span class="javascript">            nodes.forEach(<span class="hljs-function">(<span class="hljs-params">node</span>) =&gt;</span> &#123;</span><span class="javascript">              <span class="hljs-keyword">let</span> rect = node.getBoundingClientRect();</span><span class="javascript">              <span class="hljs-keyword">let</span> height = rect.height;</span><span class="javascript">              <span class="hljs-keyword">let</span> index = +node.id.slice(<span class="hljs-number">1</span>);</span><span class="javascript">              <span class="hljs-keyword">let</span> oldHeight = <span class="hljs-built_in">this</span>.positions[index].height;</span><span class="javascript">              <span class="hljs-keyword">let</span> dValue = oldHeight - height;</span><span class="javascript">              <span class="hljs-comment">//å­˜åœ¨å·®å€¼</span></span>              if (dValue) &#123;<span class="javascript">                <span class="hljs-built_in">this</span>.positions[index].bottom =</span><span class="javascript">                  <span class="hljs-built_in">this</span>.positions[index].bottom - dValue;</span><span class="javascript">                <span class="hljs-built_in">this</span>.positions[index].height = height;</span><span class="javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = index + <span class="hljs-number">1</span>; k &lt; <span class="hljs-built_in">this</span>.positions.length; k++) &#123;</span><span class="javascript">                  <span class="hljs-built_in">this</span>.positions[k].top = <span class="hljs-built_in">this</span>.positions[k - <span class="hljs-number">1</span>].bottom;</span><span class="javascript">                  <span class="hljs-built_in">this</span>.positions[k].bottom = <span class="hljs-built_in">this</span>.positions[k].bottom - dValue;</span>                &#125;              &#125;            &#125;);          &#125;,<span class="javascript">          <span class="hljs-comment">//è®¡ç®—åç§»é‡å¹¶translate</span></span><span class="javascript">          <span class="hljs-function"><span class="hljs-title">setStartOffset</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">            <span class="hljs-keyword">let</span> startOffset;</span><span class="javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.start &gt;= <span class="hljs-number">1</span>) &#123;</span><span class="javascript">              <span class="hljs-keyword">let</span> size =</span><span class="javascript">                <span class="hljs-built_in">this</span>.positions[<span class="hljs-built_in">this</span>.start].top -</span><span class="javascript">                (<span class="hljs-built_in">this</span>.positions[<span class="hljs-built_in">this</span>.start - <span class="hljs-built_in">this</span>.aboveCount]</span><span class="javascript">                  ? <span class="hljs-built_in">this</span>.positions[<span class="hljs-built_in">this</span>.start - <span class="hljs-built_in">this</span>.aboveCount].top</span>                  : 0);<span class="javascript">              startOffset = <span class="hljs-built_in">this</span>.positions[<span class="hljs-built_in">this</span>.start - <span class="hljs-number">1</span>].bottom - size;</span><span class="javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span>              startOffset = 0;            &#125;<span class="javascript">            <span class="hljs-built_in">this</span>.$refs.content.style.transform = <span class="hljs-string">`translate3d(0,<span class="hljs-subst">$&#123;startOffset&#125;</span>px,0)`</span>;</span>          &#125;,<span class="javascript">          <span class="hljs-comment">//æ»šåŠ¨äº‹ä»¶</span></span><span class="javascript">          <span class="hljs-function"><span class="hljs-title">scrollEvent</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">            <span class="hljs-comment">//å½“å‰æ»šåŠ¨ä½ç½®</span></span><span class="javascript">            <span class="hljs-keyword">let</span> scrollTop = <span class="hljs-built_in">this</span>.$refs.list.scrollTop;</span><span class="javascript">            <span class="hljs-comment">// let startBottom = this.positions[this.start - ]</span></span><span class="javascript">            <span class="hljs-comment">//æ­¤æ—¶çš„å¼€å§‹ç´¢å¼•</span></span><span class="javascript">            <span class="hljs-built_in">this</span>.start = <span class="hljs-built_in">this</span>.getStartIndex(scrollTop);</span><span class="javascript">            <span class="hljs-comment">//æ­¤æ—¶çš„ç»“æŸç´¢å¼•</span></span><span class="javascript">            <span class="hljs-built_in">this</span>.end = <span class="hljs-built_in">this</span>.start + <span class="hljs-built_in">this</span>.visibleCount;</span><span class="javascript">            <span class="hljs-comment">//æ­¤æ—¶çš„åç§»é‡</span></span><span class="javascript">            <span class="hljs-built_in">this</span>.setStartOffset();</span>          &#125;,        &#125;,      &#125;);<span class="javascript">      <span class="hljs-keyword">new</span> Vue(&#123;</span><span class="javascript">        el: <span class="hljs-string">&quot;#app&quot;</span>,</span>        data: &#123;          dataLength: 100000,          list: [],        &#125;,<span class="javascript">        <span class="hljs-function"><span class="hljs-title">created</span>(<span class="hljs-params"></span>)</span> &#123;</span><span class="javascript">          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> id = <span class="hljs-number">0</span>; id &lt; <span class="hljs-built_in">this</span>.dataLength; ++id) &#123;</span><span class="javascript">            <span class="hljs-built_in">this</span>.list.push(&#123;</span>              id,              value: faker.lorem.sentences(),            &#125;);          &#125;        &#125;,      &#125;);    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é“¾è¡¨</title>
    <link href="/2022/02/24/%E9%93%BE%E8%A1%A8/"/>
    <url>/2022/02/24/%E9%93%BE%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ul><li>æ•°ç»„éœ€è¦ç”³è¯·è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œé“¾è¡¨å¯ä»¥ä½¿ç”¨â€œé›¶æ•£çš„â€å†…å­˜ç©ºé—´</li><li>æ’å…¥/åˆ é™¤æ—¶é—´å¤æ‚åº¦<code>O(1)</code></li><li>éšæœºè®¿é—®æ—¶é—´å¤æ‚åº¦<code>O(n)</code></li></ul><h2 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h2><ul><li>é›¶æ•£çš„å†…å­˜å—ç§°ä¸º<code>ç»“ç‚¹</code></li><li>è®°å½•ä¸‹ä¸€ä¸ªç»“ç‚¹åœ°å€çš„æŒ‡é’ˆå«åš<code>åç»§æŒ‡é’ˆnext</code></li><li><code>headNode</code></li><li><code>tailNode.next = null</code></li></ul><h2 id="ç§ç±»"><a href="#ç§ç±»" class="headerlink" title="ç§ç±»"></a>ç§ç±»</h2><ul><li>å•é“¾è¡¨</li><li>å¾ªç¯é“¾è¡¨</li></ul><p>  <code>tailNode.next = headNode</code></p><p>  é€‚åˆå¤„ç†ç¯çŠ¶ç»“æ„çš„æ•°æ®</p><ul><li><p>åŒå‘é“¾è¡¨</p><p>ç»“ç‚¹æ‹¥æœ‰ä¸¤ä¸ªæŒ‡é’ˆ<br><code>curNode.prev</code><br><code>curNode.next</code></p><p><code>O(1)</code>æ—¶é—´å¤æ‚åº¦å³å¯è®¿é—®å‰åºç»“ç‚¹</p></li><li><p>åŒå‘å¾ªç¯é“¾è¡¨</p><p><code>headNode.prev = tailNode</code><br><code>tailNode.next = headNode</code></p></li></ul><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å•å‘é“¾è¡¨</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">element</span>)</span> &#123;    <span class="hljs-built_in">this</span>.element = element;    <span class="hljs-built_in">this</span>.next = <span class="hljs-literal">null</span>;  &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">linkedList</span> </span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123;    <span class="hljs-built_in">this</span>.head = <span class="hljs-literal">null</span>;    <span class="hljs-built_in">this</span>.length = <span class="hljs-number">0</span>;  &#125;  <span class="hljs-comment">// è¿½åŠ </span>  <span class="hljs-function"><span class="hljs-title">append</span>(<span class="hljs-params">element</span>)</span> &#123;    <span class="hljs-keyword">const</span> n = <span class="hljs-keyword">new</span> Node(element);    <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head;    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.head) &#123;      <span class="hljs-built_in">this</span>.head = n;    &#125; <span class="hljs-keyword">else</span> &#123;      <span class="hljs-keyword">while</span> (cur.next) &#123;        cur = cur.next;      &#125;      cur.next = n;      <span class="hljs-built_in">this</span>.length++;    &#125;  &#125;  <span class="hljs-comment">// æŸ¥æ‰¾</span>  <span class="hljs-function"><span class="hljs-title">search</span>(<span class="hljs-params">element</span>)</span> &#123;    <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head;    <span class="hljs-keyword">if</span> (!cur) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    <span class="hljs-keyword">while</span> (cur) &#123;      <span class="hljs-keyword">if</span> (cur.element === element) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;      &#125;      cur = cur.next;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  &#125;  <span class="hljs-comment">// æ’å…¥</span>  <span class="hljs-comment">// positionä¹‹å‰æ’å…¥æ–°node</span>  <span class="hljs-function"><span class="hljs-title">insert</span>(<span class="hljs-params">position, element</span>)</span> &#123;    <span class="hljs-keyword">if</span> (position &gt;= <span class="hljs-number">0</span> &amp;&amp; position &lt;= <span class="hljs-built_in">this</span>.length) &#123;      <span class="hljs-keyword">let</span> n = <span class="hljs-keyword">new</span> Node(element);      <span class="hljs-keyword">if</span> (position === <span class="hljs-number">0</span>) &#123;        n.next = <span class="hljs-built_in">this</span>.head;        <span class="hljs-built_in">this</span>.head = n;      &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head,pre        <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (index &lt; position) &#123;          pre = cur;          cur = cur.next;          index++;        &#125;        pre.next = n;        n.next = cur;      &#125;      <span class="hljs-built_in">this</span>.length++;    &#125; <span class="hljs-keyword">else</span> &#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    &#125;  &#125;  <span class="hljs-comment">// åˆ é™¤</span>  <span class="hljs-function"><span class="hljs-title">remove</span>(<span class="hljs-params">element</span>)</span> &#123;    <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head,      pre = <span class="hljs-built_in">this</span>.head    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.head) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>    <span class="hljs-keyword">while</span> (cur) &#123;      <span class="hljs-keyword">if</span> (cur.element === element) &#123;        cur = cur.next;        pre.next = cur;        <span class="hljs-built_in">this</span>.length --       &#125;      pre = cur      cur = cur.next;    &#125;  &#125;&#125;<span class="hljs-comment">// åŒå‘é“¾è¡¨</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DubLinkedList</span>(<span class="hljs-params">params</span>) </span>&#123;  <span class="hljs-keyword">const</span> Node = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">element</span>) </span>&#123;    <span class="hljs-built_in">this</span>.prev = <span class="hljs-literal">null</span>;    <span class="hljs-built_in">this</span>.next = <span class="hljs-literal">null</span>;    <span class="hljs-built_in">this</span>.element = element;  &#125;;  <span class="hljs-built_in">this</span>.head = <span class="hljs-literal">null</span>;  <span class="hljs-built_in">this</span>.tail = <span class="hljs-literal">null</span>;  <span class="hljs-built_in">this</span>.length = <span class="hljs-number">0</span>;  <span class="hljs-built_in">this</span>.append = <span class="hljs-function">(<span class="hljs-params">element</span>) =&gt;</span> &#123;    <span class="hljs-keyword">let</span> newNode = <span class="hljs-keyword">new</span> Node(element);    <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head;    <span class="hljs-keyword">if</span> (!cur) &#123;      <span class="hljs-built_in">this</span>.head = newNode;      <span class="hljs-built_in">this</span>.tail = newNode;    &#125; <span class="hljs-keyword">else</span> &#123;      <span class="hljs-keyword">while</span> (cur.next) &#123;        cur = cur.next;      &#125;      cur.next = newNode      newNode.prev = cur      <span class="hljs-built_in">this</span>.tail = newNode    &#125;    <span class="hljs-built_in">this</span>.length++;  &#125;  <span class="hljs-built_in">this</span>.insert = <span class="hljs-function">(<span class="hljs-params">position,element</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span>(position&gt;=<span class="hljs-number">0</span> &amp;&amp; position &lt;=<span class="hljs-built_in">this</span>.length)&#123;      <span class="hljs-keyword">let</span> newNode = <span class="hljs-keyword">new</span> Node(element)      <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head,pre      <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>      <span class="hljs-keyword">if</span>(position===<span class="hljs-number">0</span>)&#123;        <span class="hljs-comment">//å¤´</span>        <span class="hljs-keyword">if</span>(!cur)&#123;          <span class="hljs-built_in">this</span>.head = newNode;          <span class="hljs-built_in">this</span>.tail = newNode;        &#125;<span class="hljs-keyword">else</span>&#123;          newNode.next = <span class="hljs-built_in">this</span>.head          cur.prev = newNode          <span class="hljs-built_in">this</span>.head = newNode        &#125;      &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(position===<span class="hljs-built_in">this</span>.length)&#123;        <span class="hljs-comment">//å°¾å·´</span>        cur = <span class="hljs-built_in">this</span>.tail        cur.prev = newNode        newNode.next = cur        <span class="hljs-built_in">this</span>.tail = newNode      &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">while</span>(index&lt;position)&#123;          pre = cur          cur = cur.next          index++        &#125;        cur.prev = newNode        pre.next = newNode        newNode.next = cur        newNode.prev = pre      &#125;      <span class="hljs-built_in">this</span>.length ++    &#125;<span class="hljs-keyword">else</span>&#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>    &#125;  &#125;  <span class="hljs-built_in">this</span>.remove = <span class="hljs-function"><span class="hljs-params">position</span> =&gt;</span> &#123;    <span class="hljs-keyword">if</span>(position&gt;=<span class="hljs-number">0</span> &amp;&amp; position&lt;<span class="hljs-built_in">this</span>.length &amp;&amp; <span class="hljs-built_in">this</span>.length&gt;<span class="hljs-number">0</span>)&#123;      <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head,pre,index = <span class="hljs-number">0</span>      <span class="hljs-keyword">if</span>(position===<span class="hljs-number">0</span>)&#123;        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.length === <span class="hljs-number">1</span>)&#123;          <span class="hljs-built_in">this</span>.head = <span class="hljs-literal">null</span>          <span class="hljs-built_in">this</span>.tail = <span class="hljs-literal">null</span>        &#125;<span class="hljs-keyword">else</span>&#123;          cur = cur.next          cur.prev = <span class="hljs-literal">null</span>          <span class="hljs-built_in">this</span>.head = cur        &#125;      &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(position===<span class="hljs-built_in">this</span>.length-<span class="hljs-number">1</span>)&#123;        cur = <span class="hljs-built_in">this</span>.tail        pre = cur.prev        pre.next = <span class="hljs-literal">null</span>        <span class="hljs-built_in">this</span>.tail = pre      &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">while</span>(index&lt;position)&#123;          pre = cur          cur = cur.next          index ++        &#125;        cur = cur.next        pre.next = cur        cur.prev = pre      &#125;      <span class="hljs-built_in">this</span>.length --      <span class="hljs-keyword">return</span> cur.element    &#125;<span class="hljs-keyword">else</span>&#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>    &#125;  &#125;  <span class="hljs-built_in">this</span>.search = <span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span>&#123;    <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">this</span>.head) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>    <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head    <span class="hljs-keyword">while</span>(cur)&#123;      <span class="hljs-keyword">if</span>(cur.element === element)&#123;        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>      &#125;      cur = cur.next    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>  &#125;&#125;</code></pre></div><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><h3 id="æ³¨æ„è¾¹ç•Œæƒ…å†µ"><a href="#æ³¨æ„è¾¹ç•Œæƒ…å†µ" class="headerlink" title="æ³¨æ„è¾¹ç•Œæƒ…å†µ"></a>æ³¨æ„è¾¹ç•Œæƒ…å†µ</h3><ul><li>é“¾è¡¨ä¸ºç©º</li><li>é“¾è¡¨åªæœ‰ä¸€ä¸ªç»“ç‚¹</li><li>é“¾è¡¨åªæœ‰ä¸¤ä¸ªç»“ç‚¹</li><li>å¤„ç†å¤´éƒ¨ç»“ç‚¹å’Œå°¾éƒ¨ç»“ç‚¹</li></ul><h3 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><ul><li>å•é“¾è¡¨åè½¬<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ListNode</span>(<span class="hljs-params">val</span>)</span>&#123;  <span class="hljs-built_in">this</span>.val = val  <span class="hljs-built_in">this</span>.next = <span class="hljs-literal">null</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reverseLinkedList</span>(<span class="hljs-params">head</span>)</span>&#123;  <span class="hljs-comment">// é•¿åº¦ä¸º1</span>  <span class="hljs-keyword">if</span>(!head.next) <span class="hljs-keyword">return</span> head  <span class="hljs-comment">// é“¾è¡¨åè¿‡æ¥ï¼Œåˆ™headçš„å€¼ä¸ºnull</span>  <span class="hljs-keyword">let</span> pre = <span class="hljs-literal">null</span>  <span class="hljs-keyword">let</span> cur = head  <span class="hljs-comment">// é“¾è¡¨æ­£å‘èµ°å®Œå.next = null</span>  <span class="hljs-keyword">while</span>(cur)&#123;    <span class="hljs-keyword">const</span> _next = cur.next    cur.next = pre    pre = cur    cur = _next  &#125;  <span class="hljs-keyword">return</span> pre&#125;<span class="hljs-comment">// es6</span><span class="hljs-keyword">let</span> [pre,cur] = [<span class="hljs-literal">null</span>,head]<span class="hljs-keyword">while</span>(cur)&#123;  [cur.next,pre,cur] = [pre,cur,cur.next]&#125;<span class="hljs-keyword">return</span> pre</code></pre></div></li><li>æ£€æµ‹é“¾è¡¨æ˜¯å¦å¾ªç¯<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//</span><span class="hljs-built_in">JSON</span>.stringify() <span class="hljs-comment">//ä¸èƒ½åºåˆ—åŒ–å¾ªç¯é“¾è¡¨</span><span class="hljs-comment">//æ ‡è®°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isLoop</span>(<span class="hljs-params">head</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!head) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>  <span class="hljs-keyword">let</span> cur = head  <span class="hljs-keyword">while</span>(cur)&#123;    <span class="hljs-keyword">if</span>(cur.flag) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>    cur.flag = <span class="hljs-literal">true</span>    cur = cur.next  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;<span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆ</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isLoop2</span>(<span class="hljs-params">head</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!head || !head.next) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>  <span class="hljs-keyword">let</span> fast = head.next.next  <span class="hljs-keyword">let</span> slow = head.next  <span class="hljs-keyword">while</span>(slow!==fast)&#123;    <span class="hljs-keyword">if</span>(!fast || !fast.next)&#123;      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>    &#125;    fast = fast.next.next    slow = slow.next  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;</code></pre></div></li></ul><ul><li><p>å®ç°LRUç¼“å­˜æ·˜æ±°ç­–ç•¥</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Node</span>(<span class="hljs-params">value</span>)</span>&#123;  <span class="hljs-built_in">this</span>.value = value  <span class="hljs-built_in">this</span>.next = <span class="hljs-literal">null</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LRULinkedList</span>(<span class="hljs-params">maxSize</span>)</span>&#123;  <span class="hljs-built_in">this</span>.maxSize = maxSize  <span class="hljs-built_in">this</span>.head = <span class="hljs-literal">null</span>  <span class="hljs-built_in">this</span>.curSize = <span class="hljs-number">0</span>  <span class="hljs-built_in">this</span>.visit = <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;    <span class="hljs-keyword">const</span> n = <span class="hljs-keyword">new</span> Node(value)    <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head,pre = <span class="hljs-built_in">this</span>.head    <span class="hljs-keyword">let</span> preCatch,curCatch    <span class="hljs-keyword">if</span>(!cur)&#123;      <span class="hljs-built_in">this</span>.head = n      <span class="hljs-built_in">this</span>.curSize = <span class="hljs-number">1</span>      <span class="hljs-keyword">return</span>     &#125;    <span class="hljs-keyword">if</span>(cur.value===value) <span class="hljs-keyword">return</span>     <span class="hljs-keyword">while</span>(cur)&#123;      <span class="hljs-keyword">if</span>(cur.value === value)&#123;          <span class="hljs-comment">// æ‰¾åˆ°äº†</span>          <span class="hljs-comment">// ä»åŸæ¥ä½ç½®åˆ é™¤å¹¶ä½œä¸ºå¤´</span>          pre.next = cur.next          cur.next = <span class="hljs-built_in">this</span>.head          <span class="hljs-keyword">return</span>      &#125;      preCatch = pre      curCatch = cur      pre = cur      cur = cur.next    &#125;    <span class="hljs-comment">// æ²¡æ‰¾åˆ°</span>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.curSize&lt;maxSize)&#123;      <span class="hljs-comment">// æ’å…¥å¤´éƒ¨</span>      n.next = <span class="hljs-built_in">this</span>.head      <span class="hljs-built_in">this</span>.head = n      <span class="hljs-built_in">this</span>.curSize ++    &#125;<span class="hljs-keyword">else</span>&#123;      <span class="hljs-comment">// åˆ é™¤å°¾éƒ¨ç»“ç‚¹</span>      <span class="hljs-comment">// æ’å…¥å¤´éƒ¨</span>      preCatch.next = <span class="hljs-literal">null</span>      curCatch.next = <span class="hljs-built_in">this</span>.head      <span class="hljs-built_in">this</span>.head = curCatch    &#125;  &#125;&#125;</code></pre></div></li><li><p>å›æ–‡é“¾è¡¨</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆæ‰¾å‡ºä¸­ç‚¹</span><span class="hljs-comment">// ä¸€åŠçš„é“¾è¡¨ä¸å¦ä¸€åŠé“¾è¡¨ç»„æˆçš„æ ˆå¯¹æ¯”</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isPalindrome</span>(<span class="hljs-params">head</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!head || !head.next) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>  <span class="hljs-keyword">const</span> stack = []  <span class="hljs-keyword">let</span> slow = head  <span class="hljs-keyword">let</span> fast = head  <span class="hljs-keyword">while</span>(fast &amp;&amp; fast.next &amp;&amp; fast.next.next)&#123;    slow = slow.next    fast = fast.next.next  &#125;  <span class="hljs-keyword">let</span> mid  = slow  <span class="hljs-keyword">while</span> (mid.next) &#123;    stack.push(mid.next)    mid = mid.next  &#125;  <span class="hljs-keyword">while</span>(stack.length&gt;<span class="hljs-number">0</span>)&#123;    <span class="hljs-keyword">if</span>(head.val !== stack.pop().val) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>    head = head.next  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;<span class="hljs-comment">// æˆ–è€…å°†é“¾è¡¨è½¬æ•°ç»„ï¼Œå¯¹æ’æŒ‡é’ˆ</span><span class="hljs-comment">// å¦ä¸€ç§æ˜¯åˆ°åˆ°ä¸­ç‚¹ååè½¬é“¾è¡¨ï¼Œä¸ä½¿ç”¨è¾…åŠ©æ ˆ</span></code></pre></div></li><li><p>åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Node</span>(<span class="hljs-params">val</span>)</span>&#123;  <span class="hljs-built_in">this</span>.val = val  <span class="hljs-built_in">this</span>.next = <span class="hljs-literal">null</span>&#125;<span class="hljs-comment">// 1-&gt;2-&gt;4,1-&gt;3-&gt;4</span><span class="hljs-comment">// 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeLinkedList</span>(<span class="hljs-params">l1,l2</span>)</span>&#123;  <span class="hljs-keyword">if</span>(l1===<span class="hljs-literal">null</span>)&#123;    <span class="hljs-keyword">return</span> l2  &#125;  <span class="hljs-keyword">if</span>(l2===<span class="hljs-literal">null</span>)&#123;    <span class="hljs-keyword">return</span> l1  &#125;  <span class="hljs-keyword">if</span>(l1.val&lt;=l2.val)&#123;    l1.next = mergeLinkedList(l1.next,l2)    <span class="hljs-keyword">return</span> l1  &#125;<span class="hljs-keyword">else</span>&#123;    l2.next = mergeLinkedList(l2.next,l1)    <span class="hljs-keyword">return</span> l2  &#125;&#125;<span class="hljs-comment">// æˆ–è€…è ¢åŠæ³•</span><span class="hljs-keyword">var</span> mergeTwoLists = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">l1, l2</span>) </span>&#123;   <span class="hljs-keyword">const</span> n = <span class="hljs-keyword">new</span> ListNode(-<span class="hljs-number">1</span>)   <span class="hljs-keyword">let</span> cur = n   <span class="hljs-keyword">while</span>(l1&amp;&amp;l2)&#123;       <span class="hljs-keyword">if</span>(l1.val&lt;=l2.val)&#123;           cur.next = l1           l1 = l1.next       &#125;<span class="hljs-keyword">else</span>&#123;           cur.next = l2           l2 = l2.next       &#125;       cur = cur.next   &#125;   <span class="hljs-comment">// æœ‰ä¸€æ¡åˆ°å¤´å’¯</span>   <span class="hljs-keyword">if</span>(l1)&#123;       cur.next = l1   &#125;<span class="hljs-keyword">else</span>&#123;       cur.next = l2   &#125;   <span class="hljs-keyword">return</span> n.next&#125;;</code></pre></div></li><li><p>æŸ¥æ‰¾ä¸¤ä¸ªé“¾è¡¨çš„å…¬å…±èµ·å§‹ç‚¹</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">commonPrefix</span>(<span class="hljs-params">headA,headB</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!headA || !headB) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>  <span class="hljs-keyword">while</span>(headA)&#123;    headA.flag = <span class="hljs-literal">true</span>    headA = headA.next  &#125;  <span class="hljs-keyword">while</span>(headB)&#123;    <span class="hljs-keyword">if</span>(headB.flag) <span class="hljs-keyword">return</span> headB    headB.flag =<span class="hljs-literal">true</span>    headB = headB.next  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">commonPrefix2</span>(<span class="hljs-params">headA,headB</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!headA || !headB) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>  <span class="hljs-comment">// è¿ä¸ªé“¾è¡¨åŒæ—¶ç§»åŠ¨æŒ‡é’ˆ</span>  <span class="hljs-keyword">let</span> n1 = headA  <span class="hljs-keyword">let</span> n2 = headB  <span class="hljs-keyword">while</span>(n1 || n2)&#123;    <span class="hljs-keyword">if</span>(n1===n2) <span class="hljs-keyword">return</span> n1    <span class="hljs-comment">//æŒ‡é’ˆåˆ°å¤´åè·³åˆ°å¯¹é¢çš„å¼€å¤´</span>    n1 = n1 === <span class="hljs-literal">null</span> ? headB : n1.next    n2 = n2 === <span class="hljs-literal">null</span> ? headA : n2.next  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>&#125;</code></pre></div></li><li><p>åˆ é™¤ç‰¹å®šå€¼é“¾è¡¨èŠ‚ç‚¹</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteNode</span>(<span class="hljs-params">head,val</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!head) <span class="hljs-keyword">return</span>   <span class="hljs-keyword">if</span>(head.val === val)&#123;    <span class="hljs-keyword">return</span> head.next  &#125;  head.next = deleteNode(head.next,val)  <span class="hljs-keyword">return</span> head&#125;</code></pre></div></li><li><p>è¿”å›é“¾è¡¨ä¸­ç‰¹å®šä½ç½®èŠ‚ç‚¹</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// è®¡æ•°æ³•</span><span class="hljs-comment">// ä¸€éç®—é“¾è¡¨é•¿åº¦</span><span class="hljs-comment">// ä¸€éæ ¹æ®ä½ç½®.next</span><span class="hljs-comment">// è®¡æ•°æ³•é…åˆmap</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getKthFromEnd</span>(<span class="hljs-params">head,k</span>)</span>&#123;  <span class="hljs-keyword">let</span> pos = <span class="hljs-number">1</span>  <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()  <span class="hljs-keyword">while</span>(head)&#123;    map.set(pos++,head)    head = head.next  &#125;  <span class="hljs-keyword">return</span> map.get(pos-k)&#125;<span class="hljs-comment">// åŒæŒ‡é’ˆ</span><span class="hljs-comment">// è¿”å›å€’æ•°kä½ç½®</span><span class="hljs-comment">//  * Definition for singly-linked list.</span><span class="hljs-comment">//  * function ListNode(val) &#123;</span><span class="hljs-comment">//  *     this.val = val;</span><span class="hljs-comment">//  *     this.next = null;</span><span class="hljs-comment">//  * &#125;</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getKthFromEnd</span>(<span class="hljs-params">head,k</span>)</span>&#123;  <span class="hljs-keyword">let</span> fast = head  <span class="hljs-keyword">let</span> slow = head  <span class="hljs-keyword">let</span> t = <span class="hljs-number">0</span>  <span class="hljs-keyword">while</span>(fast.next)&#123;    fast = fast.next    t ++    <span class="hljs-keyword">if</span>(t&gt;=k) slow = slow.next  &#125;  <span class="hljs-keyword">return</span> slow&#125;</code></pre></div></li><li><p>å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªä¸é‡å¤å­—ç¬¦</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//map</span><span class="hljs-comment">//å¾ªç¯ä¸¤æ¬¡</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">firstUniqChar</span>(<span class="hljs-params">s</span>)</span>&#123;  <span class="hljs-keyword">if</span>(!s) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27; &#x27;</span>  <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> [i,v] <span class="hljs-keyword">of</span> <span class="hljs-built_in">Array</span>.from(s).entries())&#123;    <span class="hljs-keyword">if</span>(map.has(v))&#123;      map.set(v,-<span class="hljs-number">1</span>)    &#125;<span class="hljs-keyword">else</span>&#123;      map.set(v,i)    &#125;  &#125;  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> map.keys())&#123;    <span class="hljs-keyword">if</span>(map.get(key)!==-<span class="hljs-number">1</span>)&#123;      <span class="hljs-keyword">return</span> key    &#125;  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27; &#x27;</span>&#125;<span class="hljs-comment">//</span>...indexOf===lastIndexOf...</code></pre></div></li><li><p>å­—ç¬¦ä¸²èƒ½å¦æ„æˆå›æ–‡</p></li></ul><p>å­—ç¬¦é¡ºåºä¿®æ”¹åèƒ½å¦å›æ–‡<br>ç›¸å½“äºéå›æ–‡å­—ç¬¦æœ€å¤šåªæœ‰ä¸€ä¸ª</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">canPermutePalindrome</span>(<span class="hljs-params">s</span>)</span>&#123;  <span class="hljs-comment">// map // objectéƒ½è¡Œ</span>&#125;<span class="hljs-keyword">var</span> canPermutePalindrome = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>&#123;  <span class="hljs-keyword">const</span> obj = &#123;&#125;  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ; i&lt;s.length ;i++)&#123;    <span class="hljs-keyword">const</span> str = s[i]    <span class="hljs-built_in">console</span>.log(str);    <span class="hljs-keyword">if</span>(obj[str])&#123;      <span class="hljs-built_in">console</span>.log(<span class="hljs-number">6</span>);      <span class="hljs-keyword">delete</span> obj[str]    &#125;<span class="hljs-keyword">else</span>&#123;      <span class="hljs-comment">// ä½¿ç”¨objectæ—¶ï¼Œä¸Šé¢çš„if(obj[str])ä¼šå’Œè¿™é‡Œå†²çª</span>      <span class="hljs-comment">// åˆšå¥½è®¾ç½®obj[str] = 0</span>      <span class="hljs-comment">// ifåˆ¤æ–­ä¸æˆç«‹</span>      obj[str] = <span class="hljs-number">1</span>    &#125;  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(obj).length &lt;= <span class="hljs-number">1</span>&#125;;</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>æ•°æ®ç»“æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é˜Ÿåˆ—åŠç®—æ³•é¢˜</title>
    <link href="/2022/02/24/%E9%98%9F%E5%88%97/"/>
    <url>/2022/02/24/%E9%98%9F%E5%88%97/</url>
    
    <content type="html"><![CDATA[<h2 id="é˜Ÿåˆ—ç»“æ„ï¼Œå…ˆè¿›å…ˆå‡º"><a href="#é˜Ÿåˆ—ç»“æ„ï¼Œå…ˆè¿›å…ˆå‡º" class="headerlink" title="é˜Ÿåˆ—ç»“æ„ï¼Œå…ˆè¿›å…ˆå‡º"></a>é˜Ÿåˆ—ç»“æ„ï¼Œå…ˆè¿›å…ˆå‡º</h2><ul><li><p>ç”¨æ•°ç»„å®ç°-é¡ºåºé˜Ÿåˆ—</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ArrayQueue</span>(<span class="hljs-params">len</span>)</span>&#123;  <span class="hljs-built_in">this</span>.items = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(len)  <span class="hljs-built_in">this</span>.n = len  <span class="hljs-built_in">this</span>.head = <span class="hljs-number">0</span>  <span class="hljs-built_in">this</span>.tail = <span class="hljs-number">0</span>&#125;ArrayQueue.prototype.enqueue = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>)</span>&#123;  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.tail === <span class="hljs-built_in">this</span>.n)&#123;<span class="hljs-comment">// tailåæ²¡æœ‰ç©ºä½™ç©ºé—´</span>    <span class="hljs-keyword">if</span>(head === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦é˜Ÿåˆ—å‰æ–¹æœ‰å·²ç»å‡ºé˜Ÿçš„ä½ç½®</span>    <span class="hljs-comment">// æœ‰åˆ™å°†æ•´ä¸ªé˜Ÿåˆ—å‘å‰ç§»åŠ¨</span>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = head;i&lt;<span class="hljs-built_in">this</span>.tail;i++)&#123;      <span class="hljs-built_in">this</span>.items[i-head] = <span class="hljs-built_in">this</span>.items[i]    &#125;    <span class="hljs-built_in">this</span>.tail = <span class="hljs-built_in">this</span>.tail-<span class="hljs-built_in">this</span>.head    <span class="hljs-built_in">this</span>.head = <span class="hljs-number">0</span>  &#125;  <span class="hljs-built_in">this</span>.items[<span class="hljs-built_in">this</span>.tail] = item  <span class="hljs-built_in">this</span>.tail ++  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;ArrayQueue.prototype.dequeue = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.head === <span class="hljs-built_in">this</span>.tail) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>  <span class="hljs-built_in">this</span>.head ++   <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.items.shift()&#125;</code></pre></div></li><li><p>!å¾ªç¯é˜Ÿåˆ—</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// é¿å…äº†é¡ºåºé˜Ÿåˆ—ä¸­çš„æ•°æ®æ¬ç§»æ“ä½œ</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CircularQueue</span>(<span class="hljs-params">len</span>)</span>&#123;  <span class="hljs-built_in">this</span>.items = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(len)  <span class="hljs-built_in">this</span>.n = len  <span class="hljs-built_in">this</span>.head = <span class="hljs-number">0</span>  <span class="hljs-built_in">this</span>.tail = <span class="hljs-number">0</span>&#125;CircularQueue.prototype = &#123;  enqueue:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>)</span>&#123;    <span class="hljs-keyword">if</span>((<span class="hljs-built_in">this</span>.tail+<span class="hljs-number">1</span>)%n===<span class="hljs-built_in">this</span>.head) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>    <span class="hljs-built_in">this</span>.items[<span class="hljs-built_in">this</span>.tail] = item    <span class="hljs-built_in">this</span>.tail = (<span class="hljs-built_in">this</span>.tail+<span class="hljs-number">1</span>)%n    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>  &#125;,  dequeue:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.head===<span class="hljs-built_in">this</span>.tail) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>    <span class="hljs-keyword">const</span> ret = <span class="hljs-built_in">this</span>.items[head]    <span class="hljs-built_in">this</span>.head = (<span class="hljs-built_in">this</span>.head+<span class="hljs-number">1</span>)%n    <span class="hljs-keyword">return</span> ret  &#125;&#125;</code></pre></div></li><li><p>ç”¨é“¾è¡¨å®ç°-é“¾å¼é˜Ÿåˆ—</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Node</span>(<span class="hljs-params">val</span>)</span>&#123;  <span class="hljs-built_in">this</span>.val = val  <span class="hljs-built_in">this</span>.next = <span class="hljs-literal">null</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LinkedListQueue</span>(<span class="hljs-params">len</span>)</span>&#123;  <span class="hljs-built_in">this</span>.head = <span class="hljs-literal">null</span>  <span class="hljs-built_in">this</span>.tail = <span class="hljs-literal">null</span>  <span class="hljs-built_in">this</span>.curLen = <span class="hljs-number">0</span>  <span class="hljs-built_in">this</span>.maxLen = len&#125;LinkedListQueue.prototype = &#123;  enqueue: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node</span>)</span>&#123;    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.head===<span class="hljs-literal">null</span>)&#123;      <span class="hljs-built_in">this</span>.head = node      <span class="hljs-built_in">this</span>.tail = node      <span class="hljs-built_in">this</span>.curLen = <span class="hljs-number">1</span>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>    &#125;    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.curLen &gt;= <span class="hljs-built_in">this</span>.len) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>    <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head    <span class="hljs-comment">// å¾ªç¯åˆ°é“¾è¡¨æœ«å°¾</span>    <span class="hljs-keyword">while</span>(cur.next)&#123;      cur = cur.next    &#125;    cur.next = node    <span class="hljs-built_in">this</span>.tail = node    <span class="hljs-built_in">this</span>.curLen ++    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>  &#125;,  dequeue : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">let</span> cur = <span class="hljs-built_in">this</span>.head    <span class="hljs-comment">// åˆ é™¤è¡¨å¤´</span>    <span class="hljs-built_in">this</span>.head = cur.next    <span class="hljs-built_in">this</span>.curLen --    <span class="hljs-keyword">return</span> cur  &#125;&#125;</code></pre></div></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢å‘å¯¹è±¡é¢˜</title>
    <link href="/2022/02/24/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E9%A2%98/"/>
    <url>/2022/02/24/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<ul><li>æ‰“è½¦æ—¶å¯ä»¥æ‰“ä¸“è½¦æˆ–å¿«è½¦ã€‚ä»»ä½•è½¦éƒ½æœ‰è½¦ç‰Œå·å’Œåç§°ã€‚å¿«è½¦æ¯å…¬é‡Œ1å…ƒï¼Œä¸“è½¦æ¯å…¬é‡Œ2å…ƒã€‚è¡Œç¨‹å¼€å§‹æ—¶ï¼Œæ˜¾ç¤ºè½¦è¾†ä¿¡æ¯ã€‚è¡Œç¨‹ç»“æŸæ—¶ï¼Œæ˜¾ç¤ºæ‰“è½¦é‡‘é¢ã€‚è¡Œç¨‹è·ç¦»ä¸º5å…¬é‡Œã€‚</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">licence,name</span>)</span>&#123;    <span class="hljs-built_in">this</span>.licence = licence    <span class="hljs-built_in">this</span>.name = name  &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FastCar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Car</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">licence,name</span>)</span>&#123;    <span class="hljs-built_in">super</span>(licence,name)    <span class="hljs-built_in">this</span>.price =<span class="hljs-number">1</span>  &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PrivateCar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Car</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">licence,name</span>)</span>&#123;    <span class="hljs-built_in">super</span>(licence,name)    <span class="hljs-built_in">this</span>.price = <span class="hljs-number">2</span>  &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Order</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">car,distance</span>)</span>&#123;    <span class="hljs-built_in">this</span>.car = car    <span class="hljs-built_in">this</span>.distance = distance  &#125;  <span class="hljs-function"><span class="hljs-title">getIn</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.car.name);    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.car.licence);  &#125;  <span class="hljs-function"><span class="hljs-title">getOff</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.car.price*<span class="hljs-built_in">this</span>.distance);  &#125;&#125;<span class="hljs-keyword">let</span> car1 = <span class="hljs-keyword">new</span> PrivateCar(<span class="hljs-string">&#x27;ç²¤A8888888&#x27;</span>,<span class="hljs-string">&#x27;ç‰¹æ–¯æ‹‰&#x27;</span>)<span class="hljs-keyword">let</span> cost1 = <span class="hljs-keyword">new</span> Order(car1,<span class="hljs-number">5</span>).getOff()</code></pre></div><ul><li>æŸåœè½¦åœº, åˆ†ä¸‰å±‚, æ¯å±‚100 è½¦ä½,æ¯ä¸ªè½¦ä½éƒ½èƒ½ç›‘æ§åˆ°è½¦è¾†çš„è¿›å…¥å’Œç¦»å¼€,è½¦è¾†è¿›å…¥å‰,æ˜¾ç¤ºæ¯å±‚çš„ç©ºä½™è½¦ä½æ•°é‡,è½¦è¾†è¿›å…¥æ—¶,æ‘„åƒå¤´å¯è¯†åˆ«è½¦ç‰Œå·å’Œè¿›å…¥æ—¶é—´,è½¦è¾†å‡ºæ¥æ—¶,å‡ºå£æ˜¾ç¤ºå±æ˜¾ç¤ºè½¦ç‰Œå·å’Œåœè½¦æ—¶é•¿</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">licence</span>)</span>&#123;    <span class="hljs-built_in">this</span>.licence = licence  &#125;&#125;<span class="hljs-comment">// æ•´ä¸ªåœè½¦åœº</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParkingLot</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">floors</span>)</span>&#123;    <span class="hljs-comment">// floors:[[300],[300],[300]]</span>    <span class="hljs-built_in">this</span>.floors = floors    <span class="hljs-built_in">this</span>.dataBase = []  &#125;  <span class="hljs-function"><span class="hljs-title">showSpace</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">this</span>.floors.length;i++)&#123;      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`ç¬¬<span class="hljs-subst">$&#123;i+<span class="hljs-number">1</span>&#125;</span>å±‚ç©ºé—²è½¦ä½(<span class="hljs-subst">$&#123;<span class="hljs-built_in">this</span>.floors[i].emptySpace()&#125;</span>)`</span>)    &#125;  &#125;  <span class="hljs-function"><span class="hljs-title">intoLot</span>(<span class="hljs-params">car,floorIndex,lotIndex</span>)</span>&#123;    <span class="hljs-comment">//è½¦ç‰Œï¼Œæ—¶é—´</span>    <span class="hljs-keyword">let</span> licence = car.licence    <span class="hljs-keyword">let</span> intoTime = <span class="hljs-built_in">Date</span>.now()    <span class="hljs-keyword">let</span> space = <span class="hljs-built_in">this</span>.floors[floorIndex].lot[lotIndex]    <span class="hljs-built_in">this</span>.dataBase[licence] = &#123;intoTime,floorIndex,lotIndex&#125;    space.checkIn()  &#125;  <span class="hljs-function"><span class="hljs-title">outLot</span>(<span class="hljs-params">car</span>)</span>&#123;    <span class="hljs-keyword">let</span> outTime = <span class="hljs-built_in">Date</span>.now()    <span class="hljs-keyword">let</span> licence = car.licence    <span class="hljs-keyword">let</span> info = <span class="hljs-built_in">this</span>.dataBase[licence]    <span class="hljs-keyword">let</span> space = <span class="hljs-built_in">this</span>.floors[info.floorIndex].lot[info.lotIndex]    <span class="hljs-keyword">let</span> timeCount = <span class="hljs-built_in">parseInt</span>((outTime-info.intoTime)/<span class="hljs-number">36000000</span>)    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`åœè½¦æ—¶é•¿<span class="hljs-subst">$&#123;timeCount&#125;</span>å°æ—¶`</span>)    space.checkOut()  &#125;&#125;<span class="hljs-comment">// è½¦ä½,ç›‘è§†é©¶å…¥ç¦»å¼€</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParkingSpace</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">this</span>.free = <span class="hljs-literal">true</span>  &#125;  <span class="hljs-function"><span class="hljs-title">checkIn</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">this</span>.free = <span class="hljs-literal">false</span>  &#125;  <span class="hljs-function"><span class="hljs-title">checkOut</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">this</span>.free = <span class="hljs-literal">true</span>  &#125;&#125;<span class="hljs-comment">// å±‚</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParkingFloor</span></span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">floor,lot</span>)</span>&#123;    <span class="hljs-built_in">this</span>.floor = floor    <span class="hljs-built_in">this</span>.lot = lot  &#125;  <span class="hljs-function"><span class="hljs-title">emptySpace</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-comment">//è¿”å›ç©ºé—²è½¦ä½</span>    <span class="hljs-keyword">let</span> freeLot = <span class="hljs-number">0</span>    <span class="hljs-built_in">this</span>.lot.forEach(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;      <span class="hljs-keyword">if</span>(item.free)&#123;        freeLot++      &#125;    &#125;);    <span class="hljs-keyword">return</span> freeLot  &#125;&#125;</code></pre></div><ul><li>ä¸€å‰¯æ‰‘å…‹ç‰Œæœ‰54å¼ ç‰Œï¼Œå…¶ä¸­52å¼ æ˜¯æ­£ç‰Œï¼Œå¦2å¼ æ˜¯å‰¯ç‰Œï¼ˆå¤§ç‹å’Œå°ç‹ï¼‰ã€‚<br>52å¼ æ­£ç‰Œåˆå‡åˆ†ä¸º13å¼ ä¸€ç»„ï¼Œå¹¶ä»¥é»‘æ¡ƒã€çº¢æ¡ƒã€è‰èŠ±ã€æ–¹å—å››ç§èŠ±è‰²è¡¨ç¤ºå„ç»„ï¼Œæ¯ç»„èŠ±è‰²çš„ç‰ŒåŒ…æ‹¬ä»1-10ï¼ˆ1é€šå¸¸è¡¨ç¤ºä¸ºAï¼‰ä»¥åŠJã€Qã€Kæ ‡ç¤ºçš„13å¼ ç‰Œã€‚<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> numbers = [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-string">&#x27;J&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>]<span class="hljs-keyword">const</span> signs = [<span class="hljs-string">&#x27;â™¥ï¸&#x27;</span>, <span class="hljs-string">&#x27;â™¦ï¸&#x27;</span>, <span class="hljs-string">&#x27;â™£ï¸&#x27;</span>, <span class="hljs-string">&#x27;â™ ï¸&#x27;</span>]<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Poker</span> </span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">signs,numbers</span>)</span> &#123;<span class="hljs-built_in">this</span>.signs = signs<span class="hljs-built_in">this</span>.numbers = numbers<span class="hljs-built_in">this</span>.mounts = <span class="hljs-number">52</span><span class="hljs-built_in">this</span>.pokers = []&#125;<span class="hljs-function"><span class="hljs-title">initPokers</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i =<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">this</span>.signs.length;i++)&#123;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>;j&lt;<span class="hljs-built_in">this</span>.numbers.length;j++)&#123;<span class="hljs-built_in">this</span>.pokers.push(<span class="hljs-keyword">new</span> Card(<span class="hljs-built_in">this</span>.signs[i],<span class="hljs-built_in">this</span>.numbers[j]))&#125;&#125;<span class="hljs-built_in">this</span>.pokers.push(<span class="hljs-keyword">new</span> Card(<span class="hljs-string">&#x27;BLACK&#x27;</span>,<span class="hljs-string">&#x27;GHOST&#x27;</span>))<span class="hljs-built_in">this</span>.pokers.push(<span class="hljs-keyword">new</span> Card(<span class="hljs-string">&#x27;RED&#x27;</span>,<span class="hljs-string">&#x27;GHOST&#x27;</span>))&#125;  <span class="hljs-function"><span class="hljs-title">shuffleCard</span>(<span class="hljs-params"></span>)</span> &#123;<span class="hljs-comment">// let arr = this.pokers</span><span class="hljs-comment">// let len = arr.length</span>    <span class="hljs-comment">// let temp,i</span>    <span class="hljs-comment">// while(len)&#123;</span>    <span class="hljs-comment">//   i = Math.floor(Math.random()*len--)</span>    <span class="hljs-comment">//   temp = arr[i]</span>    <span class="hljs-comment">//   arr[i] = arr[len]</span>    <span class="hljs-comment">//   arr[len] = temp</span>    <span class="hljs-comment">// &#125;</span>    <span class="hljs-comment">// this.pokers = arr</span>    <span class="hljs-built_in">this</span>.pokers = <span class="hljs-built_in">this</span>.pokers.sort(<span class="hljs-function">()=&gt;</span><span class="hljs-built_in">Math</span>.random()-<span class="hljs-number">0.5</span>)    <span class="hljs-comment">// Math.random() - 0.5 ä¸å®Œå…¨éšæœº</span>    <span class="hljs-keyword">const</span> temp = [...this.pokers]    <span class="hljs-keyword">let</span> len = temp.length    <span class="hljs-keyword">while</span>(len)&#123;      <span class="hljs-keyword">const</span> i = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * len--)      [temp[i],temp[len]] = [temp[len],temp[i]]      &#125;    <span class="hljs-built_in">this</span>.pokers = [...temp]  &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Card</span> </span>&#123;  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">sign, number</span>)</span> &#123;    <span class="hljs-built_in">this</span>.sign = sign;    <span class="hljs-built_in">this</span>.number = number;  &#125;&#125;<span class="hljs-keyword">let</span> game1 = <span class="hljs-keyword">new</span> Poker(signs,numbers)game1.initPokers()game1.shuffleCard()<span class="hljs-built_in">console</span>.log(game1.pokers);game1.shuffleCard()<span class="hljs-built_in">console</span>.log(game1.pokers);</code></pre></div></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åœ°å€ä¸­è¾“å…¥URLå›è½¦åå‘ç”Ÿäº†ä»€ä¹ˆ</title>
    <link href="/2022/02/24/%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B/"/>
    <url>/2022/02/24/%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h1><h2 id="ã€DNSè§£æã€‘"><a href="#ã€DNSè§£æã€‘" class="headerlink" title="ã€DNSè§£æã€‘"></a>ã€DNSè§£æã€‘</h2><ol><li>æŸ¥æ‰¾æµè§ˆå™¨DNSç¼“å­˜</li><li>æŸ¥æ‰¾ç³»ç»ŸHOSTæ–‡ä»¶</li><li>DNSæŸ¥è¯¢<blockquote><p>ä¸»æœºå’Œæœ¬åœ°åŸŸåæœåŠ¡å™¨ä¹‹é—´ä½¿ç”¨é€’å½’æŸ¥è¯¢ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨è¦è´Ÿè´£ä¸€ç›´åˆ°æŸ¥è¯¢å¾—å‡ºç»“æœ</p><p>æœ¬åœ°åŸŸåæœåŠ¡å™¨å’Œå…¶ä»–æœåŠ¡å™¨ä¹‹é—´çš„ä½¿ç”¨è¿­ä»£æŸ¥è¯¢ï¼ŒåŸŸåæœåŠ¡å™¨ä¼šå‘Šè¯‰æœ¬åœ°æœåŠ¡å™¨ä¸‹ä¸€æ¬¡å»è¯¢é—®è°ï¼Œé˜²æ­¢å•å°åŸŸåæœåŠ¡å™¨å‹åŠ›è¿‡å¤§</p></blockquote></li></ol><blockquote><p>DNSè¯·æ±‚ä½¿ç”¨<code>UDP</code>åè®®ï¼Œå¦‚æœè¯·æ±‚å¤±è´¥åˆ™ä½¿ç”¨<code>TCP</code>é‡è¯•</p></blockquote><div class="hljs code-wrapper"><pre><code class="hljs">1. æœ¬åœ°DNSæœåŠ¡å™¨æŸ¥æ‰¾è‡ªå·±ç¼“å­˜2. æœ¬åœ°DNSæœåŠ¡å™¨å‘ã€æ ¹åŸŸåæœåŠ¡å™¨ã€‘å‘é€è¯·æ±‚ï¼Œæ ¹åŸŸåæœåŠ¡å™¨è¿”å›é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€`com`3. æœ¬åœ°DNSæœåŠ¡å™¨å‘é¡¶çº§åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œé¡¶çº§åŸŸåè¿”å›äºŒçº§åŸŸåçš„æœåŠ¡å™¨åœ°å€`baidu.com`4. æœ¬åœ°DNSæœåŠ¡å™¨å‘äºŒçº§åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¾—åˆ°ç›®æ ‡ä¸»æœºIPåœ°å€ï¼Œå­˜å…¥æœ¬åœ°DNSæœåŠ¡å™¨ç¼“å­˜å¹¶è¿”å›ç»™ç”¨æˆ·ä¸»æœº5. ç”¨æˆ·ä¸»æœºå’Œæµè§ˆå™¨éƒ½å°†ç¼“å­˜è¿™ä¸ªIPåœ°å€çš„æ˜ å°„</code></pre></div><h2 id="ã€TCPæ¡æ‰‹ã€‘"><a href="#ã€TCPæ¡æ‰‹ã€‘" class="headerlink" title="ã€TCPæ¡æ‰‹ã€‘"></a>ã€TCPæ¡æ‰‹ã€‘</h2><p>å¯¹åº”IPåœ°å€ï¼Œç«¯å£å»ºç«‹TCPè¿æ¥ï¼Œæ„é€ HTTPè¯·æ±‚å¹¶ä¸æœåŠ¡å™¨æ¡æ‰‹åå‘é€tcpæ•°æ®åŒ…</p><p>  TCPä¸‰æ¬¡æ¡æ‰‹</p><blockquote><p>å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯äº’ç›¸ç¡®è®¤æ”¶å‘èƒ½åŠ›</p></blockquote><ol><li>ã€CLIENTã€‘ å‘é€<code>SYN</code>æŠ¥æ–‡ï¼ŒæŒ‡æ˜è‡ªå·±çš„åˆå§‹åŒ–åºåˆ—å·<code>ISN(c)</code></li><li>ã€SERVERã€‘ æ”¶åˆ°åï¼Œå°†clientå‘é€çš„<code>ISN(c)</code>+1ä½œä¸º<code>ACK</code>å­—ç¬¦ï¼Œå¹¶ä¸”ä¹Ÿç”Ÿæˆè‡ªå·±çš„<code>ISN(s)</code>å‘é€ç»™ã€CLIENTã€‘</li><li>ã€CLIENTã€‘ æ”¶åˆ°åï¼ŒåŒæ ·å°†<code>ISN(s)</code>+1ä½œä¸º<code>ACK</code>å­—ç¬¦å‘é€ç»™ã€SERVERã€‘</li></ol><h2 id="ã€åˆ†æè¯·æ±‚èµ„æºã€‘"><a href="#ã€åˆ†æè¯·æ±‚èµ„æºã€‘" class="headerlink" title="ã€åˆ†æè¯·æ±‚èµ„æºã€‘"></a>ã€åˆ†æè¯·æ±‚èµ„æºã€‘</h2><ul><li><p>ä¸åŒæµè§ˆå™¨å¯¹èµ„æºä¼˜å…ˆçº§åˆ†ç±»</p></li><li><p>å®‰å…¨ç­–ç•¥æ£€æŸ¥ </p><p>å†…å®¹å®‰å…¨ç­–ç•¥(Content Security Policyï¼Œç¼©å†™ CSP)æ˜¯ç”±æµè§ˆå™¨æä¾›çš„ä¸€ç§ç™½åå•åˆ¶åº¦ã€‚å‘è€…é€šè¿‡é…ç½®ï¼Œæ¥å‘Šè¯‰æµè§ˆå™¨å„ç±»å¤–éƒ¨èµ„æºçš„åŠ è½½å’Œæ‰§è¡Œé™åˆ¶ï¼Œæ¥æé«˜ç½‘é¡µçš„å®‰å…¨æ€§ã€‚ä¸€ç§æœ€å¸¸ç”¨åº”ç”¨å°±æ˜¯é€šè¿‡é™åˆ¶éä¿¡ä»»åŸŸåè„šæœ¬çš„åŠ è½½æ¥é¢„é˜²XSSæ”»å‡»ã€‚</p><p>å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥é…ç½®CSPï¼š</p><ol><li>HTTPè¯·æ±‚å¤´çš„<code>Content-Security-Policy</code></li><li><code>meta</code>æ ‡ç­¾ <div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;meta http-equiv=<span class="hljs-string">&quot;Content-Security-Policy&quot;</span> content=<span class="hljs-string">&quot;script-src &#x27;self&#x27;;style-src nos.netease.com kaola.com;&quot;</span>&gt;</code></pre></div></li></ol></li><li><p>èµ„æºä¼˜å…ˆçº§è®¡ç®—</p><ol><li><code>html,font,css</code></li><li><code>preload,script,xhr</code></li><li><code>img,audio,video</code></li><li><code>prefetch</code></li></ol></li><li><p>é¡ºåºè°ƒæ•´</p><ol><li>åŒæ­¥XHRè¯·æ±‚ä¼˜å…ˆçº§è°ƒæ•´åˆ°æœ€é«˜</li><li>å›¾ç‰‡æ ¹æ®æ˜¯å¦å‡ºç°åœ¨å¯è§†åŒºåŸŸ</li><li><code>async/defer</code>çš„<code>script</code>æ ‡ç­¾è¯·æ±‚ä¼˜å…ˆçº§é™ä½</li></ol></li></ul><h2 id="ã€åº”ç”¨ç¼“å­˜ç­–ç•¥ã€‘"><a href="#ã€åº”ç”¨ç¼“å­˜ç­–ç•¥ã€‘" class="headerlink" title="ã€åº”ç”¨ç¼“å­˜ç­–ç•¥ã€‘"></a>ã€åº”ç”¨ç¼“å­˜ç­–ç•¥ã€‘</h2><ul><li>å¼ºç¼“å­˜</li><li>åå•†ç¼“å­˜</li></ul><h2 id="ã€æ¸²æŸ“é¡µé¢ã€‘"><a href="#ã€æ¸²æŸ“é¡µé¢ã€‘" class="headerlink" title="ã€æ¸²æŸ“é¡µé¢ã€‘"></a>ã€æ¸²æŸ“é¡µé¢ã€‘</h2><h3 id="DOM-Tree"><a href="#DOM-Tree" class="headerlink" title="DOM Tree"></a>DOM Tree</h3><ul><li>å¤„ç†htmlæ ‡è®°ï¼Œç”ŸæˆDOMæ ‘ï¼Œæ‰€æœ‰æ ‡ç­¾éƒ½ä¼šåŒ…å«åœ¨å†…</li><li>DOMçš„æ„å»ºæ˜¯å¢é‡çš„</li><li>è§£æå®Œä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å­å…ƒç´ æ‰ä¼šè§£æä»–çš„å…„å¼Ÿå…ƒç´ </li></ul><h3 id="CSSOM-Tree"><a href="#CSSOM-Tree" class="headerlink" title="CSSOM Tree"></a>CSSOM Tree</h3><ul><li>åŠ è½½æ‰€æœ‰æ ·å¼ï¼Œç”ŸæˆCSSOMæ ‘</li><li>CSSOMçš„æ„å»ºä¼šé˜»å¡æ¸²æŸ“<blockquote><p>ä¸åŒæ¥æºçš„æ ·å¼ï¼ˆå†…è”ã€å†…éƒ¨styleæ ‡ç­¾å’Œå¤–éƒ¨å¼•ç”¨ï¼‰å¯èƒ½ä¼šå‘ç”Ÿè¦†ç›–ï¼Œæ‰€ä»¥è¦ç­‰ä»–ä»¬å…¨åŠ è½½å®Œæ‰èƒ½ç»§ç»­æ¸²æŸ“</p></blockquote></li></ul><h3 id="Render-Tree"><a href="#Render-Tree" class="headerlink" title="Render Tree"></a>Render Tree</h3><ul><li>å¯¹DOMèŠ‚ç‚¹æ‰¾åˆ°ä¸å…¶åŒ¹é…çš„CSSOMè§„åˆ™å¹¶åº”ç”¨</li><li>åªåŒ…å«DOMæ ‘ä¸­çš„å¯è§å…ƒç´ (å¿½ç•¥åƒ<code>displayï¼šnone/&lt;head&gt;æ ‡ç­¾</code>)</li></ul><h3 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h3><p>æµè§ˆå™¨ä¾æ®Renderæ ‘å’Œè®¾å¤‡å±å¹•ä¿¡æ¯<strong>é‡æ’</strong>ä¸€æ¬¡ï¼Œä» <code>&lt;html&gt;æ ‡ç­¾</code> å¼€å§‹å¾€ä¸‹ä¾æ¬¡è®¡ç®—æ‰€æœ‰çš„èŠ‚ç‚¹å‡ ä½•å°ºå¯¸å’Œä½ç½®</p><h3 id="Paint"><a href="#Paint" class="headerlink" title="Paint"></a>Paint</h3><p>æ ¹æ®ä¸Šä¸€æ­¥å¾—åˆ°çš„åƒç´ ä¿¡æ¯<strong>é‡ç»˜</strong>é¡µé¢</p><h3 id="Display"><a href="#Display" class="headerlink" title="Display"></a>Display</h3><p>GPUåˆæˆå„å›¾å±‚ï¼Œæ˜¾ç¤ºåœ¨å±å¹•ä¸Š</p><h1 id="å…³é”®ç‚¹"><a href="#å…³é”®ç‚¹" class="headerlink" title="å…³é”®ç‚¹"></a>å…³é”®ç‚¹</h1><h3 id="é‡æ’reflow"><a href="#é‡æ’reflow" class="headerlink" title="é‡æ’reflow"></a>é‡æ’<code>reflow</code></h3><ul><li>æœ‰äº›æƒ…å†µä¸‹ï¼Œæ¯”å¦‚ä¿®æ”¹äº†å…ƒç´ çš„æ ·å¼ï¼Œæµè§ˆå™¨å¹¶ä¸ä¼šç«‹åˆ»reflowï¼Œè€Œæ˜¯ä¼šæŠŠè¿™æ ·çš„æ“ä½œç§¯æ”’ä¸€æ‰¹ï¼Œç„¶ååšä¸€æ¬¡å¤„ç†ï¼Œè¿™åˆå«å¼‚æ­¥ reflow æˆ–å¢é‡å¼‚æ­¥ reflowã€‚</li><li>åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œæ¯”å¦‚çª—å£<code>resize</code>ï¼Œæ”¹å˜äº†é¡µé¢é»˜è®¤çš„å­—ä½“ç­‰ã€‚å¯¹äºè¿™äº›æ“ä½œï¼Œæµè§ˆå™¨ä¼šé©¬ä¸Šè¿›è¡Œ reflowã€‚</li><li>é™¤äº†æ¸²æŸ“æ ‘çš„ç›´æ¥å˜åŒ–ï¼Œå½“è·å–ä¸€äº›éœ€è¦è®¡ç®—çš„å±æ€§æ—¶ï¼Œæµè§ˆå™¨ä¸ºå–å¾—æ­£ç¡®çš„å€¼ä¹Ÿä¼šè§¦å‘é‡æ’,è¿™äº›å±æ€§åŒ…æ‹¬ï¼š<code>offsetXXXã€scrollXXXã€clientXXXã€getComputedStyle()</code></li><li>é‡æ’å¿…å®šè§¦å‘é‡ç»˜</li></ul><h3 id="é‡ç»˜"><a href="#é‡ç»˜" class="headerlink" title="é‡ç»˜"></a>é‡ç»˜</h3><p>æ”¹å˜æŸä¸ªå…ƒç´ çš„èƒŒæ™¯è‰²ã€æ–‡å­—é¢œè‰²ã€è¾¹æ¡†é¢œè‰²ç­‰ç­‰ä¸å½±å“å®ƒå‘¨å›´æˆ–å†…éƒ¨å¸ƒå±€çš„å±æ€§æ—¶ï¼Œå±å¹•çš„ä¸€éƒ¨åˆ†è¦é‡ç»˜ï¼Œä½†æ˜¯å…ƒç´ çš„å‡ ä½•å°ºå¯¸æ²¡æœ‰å˜ã€‚</p><h3 id="åˆæˆå±‚"><a href="#åˆæˆå±‚" class="headerlink" title="åˆæˆå±‚"></a>åˆæˆå±‚</h3><p>åŒºåˆ«äºä¸€èˆ¬çš„å›¾å±‚ï¼Œåˆæˆå±‚ã€compositeã€‘ä½¿ç”¨GPUçº¿ç¨‹è¿›è¡Œè®¡ç®—</p><h3 id="æå‡åˆ°åˆæˆå±‚çš„æ¡ä»¶"><a href="#æå‡åˆ°åˆæˆå±‚çš„æ¡ä»¶" class="headerlink" title="æå‡åˆ°åˆæˆå±‚çš„æ¡ä»¶"></a>æå‡åˆ°åˆæˆå±‚çš„æ¡ä»¶</h3><ul><li>3D<code>transform</code></li><li><code>opacity</code></li><li><code>filter</code></li><li><code>will-change</code></li><li><code>&lt;video&gt;,&lt;audio&gt;,&lt;canvas&gt;</code></li><li><code>position:fixed</code></li></ul><h3 id="è§£æURLå‚æ•°"><a href="#è§£æURLå‚æ•°" class="headerlink" title="è§£æURLå‚æ•°"></a>è§£æURLå‚æ•°</h3><ol><li><p>æ­£åˆ™è§£æ</p> <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseQueryString</span>(<span class="hljs-params">url</span>)</span>&#123;  <span class="hljs-keyword">const</span> rule = <span class="hljs-regexp">/([^?=&amp;]+)=([^&amp;#]*)/g</span>    <span class="hljs-keyword">return</span> url.match(rule).reduce(<span class="hljs-function">(<span class="hljs-params">a,b</span>)=&gt;</span>&#123;    <span class="hljs-keyword">let</span> [k,v] = b.split(<span class="hljs-string">&#x27;=&#x27;</span>)    k = <span class="hljs-built_in">decodeURIComponent</span>(k)    v = decodeIRIComponent(v)    a[k] = a[k] ? [...a[k],v] : v    <span class="hljs-keyword">return</span> a  &#125;,&#123;&#125;)  <span class="hljs-keyword">return</span> res&#125;</code></pre></div></li><li><p>APIè§£æ</p><p> URLSearchParams<br> <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/URLSearchParams">https://developer.mozilla.org/zh-CN/docs/Web/API/URLSearchParams</a></p> <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseURL</span>(<span class="hljs-params">url</span>)</span>&#123;  <span class="hljs-keyword">const</span> urlObj = <span class="hljs-keyword">new</span> URLSearchParams(url.slice(url.indexOf(<span class="hljs-string">&#x27;?&#x27;</span>)))  <span class="hljs-keyword">const</span> res = []  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> urlObj.keys())&#123;    res[key] = urlObj.getAll(key)  &#125;  <span class="hljs-keyword">return</span> res&#125;</code></pre></div></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»£ç æäº¤è§„èŒƒæ–°æ‰‹åŒ…</title>
    <link href="/2022/01/17/%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83%E6%96%B0%E6%89%8B%E5%8C%85/"/>
    <url>/2022/01/17/%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83%E6%96%B0%E6%89%8B%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h2 id="commit-æäº¤å·¥å…·"><a href="#commit-æäº¤å·¥å…·" class="headerlink" title="commit æäº¤å·¥å…·"></a>commit æäº¤å·¥å…·</h2><ul><li><p>å®‰è£…</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">npm i -d commitizen</code></pre></div></li><li><p>é¢„è®¾é…ç½®</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// é¢„è®¾</span>npm i -d cz-conventional-changelog</code></pre></div></li><li><p>ä¿®æ”¹<code>package.json</code></p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// æ·»åŠ config</span><span class="hljs-string">&quot;config&quot;</span>: &#123;  <span class="hljs-string">&quot;commitizen&quot;</span>: &#123;    <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;cz-conventional-changelog&quot;</span>  &#125;&#125;</code></pre></div></li><li><p>äº¤äº’å¼æäº¤</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// æ·»åŠ åˆ°script</span><span class="hljs-string">&quot;commit&quot;</span>:<span class="hljs-string">&quot;cz&quot;</span><span class="hljs-comment">//æˆ–è€…ç›´æ¥</span>cz</code></pre></div></li></ul><h2 id="commit-æ ¡éªŒå·¥å…·"><a href="#commit-æ ¡éªŒå·¥å…·" class="headerlink" title="commit æ ¡éªŒå·¥å…·"></a>commit æ ¡éªŒå·¥å…·</h2><ul><li><p>å®‰è£…</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// husky - gitçš„é’©å­å·¥å…·</span><span class="hljs-comment">// commitlint - æ ¡éªŒå·¥å…·</span>npm i -d husky commitlint</code></pre></div></li><li><p>é…ç½®</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">npm i -d @commitlint/config-conventional<span class="hljs-comment">//  .commitlintrc.js</span><span class="hljs-built_in">module</span>.exports = &#123;  <span class="hljs-keyword">extends</span>:   <span class="hljs-comment">// angluar è§„èŒƒæ ¡éªŒ</span>  [<span class="hljs-string">&#x27;@commitlint/config-conventional&#x27;</span>]&#125;;</code></pre></div><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// åˆå§‹åŒ–husky</span>npx husky install<span class="hljs-comment">// æ–°å»ºæ–‡ä»¶ .husky/commit-msg</span>#!/bin/shnpx --no-install commitlint --edit <span class="hljs-string">&quot;$1&quot;</span></code></pre></div></li><li><p>ä¹‹åçš„æ‰€æœ‰commitä¿¡æ¯éƒ½å°†æ ¡éªŒå¹¶æŠ›å‡ºæ ¡éªŒé”™è¯¯ç»“æœ</p></li></ul><h2 id="ç”ŸæˆCHANGELOG"><a href="#ç”ŸæˆCHANGELOG" class="headerlink" title="ç”ŸæˆCHANGELOG"></a>ç”ŸæˆCHANGELOG</h2><ul><li><p>å®‰è£…</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">npm i -D standard-version</code></pre></div></li><li><p>æ·»åŠ script</p><div class="hljs code-wrapper"><pre><code class="hljs javascript">&#123;  <span class="hljs-string">&quot;scripts&quot;</span>: &#123;    <span class="hljs-string">&quot;release&quot;</span>: <span class="hljs-string">&quot;standard-version&quot;</span>  &#125;&#125;</code></pre></div></li><li><p>è¿è¡Œåä¼šè‡ªåŠ¨ç”Ÿæˆ<code>CHANGELOG.md</code>ï¼Œå½“æäº¤ç±»å‹æ˜¯featå’Œfixçš„æ—¶å€™ç‰ˆæœ¬å·ä¼šç´¯åŠ </p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mapbox-glåŠ¨æ€styleè¡¨è¾¾å¼</title>
    <link href="/2022/01/17/Mapbox-gl%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <url>/2022/01/17/Mapbox-gl%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<p><a href="https://docs.mapbox.com/mapbox-gl-js/style-spec/expressions/">https://docs.mapbox.com/mapbox-gl-js/style-spec/expressions/</a></p><h1 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h1><ul><li>é€‚ç”¨äº<code>Style</code>ä¸­çš„<code>layout</code>,<code>paint</code>,<code>filter</code>å±æ€§ï¼Œå‡å¯æ·»åŠ è¡¨è¾¾å¼ã€‚</li><li>è¡¨è¾¾å¼å®šä¹‰äº†å¦‚ä½•ä½¿ç”¨é€»è¾‘ã€æ•°å­¦ã€å­—ç¬¦ä¸²æˆ–é¢œè‰²æ“ä½œç»„åˆ<code>feature</code>ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ª<code>properties</code>æˆ–<code>zoom</code>ï¼Œä»¥ç”Ÿæˆé€‚å½“çš„æ ·å¼å±æ€§å€¼æˆ–è¿‡æ»¤å™¨å†³ç­–ã€‚</li></ul><h2 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h2><p><code>[expression_name, argument_0, argument_1, ...]</code></p><ol><li>å¸¸ç”¨æ“ä½œç¬¦<code>expression_name</code></li></ol><ul><li><code>*</code></li><li><code>case</code></li><li><code>==,&gt;=,&lt;</code>(æ¯”è¾ƒçš„ä¸¤è¾¹ç±»å‹éœ€è¦ç›¸åŒï¼Œéƒ½æ˜¯æ•°å­—æˆ–éƒ½æ˜¯å­—ç¬¦ä¸²)</li><li><code>match</code></li><li><code>all</code></li><li><code>contact</code><br>â€¦  </li></ul><ol><li><p>å¤§éƒ¨åˆ†æ“ä½œç¬¦å¯ä»¥å¤šçº§åµŒå¥—</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-string">&quot;line-dasharray&quot;</span>: [<span class="hljs-string">&quot;case&quot;</span>,[<span class="hljs-string">&quot;==&quot;</span>, [<span class="hljs-string">&quot;get&quot;</span>, <span class="hljs-string">&quot;customStatus&quot;</span>], <span class="hljs-string">&quot;PLANING&quot;</span>], <span class="hljs-comment">// è§„åˆ’</span>[<span class="hljs-string">&quot;literal&quot;</span>, [<span class="hljs-number">4</span>, <span class="hljs-number">4</span>]],[<span class="hljs-string">&quot;==&quot;</span>, [<span class="hljs-string">&quot;get&quot;</span>, <span class="hljs-string">&quot;customStatus&quot;</span>], <span class="hljs-string">&quot;TEST&quot;</span>], <span class="hljs-comment">// æµ‹è¯•</span>[<span class="hljs-string">&quot;literal&quot;</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]],<span class="hljs-comment">// å›é€€é€‰é¡¹</span>[<span class="hljs-string">&quot;literal&quot;</span>, [<span class="hljs-number">1</span>]],],</code></pre></div></li><li><p>å®šä¹‰å˜é‡çš„è¡¨è¾¾å¼<br>å˜é‡éœ€è¦è®¾å®šåœ¨ä½¿ç”¨å˜é‡çš„å¤–å±‚è¡¨è¾¾å¼</p></li><li><p>è·å–featureå±æ€§</p></li></ol><ul><li><code>[&#39;get&#39;,&#39;propName&#39;]</code>è·å–propertieså¯¹è±¡ä¸­çš„å±æ€§</li><li><code>$propName</code>è·å–å®šä¹‰åœ¨featureå¯¹è±¡é¡¶å±‚çš„å±æ€§ï¼Œä¾‹å¦‚<code>$type</code>,<code>$geometry</code><br>``</li></ul><h2 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h2><ul><li>dataè¡¨è¾¾å¼<div class="hljs code-wrapper"><pre><code class="hljs javascript">&#123;    <span class="hljs-string">&quot;circle-color&quot;</span>: [        <span class="hljs-string">&quot;rgb&quot;</span>,        <span class="hljs-comment">// red is higher when feature.properties.temperature is higher</span>        [<span class="hljs-string">&quot;get&quot;</span>, <span class="hljs-string">&quot;temperature&quot;</span>],<span class="hljs-comment">// ræ•°å€¼å–temperatureæ•°å€¼</span>        <span class="hljs-comment">// green is always zero</span>        <span class="hljs-number">0</span>,        <span class="hljs-comment">// blue is higher when feature.properties.temperature is lower</span>        [<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-number">100</span>, [<span class="hljs-string">&quot;get&quot;</span>, <span class="hljs-string">&quot;temperature&quot;</span>]]<span class="hljs-comment">// bæ•°å€¼=100-temp</span>    ]&#125;</code></pre></div></li><li>cameraè¡¨è¾¾å¼<div class="hljs code-wrapper"><pre><code class="hljs javascript">&#123;    <span class="hljs-string">&quot;circle-radius&quot;</span>: [        <span class="hljs-string">&quot;interpolate&quot;</span>, [<span class="hljs-string">&quot;linear&quot;</span>], [<span class="hljs-string">&quot;zoom&quot;</span>],        <span class="hljs-comment">// zoom is 5 (or less) -&gt; circle radius will be 1px</span>        <span class="hljs-number">5</span>, <span class="hljs-number">1</span>,        <span class="hljs-comment">// zoom 5åˆ°10ä¸¤ä¸ªå®šä¹‰æ¡£ä½ä¹‹é—´ï¼Œinterpolateè¿ç®—ç¬¦è®²çº¿æ€§è®¡ç®—æ•°å€¼</span>        <span class="hljs-comment">// zoom is 10 (or greater) -&gt; circle radius will be 5px</span>        <span class="hljs-number">10</span>, <span class="hljs-number">5</span>    ]&#125;</code></pre></div></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>mapbox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è„šæ‰‹æ¶æ­å»º&amp;Lernaæ–°æ‰‹åŒ…</title>
    <link href="/2022/01/10/cli%E5%88%9D%E4%BD%93%E9%AA%8C/"/>
    <url>/2022/01/10/cli%E5%88%9D%E4%BD%93%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="è„šæ‰‹æ¶å·¥å…·"><a href="#è„šæ‰‹æ¶å·¥å…·" class="headerlink" title="è„šæ‰‹æ¶å·¥å…·"></a>è„šæ‰‹æ¶å·¥å…·</h1><h2 id="è„šæ‰‹æ¶ç»“æ„"><a href="#è„šæ‰‹æ¶ç»“æ„" class="headerlink" title="è„šæ‰‹æ¶ç»“æ„"></a>è„šæ‰‹æ¶ç»“æ„</h2><ul><li><p>æ–‡ä»¶å¤´éƒ¨</p><p>  <code>#!/usr/bin/env node</code></p></li><li><p>å‘½ä»¤ç»“æ„</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">vue &lt;command&gt;  [options]  --options params&lt;!-- <span class="hljs-comment">// eg: --&gt;</span>vue create my_app -p env=...</code></pre></div></li></ul><h2 id="æœ¬åœ°å¼€å‘"><a href="#æœ¬åœ°å¼€å‘" class="headerlink" title="æœ¬åœ°å¼€å‘"></a>æœ¬åœ°å¼€å‘</h2><ul><li><p>é“¾æ¥æœ¬åœ°è„šæ‰‹æ¶</p><div class="hljs code-wrapper"><pre><code class="hljs">  `npm link`å…¨å±€node_modulesä¸­æ·»åŠ ç›®å‰åº“</code></pre></div></li><li><p>é“¾æ¥æœ¬åœ°è„šæ‰‹æ¶çš„ä¾èµ–åº“</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// lib dir </span>npm link<span class="hljs-comment">// åŒæ—¶æ³¨æ„åœ¨è„šæ‰‹æ¶çš„package.jsonä¸­æ‰‹åŠ¨ </span>dependencies:&#123;    <span class="hljs-string">&quot;xxx-lib&quot;</span>:<span class="hljs-string">&quot;^1.0.0&quot;</span>&#125;<span class="hljs-comment">// cli dir</span>npm link xx-lib</code></pre></div></li><li><p>è§£å¼€æœ¬åœ°libå’Œæœ¬åœ°åŒ…çš„é“¾æ¥</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// lib dir</span>npm unlink<span class="hljs-comment">// cli dir</span>rm -rf node_modulesnpm unlink xxx-lib</code></pre></div></li></ul><h3 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h3><ul><li><code>npm link/unlink</code>é“¾æ¥å½“å‰é¡¹ç›®åˆ°å…¨å±€</li><li><code>npm link/unlink xxx-lib</code>å°†xxx-liæ·»åŠ /ä»å½“å‰node_modulesä¸­ç§»é™¤</li></ul><h1 id="Lerna"><a href="#Lerna" class="headerlink" title="Lerna"></a>Lerna</h1><h2 id="åŸºäºGit-Npmçš„å¤špackageé¡¹ç›®ç®¡ç†å·¥å…·"><a href="#åŸºäºGit-Npmçš„å¤špackageé¡¹ç›®ç®¡ç†å·¥å…·" class="headerlink" title="åŸºäºGit+Npmçš„å¤špackageé¡¹ç›®ç®¡ç†å·¥å…·"></a>åŸºäºGit+Npmçš„å¤špackageé¡¹ç›®ç®¡ç†å·¥å…·</h2><ol><li><p>è§£å†³åŸç”Ÿè„šæ‰‹æ¶å¼€å‘ä¸­çš„é‡å¤æ“ä½œ</p><ul><li>å¤špackageæœ¬åœ°link</li><li>å¤špackageä¾èµ–å®‰è£…</li><li>å¤špackageå•å…ƒæµ‹è¯•</li><li>å¤špackageä»£ç æäº¤</li><li>å¤špackageä»£ç å‘å¸ƒ</li></ul></li><li><p>è§£å†³ç‰ˆæœ¬ä¸€è‡´æ€§</p><ul><li>packageç‰ˆæœ¬ä¸€è‡´</li><li>ç›¸äº’ä¾èµ–ç‰ˆæœ¬å‡çº§</li></ul></li></ol><h2 id="lernaå¼€å‘è„šæ‰‹æ¶æµç¨‹"><a href="#lernaå¼€å‘è„šæ‰‹æ¶æµç¨‹" class="headerlink" title="lernaå¼€å‘è„šæ‰‹æ¶æµç¨‹"></a>lernaå¼€å‘è„šæ‰‹æ¶æµç¨‹</h2><ol><li><p>é¡¹ç›®åˆ›å»º</p> <div class="hljs code-wrapper"><pre><code class="hljs javascript">npm init npm i lernalerna init</code></pre></div></li><li><p>åˆ›å»ºpackage</p> <div class="hljs code-wrapper"><pre><code class="hljs javascript">lerna create <span class="hljs-comment">// åˆ›å»ºpackage</span>lerna add <span class="hljs-comment">//å®‰è£…ä¾èµ–</span>lerna <span class="hljs-comment">//é“¾æ¥ä¾èµ–</span></code></pre></div></li><li><p>å¼€å‘æµ‹è¯•</p> <div class="hljs code-wrapper"><pre><code class="hljs javascript">lerna exec <span class="hljs-comment">// æ‰§è¡Œshellè„šæœ¬</span>lerna runlerna clean <span class="hljs-comment">// æ¸…ç©ºä¾èµ–</span>lerna bootstrap <span class="hljs-comment">// é‡è£…ä¾èµ–</span></code></pre></div></li><li><p>å‘å¸ƒä¸Šçº¿</p> <div class="hljs code-wrapper"><pre><code class="hljs javascript">lerna version <span class="hljs-comment">// æå‡ç‰ˆæœ¬å·</span>lerna change <span class="hljs-comment">//  æŸ¥çœ‹å˜æ›´</span>lerna diff <span class="hljs-comment">// æŸ¥çœ‹diff</span>lerna public <span class="hljs-comment">// å‘å¸ƒ</span></code></pre></div></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>å·¥ç¨‹åŒ–</tag>
      
      <tag>cli</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>graphqlæ–°æ‰‹åŒ…</title>
    <link href="/2022/01/04/graphql%E6%96%B0%E6%89%8B%E5%8C%85/"/>
    <url>/2022/01/04/graphql%E6%96%B0%E6%89%8B%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h2 id="GraphQl"><a href="#GraphQl" class="headerlink" title="GraphQl"></a>GraphQl</h2><p><code>GraphQL</code>æ˜¯ä¸€ä¸ªæ—¨åœ¨ç®€åŒ–å‰ç«¯å’Œåç«¯ä¹‹é—´é€šä¿¡çš„è§„èŒƒã€‚å®ƒä¸»è¦ç”±æœåŠ¡ç«¯çš„ schema è¯­è¨€å’Œå®¢æˆ·ç«¯çš„æŸ¥è¯¢è¯­è¨€ç»„æˆã€‚<br>ã€_æŸ¥è¯¢è¯­æ³•å’Œ schema è¯­æ³•å‡ ä¹æ˜¯ç›¸ç­‰çš„_ã€‘ã€‚</p><p><code>gql</code>çš„ api éœ€è¦å®Œæ•´æè¿°æœŸæœ›è¿”å›çš„æ•°æ®ï¼Œç›¸å¯¹äº<code>RestFul API</code>å‡å°‘äº†æ•°æ®çš„å†—ä½™ã€‚ä¿®æ”¹ä¸€ä¸‹å®˜ç½‘çš„ç¤ºä¾‹ï¼š</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// æè¿°ä½ çš„æ•°æ®</span><span class="hljs-comment">// å®šä¹‰äº†ä¸€ä¸ªåä¸ºProjectçš„å¯¹è±¡ç±»å‹ï¼Œè¯¥ç±»å‹ä¸Šæœ‰ä¸‰ä¸ªå­—æ®µï¼Œå¹¶ä¸”å­—æ®µæ‹¥æœ‰ä¸åŒçš„æ•°æ®ç±»å‹</span>type Project &#123;  name: <span class="hljs-built_in">String</span>  tagline: <span class="hljs-built_in">String</span>  contributors: [User]&#125;<span class="hljs-comment">// è¯·æ±‚ä½ æ‰€è¦çš„æ•°æ®</span><span class="hljs-comment">// è¯·æ±‚projectä¸­ï¼Œnameå€¼ä¸ºå­—ç¬¦ä¸²â€˜GraphQlâ€™çš„æ•°æ®ï¼Œå¹¶è¿”å›ä»–çš„taglineå­—æ®µ</span>&#123;  <span class="hljs-function"><span class="hljs-title">project</span>(<span class="hljs-params">name: <span class="hljs-string">&quot;GraphQL&quot;</span></span>)</span> &#123;    tagline  &#125;&#125;<span class="hljs-comment">// å¾—åˆ°å¯é¢„æµ‹çš„ç»“æœ</span>&#123;  <span class="hljs-string">&quot;project&quot;</span>: &#123;    <span class="hljs-string">&quot;tagline&quot;</span>: <span class="hljs-string">&quot;A query language for APIs&quot;</span>  &#125;&#125;</code></pre></div><ul><li><p>  gql å®ä½“èµ„æºä¸èƒ½é€šè¿‡ URL è¯†åˆ«</p></li><li><p>ä¸ gql æœåŠ¡å™¨çš„<strong>å…¨éƒ¨</strong>æ•°æ®äº¤äº’åŸºäºä¸€ä¸ªæŒ‡å®šçš„<code>URL</code>é€š<br>  é“</p></li><li><p>æ ‡å‡†çš„ gql GET è¯·æ±‚</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">http:<span class="hljs-comment">//myapi/graphql?query=&#123;me&#123;name&#125;&#125;</span>&#123;  me&#123;    name  &#125;&#125;</code></pre></div></li><li><p>æ ‡å‡†çš„ gql POST è¯·æ±‚</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">content-type:application/json&#123;  <span class="hljs-string">&quot;query&quot;</span>: æŸ¥è¯¢çš„å¯¹è±¡åŠå‚æ•°,  <span class="hljs-string">&quot;operationName&quot;</span>: <span class="hljs-string">&quot;...&quot;</span>,  <span class="hljs-string">&quot;variables&quot;</span>: å˜é‡å½¢å¼çš„å‚æ•°ä¼ å‚&#125;<span class="hljs-comment">// å¹¶ä¸”ä¸€èˆ¬ä¼šå‘èµ·ä¸¤æ¬¡è¯·æ±‚ï¼Œå…ˆå‘ä¸€æ¬¡OPTIONï¼Œ</span></code></pre></div></li></ul><h3 id="gql-æ–‡ä»¶"><a href="#gql-æ–‡ä»¶" class="headerlink" title="gql æ–‡ä»¶"></a>gql æ–‡ä»¶</h3><ul><li>  æ¯”è¾ƒæ–¹ä¾¿çš„ç®¡ç† gql æ¥å£çš„æ–¹å¼å°±æ˜¯é¢„å…ˆç¼–å†™<code>.graphql</code>æ–‡ä»¶ï¼Œæ–¹ä¾¿å¤ç”¨å’Œæ‹“å±•ã€‚</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// åœ¨ä¸€ä¸ªgqlæ–‡ä»¶å†…å£°æ˜å¤šä¸ªqueryï¼Œéœ€è¦å‘½åqueryï¼Œå¹¶æ”¯æŒes6ç»“æ„å¼•ç”¨ã€‚å•ä¸ªqueryè¯·æ±‚æ–‡ä»¶åˆ™å¯ä¸å‘½åã€‚</span>query queryxxx(  $variable1: <span class="hljs-built_in">String</span>  $variable2: [<span class="hljs-built_in">String</span>])&#123;  myCoWorkers(    name:$variable1    gender:$variable2  )&#123;    name    age    gender    nation  &#125;&#125;</code></pre></div><ul><li>  ä¹Ÿå¯ä»¥åœ¨è¯·æ±‚æ—¶æ‰‹åŠ¨ç¼–å†™ï¼ˆéœ€å®‰è£…â€™graphql-tagâ€™ï¼‰</li></ul><div class="hljs code-wrapper"><pre><code class="hljs javascript">$apollo.query(  query:gql<span class="hljs-string">`query tagList &#123;</span><span class="hljs-string">      tags &#123;</span><span class="hljs-string">        id,</span><span class="hljs-string">        label</span><span class="hljs-string">      &#125;</span><span class="hljs-string">    &#125;`</span>)</code></pre></div><h2 id="ApolloClient"><a href="#ApolloClient" class="headerlink" title="ApolloClient"></a>ApolloClient</h2><p><code>Apollo</code>æ˜¯å®ç° gql æ ‡å‡†çš„å®¢æˆ·ç«¯ï¼Œ(å¯ä»¥ç†è§£æˆä½¿ç”¨ gql çš„<code>axios</code>)ã€‚å„å¤§æ¡†æ¶å’Œå¼€å‘åœºæ™¯éƒ½æœ‰å¯¹åº”çš„æ•´åˆåº“ï¼Œå¦‚<code>VueApollo</code>ã€‚</p><h3 id="å¸¸ç”¨-api-é€‰é¡¹"><a href="#å¸¸ç”¨-api-é€‰é¡¹" class="headerlink" title="å¸¸ç”¨ api/é€‰é¡¹"></a>å¸¸ç”¨ api/é€‰é¡¹</h3><p><a href="https://vue-apollo.netlify.app/zh-cn/api/smart-query.html#%E9%80%89%E9%A1%B9">https://vue-apollo.netlify.app/zh-cn/api/smart-query.html#%E9%80%89%E9%A1%B9</a></p><ul><li><p>  query æŸ¥è¯¢è¡¨ï¼ˆå¯ä»¥æ˜¯ queryï¼Œmutationï¼‰</p></li><li><p>  variables å˜é‡</p></li><li><p>fetchPolicy ç¼“å­˜é€‰é¡¹</p>  <div class="hljs code-wrapper"><pre><code class="hljs markdown"><span class="hljs-section"># cache-first[default]</span>Apollo Client é¦–å…ˆå¯¹ç¼“å­˜æ‰§è¡ŒæŸ¥è¯¢ã€‚å¦‚æœç¼“å­˜ä¸­å­˜åœ¨æ‰€æœ‰è¯·æ±‚çš„æ•°æ®ï¼Œåˆ™è¿”å›è¯¥æ•°æ®ã€‚å¦åˆ™ï¼ŒApollo Client ä¼šé’ˆå¯¹æ‚¨çš„ GraphQL æœåŠ¡å™¨æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶åœ¨ç¼“å­˜æ•°æ®åè¿”å›è¯¥æ•°æ®ã€‚<span class="hljs-section"># cache-only</span>Apollo Client ä»…é’ˆå¯¹ç¼“å­˜æ‰§è¡ŒæŸ¥è¯¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ°¸è¿œä¸ä¼šæŸ¥è¯¢æ‚¨çš„æœåŠ¡å™¨ã€‚å¦‚æœç¼“å­˜ä¸åŒ…å«æ‰€æœ‰è¯·æ±‚å­—æ®µçš„æ•°æ®ï¼Œåˆ™ä¼šå¼•å‘é”™è¯¯ã€‚<span class="hljs-section"># cache-and-network</span>Apollo Client å¯¹ç¼“å­˜å’Œ GraphQL æœåŠ¡å™¨æ‰§è¡Œå®Œæ•´æŸ¥è¯¢ã€‚å¦‚æœæœåŠ¡å™¨ç«¯æŸ¥è¯¢çš„ç»“æœä¿®æ”¹äº†ç¼“å­˜å­—æ®µï¼Œåˆ™æŸ¥è¯¢ä¼šè‡ªåŠ¨æ›´æ–°ã€‚<span class="hljs-section"># network-only</span>Apollo Client ä¼šé’ˆå¯¹æ‚¨çš„ GraphQL æœåŠ¡å™¨æ‰§è¡Œå®Œæ•´æŸ¥è¯¢ï¼Œè€Œæ— éœ€å…ˆæ£€æŸ¥ç¼“å­˜ã€‚æŸ¥è¯¢çš„ç»“æœå­˜å‚¨åœ¨ç¼“å­˜ä¸­ã€‚<span class="hljs-section"># no-cache</span>ä¸ network-only ç±»ä¼¼, ä½†ä¸ç¼“å­˜ç»“æœã€‚<span class="hljs-section"># standby</span>ä½¿ç”¨ä¸ cache-first ç›¸åŒçš„é€»è¾‘ï¼Œé™¤äº†å½“åŸºç¡€å­—æ®µå€¼æ›´æ”¹æ—¶æ­¤æŸ¥è¯¢ä¸ä¼šè‡ªåŠ¨æ›´æ–°ã€‚æ‚¨ä»ç„¶å¯ä»¥ä½¿ç”¨ refetch å’Œ updateQueries æ‰‹åŠ¨æ›´æ–°æ­¤æŸ¥è¯¢ã€‚</code></pre></div></li><li><p>  pollInterval è½®è¯¢ï¼ˆé—´éš” x æ¯«ç§’ï¼‰</p></li><li><p>  fetchMore åŠ è½½æ›´å¤šï¼ˆå¯ä»¥æ”¹å˜ä¸ªåˆ«æˆ–å…¨éƒ¨å‚æ•°å‘é€åŒä¸€ä¸ªè¯·æ±‚ï¼Œéœ€æ‰‹åŠ¨å¤„ç†è¯·æ±‚ç»“æœï¼‰</p></li></ul><h3 id="ä½¿ç”¨-Apolloï¼ˆvue-v2ï¼‰"><a href="#ä½¿ç”¨-Apolloï¼ˆvue-v2ï¼‰" class="headerlink" title="ä½¿ç”¨ Apolloï¼ˆvue v2ï¼‰"></a>ä½¿ç”¨ Apolloï¼ˆvue v2ï¼‰</h3><ul><li><p>å®‰è£…<code>Apollo</code></p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">yarn add vue-apollo graphql apollo-boost#  apollo-boost æ˜¯åˆ›å»ºapollo clientçš„æ‡’äººåŒ…ï¼ŒåŒ…å«å¸¸ç”¨çš„é»˜è®¤å€¼ï¼Œæ— éœ€ç¹ççš„æ‰‹åŠ¨é…ç½®ornpm install --save vue-apollo graphql apollo-client apollo-link apollo-link-http apollo-cache-inmemory graphql-tag</code></pre></div></li><li><p>å°è£…<code>ApolloClient</code></p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> ApolloClient <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;apollo-boost&quot;</span>;<span class="hljs-keyword">const</span> $apollo = <span class="hljs-keyword">new</span> ApolloClient(&#123;<span class="hljs-attr">uri</span>:<span class="hljs-string">&#x27;xxx&#x27;</span>&#125;)<span class="hljs-comment">// or</span><span class="hljs-comment">// å°è£…ä¸¾ä¾‹</span><span class="hljs-comment">// è¶…æ—¶</span><span class="hljs-keyword">import</span> ApolloLinkTimeout <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;apollo-link-timeout&quot;</span>;<span class="hljs-keyword">const</span> timeoutLink = <span class="hljs-keyword">new</span> ApolloLinkTimeout(<span class="hljs-number">30000</span>);<span class="hljs-comment">// ç¼“å­˜</span><span class="hljs-keyword">import</span> &#123; InMemoryCache &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;apollo-cache-inmemory&#x27;</span><span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> InMemoryCache()<span class="hljs-comment">// link</span><span class="hljs-keyword">const</span> httpLink = createHttpLink(&#123; <span class="hljs-attr">uri</span>: <span class="hljs-string">&#x27;xxx&#x27;</span> &#125;);<span class="hljs-keyword">const</span> timeoutHttpLink = timeoutLink.concat(httpLink);<span class="hljs-keyword">const</span> apolloClient = <span class="hljs-keyword">new</span> ApolloClient(&#123;  version:<span class="hljs-string">&#x27;&#x27;</span>,  name:<span class="hljs-string">&#x27;&#x27;</span>,  link: timeoutHttpLink,<span class="hljs-comment">//åŒæ—¶æä¾›æ—¶ä¼˜å…ˆçº§é«˜äºuriï¼Œæä¾›æ›´ç²¾ç»†åŒ–çš„é…ç½®</span>  cache: <span class="hljs-comment">// InMemoryCache (&#123;......&#125;) ç¼“å­˜æ§åˆ¶ www.apollographql.com/docs/react/caching/cache-configuration/`</span>  defaultOptions:&#123;      watchQuery: &#123;        fetchPolicy: <span class="hljs-string">&#x27;cache-and-network&#x27;</span>,        errorPolicy: <span class="hljs-string">&#x27;ignore&#x27;</span>,      &#125;,      query: &#123;        fetchPolicy: <span class="hljs-string">&#x27;network-only&#x27;</span>,        errorPolicy: <span class="hljs-string">&#x27;all&#x27;</span>,      &#125;,      mutate: &#123;        errorPolicy: <span class="hljs-string">&#x27;all&#x27;</span>,      &#125;    &#125;<span class="hljs-comment">//&#x27;å„ç§æŸ¥è¯¢çš„é»˜è®¤ç­–ç•¥&#x27;</span>  &#125;);</code></pre></div></li><li><p>ä½¿ç”¨æ–¹æ³•</p><ul><li><h4 id="apollo-provider"><a href="#apollo-provider" class="headerlink" title="apollo provider"></a>apollo provider</h4><p>  ä½¿ç”¨ apollo ç»„ä»¶ï¼Œéœ€å…ˆç”Ÿæˆ<code>apollo provider</code>ï¼Œä¸º vue å®ä¾‹æä¾› apollo èƒ½åŠ›</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">Vue.use(VueApollo);<span class="hljs-keyword">const</span> apolloProvider = <span class="hljs-keyword">new</span> VueApollo(&#123;defaultClient: apolloClient,&#125;);<span class="hljs-keyword">new</span> Vue(&#123;el: <span class="hljs-string">&quot;#app&quot;</span>,<span class="hljs-comment">// åƒ vue-router æˆ– vuex ä¸€æ ·æ³¨å…¥ apolloProvider</span>apolloProvider,render: <span class="hljs-function">(<span class="hljs-params">h</span>) =&gt;</span> h(App),&#125;);</code></pre></div><p>  å¼•å…¥åä¹‹åï¼Œåœ¨ä½ çš„æ¯ä¸ª vue ç»„ä»¶å®ä¾‹ä¸Šå°†å¤šå‡º$apollo å¯¹è±¡æŒ‡å‘ apollo å®¢æˆ·ç«¯ã€‚</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">this</span>.$apollo ===&gt;&#123;<span class="hljs-attr">query</span>:[....],&#125;</code></pre></div><p>  å¹¶ä¸”ä¸ data é€‰é¡¹å¹³è¡Œçš„ apollo é€‰æ‹©ä¸­å¯ä»¥è‡ªå®šä¹‰å„ç§ gql æŸ¥è¯¢ï¼Œå¹¶ä¸”ä»–ä»¬çš„ç»“æœå°†ä½œä¸º vue å˜é‡æ¥ä½¿ç”¨</p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span>&#123;  <span class="hljs-keyword">return</span> &#123;    a:<span class="hljs-number">1</span>  &#125;&#125;,apollo:&#123;  fetchB:&#123;    query:...,    variables:...,    fetchPolicy:...,    ...å„ç§apolloçš„apié€‰é¡¹  &#125;&#125;</code></pre></div></li><li><h4 id="apollo-ç»„ä»¶"><a href="#apollo-ç»„ä»¶" class="headerlink" title="apollo ç»„ä»¶"></a>apollo ç»„ä»¶</h4><p>  åœ¨ç»„ä»¶æ¨¡ç‰ˆä¸­ç¼–å†™ gql æŸ¥è¯¢ï¼ŒåŒæ—¶é€šè¿‡æ’æ§½<code>slot</code>åˆ†å‘è¯·æ±‚ç»“æœ,åˆ†åˆ«æœ‰<code>ApolloQuery</code>,<code>ApolloMutation</code>,<code>ApolloSubscribeToMore</code></p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;template&gt;  &lt;!-- Apollo æŸ¥è¯¢ --&gt;  &lt;ApolloQuery :query=<span class="hljs-string">&quot;/* ä¸€äº›æŸ¥è¯¢ */&quot;</span>&gt;    &lt;!-- ç»“æœå°†è‡ªåŠ¨æ›´æ–° --&gt;    &lt;template slot-scope=<span class="hljs-string">&quot;&#123; result: &#123; data, loading &#125; &#125;&quot;</span>&gt;      &lt;!-- ä¸€äº›å†…å®¹ --&gt;      &lt;div v-<span class="hljs-keyword">if</span>=<span class="hljs-string">&quot;loading&quot;</span>&gt;Loading...&lt;/div&gt;      &lt;ul v-<span class="hljs-keyword">else</span>&gt;        &lt;li v-<span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;user of data.users&quot;</span> <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;user&quot;</span>&gt;          &#123;&#123; user.name &#125;&#125;        &lt;/li&gt;      &lt;/ul&gt;    &lt;/template&gt;  &lt;/ApolloQuery&gt;&lt;/template&gt;</code></pre></div></li><li><h4 id="çº¯-api-å°è£…"><a href="#çº¯-api-å°è£…" class="headerlink" title="çº¯ api å°è£…"></a>çº¯ api å°è£…</h4><p>  åŸºæœ¬ä¸Šæ²¡æœ‰ä¾µå…¥æ€§çš„ä½¿ç”¨æ–¹æ³•ï¼Œå°è£…æˆå‡½æ•°å¼çš„ apiï¼Œä¸éœ€è¦åœ¨å®ä¾‹ä¸­æ’å…¥<code>Apollo Provider</code>å’Œ<code>vue.use(vueApollo)</code></p>  <div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// ä¼ªä»£ç </span><span class="hljs-keyword">import</span> apolloclient<span class="hljs-keyword">import</span> gqlå›¾è¡¨æ–‡ä»¶<span class="hljs-comment">// apolloè¯·æ±‚åŸºäºpromise</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> xxxapi = <span class="hljs-keyword">async</span> (params) =&gt; &#123;  <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> $apollo.query(&#123;    query:ï¼Œ    variables:&#123;&#125;,    fetchPolicy,    ...    ...å„ç§å‚æ•°  &#125;)&#125;</code></pre></div><p>  ç„¶ååœ¨ä½ çš„ js ä»£ç ä¸­å¼•å…¥,ç†Ÿæ‚‰çš„å‘³é“ç†Ÿæ‚‰çš„é…æ–¹</p></li></ul></li></ul><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ç›¸è¾ƒäº<code>restful</code>å°‘äº†å¤§é‡å¤„ç†æ•°æ®çš„æ­¥éª¤ï¼Œæ¥å£å¤©ç„¶æ›´åŠ å®‰å…¨(å‚æ•°ç±»å‹å‚æ•°æ•°é‡å¯¹ä¸ä¸Šéƒ½ä¼šè¯·æ±‚å¤±è´¥)ï¼Œapollo åŠŸèƒ½ä¹Ÿæ˜¯ååˆ†å¼ºå¤§ï¼ˆè½®è¯¢ï¼Œåˆ†é¡µï¼Œç¼“å­˜ï¼‰ï¼Œå†å›å»ç”¨ restful ä¼šæœ‰ä¸€ç§ç•¥éš¾å—çš„æ„Ÿè§‰ã€‚å¹¶ä¸”åç«¯çš„åŒå­¦ä¹Ÿè¡¨ç¤ºèˆ’æœã€‚</p><p>ä¹‹åæ‰“ç®—åœ¨åˆ«çš„é¡¹ç›®é‡Œé™†ç»­è¯•ä¸€è¯•æ™ºèƒ½æŸ¥è¯¢å’Œ apollo ç»„ä»¶ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰è€¦åˆåº¦ä½çš„æ¥å…¥æ–¹å¼æˆ–è€…å¤ç”¨çš„ apollo ç»„ä»¶ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>graphql</tag>
      
      <tag>apollo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jsè®¾è®¡æ¨¡å¼</title>
    <link href="/2021/09/09/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    <url>/2021/09/09/javascript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<p><a href="https://item.jd.com/11747684.html">javascriptè®¾è®¡æ¨¡å¼ å¼ å®¹é“­</a></p><h2 id="åˆ›å»ºæ€§è®¾è®¡æ¨¡å¼"><a href="#åˆ›å»ºæ€§è®¾è®¡æ¨¡å¼" class="headerlink" title="åˆ›å»ºæ€§è®¾è®¡æ¨¡å¼"></a>åˆ›å»ºæ€§è®¾è®¡æ¨¡å¼</h2><ul><li><h3 id="å®‰å…¨æ¨¡å¼"><a href="#å®‰å…¨æ¨¡å¼" class="headerlink" title="å®‰å…¨æ¨¡å¼"></a>å®‰å…¨æ¨¡å¼</h3><p>åˆ›å»ºå®ä¾‹æ—¶ï¼Œä¸ºäº†ä¿è¯è¢«newå…³é”®å­—æ­£ç¡®è°ƒç”¨ï¼Œå¯åœ¨æ„é€ å‡½æ•°ä¸­åŠ å…¥å¯¹thisæŒ‡å‘çš„åˆ¤æ–­ã€‚</p><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> Factory = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>)</span>&#123;  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span> <span class="hljs-keyword">instanceof</span> Factory)&#123;    ...    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">this</span>(args)  &#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Factory(...args)  &#125;&#125;</code></pre></div></li><li><h3 id="ç®€å•å·¥å‚æ¨¡å¼ï¼ˆé™æ€å·¥å‚ï¼‰"><a href="#ç®€å•å·¥å‚æ¨¡å¼ï¼ˆé™æ€å·¥å‚ï¼‰" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼ï¼ˆé™æ€å·¥å‚ï¼‰"></a>ç®€å•å·¥å‚æ¨¡å¼ï¼ˆé™æ€å·¥å‚ï¼‰</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// åˆ›å»ºå•ç‹¬ä¸€ç±»å¯¹è±¡</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Factory</span>(<span class="hljs-params">name,age,gender</span>)</span>&#123;  <span class="hljs-keyword">const</span> o = &#123;&#125;  o.name = name  o.age = age  o.gender = gender  o.say = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;my name is&quot;</span>+  <span class="hljs-built_in">this</span>.name)  &#125;  <span class="hljs-keyword">return</span> o&#125;</code></pre></div></li><li><h3 id="å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="å·¥å‚æ–¹æ³•æ¨¡å¼"></a>å·¥å‚æ–¹æ³•æ¨¡å¼</h3><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// åˆ›å»ºå¤šç±»å¯¹è±¡</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Factory</span>(<span class="hljs-params">...args</span>)</span>&#123;    ...&#125;Factory.prototype = &#123;  Product1:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-comment">// ç®€å•å·¥å‚</span>  &#125;,  Product2:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-comment">//ç®€å•å·¥å‚</span>  &#125;&#125;</code></pre></div></li><li><h3 id="æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="æŠ½è±¡å·¥å‚æ¨¡å¼"></a>æŠ½è±¡å·¥å‚æ¨¡å¼</h3><ul><li><code>æŠ½è±¡ç±»</code>ï¼šæ²¡æœ‰ä»»ä½•å±æ€§ï¼Œå¹¶ä¸”åŸå½¢ä¸Šçš„æ–¹æ³•éƒ½è¢«é™åˆ¶ä¸èƒ½ä½¿ç”¨ã€‚</li><li>ä½œç”¨ï¼šå‡è®¾å­ä»£éƒ½å¯èƒ½è°ƒç”¨ä¸€äº›è¯¥ç±»çš„å¿…è¦æ–¹æ³•ï¼Œå¦‚æœåªæ˜¯è°ƒç”¨è€Œä¸é‡å†™è¯¥æ–¹æ³•ï¼Œåˆ™ä¼šè°ƒç”¨ç±»ä¸Šçš„è¢«é™åˆ¶çš„ç‰ˆæœ¬è€Œå¾—åˆ°é”™è¯¯æç¤ºã€‚<div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> Car = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;&#125;Car.prototype = &#123;  getPrice:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;æŠ½è±¡æ–¹æ³•ä¸èƒ½è°ƒç”¨&quot;</span>)  &#125;,  getSpeed:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;æŠ½è±¡æ–¹æ³•ä¸èƒ½è°ƒç”¨&quot;</span>)  &#125;&#125;</code></pre></div></li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
      <tag>js</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
